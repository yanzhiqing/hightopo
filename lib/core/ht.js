!function(d,S,B){"use strict";function D(b,v){if("function"!=typeof v&&null!==v)throw new TypeError("Super expression must either be null or a function");b.prototype=S.create(v&&v.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),v&&gd(b,v)}function P(t){var C=S.prototype.toString.call(t);return"Array]"===C.substring(C.length-6)}function A(X,c,r,e,O,l){c=c||[],r=r||[],e=e||[];try{c.push(X);var A=Function.apply(0,c);return r[r.length]="return "+A,Function.apply(0,r).apply(0,e)}catch(W){return l&&l(W),O}}function W(M){var n={};return{get:function(F){if(n[F]!==B)return n[F];var m;switch(F){case"WEBGL_depth_texture":m=M.getExtension("WEBGL_depth_texture")||M.getExtension("MOZ_WEBGL_depth_texture")||M.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":m=M.getExtension("EXT_texture_filter_anisotropic")||M.getExtension("MOZ_EXT_texture_filter_anisotropic")||M.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":m=M.getExtension("WEBGL_compressed_texture_s3tc")||M.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||M.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":m=M.getExtension("WEBGL_compressed_texture_pvrtc")||M.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":m=M.getExtension("WEBGL_compressed_texture_etc1");break;default:m=M.getExtension(F)}return n[F]=m,m}}}function f(g,u,U){function E(){if(C!==B)return C;var j=u.get("EXT_texture_filter_anisotropic");return C=null!==j?g.getParameter(j.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function W(p){if("highp"===p){if(g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.HIGH_FLOAT).precision>0&&g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.HIGH_FLOAT).precision>0)return"highp";p="mediump"}return"mediump"===p&&g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.MEDIUM_FLOAT).precision>0&&g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var C;U=U||{};var b="undefined"!=typeof WebGL2RenderingContext&&g instanceof WebGL2RenderingContext,O=U.precision!==B?U.precision:"highp",d=W(O);d!==O&&(console.warn("WebGL:",O,"not supported, using",d,"instead."),O=d);var n,q=U.logarithmicDepthBuffer===!0,N=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS),R=g.getParameter(g.MAX_VERTEX_TEXTURE_IMAGE_UNITS),i=g.getParameter(g.MAX_TEXTURE_SIZE),Y=g.getParameter(g.MAX_CUBE_MAP_TEXTURE_SIZE),H=g.getParameter(g.MAX_VERTEX_ATTRIBS),A=g.getParameter(g.MAX_VERTEX_UNIFORM_VECTORS),f=g.getParameter(g.MAX_VARYING_VECTORS),p=g.getParameter(g.MAX_FRAGMENT_UNIFORM_VECTORS),m=R>0,F=b||!!u.get("OES_texture_float"),P=(b||!!u.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,J=m&&F,o=b?g.getParameter(g.MAX_SAMPLES):0,$=!1;return b?$=!0:(n=u.get("ANGLE_instanced_arrays"))&&($=!0,g.vertexAttribDivisor=function(R,J){return n.vertexAttribDivisorANGLE(R,J)},g.drawElementsInstanced=function(u,P,i,R,w){return n.drawElementsInstancedANGLE(u,P,i,R,w)},g.drawArraysInstanced=function(M,v,e,W){return n.drawArraysInstancedANGLE(M,v,e,W)}),{getMaxAnisotropy:E,getMaxPrecision:W,precision:O,logarithmicDepthBuffer:q,maxTextures:N,maxVertexTextures:R,maxTextureSize:i,maxCubemapSize:Y,maxAttributes:H,maxVertexUniforms:A,maxVaryings:f,maxFragmentUniforms:p,vertexTextures:m,floatFragmentTextures:F,elementTypeUint:P,floatVertexTextures:J,maxSamples:o,instancedArray:$}}function G(H,J){return H.z!==J.z?J.z-H.z:H.id-J.id}var j="ht";if(!d[j]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),d.performance&&d.performance.now||function(){var u=Date.now();d.performance||(d.performance={}),d.performance.now=function(){return Date.now()-u}}();for(var R=Date.now(),H=16,I=["ms","moz","webkit","o"],p=0;p<I.length&&!d.requestAnimationFrame;++p)d.requestAnimationFrame=d[I[p]+"RequestAnimationFrame"],d.cancelAnimationFrame=d[I[p]+"CancelAnimationFrame"]||d[I[p]+"CancelRequestAnimationFrame"];d.requestAnimationFrame||(d.requestAnimationFrame=function(V){var w=Date.now(),v=H+R-w;return 0>v&&(v=0),R=w,d.setTimeout(function(){R=Date.now(),V(performance.now())},v)}),d.cancelAnimationFrame||(d.cancelAnimationFrame=function(o){return d.clearTimeout(o)}),S.assign===B&&(S.assign=function(l){if(l===B||null===l)throw new TypeError("Cannot convert undefined or null to object");for(var h=S(l),J=1;J<arguments.length;J++){var q=arguments[J];if(q!==B&&null!==q)for(var H in q)S.prototype.hasOwnProperty.call(q,H)&&(h[H]=q[H])}return h}),d.btoa===B&&(d.btoa=function(c){for(var s,U,r=String(c),n=0,B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",J="";r.charAt(0|n)||(B="=",n%1);J+=B.charAt(63&s>>8-8*(n%1))){if(U=r.charCodeAt(n+=.75),U>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");s=s<<8|U}return J})}();var k,R,h,a,Z=d.location,T=Z&&d.document,z=null,F=B,_=d[j]={},q=d[j+"config"],m=_.Default=q&&q.Default||{},b=_.Style=q&&q.Style||{},M=_.Attr=q&&q.Attr||{},X=function(){return!0},I=function(){return!1},r=function(G){return G},p=function(z){return!z},g=_.Color=q&&q.Color||{},t=_.IsGetter=q&&q.IsGetter||{};!function(){var _=!1;try{var s=S.defineProperty({},"passive",{get:function(){return _=!0,B}});Z&&(h=k=Z)&&d.addEventListener("test",s,s),Z&&(a=R=Z)&&d.removeEventListener("test",s,s)}catch(j){_=!1}m.passiveSupported=_}();var V,U,K,x,y=m.passiveSupported,O=m.eventListenerOptionsFalse=y?{passive:!1,capture:!1}:!1,E=m.eventListenerOptionsTrue=y?{passive:!1,capture:!0}:!0,C=function(z,L,K,m){z.addEventListener(L,K,m?E:O)},v=function(G,S,W,M){G.removeEventListener(S,W,M?E:O)},o=Math,w=o.round,e=o.floor,u=o.ceil,l=o.sqrt,$=o.max,H=o.min,n=o.abs,c=o.cos,L=o.acos,N=o.sin,Y=o.pow,J=o.asin,i=o.exp,s=o.PI,Q=2*s,Yp=s/2,Qn=o.tan,Wc=o.atan2,Um=o.random,Sc=o.log,qe=function(P,q,t){return Math.max(q,Math.min(t,P))},dq=Y(2,1),Sk=!1,Mm=d.parseInt||global.parseInt,vl="2022-7-15",Dq=Z&&(d.navigator?d.navigator.platform.indexOf("Win")>-1:!1),cp=function(M){return M*M},Vr=Z&&d.setTimeout,Eh=Z&&d.clearTimeout,pl=Z&&(d.navigator?d.navigator.userAgent.toLowerCase():""),Ri=function(v){return v.test(pl)},pc=Ri(/msie/),Md=Ri(/msie/)||Ri(/trident/),Ko=Ri(/msie 10/),hd=Ri(/edge/),kl=Ri(/firefox/),kj=Ri(/mac/),fd=Ri(/mscAndroid/),Xl=m.isTouchable===B?Dq?!1:T?"ontouchend"in T:!1:m.isTouchable,ck="default",bb="single",Ok="multiple",Dn="front",Zl="back",Mq="left",ze="right",Ih="top",Vd="bottom",Gp="center",xe="eye",rn="middle",lb="east",Eb="west",$h="north",Ip="none",Eq="px",hc="absolute",Kh="border",qn="triangle",Ol="rect",qs="circle",Vb="cylinder",Sd="shape",Zd="items",rh="normal",Zf="remove",hm="clear",yb="width",bg="height",Dm="ingroup",Bn="check",qq="uncheck",_g="radio",_r="radioOn",_q="radioOff",Bj="points",dl="values",Rl="series",wo="body",dk="label",Sn="label2",kb="note",Wb="note2",cs="icons",Ac="labelFont",Mf="labelColor",cf="labelSelectColor",Ag="note.expanded",dn="note2.expanded",ks="edge.expanded",vp="edge.points",Ur="edge.type",Qc="rotation",kf="hidden",xp="visible",Nm="tuv",Re="no",Uc="draw",qc="select",ql="currentSubGraph",md="selectBackground",Fd="autoMakeVisible",rm="autoHideScrollBar",Di="scrollBarColor",gk="scrollBarSize",xc="indent",Qb="rowHeight",tf="columnLineColor",uk="rowLineColor",xl="columnLineVisible",sd="rowLineVisible",yp="visibleFunc",cd="expandIcon",lr="collapseIcon",Jq="checkMode",Yd="sortFunc",so="editable",Vi="batchEditable",ps="tristate",Tp="asc",ll="desc",Yq="position",Yl="__",mj="elevation",jn="children",Kr="translateX",Kc="translateY",Kd="dataModel",Bo="maxSize",Bg="enc",sh="state",Lr=Bg+"o"+"de",um="shape3d",ao="shape3d.resolution",Nc="shape3d.visible",jj="shape3d.from.visible",bl="shape3d.to.visible",gg="shape3d.top.visible",kc="shape3d.bottom.visible",gh="repeat.uv.length",Nl="serializeValue",li="deserializeValue",cl="centerUniform",yf="uniform",ki="rgba(255,255,255,0)",ls="style",Ho="attr",Dp="field",Xe="string",Qh="boolean",Wq="color",Tr="int",tg="number",Cc="ew-resize",Be="ns-resize",Gr="pointer",uj="auto",ah="mousedown",ph="mousemove",Hj="mouseup",Dl="mouseout",Km="touchstart",Ld="touchmove",Dd="touchend",Mb="keydown",Ic="keyup",fj=["DOMMouseScroll","mousewheel"],Rh=kl?fj[0]:fj[1],Pm=Yl+j+Yl+Lr,xh=[Km,Ld,Dd],Xg=[ah,ph,Hj,Dl,Rh,"wheel","mouseenter","mouseleave","mouseover"],Hm=[Mb,Ic,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],$m=Xl?xh.concat(Hm):Xg.concat(Hm),Eo=z,Il=z,on=z,Dj=z,fl=!0,pe=Hj.length,Jc=function(){on&&(Eh(on.timeout),on=z)},Oq=function(){on&&Zb(on.e,on.info)};d.addEventListener&&(F=Z)&&(Xl||(C(d,Dl,function(){Jc()}),C(d,Rh,function(){yd()})),C(d,Ic,function(y){91===y.keyCode?nq={}:delete nq[y.keyCode]},!0),C(d,Mb,function(s){nq[s.keyCode]=!0},!0),C(d,"blur",function(){nq={}}));var wm,fp,Wl,Hc=0,$l=z,ek=function(N,K){var b=Vr(function(){delete $l[b],od($l)&&($l=z),N()},K);return b},vj=z,Ch=z,Nq={},Rb={},mf={},zn={},tr={},nq={},Ib={},zk={},Kf={},Fi={},bp=/.json$/,Qj=/\.(json|bin)$/,gb=/^data:image\/svg\+xml/,Gi={},Nr=[],df={},Jg=z,Nb=z,uo=function(){},gm=function(){throw"Oops!"},nr=[0,0,0],ac={x:0,y:0,width:0,height:0},Gn=z,Bf=z,fh=z,_o=function(z,U){Rb[z]=U,U&&U.comps&&!U.uuid&&(U.uuid=_.Math.generateUUID()),Tm[z]&&(U.cacheRule=Tm[z],delete Tm[z])},yk=function(Z){Bf&&!Z._72O&&(fh||(fh={}),fh[Z._72O=Ie()]=Z),wm!=z?Mo()<.05&&x&&!fp&&(tl=Jc):tl=Zn},$p=function(q,U,V,l){Bf||(Bf={});var M=Bf[q];if(M){if(M.url===U)return;M.image?(M.image.onload=uo,M.image.onerror=uo):M.request&&(M.request.onload=uo,M.request.onerror=uo)}if(bp.test(U)){var R=new Bp;if(Bf[q]={request:R,url:U},U=m.beforeLoadURL(U,q),U.data){var D=m.parse(U.data);ob(q,D),m.handleImageLoaded(q,D)}else{R.onload=function(){if(200===this.status||0===this.status){var a=m.parse(R.getResponseText());ob(q,a),m.handleImageLoaded(q,a)}else ob(q,m.handleUnfoundImage(q,U)||z)},R.onerror=function(){ob(q,m.handleUnfoundImage(q,U)||z)};var h={};h.url=encodeURI(U),h.sync=!1,R.send(h)}}else{var D=new Image;Bf[q]={image:D,url:U},/^data:image/.test(U)||(U=m.beforeLoadURL(U,q),U=m.appendTimeStamp(U),U=encodeURI(U),D.crossOrigin=m.crossOrigin),m.convertImageSrc(U,function(g){Md&&(U.toLowerCase().indexOf(".svg")>0||gb.test(U))?(T.body.appendChild(D),D.style.visibility="hidden",D.onload=function(){Vr(function(){if(V&&(D.width=V),l&&(D.height=l),!D.width||!D.height){var u=D.width||D.clientWidth,r=D.height||D.clientHeight;D.width=u,D.height=r}m.handleImageLoaded(q,D),ob(q,D),T.body.removeChild(D),D.style.visibility=""},180)},D.onerror=function(){ob(q,m.handleUnfoundImage(q,U)||z),T.body.removeChild(D),D.style.visibility=""}):(D.onload=function(){V&&(D.width=V),l&&(D.height=l),m.handleImageLoaded(q,D),ob(q,D)},D.onerror=function(){ob(q,m.handleUnfoundImage(q,U)||z)}),D.src=g})}},ob=function(s,V){if(_o(s,V),delete Bf[s],od(Bf)&&(Bf=z,fh)){for(var j in fh){var $=fh[j];$._2O&&$._2O[s]&&($.deleteTexture(s),delete $._2O[s]),$.invalidateAll&&$.invalidateAll(B,"imageLoaded",s),$.redraw&&$.redraw(),$.iv(),V&&V.layoutAttach&&Qr($.dm)&&$.dm().updateLayoutAttach(s),delete $._72O}fh=z}if(V&&fh)for(var j in fh){var $=fh[j];$.invalidateAll&&$.invalidateAll(B,"imageLoading",s),$.redraw&&$.redraw(),$.iv(),V.layoutAttach&&Qr($.dm)&&$.dm().updateLayoutAttach(s)}},cr=function(){return Sc=o&&Date,function(){return d.performance&&d.performance.now?d.performance.now():Date.now()}}(),$c=function(c,l,D){return{width:c,height:l,comps:Jm(D)?D:[D]}},xm=function(i,M){return{type:qs,rect:[i,M,1.6,1.6],borderWidth:1,borderColor:rg,gradient:Td,gradientColor:rc,background:rg}},Jf=function(P,a){return $c(16,16,{type:qn,rect:[4,4,10,8],background:P,rotation:a?1.57:3.14})},If=function(c,p){return $c(16,16,{type:qn,rect:[4,4,8,7],background:c,rotation:p?3.14:0})},Jl=function(O){var b=O._orientation;return"horizontal"===b||"h"===b},fg=function(h,P){var E=z||4,G=z||1,A=z||1;0>E?E=0:E>.25&&(E=.25);var f,p,q,W,d,r,y,S=.5,L=[],M=[],j=[],x=Q/A,l=Q/G,Z=S-E;for(p=0;G>=p;p++)for(W=-s+p*l,r=c(W),d=N(W),f=0;A>=f;f++)q=f*x,y=Z+E*r,L.push(c(q)*y,d*E,-N(q)*y),(U=[h,P])&&M.push(f/A,1-p/G);for(p=0;G>p;p++){var i=p*(A+1),o=(p+1)*(A+1);for(f=0;A>f;f++)j.push(i+f,o+f+1,o+f,i+f,i+f+1,o+f+1),Po.z=$b.z=[h,P]}},Xm=function(e){var x=2,E=0;for(var i in e)i.length===x&&Mm(i,32)===wk&&(Jg=Nb=e[i]),E++;return E},Sq=function(B,A,D,Y){return D||(D=Xl?5:3,D/=Y||1),{x:B-D,y:A-D,width:2*D,height:2*D}},em=function(a,j,Q,V){var M=this;j||(j=Xl?5:3,Q=20,V=20);var u={x:a,y:j,width:Q,height:V};if(Q)for(var T=0;Q>T;T++)if(3===Q)V=20;else for(var t=0;V>t;t++)M=d?d:Q;var K={x:s,y:2*s};if(tq(u,K)){var l=bg[0]+Ih[0]+hm[1]+Tp.length,A=kf[0]+ps[0]+hm[1]+wo.length;yr[xe]=[M[l],M[A]],M[l]=Tn[xe],M[A]=Tn[um]}},dc=function(V){return(/ble$/.test(V)||/ed$/.test(V)||t[V]?"is":"get")+V.charAt(0).toUpperCase()+V.slice(1)},Tn=function(F){return"set"+F.charAt(0).toUpperCase()+F.slice(1)},hq=function(D){return typeof D===Xe||D instanceof String},Aj=function(k){return typeof k===tg},Zn=function(D){return typeof D===Qh},Th=function(X){return X&&"object"==typeof X},Qr=function(i){return"function"==typeof i},Jm=function(N){return N instanceof Array},pj=function(E){return E instanceof An},cq=function(z){return Jm(z)?new An(z):z},Dk=function(b){return b instanceof Oe},Xr=function(B){return B instanceof ke},Hh=function(p){return p instanceof ue},Pc=function(d,y){if(!(d instanceof _.Group))return!1;if(!y)return d.isExpanded();var B=y.getDataUI(d);return B&&B._88I?!0:!1},yq=function(y){return y instanceof Sm},zb=function(U){return U&&"IFRAME"===U.tagName},Em=function(I){return I==z||m.numberDigits==z?I:parseFloat(I.toFixed(m.numberDigits))},re=function(U,K,R){var P,Q=K.length;if(R)for(var I=0;R>I;I++)if(3===Q)U.push(K[0]),U.push(K[1]),U.push(K[2]);else for(P=0;Q>P;P++)U.push(K[P]);else if(3===Q)U.push(K[0]),U.push(K[1]),U.push(K[2]);else for(P=0;Q>P;P++)U.push(K[P])},vi=function(f){return f?Th(f)?f:{}:!1},Lp=function(t,n,v){var s,d=Th(t)?t:t.prototype;for(s in n)v&&s in d?d[s]===B&&console.warn("class",d,"has own undefined property",s,", keep exist!"):d[s]=n[s];return t},Nn=function(c,g){if(!("wheelDelta"in g)){var z=g.deltaMode;g.wheelDelta=z===g.DOM_DELTA_PIXEL?-g.deltaY:z===g.DOM_DELTA_LINE?40*-g.deltaY:120*-g.deltaY}c.handle_mousewheel(g)},Pd=function(c){return String.fromCharCode(c)},Zq=function(Z){for(var Q,C=0,Y="";C<Z.length;C++)Q=Z[Z.length-1-C],"%"===Q?Q="'":"a"===Q?Q='"':"]"===Q&&(Q="\\"),Y+=Pd(Q.charCodeAt(0)-1);return Y},mg=function($,R,S){$.superClass.constructor.apply(R,S)},od=function(D){for(var v in D)return!1;return!0},Tc=function(A){return A?0===A.length:!0},Df=function(){var I="";return[qq[0],uk[0],dk[0]].forEach(function(B){I+=Tn(B).slice(3)}),yf=T&&T[I]||cl,function(O,u){return O===u?!0:O.x===u.x&&O.y===u.y&&O.width===u.width&&O.height===u.height}}(),jp=function(h,P,T){return P>h?P:h>T?T:h},ud=function(k){return 0>k?-1:k>0?1:0},Mo=function(){var Y=1e4*N(pe++);return Y-e(Y)},xg=function(g,M,C){return Zk(g.x,g.y,M.x,M.y,C.x,C.y,C.x+C.width,C.y,!0)||Zk(g.x,g.y,M.x,M.y,C.x+C.width,C.y,C.x+C.width,C.y+C.height,!0)||Zk(g.x,g.y,M.x,M.y,C.x+C.width,C.y+C.height,C.x,C.y+C.height,!0)||Zk(g.x,g.y,M.x,M.y,C.x,C.y+C.height,C.x,C.y,!0)},Zk=function(t,A,M,r,n,C,D,O,c){var X=(D-n)*(A-C)-(O-C)*(t-n),T=(O-C)*(M-t)-(D-n)*(r-A);if(0!==T){var E=X/T,y=t+E*(M-t),I=A+E*(r-A);return c&&(y+ic<H(t,M)||y-ic>$(t,M)||y+ic<H(n,D)||y-ic>$(n,D)||I+ic<H(A,r)||I-ic>$(A,r)||I+ic<H(C,O)||I-ic>$(C,O))?z:[y,I]}return z},Zh=function(f,h,Y){if(f&&Y)if(h){if(h===ls)return f.getStyle(Y);if(h===Ho)return f.getAttr(Y);if(h===Dp)return f[Y]}else if(Y=dc(Y),f[Y])return f[Y]();return B},Ij=function(F,z,a,i){if(F&&a)if(z){if(z===ls)F.s(a,i);else if(z===Ho)F.a(a,i);else if(z===Dp){var u=F[a];F[a]=i,F.fp("f:"+a,u,i)}}else a=Tn(a),F[a]&&F[a](i)},Ai=function(d,L,z){var N=100*Math.max(d.width,d.height);return L&&"top"!==L?"bottom"===L?{x:d.x-N,y:d.y-N,width:d.width+2*N,height:d.height*z+N}:"right"===L?{x:d.x-N,y:d.y-N,width:d.width*z+N,height:d.height+2*N}:"left"===L?{x:d.x+d.width*(1-z),y:d.y-N,width:d.width*z+N,height:d.height+2*N}:void 0:{x:d.x-N,y:d.y+d.height*(1-z),width:d.width+2*N,height:d.height*z+N}},ve=function(b,V,U,i,F){V&&rr(b,U,i,1,F,V)},lk=function(I,C,A,P){var _=1-I;return _*_*C+2*I*_*A+I*I*P},Po=function(J,A,u,B,h){var L=1-J;return L*L*L*A+3*L*L*J*u+3*L*J*J*B+J*J*J*h},ko=function(u){var S,r,E,s,L=0;return u.forEach(function(C){if(S=C.length,S>0)for(r=C[0],s=1;S>s;s++)E=C[s],L+=bh(r,E),r=E}),L},Uh=function(k,Q,P){var f="__"+k,W=function(U){("mousedown"===k||"mouseup"===k||"touchstart"===k||"touchend"===k)&&ds(U),P.disabled||P["handle_"+k](U)};P[f]||(P[f]=W,C(Q,k,W))},$i=function(i,j,q){var h="__"+i,D=q[h];D&&(v(j,i,D),delete q[h])},Qg=function(H,I){var s="_"+I;H[dc(I)]=function(){return this[s]},H[Tn(I)]=function(q){var W=this[s];this[s]=q,this.fp(I,W,q)}},Wh=function(y){return S.create(y)},Nk=function(i){if(!i.element){var X,j;(X=i.textField)?j=Hn(It.TextField,X):(X=i.textArea)?j=Hn(It.TextArea,X):(X=i.button)?j=Hn(It.Button,X):(X=i.comboBox)?j=Hn(It.ComboBox,X):(X=i.checkBox)?j=Hn(It.CheckBox,X):(X=i.radioButton)?j=Hn(It.RadioButton,X):(X=i.slider)?j=Hn(It.Slider,X):(X=i.colorPicker)?j=Hn(It.ColorPicker,X):(X=i.image)&&(j=Hn(It.Image,X)),j&&(i.element=j)}},Oc=function(n,X){var W=fo(n);return W._ht=X,W},ec=d.top===d?d.top:d||d.document,fo=function(s,t){var v=T.createElement("div"),Y=v.style;return v.tabIndex=-1,v.onkeydown=pd,Y.msTouchAction=Ip,tj(v,z,0),Xl&&Y.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",z),s&&(Y.overflow=kf),t&&as(t,v),v},km=function(Z,a){var l=T.createElement("canvas"),N=l.style;return N.msTouchAction=Ip,a||(N.pointerEvents=Ip),tj(l,z,0),Z&&as(Z,l),l},tj=function(s,D,x){var j=s.style;j.border=D?D+" solid 1px":0,j.outline=0,j.padding=x?"0 "+x+Eq:0,Ro(s)},Ro=function(Q){var F=Q.style;F.position=hc,F.margin=0,F.setProperty("box-sizing","border-box",z),F.setProperty("-moz-box-sizing","border-box",z)},Eg=function(j,F,u,r){r||(r=sq),F!=z&&(j.width=F*r,j.style.width=F+Eq),u!=z&&(j.height=u*r,j.style.height=u+Eq)},as=function(w,o,I){w.appendChild(o),I&&(o.style.position=hc)},kp=function(Z,C){C.split||(C+="");for(var q,$=C.split("\n"),_=0,L=$.length,t=0;L>t;t++){var b=nd(Z.font,$[t]);b.width>_&&(_=b.width),q||(q=b.height)}return Z.ss=$,{width:_,height:q*L}},Jh=function(){var C=T?km().getContext("2d"):z;return function(p,z,m,H,J,I){var t=p.split("\n"),D=[],E=nd(m,p).height;return H||(H=0),C.font=m,C.textBaseline=Ih,t.forEach(function(t){for(var b=0,P=1,e=0,T=t.length;T>=P;P++){var N=t.substring(b,P),i=J?C.measureText(t[P]):nd(m,N);J&&(e+=i.fontBoundingBoxDescent||E);var X=J?e+(N.length-1)*I:i.width+(N.length-1)*H;X>z&&(P-1===b?(D.push(t.substring(b,P)),b=P):(D.push(t.substring(b,P-1)),b=P-1,P--),e=0)}b!==P-1&&D.push(t.substring(b,P))}),D}}(),Yf=function(Z,H,w,p,E,P,h,B){Z.font=w;var U=Z.measureText(H);if(Z.beginPath(),Z.strokeStyle=p,Z.lineWidth=1,"underline"===B){var n;n=U.actualBoundingBoxDescent?U.actualBoundingBoxDescent+1:nd(w,H).size/2,Z.moveTo(E-h/2,P+n),Z.lineTo(E+h/2,P+n)}else if("strikethrough"===B)Z.moveTo(E-h/2,P),Z.lineTo(E+h/2,P);else if("overline"===B){var n;n=U.fontBoundingBoxAscent?U.fontBoundingBoxAscent:nd(w,H).size/2,Z.moveTo(E-h/2,P-n),Z.lineTo(E+h/2,P-n)}Z.stroke()},He=function(k,o,T,v,L,B,H,q,l,A,s){var D=L.x,y=L.y,U=L.width,b=L.height;if(o!=z){var P=nd(T,o),e={};l&&(P.width+=(o.length-1)*l),e.y=H&&H!==rn?H===Ih?y+P.height/2:y+b-P.height/2:y+b/2,e.x=B&&B!==Mq?B===ze?D+U-P.width/2:D+U/2:D+P.width/2,Uq(k,o,e,T,v,l,A,s),q&&Yf(k,o,T,v,e.x,e.y,P.width,q)}},Bc=function(L,I,q,w,h,C,c,y,D,T){var _=I.length;if(1===_){var k=I[0];if(Uq(L,k,q,w,h,y,D,T),c){var v=nd(w,k);Yf(L,k,w,h,q.x+q.width/2,q.y+q.height/2,v.width,c)}}else for(var g=q.height/_,j={x:q.x,y:q.y,width:q.width,height:g},d=0;d<I.length;d++){if(C)He(L,I[d],w,h,j,C,null,c,y,D,T);else if(Uq(L,I[d],j,w,h,y,D,T),c){var v=nd(w,I[d]);Yf(L,I[d],w,h,j.x+j.width/2,j.y+j.height/2,v.width,c)}j.y+=g}},Uq=function(a,t,k,p,X,L,Q,n){a.font=p?p:Fc,a.fillStyle=X?X:ne,a.textAlign=Gp,a.textBaseline=rn;var W,Y;k?k.width===B?(W=k.x,Y=k.y):(W=k.x+k.width/2,Y=k.y+k.height/2):(W=0,Y=0);var N=Q&&n;if(N&&(a.strokeStyle=n,a.lineWidth=Q),L){var J=nd(p,t);W-=(J.width+L*(t.length-1))/2;for(var i=(t+"").length,_=0;i>_;_++){var z=t[_],D=a.measureText(z);N&&a.strokeText(z,w(W+(D.width+4)/2),w(Y)),a.fillText(z,w(W+(D.width+4)/2),w(Y)),W+=D.width+L}}else N&&a.strokeText(t,w(W),w(Y)),a.fillText(t,w(W),w(Y))},Ce=function(g){g.getView&&(g=g.getView());var F=g.offsetWidth||g.scrollWidth;return!F&&g.style.width&&(F=Mm(g.style.width)),F},dm=function(G){G.getView&&(G=G.getView());var p=G.offsetHeight||G.scrollHeight;return!p&&G.style.height&&(p=Mm(G.style.height)),p},Ir=function(C,u,n){var i=u[0].toUpperCase()+u.substring(1,u.length);C["webkit"+i]=n,C["moz"+i]=n,C["ms"+i]=n,C["o"+i]=n,C[u]=n},ts=function(){var b=function(f){pd(f),f.stopPropagation()},Z=function(E){pd(E)},A=[Km,Mb,ah];return function(X,D){var T=fo(),g=T.style;return g.backgroundColor=m.disabledBackground,X&&(g.backgroundImage="url("+X+")",g.backgroundPosition="50% 50%",g.backgroundRepeat="no-repeat no-repeat"),D===!1?A.forEach(function(t){C(T,t,Z)}):A.forEach(function(Q){C(T,Q,b)}),T}}(),rk=function(J){var u=J.getContext("2d");return u.save(),u.lineCap=qg,u.lineJoin=Ec,u},tl=function(I,m,k,c){Jo(I,m*sq,k*sq),c*=sq,1!==c&&I.scale(c,c)},Jo=function(h,r,q){h.translate(r,q)},af=function(m,k){k&&m.rotate(k)},to=function(A,O,$){O===B&&(O=1),$===B&&($=1),(1!==O||1!==$)&&A.scale(O,$)},Uf=!1,i=ec[Bn[1]+Kr[0]],pk=function(c){var M=T.activeElement;if(T.activeElement!==c){M&&M.forceOnblur&&M.forceOnblur();for(var G=[],b=c.parentNode;b;)G.push([b,b.scrollLeft,b.scrollTop]),b=b.parentNode;if(!Uf){var r=[],$=[];try{for(var X=d.parent,Y=d;X!==Y;)r.push([X,X.scrollX,X.scrollY]),Y=X,X=d.parent;var I=d.frameElement;if(I)for(var B=I.parentNode;B;)$.push([B,B.scrollLeft,B.scrollTop]),B=B.parentNode}catch(p){Uf=!0}}if(Xl)c.focus();else{var t=Yr(),i=t.target;c.focus(),i.scrollLeft=t.left,i.scrollTop=t.top}G.forEach(function(C){C[0].scrollLeft=C[1],C[0].scrollTop=C[2]}),Uf||(r.forEach(function(M){M[0].scrollTo(M[1],M[2])}),$.forEach(function(O){O[0].scrollLeft=O[1],O[0].scrollTop=O[2]}))}},Ll=function(w){return w&&w.getView?w.getView():w},fs=function(U,w,G,V,A){if(2===arguments.length&&(G=w.y,V=w.width,A=w.height,w=w.x),U.isSelfViewEvent)U.setX(w),U.setY(G),U.setWidth(V),U.setHeight(A);else{var h=Ll(U),D=h.style;if((T.fullscreenElement||T.mozFullScreenElement||T.webkitFullscreenElement||T.msFullscreenElement)!==h)w!==B&&(D.left=w+Eq),G!==B&&(D.top=G+Eq),V!==B&&(D.width=V+Eq),A!==B&&(D.height=A+Eq);else{var i=m.getWindowInfo();D.left=(w=i.left)+Eq,D.top=(G=i.top)+Eq,D.width=(V=i.width)+Eq,D.height=(A=i.height)+Eq}U.endEditing&&!Xl&&U.endEditing(),U.redraw&&U.redraw(),U.invalidate&&U.invalidate(),U.onLayouted&&U.onLayouted(w,G,V,A),U.fireViewEvent&&U.fireViewEvent("layout")}},$j=function(X){if(!X.touches)return X;var c=X.touches[0];return c?c:X.changedTouches[0]},Aq=function(j){return wg(j)?$j(j).target:j.target},wg=function(z){return z&&"object"==typeof z&&"touches"in z},Nj=function(q){m.popup&&m.popup.close(),m.popup=q},es=z,Xf=function(A){es.handleWindowTouchMove(A)},mk=function(B){es.handleWindowTouchEnd(B),v(d,Ld,Xf),v(d,Dd,mk),v(d,"blur",mk),es=z},oe=function(N){es.handleWindowMouseMove(N)},gc=function(w){es.handleWindowMouseUp(w),v(d,ph,oe),v(d,Hj,gc),v(d,"blur",gc),es=z},th=function(j){return 1===js(j)},ub=function(X,P){return P?P.keyCode===X:nq[X]},jq=function(e){return Wo(e)&&ub(65,e)},xi=function(V){return ub(46,V)||ub(8,V)},rq=function(w){return function(m){return m?m.keyCode===w:nq[w]}},wk=573,Ub=[65,83,68,87,37,38,39,40,32,13,27],Xh=rq(Ub[0]),he=rq(Ub[1]),ni=rq(Ub[2]),td=rq(Ub[3]),kr=rq(Ub[4]),jc=rq(Ub[5]),Zg=rq(Ub[6]),Cg=rq(Ub[7]),sc=rq(Ub[8]),Ud=rq(Ub[9]),Vq=rq(Ub[10]),ar={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},yn=[2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,11,5233],Pj=z,Id=z,ee=function(k,E){Pj||(Pj=km()),Eg(Pj,k,E,1);var K=rk(Pj);return K.clearRect(0,0,k,E),K},zp=function(R,x,r){if(x&&R){if("override"===r)return x;if("override_rgb"===r){var B=Qk(x);return R=ws(R),"rgba("+w(255*B[0])+","+w(255*B[1])+","+w(255*B[2])+","+R[3]/255+")"}if("override_a"===r){var B=Qk(x);return R=ws(R),"rgba("+R[0]+","+R[1]+","+R[2]+","+B[3]+")"}if("multiply_destinationAtop"===r){var F=zs(Qk(R)),l=F[3],V=zs(Qk(x)),b=V[3],q=zs(F),h=q[3],u=F.map(function(x,J){return x*V[J]}),X=1-l,I=1-b,i=I*l+b;return F=F.map(function(q,v){return(b*X*V[v]+b*l*u[v]+I*l*q)/i}),l=i,X=1-l,F=F.map(function(o,Q){return(h*q[Q]*X+l*o*h)/h}),l=h,"rgba("+w(255*F[0])+","+w(255*F[1])+","+w(255*F[2])+","+l+")"}var B=Qk(x);return R=ws(R),"rgba("+w(R[0]*B[0])+","+w(R[1]*B[1])+","+w(R[2]*B[2])+","+R[3]/255*B[3]+")"}return R},ws=function(){var s,j={};for(var B in d){var V=Ok.length;if(B.length==V&&B[0]===Ok[2]&&B[1]===Ip[1]&&B[4]===Ok[3]&&B[5]===Ok[4]&&B.substr(V-2)===Ip[1]+Ip[2]){var k=d[B];for(var X in k)X.length===V&&X.substr(0,3)===ze[3]+Zf[3]+qc[0]&&X.substr(V-2)===Ok[0]+kb[3]&&(fj=k[X])}}return function(z){var y,k=j[z];return k||(s||(s=km(),Eg(s,1,1,1)),y=s.getContext("2d"),y.clearRect(0,0,1,1),rr(y,0,0,1,1,z),k=y.getImageData(0,0,1,1).data,k=j[z]=[k[0],k[1],k[2],k[3]]),k}}(),Qk=function(W){if(!hq(W))return W;var x=ws(W);return x.CA||(x.CA=[x[0]/255,x[1]/255,x[2]/255,x[3]/255]),x.CA},lh=function(r,F,e,w,p){var B=km();B.width=e,B.height=w;var h=B.getContext("2d");h.drawImage(r,0,0,e,w);try{for(var P=h.getImageData(0,0,e,w),q=P.data,U=0,S=q.length;S>U;U+=4){var K=q[U+0],Y=q[U+1],i=q[U+2],m=q[U+3];"override_a"===p?q[U+3]=255*F[3]:"override_rgb"===p?(q[U+0]=255*F[0],q[U+1]=255*F[1],q[U+2]=255*F[2]):"override"===p?(q[U+0]=255*F[0],q[U+1]=255*F[1],q[U+2]=255*F[2],q[U+3]=255*F[3]):(q[U+0]=F[0]*K,q[U+1]=F[1]*Y,q[U+2]=F[2]*i,q[U+3]=F[3]*m)}h.putImageData(P,0,0)}catch(O){return r}return B},yr=function(a,q,v){return q&&(q="miter"===v?8*q+20:q+1,a&&gp(a,q)),q},Al=function(T,q){if(q){var t=new hg(q),s=T.width/2,V=T.height/2,A=sf([t.tf(-s,-V),t.tf(s,-V),t.tf(s,V),t.tf(-s,V)]);return A.x+=T.x+s,A.y+=T.y+V,A}return T},Fp=function(u,g,F,C,Q,s,O,V){C*=Math.PI/180;var H={x:Math.cos(C)*(u.x-O.x)/2+Math.sin(C)*(u.y-O.y)/2,y:-Math.sin(C)*(u.x-O.x)/2+Math.cos(C)*(u.y-O.y)/2},E=Math.pow(H.x,2)/Math.pow(g,2)+Math.pow(H.y,2)/Math.pow(F,2);E>1&&(g*=Math.sqrt(E),F*=Math.sqrt(E));var L=(Q==s?-1:1)*Math.sqrt((Math.pow(g,2)*Math.pow(F,2)-Math.pow(g,2)*Math.pow(H.y,2)-Math.pow(F,2)*Math.pow(H.x,2))/(Math.pow(g,2)*Math.pow(H.y,2)+Math.pow(F,2)*Math.pow(H.x,2)));isNaN(L)&&(L=0);var o={x:L*g*H.y/F,y:L*-F*H.x/g},W={x:(u.x+O.x)/2+Math.cos(C)*o.x-Math.sin(C)*o.y,y:(u.y+O.y)/2+Math.sin(C)*o.x+Math.cos(C)*o.y},c=function(Q){return Math.sqrt(Math.pow(Q[0],2)+Math.pow(Q[1],2))},T=function(S,s){return(S[0]*s[0]+S[1]*s[1])/(c(S)*c(s))},N=function(l,s){return(l[0]*s[1]<l[1]*s[0]?-1:1)*Math.acos(T(l,s))},D=N([1,0],[(H.x-o.x)/g,(H.y-o.y)/F]),M=[(H.x-o.x)/g,(H.y-o.y)/F],r=[(-H.x-o.x)/g,(-H.y-o.y)/F],x=N(M,r);T(M,r)<=-1&&(x=Math.PI),T(M,r)>=1&&(x=0);var T=g>F?g:F,k=g>F?1:g/F,G=g>F?F/g:1;if(null==V){var t={x:0,y:0,width:0,height:0};gp(t,T),t.x*=k,t.width*=k,t.y*=G,t.height*=G;var X=new hg(C);return t=sf([X.tf(t.x,t.y),X.tf(t.x+t.width,t.y),X.tf(t.x+t.width,t.y+t.height),X.tf(t.x,t.y+t.height)]),t.x+=W.x,t.y+=W.y,[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}]}V.translate(W.x,W.y),V.rotate(C),V.scale(k,G),V.arc(0,0,T,D,D+x,1-s),V.scale(1/k,1/G),V.rotate(-C),V.translate(-W.x,-W.y)},te=function(a,h){a&&a.beginPath();for(var o,Z,W,T=[],i=function(P){for(var h,K=/(\-{0,1}[\d\.]+)/gi,R=[];h=K.exec(P);)R.push(parseFloat(h[0]));return R},G=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,v={x:0,y:0};o=G.exec(h);){var V=o[0],E=V.substr(0,1);if("M"===E||"m"===E){for(var S=i(V),y=0;y<S.length;y+=2){var j=S[y],N=S[y+1];"m"===E&&(j+=v.x,N+=v.y),a&&a.moveTo(j,N),T.push({x:j,y:N}),v.x=j,v.y=N}Z=W=null}else if("H"===E||"h"===E){for(var S=i(V),y=0;y<S.length;y+=1){var j=S[y];"h"===E&&(j+=v.x),a&&a.lineTo(j,v.y),T.push({x:j,y:v.y}),v.x=j}Z=W=null}else if("C"===E||"c"===E){for(var S=i(V),y=0;y<S.length;y+=6){var c=S[y],f=S[y+1],u=S[y+2],P=S[y+3],j=S[y+4],N=S[y+5];"c"===E&&(c+=v.x,f+=v.y,u+=v.x,P+=v.y,j+=v.x,N+=v.y),a&&a.bezierCurveTo(c,f,u,P,j,N),T.push({x:c,y:f}),T.push({x:u,y:P}),T.push({x:j,y:N}),v.x=j,v.y=N}Z=[c,f,u,P,j,N],W=null}else if("S"===E||"s"===E){for(var S=i(V),y=0;y<S.length;y+=4){var c,f;Z?(c=2*Z[4]-Z[2],f=2*Z[5]-Z[3]):(c=v.x,f=v.y);var u=S[y],P=S[y+1],j=S[y+2],N=S[y+3];"s"===E&&(u+=v.x,P+=v.y,j+=v.x,N+=v.y),a&&a.bezierCurveTo(c,f,u,P,j,N),T.push({x:c,y:f}),T.push({x:u,y:P}),T.push({x:j,y:N}),v.x=j,v.y=N}Z=[c,f,u,P,j,N],W=null}else if("Q"===E||"q"===E){for(var S=i(V),y=0;y<S.length;y+=4){var c=S[y],f=S[y+1],j=S[y+2],N=S[y+3];"q"===E&&(c+=v.x,f+=v.y,j+=v.x,N+=v.y),a&&a.quadraticCurveTo(c,f,j,N),T.push({x:c,y:f}),T.push({x:j,y:N}),v.x=j,v.y=N}Z=null,W=[c,f,j,N]}else if("T"===E||"t"===E){for(var S=i(V),y=0;y<S.length;y+=2){var c,f;W?(c=2*W[2]-W[0],f=2*W[3]-W[1]):(c=v.x,f=v.y);var j=S[y],N=S[y+1];"t"===E&&(j+=v.x,N+=v.y),a&&a.quadraticCurveTo(c,f,j,N),T.push({x:c,y:f}),T.push({x:j,y:N}),v.x=j,v.y=N}Z=null,W=[c,f,j,N]}else if("V"===E||"v"===E){for(var S=i(V),y=0;y<S.length;y+=1){var N=S[y];"v"===E&&(N+=v.y),a&&a.lineTo(v.x,N),T.push({x:v.x,y:N}),v.y=N}Z=W=null}else if("L"===E||"l"===E){for(var S=i(V),y=0;y<S.length;y+=2){var j=S[y],N=S[y+1];"l"===E&&(j+=v.x,N+=v.y),a&&a.lineTo(j,N),T.push({x:j,y:N}),v.x=j,v.y=N}Z=W=null}else if("A"===E||"a"===E){for(var S=i(V),y=0;y<S.length;y+=7){var H=S[y],$=S[y+1],F=S[y+2],p=S[y+3],C=S[y+4],j=S[y+5],N=S[y+6];"a"===E&&(j+=v.x,N+=v.y);var b=Fp(v,H,$,F,p,C,{x:j,y:N},a);b&&(T=T.concat(b)),v.x=j,v.y=N}Z=W=null}var r=V.substr(V.length-1);("z"===r||"Z"===r)&&a&&a.closePath()}return T},No=function(a,h,q,Y,R){var y,X=h[0];if(a.save(),Jm(h))if(X&&1===X.length){var G,e="L"===h[0],u=h.length;e?(a.transform(h[5],h[6],h[7],h[8],h[9],h[10]),y=a.createLinearGradient(h[1],h[2],h[3],h[4]),G=11):(a.transform(h[7],h[8],h[9],h[10],h[11],h[12]),y=a.createRadialGradient(h[1],h[2],h[3],h[4],h[5],h[6]),G=13);for(var p=a.compGray;u>G;){var l=h[G+1];l=q(l),y.addColorStop(h[G],p?m.toGrayColor(l):l),G+=2}}else{var G,e="linear"===X,f=R.x,L=R.y,D=R.width,H=R.height,u=h.length,p=a.compGray;if(e)y=a.createLinearGradient(f+D*h[1],L+H*h[2],f+D*h[3],L+H*h[4]),G=5;else{var v=Math.min(D,H),J=h[1]*D+f,d=h[2]*H+L,W=h[3]*v;if(hq(h[5]))y=a.createRadialGradient(J,d,0,J,d,W),G=4;else{a.transform(h[7],h[8],h[9],h[10],h[11]+J,h[12]+d);var N=h[4]*D+f-J,o=h[5]*H+L-d,M=h[6]*v;y=a.createRadialGradient(0,0,W,N,o,M),G=13}}for(;u>G;){var l=h[G+1];l=q(l),y.addColorStop(h[G],p?m.toGrayColor(l):l),G+=2}}else y=h;return Y?a.strokeStyle=y:a.fillStyle=y,y},$b=function(){function J(r,Q){var Z=r.length,I=r[0];if(hq(r)||I&&1!==I.length)return r;for(var R=new Array(Z),J=0;Z>J;J++)R[J]=r[J];var q,$,N,K,A,d,Y,l,W,i,P,k,S,p="L"===R[0];return q=p?5:7,$=R[q],N=R[q+1],K=R[q+2],A=R[q+3],d=R[q+4],Y=R[q+5],l=Q[0],W=Q[1],i=Q[2],P=Q[3],k=Q[4],S=Q[5],R[q]=l*$+i*N,R[q+1]=W*$+P*N,R[q+2]=l*K+i*A,R[q+3]=W*K+P*A,R[q+4]=l*d+i*Y+k,R[q+5]=W*d+P*Y+S,R}return function(Q,Z){var H;(H=Q.s("shape.gradient.pack"))&&Q.s("shape.gradient.pack",J(H,Z)),(H=Q.s("shape.border.gradient.pack"))&&Q.s("shape.border.gradient.pack",J(H,Z))}}(),Ff=function(N,i,w,D){var R=!1;if(N.beginPath?N.beginPath():R=!0,pj(i)&&(i=i._as),pj(w)&&(w=w._as),w&&w.length){for(var $,q,r,I,B=0,L=0,P=w.length;P>L;L++)$=w[L],1===$?(q=i[B++],N.moveTo(q.x,R?-q.y:q.y)):2===$?(q=i[B++],N.lineTo(q.x,R?-q.y:q.y)):3===$?(q=i[B++],r=i[B++],N.quadraticCurveTo(q.x,R?-q.y:q.y,r.x,R?-r.y:r.y)):4===$?(q=i[B++],r=i[B++],I=i[B++],N.bezierCurveTo(q.x,R?-q.y:q.y,r.x,R?-r.y:r.y,I.x,R?-I.y:I.y)):5===$&&N.closePath();D&&5!==$&&N.closePath()}else{var d,Q,s,m=i.length;if(m>0){for(d=i[0],N.moveTo(d.x,R?-d.y:d.y),Q=1;m>Q;Q++)s=i[Q],N.lineTo(s.x,R?-s.y:s.y);D&&N.closePath()}}},Qf=function(a,D,Z,H){if(pj(a)&&(a=a._as),pj(D)&&(D=D._as),D&&D.length){Z=Z||rp;for(var V,K,I,X,_,J,t,s,k=[],m=z,L=0,n=0,j=D.length;j>n;n++)if(V=D[n],1===V)k.push(m=[]),m.push(a[L++]);else if(2===V)m.push(a[L++]);else if(3===V){for(K=m[m.length-1],I=a[L++],X=a[L++],J=1;Z>J;J++)t=lk(J/Z,K.x,I.x,X.x),s=lk(J/Z,K.y,I.y,X.y),m.push({x:t,y:s,b:!0});
m.push(X)}else if(4===V){for(K=m[m.length-1],I=a[L++],X=a[L++],_=a[L++],J=1;Z>J;J++)t=Po(J/Z,K.x,I.x,X.x,_.x),s=Po(J/Z,K.y,I.y,X.y,_.y),m.push({x:t,y:s,b:!0});m.push(_)}else 5===V&&m.push(m[0]);return H&&5!==V&&m&&m.length>2&&m.push(m[0]),k}return H&&a.length>2&&(a=a.slice(),a.push(a[0])),a?[a]:[]},lf=function(o,T,v,Q,L,B){var D,F,_,b=ws(T),l=Q,O=b[0],f=b[1],x=b[2];if(v){var P=ws(v);D=P[0]-O,F=P[1]-f,_=P[2]-x}else D=255-O,F=255-f,_=255-x;for(B||(B=Q>10?1:.5,B=1>L?H(B/L,2):B),o.save(),o.shadowOffsetX=0,o.shadowOffsetY=0,o.shadowBlur=0,o.shadowColor=0;(Q-=B)>0;){var A=1-Q/l,t=O+D*A,p=f+F*A,V=x+_*A;t=H(u(t),255),p=H(u(p),255),V=H(u(V),255),o.strokeStyle="rgb("+t+","+p+","+V+")",o.lineWidth=Q,o.stroke()}o.restore()},gj=function(){if(fl&&F){var _=F+""||Tp;fd=_.indexOf(kf.substr(0,2))>0&&_.indexOf(Ih+Ih.substr(1,1))>1?!0:!1}var V={};return function(S,i){var b=S+"-"+i,q=V[b];if(q)return q;var B,j,P,R=ws(S);return 0>i?(i=(100+i)/100,B=u(R[0]*i),j=u(R[1]*i),P=u(R[2]*i)):(i/=100,B=R[0],j=R[1],P=R[2],B+=(255-B)*i,j+=(255-j)*i,P+=(255-P)*i,B=H(u(B),255),j=H(u(j),255),P=H(u(P),255)),V[b]="rgb("+B+","+j+","+P+")"}}(),rr=function(m,B,N,x,t,h){h&&(m.fillStyle=h),m.beginPath(),m.rect(B,N,x,t),m.fill()},np=function(z,u,q,x,S,b,P){z.beginPath(),ui[u](z,q.x,q.y,q.width,q.height,x,S,b,P)},os=function(l,x,_,U,H){var u=ui[_];l.fillStyle=u?u(l,x,U?U:rc,H.x,H.y,H.width,H.height):x},Tj=function(v,z,u,g,w,R){v.fillStyle=gi(v,z,u,g,w,R)},us=function(t,d,F,C,J,K){t.strokeStyle=gi(t,d,F,C,J,K)},gi=function(N,e,c,X,J,L){var j;try{if(!e.tagName&&e.comps){e._cacheImage_||(e._cacheImage_={});var B;B="override"===X?"colors_override":"override_rgb"===X?"colors_override_rgb":"override_a"===X?"colors_override_a":"colors",e._cacheImage_[B]||(e._cacheImage_[B]={__count__:0});var E=e._cacheImage_[B][c];E||(e._cacheImage_[B].__count__>m.imageCacheThreshold&&(e._cacheImage_[B]={__count__:0}),E=_.Default.toCanvas(e,To(e),Of(e),null,J,L,c,null,X),e._cacheImage_[B][c]=E,e._cacheImage_[B].__count__++),e=E}j=N.createPattern(e,"repeat")}catch(Z){j="black"}return j},mm=function(v){var F,K,Z=[],o=0,z=v.length;for(F=0;65>F;F++)Z[F]=F;for(F=0;65>F;F++)o=(o+Z[F]+v.charCodeAt(F%z))%65,K=Z[F],Z[F]=Z[o],Z[o]=K;for(F=0;65>F;F++)Z[F]=Pn[Z[F]];return Z.join("")},Dh=function(K){for(var R=8+_k.randomInt(8),W=Pn[8*_k.randomInt(8)+(R-8)],L="",O=0;R>O;O++)L+=Pn[_k.randomInt(64)];var u=mm(L+j+Yl+Lr);return W+L+mh.encode(K,u)},ak=function(a){var C=a[0],s=Pn.indexOf(C);if(0>s)return"";s=8+(7&s);var c=a.slice(1,1+s),f=mm(c+j+Yl+Lr);return mh.decode(a,f,1+s)},Cr=function(Y,H,W,z,d,Z,a){Y.save(),Y.translate(H,W),Y.scale(1,a/Z),Y.arc(0,0,Z,z,d),Y.restore()},lo=function(D,t,x,V,m,f,E,b){var C,M,I,i,S,o,G,K,a,Q,g;if(n(m)>2*s&&(m=2*s),S=u(n(m)/(s/4)),C=m/S,M=-C,I=-V,S>0){o=t+c(V)*f,G=x+N(-V)*E,b?D.lineTo(o,G):D.moveTo(o,G);for(var R=0;S>R;R++)I+=M,i=I-M/2,K=t+c(I)*f,a=x+N(I)*E,Q=t+c(i)*(f/c(M/2)),g=x+N(i)*(E/c(M/2)),D.quadraticCurveTo(Q,g,K,a)}},lm=function(G,J,L,j,o,B,f,e,v){6===arguments.length&&(Jm(B)?(e=B[1],v=B[2],f=B[3],B=B[0]):(f=B,e=B,v=B));var z=J+j,_=L+o,W=o>j?2*j:2*o;return B=W>B?B:W,f=W>f?f:W,e=W>e?e:W,v=W>v?v:W,G.roundRect?(G.roundRect(J,L,j,o,[B,f,v,e]),void 0):(G.moveTo(J+j/2,L),G.arcTo(z,L,z,_,f),G.arcTo(z,_,J,_,v),G.arcTo(J,_,J,L,e),G.arcTo(J,L,z,L,B),G.lineTo(J+j/2,L),void 0)},rl=function(k,n,P,b,V,i,Q){n&&(P=w(P),b=w(b),Q||(Q=1),k.fillStyle=n,k.beginPath(),k.rect(P,b,Q,i),k.rect(P,b,V,Q),i-Q>0&&k.rect(P,b+i-Q,V,Q),V-Q>0&&k.rect(P+V-Q,b,Q,i),k.fill())},fn=function(t,X,B,N){var V=N.x,I=N.y,a=N.width,y=N.height;if(!(!X||!B||0>=a||0>=y)){var z,G=Xj(X),C=Gg(X),c=B>0;1===B||-1===B?(t.fillStyle=c?G:C,t.beginPath(),t.rect(V,I,1,y),t.rect(V,I,a,1),t.fill(),t.fillStyle=c?C:G,t.beginPath(),t.rect(V,I+y-1,a,1),t.rect(V+a-1,I,1,y),t.fill()):(B=H(n(B),H(a/2,y/2)),z=t.createLinearGradient(V,I,V+B,I),z.addColorStop(0,c?G:C),z.addColorStop(1,X),t.fillStyle=z,t.beginPath(),t.moveTo(V,I),t.lineTo(V+B,I+B),t.lineTo(V+B,I+y-B),t.lineTo(V,I+y),t.lineTo(V,I),t.fill(),z=t.createLinearGradient(V,I,V,I+B),z.addColorStop(0,c?G:C),z.addColorStop(1,X),t.fillStyle=z,t.beginPath(),t.moveTo(V,I),t.lineTo(V+B,I+B),t.lineTo(V+a-B,I+B),t.lineTo(V+a,I),t.lineTo(V,I),t.fill(),z=t.createLinearGradient(V,I+y,V,I+y-B),z.addColorStop(0,c?C:G),z.addColorStop(1,X),t.fillStyle=z,t.beginPath(),t.moveTo(V,I+y),t.lineTo(V+B,I+y-B),t.lineTo(V+a-B,I+y-B),t.lineTo(V+a,I+y),t.lineTo(V,I+y),t.fill(),z=t.createLinearGradient(V+a,I,V+a-B,I),z.addColorStop(0,c?C:G),z.addColorStop(1,X),t.fillStyle=z,t.beginPath(),t.moveTo(V+a,I),t.lineTo(V+a-B,I+B),t.lineTo(V+a-B,I+y-B),t.lineTo(V+a,I+y),t.lineTo(V+a,I),t.fill())}},Rm=function(v,L,J,i,d,$,b){var D=v.createLinearGradient(i,d,$,b);return D.addColorStop(0,J),D.addColorStop(1,L),D},Qp=function(n,V,W,c,D,E,g){var U=n.createLinearGradient(c,D,E,g);return U.addColorStop(0,V),U.addColorStop(.5,W),U.addColorStop(1,V),U},jm=function(x,C,z,m,p,Z,i){var s=x.createLinearGradient(m,p,Z,i);return s.addColorStop(0,C),s.addColorStop(1/3,z),s.addColorStop(2/3,C),s.addColorStop(1,z),s},sk=function(Z,q,i,p,y,w,n,Q,r){var h=Z.createRadialGradient(p+w*Q,y+n*r,H(w,n)/24,p+w/2,y+n/2,$(w,n)/2);return h.addColorStop(0,i),h.addColorStop(1,q),h},Rf=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],ui={polygon:function(r,f,t,E,A,a,O,j){(a==z||3>a)&&(a=6),O==z&&(O=0),j==z&&(j=!0);var h,Y=H(E,A),V=Y/2,p=new sm(f+E/2,t+A/2),F=new sm,K=0,L=2*s/a,d=new sm(V,V);if(j===!1&&d.multiply({x:E/Y,y:A/Y}),0===O)for(h=0;a>h;h++)F.set(c(K),N(K)).multiply(d).add(p),0===h?r.moveTo(F.x,F.y):r.lineTo(F.x,F.y),K+=L;else{var e=[];for(h=0;2>h;h++)e.push(new sm(c(K),N(K)).multiply(d).add(p)),K+=L;var S=e.shift(),Z=e[0],R=new sm(c(K),N(K)).multiply(d).add(p),U=S.clone().sub(Z),C=R.clone().sub(Z),G=U.clone().normalize().dot(C.clone().normalize()),u=Math.sqrt((1-G)/(1+G)),n=O/u;for(U.setLength(n).add(Z),r.moveTo(U.x,U.y),h=0;a>h;h++)e.push(new sm(c(K),N(K)).multiply(d).add(p)),K+=L,S=e.shift(),Z=e[0],r.arcTo(S.x,S.y,Z.x,Z.y,O)}r.closePath()},arc:function(K,h,S,t,x,U,n,O,E){U==z&&(U=s),n==z&&(n=Q),O==z&&(O=!0);var L=h+t/2,j=S+x/2;O&&K.moveTo(L,j),E?Cr(K,L,j,U,n,t/2,x/2):K.arc(L,j,H(t,x)/2,U,n),O&&K.closePath()},rect:function(v,e,w,W,i){v.rect(e,w,W,i)},circle:function(h,y,m,M,e){h.arc(y+M/2,m+e/2,H(M,e)/2,0,Q,!0)},oval:function(E,b,f,B,n){Cr(E,b+B/2,f+n/2,0,Q,B/2,n/2)},roundRect:function(e,V,y,U,C,Z){Z==z&&(Z=H(H(U,C)/4,8)),lm(e,V,y,U,C,Z),e.closePath()},star:function(X,T,l,q,A){var x=2*q,S=2*A,U=T+q/2,$=l+A/2;X.moveTo(U-x/4,$-S/12),X.lineTo(T+.306*q,l+.579*A),X.lineTo(U-x/6,$+S/4),X.lineTo(T+q/2,l+.733*A),X.lineTo(U+x/6,$+S/4),X.lineTo(T+.693*q,l+.579*A),X.lineTo(U+x/4,$-S/12),X.lineTo(T+.611*q,l+.332*A),X.lineTo(U+0,$-S/4),X.lineTo(T+.388*q,l+.332*A),X.closePath()},pentagram:function(y,x,o,R,h){var t=.5*h,A=x+.5*R,i=o+t,N=.5257311121191336*R;N>t&&(N=t);var $=Rf,X=0;for(y.moveTo(A+N*$[X++],i+N*$[X++]);20>X;)y.lineTo(A+N*$[X++],i+N*$[X++]);y.closePath()},triangle:function(G,j,t,O,v){G.moveTo(j+O/2,t),G.lineTo(j+O,t+v),G.lineTo(j,t+v),G.closePath()},hexagon:function(L,G,x,C,Y){L.moveTo(G,x+Y/2),L.lineTo(G+C/4,x+Y),L.lineTo(G+3*C/4,+x+Y),L.lineTo(G+C,x+Y/2),L.lineTo(G+3*C/4,x),L.lineTo(G+C/4,x),L.closePath()},pentagon:function(H,A,t,$,h){var k=2*$,s=2*h,n=A+$/2,C=t+h/2;H.moveTo(n-k/4,C-s/12),H.lineTo(n-k/6,C+s/4),H.lineTo(n+k/6,C+s/4),H.lineTo(n+k/4,C-s/12),H.lineTo(n+0,C-s/4),H.closePath()},diamond:function(j,h,Y,X,p){j.moveTo(h+X/2,Y),j.lineTo(h,Y+p/2),j.lineTo(h+X/2,Y+p),j.lineTo(h+X,Y+p/2),j.closePath()},rightTriangle:function(T,n,j,i,L){T.moveTo(n,j),T.lineTo(n+i,j+L),T.lineTo(n,j+L),T.closePath()},parallelogram:function(q,R,V,W,d){var N=W/4;q.moveTo(R+N,V),q.lineTo(R+W,V),q.lineTo(R+W-N,V+d),q.lineTo(R,V+d),q.closePath()},trapezoid:function(u,O,P,e,Y){var M=e/4;u.moveTo(O+M,P),u.lineTo(O+e-M,P),u.lineTo(O+e,P+Y),u.lineTo(O,P+Y),u.closePath()},"linear.southwest":function(f,Z,g,l,w,c,I){return Rm(f,Z,g,l,w+I,l+c,w)},"linear.southeast":function(A,M,n,C,X,o,V){return Rm(A,M,n,C+o,X+V,C,X)},"linear.northwest":function(J,C,x,S,m,i,$){return Rm(J,C,x,S,m,S+i,m+$)},"linear.northeast":function(m,U,X,o,P,z,C){return Rm(m,U,X,o+z,P,o,P+C)},"linear.north":function(G,I,$,H,t,D,S){return Rm(G,I,$,H,t,H,t+S)},"linear.south":function(n,S,L,w,p,z,D){return Rm(n,S,L,w,p+D,w,p)},"linear.west":function(_,N,X,o,n,k){return Rm(_,N,X,o,n,o+k,n)},"linear.east":function(b,X,p,m,g,u){return Rm(b,X,p,m+u,g,m,g)},"radial.center":function(C,S,y,Q,I,b,Z){return sk(C,S,y,Q,I,b,Z,.5,.5)},"radial.southwest":function(Z,q,S,B,K,P,A){return sk(Z,q,S,B,K,P,A,.25,.75)},"radial.southeast":function(I,c,M,A,f,V,r){return sk(I,c,M,A,f,V,r,.75,.75)},"radial.northwest":function(L,o,n,T,v,h,F){return sk(L,o,n,T,v,h,F,.25,.25)},"radial.northeast":function(v,M,j,u,Y,s,$){return sk(v,M,j,u,Y,s,$,.75,.25)},"radial.north":function(R,i,q,Y,l,j,O){return sk(R,i,q,Y,l,j,O,.5,.25)},"radial.south":function(w,B,h,L,q,G,v){return sk(w,B,h,L,q,G,v,.5,.75)},"radial.west":function(Q,w,h,V,T,s,n){return sk(Q,w,h,V,T,s,n,.25,.5)},"radial.east":function(h,v,S,G,E,L,O){return sk(h,v,S,G,E,L,O,.75,.5)},"spread.horizontal":function(R,$,W,s,V,i){return Qp(R,$,W,s,V,s+i,V)},"spread.vertical":function(O,q,o,u,F,I,N){return Qp(O,q,o,u,F,u,F+N)},"spread.diagonal":function(t,Z,O,d,M,X,u){return Qp(t,Z,O,d+X,M,d,M+u)},"spread.antidiagonal":function(v,T,h,A,k,j,e){return Qp(v,T,h,A,k,A+j,k+e)},"spread.north":function(V,Q,f,y,r,B,h){return jm(V,Q,f,y,r-h/4,y,r+h+h/4)},"spread.south":function(Q,A,K,L,X,j,W){return jm(Q,K,A,L,X-W/4,L,X+W+W/4)},"spread.west":function(Q,T,R,z,F,W){return jm(Q,T,R,z-W/4,F,z+W+W/4,F)},"spread.east":function(o,h,L,E,B,v){return jm(o,L,h,E-v/4,B,E+v+v/4,B)}},ij=function(G,$,X){return new hg(G).tf($,X)},vq=function(N){var x=N.touches[0],p=N.touches[1],j=x.clientX,v=x.clientY,w=p.clientX,C=p.clientY;return l((j-w)*(j-w)+(v-C)*(v-C))},Lq=function(g){var x=g.touches[0],v=g.touches[1],o=x.clientX,u=x.clientY,n=v.clientX,A=v.clientY;return{x:(o+n)/2,y:(u+A)/2}},Kl=(function(){for(var n=0,b=ll.split(""),j=0;j<b.length;j++)n=10*Mm(b[j])+n;return fg(d[wk.toString(8*j)+dk.substr(j)+3],d[wk.toString(8*j)+dk.substr(j)+4]),n}(),function(g,s,I){for(var B=0;B<I.size();B++){var x=I.get(B);g.co(x)&&s.add(x)}for(B=0;B<I.size();B++)x=I.get(B),Kl(g,s,x._children)}),_m=function(m,W,K){for(var e=0;e<K.size();e++){var f=K.get(K.size()-1-e);m.co(f)&&W.add(f)}for(e=0;e<K.size();e++)f=K.get(e),_m(m,W,f._children)},Ae=function(z,T,r){for(var b=!1,F=0;F<r.size();F++){var J=r.get(F);z.co(J)?b&&T.add(J):b=1}for(F=0;F<r.size();F++)J=r.get(F),Ae(z,T,J._children)},Kn=function(N,w,m){for(var W=!1,D=0;D<m.size();D++){var b=m.get(m.size()-1-D);N.co(b)?W&&w.add(b):W=!0}for(D=0;D<m.size();D++)b=m.get(D),Kn(N,w,b._children)},Yj=m.moveDatas=function(Y,S,T,n){var W=n==z;if(0!==S||0!==T||!W&&0!==n){var y=!0,l=[];if(Y.forEach(function(c){y&&(c._69O||Hh(c)||yq(c))&&(y=!1)}),y)l=Y;else{var M={},s={};Y.forEach(function(W){M[W._id]=!0});var g={},P=function(L){var D=L._id;return M[D]?(l.push(L),g[D]=!0):g[D]=!1},H=function(T){var c=T._id;if(s[c])return P(T);var k=g[c];if(k!==B)return k;var v=T._parent;if(v&&(yq(v)||Hh(v))&&H(v))return g[c]=!0;var F=T._host;return F&&(s[c]=c,k=H(F),s[c]=B,k)?g[c]=!0:P(T)};Y.forEach(function(K){H(K)})}l.forEach(function(p){if(Dk(p))W?p.translate(S,T):p.translate3d(S,T,n);else{var m=p.s(vp);if(!m||m.isEmpty())return;var i=new An;m.each(function(M){M=zs(M),W?(M.x+=S,M.y+=T):(M.x+=S,M.y+=n,M.e==z?M.e=T:M.e+=T),i.add(M)}),p.s(vp,i)}})}},Ul=function(){function g(G,s){return s===G.substring(0,s.length)?!0:!1}function e(m){return parseFloat(m)||0}function X(O,y){if(y==B&&(y=new vr),g(O,"matrix3d")){var q=O.substring(9,O.length-1).split(",");q=q.map(e),y.fromArray(q)}else if(g(O,"matrix")){var q=O.substring(7,O.length-1).split(",");q=q.map(e),y.el[0]=q[0],y.el[1]=q[1],y.el[2]=0,y.el[3]=0,y.el[4]=q[2],y.el[5]=q[3],y.el[6]=0,y.el[7]=0,y.el[8]=0,y.el[9]=0,y.el[10]=1,y.el[11]=0,y.el[12]=q[4],y.el[13]=q[5],y.el[14]=0,y.el[15]=1}return y}function k(G,b){b==B&&(b=new Or);var X=G.split(/\s+/);return X=X.map(e),b.set(X[0]||0,X[1]||0,X[2]||0),b}var P,t,x,f,d,z=function(V,r){P||(P=new vr,t=new Or,x=new vr,f=new vr,d=new vr),r==B&&(r=new vr);var R=getComputedStyle(V);R.transform&&"none"!==R.transform&&(X(R.transform,P),k(R.transformOrigin,t),f.setPosition(t),t.negate(),d.setPosition(t),(Md||"preserve-3d"!==R.transformStyle)&&(P.el[8]=0,P.el[9]=0,P.el[10]=1,P.el[11]=0),r.multiplyMatrices(d,r),r.multiplyMatrices(P,r),r.multiplyMatrices(f,r)),!Md&&R.perspective&&"none"!==R.perspective&&(x.el[11]=-1/e(R.perspective),k(R.perspectiveOrigin,t),f.setPosition(t),t.negate(),d.setPosition(t),r.multiplyMatrices(d,r),r.multiplyMatrices(x,r),r.multiplyMatrices(f,r));for(var Y=V.offsetParent,m=V.offsetLeft,c=V.offsetTop,C=V.parentElement;C&&C!==Y;){var i=getComputedStyle(C);if("none"!==i.transform||"none"!==i.perspective)break;C=C.parentElement}return C==B&&V!==V.ownerDocument.documentElement&&"fixed"!==R.position&&(C=V.ownerDocument.documentElement),Y!=B&&Y!=C&&(m-=C.offsetLeft,c-=C.offsetTop),C&&(m-=C.scrollLeft,c-=C.scrollTop),t.set(m,c,0),f.setPosition(t),r.multiplyMatrices(f,r),C&&z(C,r),r};return function(k,P){var c=k.parentElement;if(c){var I=c.updateAppendMatrix;if(I){delete c.updateAppendMatrix;var E=new vr;z(c,E);var M=new vr;M.getInverse(E),c._matrixAppend=M,c._maxrixPreAppend=E}return P?c._matrixAppend:c._maxrixPreAppend}}}(),dj=function(e,w){for(;e&&!e.hasOwnProperty(w);)e=S.getPrototypeOf(e);return e&&S.getOwnPropertyDescriptor(e,w)},Vc=S.getPrototypeOf?function(b,Q,k){var P=dj(Q,k);P&&S.defineProperty(b,k,P)}:function(z,h,g){z[g]=h[g]},nm={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Gb=function(){var Y={1:function(d,s){return{x:d.x-s.width/2,y:d.y-s.height/2}},2:function(d,u){return{x:d.x+u.width/2,y:d.y-u.height/2}},3:function(F,U){return{x:F.x+F.width/2,y:F.y-U.height/2}},4:function(n,m){return{x:n.x+n.width-m.width/2,y:n.y-m.height/2}},5:function(H,E){return{x:H.x+H.width+E.width/2,y:H.y-E.height/2}},6:function(W){return{x:W.x,y:W.y}},7:function(n){return{x:n.x+n.width/2,y:n.y}},8:function(G){return{x:G.x+G.width,y:G.y}},9:function(o,F){return{x:o.x-F.width/2,y:o.y+F.height/2}},10:function(L,Z){return{x:L.x+Z.width/2,y:L.y+Z.height/2}},11:function(u,b){return{x:u.x+u.width/2,y:u.y+b.height/2}},12:function(n,G){return{x:n.x-G.width/2+n.width,y:n.y+G.height/2}},13:function(m,B){return{x:m.x+m.width+B.width/2,y:m.y+B.height/2}},14:function(z,A){return{x:z.x-A.width/2,y:z.y+z.height/2}},15:function(K){return{x:K.x,y:K.y+K.height/2}},16:function(q,e){return{x:q.x+e.width/2,y:q.y+q.height/2}},17:function(H){return{x:H.x+H.width/2,y:H.y+H.height/2}},18:function(O,j){return{x:O.x+O.width-j.width/2,y:O.y+O.height/2}},19:function($){return{x:$.x+$.width,y:$.y+$.height/2}},20:function(I,D){return{x:I.x+I.width+D.width/2,y:I.y+I.height/2}},21:function(Q,x){return{x:Q.x-x.width/2,y:Q.y+Q.height-x.height/2}},22:function(D,n){return{x:D.x+n.width/2,y:D.y+D.height-n.height/2}},23:function(U,F){return{x:U.x+U.width/2,y:U.y+U.height-F.height/2}},24:function(E,p){return{x:E.x+E.width-p.width/2,y:E.y+E.height-p.height/2}},25:function(K,k){return{x:K.x+K.width+k.width/2,y:K.y+K.height-k.height/2}},26:function(S){return{x:S.x,y:S.y+S.height}},27:function(H){return{x:H.x+H.width/2,y:H.y+H.height}},28:function(_){return{x:_.x+_.width,y:_.y+_.height}},29:function(T,Y){return{x:T.x-Y.width/2,y:T.y+T.height+Y.height/2}},30:function(L,E){return{x:L.x+E.width/2,y:L.y+L.height+E.height/2}},31:function(D,x){return{x:D.x+D.width/2,y:D.y+D.height+x.height/2}},32:function(i,R){return{x:i.x+i.width-R.width/2,y:i.y+i.height+R.height/2}},33:function(o,Z){return{x:o.x+o.width+Z.width/2,y:o.y+o.height+Z.height/2}},34:function(y,g){return{x:y.x,y:y.y-g.height/2}},35:function(A,z){return{x:A.x+A.width,y:A.y-z.height/2}},36:function(q,E){return{x:q.x,y:q.y+q.height+E.height/2}},37:function(j,C){return{x:j.x+j.width,y:j.y+j.height+C.height/2}},38:function(I,s){return{x:I.x+I.width/4,y:I.y-s.height/2}},39:function(Y,N){return{x:Y.x+3*Y.width/4,y:Y.y-N.height/2}},40:function(x){return{x:x.x+x.width/4,y:x.y}},41:function(P){return{x:P.x+3*P.width/4,y:P.y}},42:function(m,U){return{x:m.x+m.width/4,y:m.y+U.height/2}},43:function(M,m){return{x:M.x+3*M.width/4,y:M.y+m.height/2}},44:function(h,H){return{x:h.x+h.width/2,y:h.y+h.height/2-H.height/2}},45:function(o){return{x:o.x+o.width/4,y:o.y+o.height/2}},46:function(r,t){return{x:r.x+r.width/2-t.width/2,y:r.y+r.height/2}},47:function(l,d){return{x:l.x+l.width/2+d.width/2,y:l.y+l.height/2}},48:function(h){return{x:h.x+3*h.width/4,y:h.y+h.height/2}},49:function(R,l){return{x:R.x+R.width/2,y:R.y+R.height/2+l.height/2}},50:function($,Y){return{x:$.x+$.width/4,y:$.y+$.height-Y.height/2}},51:function(O,v){return{x:O.x+3*O.width/4,y:O.y+O.height-v.height/2}},52:function(Y){return{x:Y.x+Y.width/4,y:Y.y+Y.height}},53:function(F){return{x:F.x+3*F.width/4,y:F.y+F.height}},54:function(h,i){return{x:h.x+h.width/4,y:h.y+h.height+i.height/2}},55:function(z,o){return{x:z.x+3*z.width/4,y:z.y+z.height+o.height/2}}};return Xm(d)?function(x,H,j){return Y[x](H,j?j:ac)}:void 0}();Lp(g,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Ml=g.reverse,an=g.transparent,ep=g.rectSelectBackground,Lk=g.dash,Sg=g.titleBackground,Fk=g.titleIconBackground,Rr=g.headerBackground,hh=g.headerIconBackground,Dr=g.headerSeparator,hr=g.headerLine,Sr=g.contentIconBackground,Jd=g.contentLine,Iq=(g.widgetIconHighlight,g.widgetIconBorder),rg=(g.widgetIconGradient,g.imageBackground),rc=g.imageGradient,Up=g.highlight,Pb=g.label,fr=g.labelSelect;if(vl&&!d.shutAlert1){var fc=new Date,qr=vl.split("-"),Bs=new Date(fc.getFullYear(),fc.getMonth(),fc.getDate()),vl=new Date(Mm(qr[0],10),Mm(qr[1],10)-1,Mm(qr[2],10)),jf=Bs.getTime(),ge=vl.getTime(),Ad=j+"_try",tc=d.alert;try{var Kg=d.localStorage;if(Kg&&tc)if(ge>jf&&1728e6>ge-jf){var hl=(ge-jf)/864e5;Kg&&Kg[Ad]!=hl&&(Kg[Ad]=hl,d.htWillExpire?tc(d.htWillExpire.replace("{{day}}",hl)):tc("HT for Web free trial license will expire in "+hl+" days, please apply for a new license!"))}else jf>=ge&&(d.htExpired?tc(d.htExpired):tc("Your free trial of HT for Web has expired!")),Kg&&delete Kg[Ad]}catch(Cl){}}Math.sign===B&&(Math.sign=function(h){return 0>h?-1:h>0?1:+h});var Pn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",mh={encode:function(d,C){var M,R,V,m,v,L,y,g="",s=0;for(d=unescape(encodeURIComponent(d));s<d.length;)M=d.charCodeAt(s++),R=d.charCodeAt(s++),V=d.charCodeAt(s++),m=M>>2,v=(3&M)<<4|R>>4,L=(15&R)<<2|V>>6,y=63&V,isNaN(R)?L=y=64:isNaN(V)&&(y=64),g=g+C.charAt(m)+C.charAt(v)+C.charAt(L)+C.charAt(y);return g},decode:function(p,Y,O){for(var F,j,k,J,g,h,u,X="",e=O||0;e<p.length;)J=Y.indexOf(p.charAt(e++)),g=Y.indexOf(p.charAt(e++)),h=Y.indexOf(p.charAt(e++)),u=Y.indexOf(p.charAt(e++)),F=J<<2|g>>4,j=(15&g)<<4|h>>2,k=(3&h)<<6|u,X+=String.fromCharCode(F),64!=h&&(X+=String.fromCharCode(j)),64!=u&&(X+=String.fromCharCode(k));return X=decodeURIComponent(escape(X))},_utf8_encode:function(T){T=T.replace(/\r\n/g,"\n");for(var L="",U=0;U<T.length;U++){var f=T.charCodeAt(U);128>f?L+=String.fromCharCode(f):f>127&&2048>f?(L+=String.fromCharCode(192|f>>6),L+=String.fromCharCode(128|63&f)):(L+=String.fromCharCode(224|f>>12),L+=String.fromCharCode(128|63&f>>6),L+=String.fromCharCode(128|63&f))}return L},_utf8_decode:function(j){for(var B="",b=0,P=0,N=0,m=0;b<j.length;)P=j.charCodeAt(b),128>P?(B+=String.fromCharCode(P),b++):P>191&&224>P?(N=j.charCodeAt(b+1),B+=String.fromCharCode((31&P)<<6|63&N),b+=2):(N=j.charCodeAt(b+1),m=j.charCodeAt(b+2),B+=String.fromCharCode((15&P)<<12|(63&N)<<6|63&m),b+=3);return B}},Dg=[],kk=[],_k=_.Math={generateUUID:function(){for(var g=[],h=0;256>h;h++)g[h]=(16>h?"0":"")+h.toString(16).toUpperCase();return function(){var O=0|4294967295*Math.random(),p=0|4294967295*Math.random(),U=0|4294967295*Math.random(),X=0|4294967295*Math.random();return g[255&O]+g[255&O>>8]+g[255&O>>16]+g[255&O>>24]+"-"+g[255&p]+g[255&p>>8]+"-"+g[64|15&p>>16]+g[255&p>>24]+"-"+g[128|63&U]+g[255&U>>8]+"-"+g[255&U>>16]+g[255&U>>24]+g[255&X]+g[255&X>>8]+g[255&X>>16]+g[255&X>>24]}}(),clamp:function(y,Q,I){return Math.max(Q,Math.min(I,y))},fequal:function(d,i,Q){return null==Q&&(Q=1e-8),Math.abs(d-i)<Q},generateIncreasingID:function(){var p=0;return function(){return++p}}(),encodeBase64:function(S,X){return mh.encode(S,X||Pn)},decodeBase64:function(F,y){return mh.decode(F,y||Pn)},randomArray:function(N,u){u=u||N.length;for(var A=u-1;A>0;A--){var w=Math.floor(Math.random()*(A+1)),W=N[A];N[A]=N[w],N[w]=W}return N},randomInt:function(f,Y){return Y===B&&(Y=f,f=0),f+Math.floor(Math.random()*(Y-f))},randomFloat:function(W,l){return l===B&&(l=W,W=0),W+Math.random()*(l-W)},isPOT:function(i){return i>0&&0===(i-1&i)},nearestPOT:function(H){if(!H)return 1;var M=H;M--,M|=M>>1,M|=M>>2,M|=M>>4,M|=M>>8,M|=M>>16,M++;var E=M>>1;return H-E>M-H?M:E},requestMatrix4:function(){return Dg.length>0?Dg.pop():new _k.Matrix4},releaseMatrix4:function(P){Dg.push(P)},requestVector3:function(){return kk.length>0?kk.pop():new _k.Vector3},releaseVector3:function(_){kk.push(_)}},hf=_.Matrix=_.Math.Matrix2d=function(w,K,p,S,h){this.setFromTransform(w,K,p,S,h)},hg=hf;hf.prototype={},hf.prototype.constructor=hf,hf.prototype.set=function(V,O,I,y,q,l){return this.a=V,this.b=O,this.c=I,this.d=y,this.tx=q,this.ty=l,this},hf.prototype.setFromTransform=function(U,o,P,K,T){var Y=this;if(U===B)return Y.a=1,Y.b=0,Y.c=0,Y.d=1,Y.tx=0,Y.ty=0,void 0;var y,Z;return U?(y=N(U),Z=c(U)):(y=0,Z=1),K=K||1,T=T||1,Y.a=Z*K,Y.b=y*K,Y.c=-y*T,Y.d=Z*T,Y.tx=o||0,Y.ty=P||0,Y},hf.prototype.apply=function(Y,U){U=U||new sm;var H=Y.x,O=Y.y;return U.x=this.a*H+this.c*O+this.tx,U.y=this.b*H+this.d*O+this.ty,U},hf.prototype.applyInverse=function(S,W){W=W||new sm;var n=1/(this.a*this.d+this.c*-this.b),N=S.x,j=S.y;return W.x=this.d*n*N+-this.c*n*j+(this.ty*this.c-this.tx*this.d)*n,W.y=this.a*n*j+-this.b*n*N+(-this.ty*this.a+this.tx*this.b)*n,W},hf.prototype.translate=function(g,P){return this.tx+=g,this.ty+=P,this},hf.prototype.scale=function(k,q){return this.a*=k,this.d*=q,this.c*=k,this.b*=q,this.tx*=k,this.ty*=q,this},hf.prototype.rotate=function(m){var H=Math.cos(m),S=Math.sin(m),j=this.a,R=this.c,g=this.tx;return this.a=j*H-this.b*S,this.b=j*S+this.b*H,this.c=R*H-this.d*S,this.d=R*S+this.d*H,this.tx=g*H-this.ty*S,this.ty=g*S+this.ty*H,this},hf.prototype.appendTranslate=function(N,k){return this.tx+=this.a*N+this.c*k,this.ty+=this.b*N+this.d*k,this},hf.prototype.appendScale=function(e,p){return this.a*=e,this.d*=p,this.c*=p,this.b*=e,this},hf.prototype.appendRotate=function(U){if(!U)return this;var _=Math.cos(U),v=Math.sin(U),g=this.a,w=this.b;return this.a=g*_+this.c*v,this.b=w*_+this.d*v,this.c=-g*v+this.c*_,this.d=-w*v+this.d*_,this},hf.prototype.append=function(f){var G=this.a,c=this.b,u=this.c,M=this.d;return this.a=f.a*G+f.b*u,this.b=f.a*c+f.b*M,this.c=f.c*G+f.d*u,this.d=f.c*c+f.d*M,this.tx=f.tx*G+f.ty*u+this.tx,this.ty=f.tx*c+f.ty*M+this.ty,this},hf.prototype.setTransform=function(g,u,n,e,O,i,T,X,L){var d,o,R,S,W,w,c,E,N,U;return W=Math.sin(T),w=Math.cos(T),c=Math.cos(L),E=Math.sin(L),N=-Math.sin(X),U=Math.cos(X),d=w*O,o=W*O,R=-W*i,S=w*i,this.a=c*d+E*R,this.b=c*o+E*S,this.c=N*d+U*R,this.d=N*o+U*S,this.tx=g+(n*d+e*R),this.ty=u+(n*o+e*S),this},hf.prototype.prepend=function(f){var z=this.tx;if(1!==f.a||0!==f.b||0!==f.c||1!==f.d){var J=this.a,X=this.c;this.a=J*f.a+this.b*f.c,this.b=J*f.b+this.b*f.d,this.c=X*f.a+this.d*f.c,this.d=X*f.b+this.d*f.d}return this.tx=z*f.a+this.ty*f.c+f.tx,this.ty=z*f.b+this.ty*f.d+f.ty,this},hf.prototype.transform=hf.prototype.prepend,hf.prototype.invert=function(){var b=this.a,j=this.b,x=this.c,q=this.d,p=this.tx,E=b*q-j*x;return this.a=q/E,this.b=-j/E,this.c=-x/E,this.d=b/E,this.tx=(x*this.ty-q*p)/E,this.ty=-(b*this.ty-j*p)/E,this},hf.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},hf.prototype.clone=function(){var c=new hf;return c.a=this.a,c.b=this.b,c.c=this.c,c.d=this.d,c.tx=this.tx,c.ty=this.ty,c},hf.prototype.copy=function(l){return l.a=this.a,l.b=this.b,l.c=this.c,l.d=this.d,l.tx=this.tx,l.ty=this.ty,l},hf.prototype.tf=function(N,z){1===arguments.length&&(z=N.y,N=N.x);var U=this;return{x:U.a*N+U.c*z+U.tx,y:U.b*N+U.d*z+U.ty}},hf.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},hf.prototype.fromArray=function(z){return this.a=z[0],this.b=z[1],this.c=z[2],this.d=z[3],this.tx=z[4],this.ty=z[5],this},hf.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},hf.prototype.tfi=function(w,R){1===arguments.length&&(R=w.y,w=w.x);var h=this,D=1/(h.a*h.d+h.c*-h.b);return{x:h.d*D*w+-h.c*D*R+(h.ty*h.c-h.tx*h.d)*D,y:h.a*D*R+-h.b*D*w+(-h.ty*h.a+h.tx*h.b)*D}},hf.prototype.decompose=function(){var k=this,a=k.a,F=k.b,j=k.c,t=k.d,w=Math.sqrt(a*a+F*F),Z=Math.sqrt(j*j+t*t),r=a*t-F*j;return 0>r&&(t>a?w=-w:Z=-Z),w&&(a*=1/w,F*=1/w),Z&&(j*=1/Z,t*=1/Z),{translateX:k.tx,translateY:k.ty,rotation:Math.atan2(F,a),scaleX:w,scaleY:Z}},hf.IDENTITY=new hf,hf.TEMP_MATRIX=new hf;var eo=_.Math.Quaternion=function(H,Q,B,N){this.set(H,Q,B,N)};S.assign(eo.prototype,{set:function(m,u,r,X){var I=this;return I._x=m||0,I._y=u||0,I._z=r||0,I._w=X!==B?X:1,I},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(G){var $=this;return $._x=G._x,$._y=G._y,$._z=G._z,$._w=G._w,$},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(d){return this._x*d._x+this._y*d._y+this._z*d._z+this._w*d._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var H=this.length();return 0===H?(this._x=0,this._y=0,this._z=0,this._w=1):(H=1/H,this._x=this._x*H,this._y=this._y*H,this._z=this._z*H,this._w=this._w*H),this},fromArray:function(O,c){c===B&&(c=0);var r=this;return r._x=O[c],r._y=O[c+1],r._z=O[c+2],r._w=O[c+3],this},slerp:function(l,B){if(0===B)return this;if(1===B)return this.copy(l);var Q=this._x,n=this._y,z=this._z,o=this._w,D=o*l._w+Q*l._x+n*l._y+z*l._z;if(0>D?(this._w=-l._w,this._x=-l._x,this._y=-l._y,this._z=-l._z,D=-D):this.copy(l),D>=1)return this._w=o,this._x=Q,this._y=n,this._z=z,this;var $=Math.sqrt(1-D*D);if(Math.abs($)<.001)return this._w=.5*(o+this._w),this._x=.5*(Q+this._x),this._y=.5*(n+this._y),this._z=.5*(z+this._z),this;var E=Math.atan2($,D),A=Math.sin((1-B)*E)/$,u=Math.sin(B*E)/$;return this._w=o*A+this._w*u,this._x=Q*A+this._x*u,this._y=n*A+this._y*u,this._z=z*A+this._z*u,this},setFromAxisAngle:function(W,J){var V=J/2,w=Math.sin(V);return this._x=W.x*w,this._y=W.y*w,this._z=W.z*w,this._w=Math.cos(V),this},setFromEuler:function(i){var X=i._x,g=i._y,N=i._z,$=i._order,y=Math.cos,t=Math.sin,k=y(X/2),D=y(g/2),G=y(N/2),M=t(X/2),r=t(g/2),U=t(N/2);return"XYZ"===$?(this._x=M*D*G+k*r*U,this._y=k*r*G-M*D*U,this._z=k*D*U+M*r*G,this._w=k*D*G-M*r*U):"YXZ"===$?(this._x=M*D*G+k*r*U,this._y=k*r*G-M*D*U,this._z=k*D*U-M*r*G,this._w=k*D*G+M*r*U):"ZXY"===$?(this._x=M*D*G-k*r*U,this._y=k*r*G+M*D*U,this._z=k*D*U+M*r*G,this._w=k*D*G-M*r*U):"ZYX"===$?(this._x=M*D*G-k*r*U,this._y=k*r*G+M*D*U,this._z=k*D*U-M*r*G,this._w=k*D*G+M*r*U):"YZX"===$?(this._x=M*D*G+k*r*U,this._y=k*r*G+M*D*U,this._z=k*D*U-M*r*G,this._w=k*D*G-M*r*U):"XZY"===$&&(this._x=M*D*G-k*r*U,this._y=k*r*G-M*D*U,this._z=k*D*U+M*r*G,this._w=k*D*G+M*r*U),this},setFromRotationMatrix:function(b){var y,z=b.el,q=z[0],G=z[4],Z=z[8],E=z[1],V=z[5],S=z[9],F=z[2],Y=z[6],v=z[10],A=q+V+v;return A>0?(y=.5/Math.sqrt(A+1),this._w=.25/y,this._x=(Y-S)*y,this._y=(Z-F)*y,this._z=(E-G)*y):q>V&&q>v?(y=2*Math.sqrt(1+q-V-v),this._w=(Y-S)/y,this._x=.25*y,this._y=(G+E)/y,this._z=(Z+F)/y):V>v?(y=2*Math.sqrt(1+V-q-v),this._w=(Z-F)/y,this._x=(G+E)/y,this._y=.25*y,this._z=(S+Y)/y):(y=2*Math.sqrt(1+v-q-V),this._w=(E-G)/y,this._x=(Z+F)/y,this._y=(S+Y)/y,this._z=.25*y),this},setFromToVectors:function(){var k,u;return function(d,S){return k===B&&(k=new Or),u=d.dot(S)+1,1e-7>u?(u=0,Math.abs(d.x)>Math.abs(d.z)?k.set(-d.y,d.x,0):k.set(0,-d.z,d.y)):k.crossVectors(d,S),this._x=k.x,this._y=k.y,this._z=k.z,this._w=u,this.normalize()}}(),setFromUnitVectors:function(){var Y,v,G=1e-6;return function(c,K){return Y===B&&(Y=new Or),v=c.dot(K)+1,G>v?(v=0,Math.abs(c.x)>Math.abs(c.z)?Y.set(-c.y,c.x,0):Y.set(0,-c.z,c.y)):Y.crossVectors(c,K),this._x=Y.x,this._y=Y.y,this._z=Y.z,this._w=v,this.normalize()}}(),multiply:function(x){return this.multiplyQuaternions(this,x)},premultiply:function(v){return this.multiplyQuaternions(v,this)},multiplyQuaternions:function(E,p){var t=E._x,J=E._y,W=E._z,e=E._w,j=p._x,M=p._y,T=p._z,_=p._w;return this._x=t*_+e*j+J*T-W*M,this._y=J*_+e*M+W*j-t*T,this._z=W*_+e*T+t*M-J*j,this._w=e*_-t*j-J*M-W*T,this},toArray:function($,r){return $||($=[]),r=r||0,$[r]=this._x,$[r+1]=this._y,$[r+2]=this._z,$[r+3]=this._w,$}});var il=_.Math.Vector4=function(b,R,I,e){this.x=b||0,this.y=R||0,this.z=I||0,this.w=e!==B?e:1};S.assign(il.prototype,{isVector4:!0,set:function(P,Q,B,S){return this.x=P,this.y=Q,this.z=B,this.w=S,this},setScalar:function(f){return this.x=f,this.y=f,this.z=f,this.w=f,this},setX:function(t){return this.x=t,this},setY:function(L){return this.y=L,this},setZ:function(L){return this.z=L,this},setW:function(F){return this.w=F,this},setComponent:function(w,R){switch(w){case 0:this.x=R;break;case 1:this.y=R;break;case 2:this.z=R;break;case 3:this.w=R;break;default:throw new Error("index is out of range: "+w)}return this},getComponent:function(W){switch(W){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+W)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(o){return this.x=o.x,this.y=o.y,this.z=o.z,this.w=o.w!==B?o.w:1,this},add:function(l,O){return O!==B?this.addVectors(l,O):(this.x+=l.x,this.y+=l.y,this.z+=l.z,this.w+=l.w,this)},addScalar:function(g){return this.x+=g,this.y+=g,this.z+=g,this.w+=g,this},addVectors:function(N,k){return this.x=N.x+k.x,this.y=N.y+k.y,this.z=N.z+k.z,this.w=N.w+k.w,this},addScaledVector:function(s,H){return this.x+=s.x*H,this.y+=s.y*H,this.z+=s.z*H,this.w+=s.w*H,this},sub:function(f,H){return H!==B?this.subVectors(f,H):(this.x-=f.x,this.y-=f.y,this.z-=f.z,this.w-=f.w,this)},subScalar:function(w){return this.x-=w,this.y-=w,this.z-=w,this.w-=w,this},subVectors:function(J,X){return this.x=J.x-X.x,this.y=J.y-X.y,this.z=J.z-X.z,this.w=J.w-X.w,this},multiplyScalar:function(V){return this.x*=V,this.y*=V,this.z*=V,this.w*=V,this},applyMatrix4:function(M){var T=this.x,c=this.y,f=this.z,S=this.w,d=M.el;
return this.x=d[0]*T+d[4]*c+d[8]*f+d[12]*S,this.y=d[1]*T+d[5]*c+d[9]*f+d[13]*S,this.z=d[2]*T+d[6]*c+d[10]*f+d[14]*S,this.w=d[3]*T+d[7]*c+d[11]*f+d[15]*S,this},divideScalar:function(I){return this.multiplyScalar(1/I)},setAxisAngleFromQuaternion:function(H){this.w=2*Math.acos(H.w);var A=Math.sqrt(1-H.w*H.w);return 1e-4>A?(this.x=1,this.y=0,this.z=0):(this.x=H.x/A,this.y=H.y/A,this.z=H.z/A),this},setAxisAngleFromRotationMatrix:function(X){var j,I,G,c,a=.01,H=.1,$=X.el,r=$[0],E=$[4],_=$[8],J=$[1],L=$[5],W=$[9],M=$[2],t=$[6],V=$[10];if(Math.abs(E-J)<a&&Math.abs(_-M)<a&&Math.abs(W-t)<a){if(Math.abs(E+J)<H&&Math.abs(_+M)<H&&Math.abs(W+t)<H&&Math.abs(r+L+V-3)<H)return this.set(1,0,0,0),this;j=Math.PI;var S=(r+1)/2,Y=(L+1)/2,K=(V+1)/2,m=(E+J)/4,p=(_+M)/4,e=(W+t)/4;return S>Y&&S>K?a>S?(I=0,G=.707106781,c=.707106781):(I=Math.sqrt(S),G=m/I,c=p/I):Y>K?a>Y?(I=.707106781,G=0,c=.707106781):(G=Math.sqrt(Y),I=m/G,c=e/G):a>K?(I=.707106781,G=.707106781,c=0):(c=Math.sqrt(K),I=p/c,G=e/c),this.set(I,G,c,j),this}var O=Math.sqrt((t-W)*(t-W)+(_-M)*(_-M)+(J-E)*(J-E));return Math.abs(O)<.001&&(O=1),this.x=(t-W)/O,this.y=(_-M)/O,this.z=(J-E)/O,this.w=Math.acos((r+L+V-1)/2),this},min:function(L){return this.x=Math.min(this.x,L.x),this.y=Math.min(this.y,L.y),this.z=Math.min(this.z,L.z),this.w=Math.min(this.w,L.w),this},max:function(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this.w=Math.max(this.w,i.w),this},clamp:function(S,V){return this.x=Math.max(S.x,Math.min(V.x,this.x)),this.y=Math.max(S.y,Math.min(V.y,this.y)),this.z=Math.max(S.z,Math.min(V.z,this.z)),this.w=Math.max(S.w,Math.min(V.w,this.w)),this},clampScalar:function(){var Z,$;return function(w,n){return Z===B&&(Z=new il,$=new il),Z.set(w,w,w,w),$.set(n,n,n,n),this.clamp(Z,$)}}(),clampLength:function(y,C){var R=this.length();return this.divideScalar(R||1).multiplyScalar(Math.max(y,Math.min(C,R)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(G){return this.x*G.x+this.y*G.y+this.z*G.z+this.w*G.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(n,s){return this.x+=(n.x-this.x)*s,this.y+=(n.y-this.y)*s,this.z+=(n.z-this.z)*s,this.w+=(n.w-this.w)*s,this},lerpVectors:function(I,L,K){return this.subVectors(L,I).multiplyScalar(K).add(I)},equals:function(u){return u.x===this.x&&u.y===this.y&&u.z===this.z&&u.w===this.w},fromArray:function(u,C){return C===B&&(C=0),this.x=u[C],this.y=u[C+1],this.z=u[C+2],this.w=u[C+3],this},toArray:function(e,W){return e===B&&(e=[]),W===B&&(W=0),e[W]=this.x,e[W+1]=this.y,e[W+2]=this.z,e[W+3]=this.w,e},fromBufferAttribute:function(A,B){return this.x=A.getX(B),this.y=A.getY(B),this.z=A.getZ(B),this.w=A.getW(B),this}});var Or=_.Math.Vector3=function($,X,Q){$===B?(this.x=0,this.y=0,this.z=0):"object"==typeof $?this.copy($):this.set($,X==B?$:X,Q==B?$:Q)},Yb=_.Math.Vector3;S.assign(Or.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(l,c,N){return this.x=l,this.y=c,this.z=N,this},equals:function(O){return O&&this.x===O.x&&this.y===O.y&&this.z===O.z},setScalar:function(f){return this.x=f,this.y=f,this.z=f,this},setX:function(E){return this.x=E,this},setY:function(C){return this.y=C,this},setZ:function(z){return this.z=z,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(X){return X.x===B?(this.x=X[0],this.y=X[1],this.z=X[2]):(this.x=X.x,this.y=X.y,this.z=X.z||0),this},add:function(Y){return this.x+=Y.x,this.y+=Y.y,this.z+=Y.z,this},addScalar:function(i){return this.x+=i,this.y+=i,this.z+=i,this},addVectors:function(A,u){return this.x=A.x+u.x,this.y=A.y+u.y,this.z=A.z+u.z,this},addScaledVector:function(L,g){return this.x+=L.x*g,this.y+=L.y*g,this.z+=L.z*g,this},sub:function(C){return this.x-=C.x,this.y-=C.y,this.z-=C.z,this},subScalar:function(N){return this.x-=N,this.y-=N,this.z-=N,this},subVectors:function(r,S){return this.x=r.x-S.x,this.y=r.y-S.y,this.z=r.z-S.z,this},divide:function(A){return this.x/=A.x,this.y/=A.y,this.z/=A.z,this},multiply:function(N){return this.x*=N.x,this.y*=N.y,this.z*=N.z,this},multiplyScalar:function(C){return this.x*=C,this.y*=C,this.z*=C,this},divideScalar:function(j){if(0!==j){var x=1/j;this.x*=x,this.y*=x,this.z*=x}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(F){return Math.sqrt(this.distanceToSquared(F))},distanceToSquared:function(P){var $=this.x-P.x,D=this.y-P.y,w=this.z-P.z;return $*$+D*D+w*w},distanceToSquared2:function(Z){var z=this.x-Z[0],A=this.y-Z[1],I=this.z-Z[2];return z*z+A*A+I*I},divideVectors:function(I,F){return this.x=I.x/F.x,this.y=I.y/F.y,this.z=I.z/F.z,this},multiplyVectors:function(b,n){return this.x=b.x*n.x,this.y=b.y*n.y,this.z=b.z*n.z,this},transformDirection:function(E){var n=this.x,b=this.y,c=this.z,G=E.el;return this.x=G[0]*n+G[4]*b+G[8]*c,this.y=G[1]*n+G[5]*b+G[9]*c,this.z=G[2]*n+G[6]*b+G[10]*c,this.normalize()},applyAxisAngle:function(){var o=new eo;return function(S,V){return this.applyQuaternion(o.setFromAxisAngle(S,V))}}(),applyEuler:function(){var w=new eo;return function(i){return this.applyQuaternion(w.setFromEuler(i))}}(),applyQuaternion:function(K){var W=this.x,H=this.y,p=this.z,O=K._x,E=K._y,n=K._z,Z=K._w,k=Z*W+E*p-n*H,$=Z*H+n*W-O*p,A=Z*p+O*H-E*W,a=-O*W-E*H-n*p;return this.x=k*Z+a*-O+$*-n-A*-E,this.y=$*Z+a*-E+A*-O-k*-n,this.z=A*Z+a*-n+k*-E-$*-O,this},applyMatrix4:function(j){var t=this.x,D=this.y,P=this.z,o=j.el,Y=1/(o[3]*t+o[7]*D+o[11]*P+o[15]);return this.x=(o[0]*t+o[4]*D+o[8]*P+o[12])*Y,this.y=(o[1]*t+o[5]*D+o[9]*P+o[13])*Y,this.z=(o[2]*t+o[6]*D+o[10]*P+o[14])*Y,this},applyMatrix3:function(N){var O=this.x,T=this.y,y=this.z,A=N.el;return this.x=A[0]*O+A[3]*T+A[6]*y,this.y=A[1]*O+A[4]*T+A[7]*y,this.z=A[2]*O+A[5]*T+A[8]*y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var s=new Or;return function(l){return this.sub(s.copy(l).multiplyScalar(2*this.dot(l)))}}(),dot:function(E){return this.x*E.x+this.y*E.y+this.z*E.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var W=this.length();return W?this.multiplyScalar(1/W):this},setLength:function(Z){return this.normalize().multiplyScalar(Z)},fromArray:function(x,V){return V===B&&(V=0),this.x=x[V],this.y=x[V+1],this.z=x[V+2],this},toArray:function(L,W){return L===B&&(L=[0,0,0]),W===B&&(W=0),L[W]=this.x,L[W+1]=this.y,L[W+2]=this.z,L},cross:function(x){return this.crossVectors(this,x)},angleTo:function(B){var z=this.dot(B)/Math.sqrt(this.lengthSq()*B.lengthSq());return z>1||-1>z?0:Math.acos(z)},lerp:function(E,U){return this.x+=(E.x-this.x)*U,this.y+=(E.y-this.y)*U,this.z+=(E.z-this.z)*U,this},lerpVectors:function(H,n,U){return this.subVectors(n,H).multiplyScalar(U).add(H)},crossVectors:function(E,j){var O=E.x,U=E.y,H=E.z,t=j.x,m=j.y,k=j.z;return this.x=U*k-H*m,this.y=H*t-O*k,this.z=O*m-U*t,this},min:function(V){return this.x=Math.min(this.x,V.x),this.y=Math.min(this.y,V.y),this.z=Math.min(this.z,V.z),this},max:function(q){return this.x=Math.max(this.x,q.x),this.y=Math.max(this.y,q.y),this.z=Math.max(this.z,q.z),this},setFromMatrixPosition:function(X){return this.setFromMatrixColumn(X,3)},setFromMatrixScale:function(E){var Z=this.setFromMatrixColumn(E,0).length(),i=this.setFromMatrixColumn(E,1).length(),x=this.setFromMatrixColumn(E,2).length();return this.x=Z,this.y=i,this.z=x,this},setFromMatrixColumn:function(O,i){return this.fromArray(O.el,4*i)}}),Or.UP=new Or(0,1,0),Or.AxisX=new Or(1,0,0),Or.AxisY=new Or(0,1,0),Or.AxisZ=new Or(0,0,1),Or.normalizeArray=function(){var o=new Or;return function(u){return o.copy(u).normalize().toArray()}}();var sm=_.Math.Vector2=function(g,j,s){"object"==typeof g&&(g.x!=B?(j=g.y,s=g.e,g=g.x):(s=g[2],j=g[1],g=g[0])),this.set(g||0,j||0,s)};sm.prototype={},sm.prototype.constructor=sm;var go=sm;S.defineProperties(sm.prototype,{width:{get:function(){return this.x},set:function(r){this.x=r}},height:{get:function(){return this.y},set:function(i){this.y=i}}}),sm.prototype.clone=function(){return new sm(this.x,this.y,this.e)},sm.prototype.copy=function(z){return this.set(z.x,z.y,z.e),this},sm.prototype.equals=function(e){return e.x===this.x&&e.y===this.y&&e.e===this.e},sm.prototype.set=function(c,a,U){return this.x=c||0,this.y=a||(0!==a?this.x:0),U!=B&&(this.e=U),this},sm.prototype.setScalar=function(h){return this.x=h,this.y=h,this.e=h,this},sm.prototype.setX=function(t){return this.x=t||0,this},sm.prototype.setY=function(x){return this.y=x||0,this},sm.prototype.setE=function(E){return this.e=E||0,this},sm.prototype.add=function(W){return this.x+=W.x,this.y+=W.y,this},sm.prototype.addVectors=function(i,m){return this.x=i.x+m.x,this.y=i.y+m.y,this},sm.prototype.addScalar=function(B){return this.x+=B,this.y+=B,this},sm.prototype.addScaledVector=function(D,T){return this.x+=D.x*T,this.y+=D.y*T,this},sm.prototype.sub=function(j){return this.x-=j.x,this.y-=j.y,this},sm.prototype.subScalar=function(G){return this.x-=G,this.y-=G,this},sm.prototype.subVectors=function(X,$){return this.x=X.x-$.x,this.y=X.y-$.y,this},sm.prototype.multiply=function($){return this.x*=$.x,this.y*=$.y,this},sm.prototype.multiplyScalar=function(c){return this.x*=c,this.y*=c,this},sm.prototype.divide=function(R){return this.x/=R.x,this.y/=R.y,this},sm.prototype.divideScalar=function(d){return this.multiplyScalar(1/d)},sm.prototype.min=function(g){return this.x=Math.min(this.x,g.x),this.y=Math.min(this.y,g.y),this},sm.prototype.max=function(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this},sm.prototype.fromArray=function(l,S){return S===B&&(S=0),this.x=l[S],this.y=l[S+1],this},sm.prototype.clamp=function(O,L){return this.x=Math.max(O.x,Math.min(L.x,this.x)),this.y=Math.max(O.y,Math.min(L.y,this.y)),this},sm.prototype.clampScalar=function(){var q,y;return function(M,i){return q===B&&(q=new sm,y=new sm),q.set(M,M),y.set(i,i),this.clamp(q,y)}}(),sm.prototype.clampLength=function(s,t){var f=this.length();return this.multiplyScalar(Math.max(s,Math.min(t,f))/f)},sm.prototype.dot=function(X){return this.x*X.x+this.y*X.y},sm.prototype.cross=function(v){return this.x*v.y-this.y*v.x},sm.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},sm.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},sm.prototype.normalize=function(){return this.divideScalar(this.length())},sm.prototype.angle=function(){var r=Math.atan2(this.y,this.x);return 0>r&&(r+=2*Math.PI),r},sm.prototype.distanceTo=function(p){return Math.sqrt(this.distanceToSquared(p))},sm.prototype.distanceToSquared=function(M){var p=this.x-M.x,R=this.y-M.y;return p*p+R*R},sm.prototype.isNearEnough=function($){return this.distanceToSquared($)<1e-8},sm.prototype.setLength=function(A){var u=this.length();return u?this.multiplyScalar(A/u):this},sm.prototype.lerp=function(d,D){return this.x+=(d.x-this.x)*D,this.y+=(d.y-this.y)*D,"number"==typeof d.e&&"number"==typeof this.e&&(this.e+=(d.e-this.e)*D),this},sm.prototype.lerpVectors=function(h,$,k){return this.subVectors($,h).multiplyScalar(k).add(h)},sm.prototype.rotateAround=function(t,i){var c=t?t.x:0,z=t?t.y:0,j=Math.cos(i),g=Math.sin(i),E=this.x-c,$=this.y-z;return this.x=E*j-$*g+c,this.y=E*g+$*j+z,this};var Sl=_.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};S.assign(Sl.prototype,{isMatrix3:!0,set:function(u,w,c,o,q,S,k,d,G){var F=this.el;return F[0]=u,F[1]=o,F[2]=k,F[3]=w,F[4]=q,F[5]=d,F[6]=c,F[7]=S,F[8]=G,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(Q){var Z=this.el,g=Q.el;return Z[0]=g[0],Z[1]=g[1],Z[2]=g[2],Z[3]=g[3],Z[4]=g[4],Z[5]=g[5],Z[6]=g[6],Z[7]=g[7],Z[8]=g[8],this},setFromMatrix4:function(x){var t=x.el;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var c=new Or;return function(r){for(var K=0,Q=r.count;Q>K;K++)c.x=r.getX(K),c.y=r.getY(K),c.z=r.getZ(K),c.applyMatrix3(this),r.setXYZ(K,c.x,c.y,c.z);return r}}(),multiply:function(Z){return this.multiplyMatrices(this,Z)},premultiply:function(J){return this.multiplyMatrices(J,this)},multiplyMatrices:function(U,I){var B=U.el,C=I.el,t=this.el,R=B[0],L=B[3],K=B[6],b=B[1],O=B[4],p=B[7],H=B[2],w=B[5],S=B[8],P=C[0],k=C[3],X=C[6],f=C[1],o=C[4],e=C[7],N=C[2],r=C[5],u=C[8];return t[0]=R*P+L*f+K*N,t[3]=R*k+L*o+K*r,t[6]=R*X+L*e+K*u,t[1]=b*P+O*f+p*N,t[4]=b*k+O*o+p*r,t[7]=b*X+O*e+p*u,t[2]=H*P+w*f+S*N,t[5]=H*k+w*o+S*r,t[8]=H*X+w*e+S*u,this},multiplyScalar:function(R){var F=this.el;return F[0]*=R,F[3]*=R,F[6]*=R,F[1]*=R,F[4]*=R,F[7]*=R,F[2]*=R,F[5]*=R,F[8]*=R,this},determinant:function(){var P=this.el,L=P[0],E=P[1],u=P[2],z=P[3],M=P[4],j=P[5],O=P[6],N=P[7],p=P[8];return L*M*p-L*j*N-E*z*p+E*j*O+u*z*N-u*M*O},getInverse:function(j){var o=j.el,E=this.el,H=o[0],G=o[1],F=o[2],$=o[3],h=o[4],D=o[5],g=o[6],X=o[7],d=o[8],v=d*h-D*X,T=D*g-d*$,c=X*$-h*g,u=H*v+G*T+F*c;if(0===u)return this.identity();var b=1/u;return E[0]=v*b,E[1]=(F*X-d*G)*b,E[2]=(D*G-F*h)*b,E[3]=T*b,E[4]=(d*H-F*g)*b,E[5]=(F*$-D*H)*b,E[6]=c*b,E[7]=(G*g-X*H)*b,E[8]=(h*H-G*$)*b,this},transpose:function(){var I,B=this.el;return I=B[1],B[1]=B[3],B[3]=I,I=B[2],B[2]=B[6],B[6]=I,I=B[5],B[5]=B[7],B[7]=I,this},getNormalMatrix:function(x){return this.setFromMatrix4(x).getInverse(this).transpose()},transposeIntoArray:function(u){var F=this.el;return u[0]=F[0],u[1]=F[3],u[2]=F[6],u[3]=F[1],u[4]=F[4],u[5]=F[7],u[6]=F[2],u[7]=F[5],u[8]=F[8],this},setUvTransform:function(R,D,Z,H,M,h,y){var J=Math.cos(M),B=Math.sin(M);this.set(Z*J,Z*B,-Z*(J*h+B*y)+h+R,-H*B,H*J,-H*(-B*h+J*y)+y+D,0,0,1)},scale:function(O,D){var g=this.el;return g[0]*=O,g[3]*=O,g[6]*=O,g[1]*=D,g[4]*=D,g[7]*=D,this},rotate:function(C){var B=Math.cos(C),M=Math.sin(C),i=this.el,y=i[0],d=i[3],Y=i[6],F=i[1],V=i[4],z=i[7];return i[0]=B*y+M*F,i[3]=B*d+M*V,i[6]=B*Y+M*z,i[1]=-M*y+B*F,i[4]=-M*d+B*V,i[7]=-M*Y+B*z,this},translate:function(P,q){var o=this.el;return o[0]+=P*o[2],o[3]+=P*o[5],o[6]+=P*o[8],o[1]+=q*o[2],o[4]+=q*o[5],o[7]+=q*o[8],this},equals:function(Y){for(var l=this.el,_=Y.el,u=0;9>u;u++)if(l[u]!==_[u])return!1;return!0},fromArray:function(u,r){r===B&&(r=0);for(var L=0;9>L;L++)this.el[L]=u[L+r];return this},toArray:function(z,w){z===B&&(z=[]),w===B&&(w=0);var s=this.el;return z[w]=s[0],z[w+1]=s[1],z[w+2]=s[2],z[w+3]=s[3],z[w+4]=s[4],z[w+5]=s[5],z[w+6]=s[6],z[w+7]=s[7],z[w+8]=s[8],z}});var jl=_.Math.Plane=function(q,O){this.normal=q!==B?q:new Or(1,0,0),this.constant=O!==B?O:0};S.assign(jl.prototype,{set:function(Z,C){return this.normal.copy(Z),this.constant=C,this},setComponents:function(g,M,h,w){return this.normal.set(g,M,h),this.constant=w,this},setFromNormalAndCoplanarPoint:function(c,Z){return this.normal.copy(c),this.constant=-Z.dot(this.normal),this},setFromCoplanarPoints:function(){var b=new Or,O=new Or;return function(w,s,r){var a=b.subVectors(r,s).cross(O.subVectors(w,s)).normalize();return this.setFromNormalAndCoplanarPoint(a,w),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(p){return this.normal.copy(p.normal),this.constant=p.constant,this},normalize:function(){var C=1/this.normal.length();return this.normal.multiplyScalar(C),this.constant*=C,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(l){return this.normal.dot(l)+this.constant},distanceToSphere:function(S){return this.distanceToPoint(S.center)-S.radius},projectPoint:function(J,U){return U===B&&(U=new Or),U.copy(this.normal).multiplyScalar(-this.distanceToPoint(J)).add(J)},intersectLine:function(){var j=new Or;return function(Y,K){K===B&&(K=new Or);var o=Y.delta(j),O=this.normal.dot(o);if(0===O)return 0===this.distanceToPoint(Y.start)?K.copy(Y.start):B;var W=-(Y.start.dot(this.normal)+this.constant)/O;return 0>W||W>1?B:K.copy(o).multiplyScalar(W).add(Y.start)}}(),intersectsLine:function(T){var b=this.distanceToPoint(T.start),P=this.distanceToPoint(T.end);return 0>b&&P>0||0>P&&b>0},intersectsBox:function(Y){return Y.intersectsPlane(this)},intersectsSphere:function(g){return g.intersectsPlane(this)},coplanarPoint:function(L){return L===B&&(L=new Or),L.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var g=new Or,U=new Sl;return function(O,X){var A=X||U.getNormalMatrix(O),T=this.coplanarPoint(g).applyMatrix4(O),a=this.normal.applyMatrix3(A).normalize();return this.constant=-T.dot(a),this}}(),translate:function(R){return this.constant-=R.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var kq=_.Math.Ray=function(G,N){this.origin=G!==B?G.clone():new Or,this.direction=N!==B?N.clone():new Or};S.assign(kq.prototype,{set:function(V,C){return this.origin.copy(V),this.direction.copy(C),this},clone:function(){return(new this.constructor).copy(this)},copy:function(O){return this.origin.copy(O.origin),this.direction.copy(O.direction),this.maxHitLen=O.maxHitLen,this},at:function(z,N){var p=N||new Or;return p.copy(this.direction).multiplyScalar(z).add(this.origin)},setMaxHitLength:function(y){this.maxHitLen=y},lookAt:function(a){return this.direction.copy(a).sub(this.origin).normalize(),this},applyMatrix4:function(p){var B=this.maxHitLen;if(B){var t=this.direction.clone().multiplyScalar(B).add(this.origin);t.applyMatrix4(p)}return this.origin.applyMatrix4(p),this.direction.transformDirection(p),B&&(this.maxHitLen=this.origin.distanceTo(t)),this},distanceToPlane:function(A){var V=A.normal.dot(this.direction);if(0===V)return 0===A.distanceToPoint(this.origin)?0:null;var u=-(this.origin.dot(A.normal)+A.constant)/V;return u>=0?u:null},intersectPlane:function(E,T){var H=this.distanceToPlane(E);return null===H?null:this.at(H,T)},intersectSphere:function(){var g=new Or;return function(A,Z){g.subVectors(A.center,this.origin);var X=g.dot(this.direction),F=g.dot(g)-X*X,P=A.radius*A.radius;if(F>P)return null;var B=Math.sqrt(P-F),E=X-B,i=X+B;return 0>E&&0>i?null:0>E?this.at(i,Z):this.at(E,Z)}}(),intersectEllipsoid:function(){var w=new Or,m=new Or;return function(X,v){w.subVectors(X.center,this.origin),w.divide(X.radius),m.divideVectors(this.direction,X.radius);var d=m.lengthSq(),z=w.dot(m),b=w.dot(w)*d-z*z;if(b>d)return null;var y=Math.sqrt(d-b),R=(z-y)/d,T=(z+y)/d;return 0>R&&0>T?null:0>R?this.at(T,v):this.at(R,v)}}(),intersectBox:function(o,m){var l,x,h,G,e,i,C=1/this.direction.x,p=1/this.direction.y,T=1/this.direction.z,y=this.origin;if(C>=0?(l=(o.min.x-y.x)*C,x=(o.max.x-y.x)*C):(l=(o.max.x-y.x)*C,x=(o.min.x-y.x)*C),p>=0?(h=(o.min.y-y.y)*p,G=(o.max.y-y.y)*p):(h=(o.max.y-y.y)*p,G=(o.min.y-y.y)*p),l>G||h>x)return null;if((h>l||l!==l)&&(l=h),(x>G||x!==x)&&(x=G),T>=0?(e=(o.min.z-y.z)*T,i=(o.max.z-y.z)*T):(e=(o.max.z-y.z)*T,i=(o.min.z-y.z)*T),l>i||e>x)return null;if((e>l||l!==l)&&(l=e),(x>i||x!==x)&&(x=i),0>x)return null;var D=l>=0?l:x,d=this.maxHitLen;return d&&D>d?null:this.at(D,m)},intersectTriangle:function(){var q=new Or,a=new Or,k=new Or,v=new Or;return function(d,u,t,I,e){a.subVectors(u,d),k.subVectors(t,d),v.crossVectors(a,k);var J,$=this.direction.dot(v);if($>0){if(I)return null;J=1}else{if(!(0>$))return null;J=-1,$=-$}q.subVectors(this.origin,d);var c=J*this.direction.dot(k.crossVectors(q,k));if(0>c)return null;var o=J*this.direction.dot(a.cross(q));if(0>o||c+o>$)return null;var Z=-J*q.dot(v);if(0>Z)return null;var H=Z/$,i=this.maxHitLen;return i&&H>i?null:this.at(H,e)}}()});var $k=_.Math.Box3=function(H,V){this.min=H!==B?H:new Or(1/0,1/0,1/0),this.max=V!==B?V:new Or(-1/0,-1/0,-1/0)};S.assign($k.prototype,{set:function(x,y){return this.min.copy(x),this.max.copy(y),this},setFromArray:function(u){for(var O=1/0,c=1/0,z=1/0,Y=-1/0,l=-1/0,g=-1/0,j=0,$=u.length;$>j;j+=3){var x=u[j],X=u[j+1],o=u[j+2];O>x&&(O=x),c>X&&(c=X),z>o&&(z=o),x>Y&&(Y=x),X>l&&(l=X),o>g&&(g=o)}return this.min.set(O,c,z),this.max.set(Y,l,g),this},setFromPoints:function(x){this.makeEmpty();for(var w=0,$=x.length;$>w;w++)this.expandByPoint(x[w]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(N){return N.max.x<this.min.x||N.min.x>this.max.x||N.max.y<this.min.y||N.min.y>this.max.y||N.max.z<this.min.z||N.min.z>this.max.z?!1:!0},copy:function(f){return this.min.copy(f.min),this.max.copy(f.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(w){return this.min.min(w),this.max.max(w),this},expandByBox:function(r){return this.min.min(r.min),this.max.max(r.max),this},applyMatrix4:function(){var W=[new Or,new Or,new Or,new Or,new Or,new Or,new Or,new Or];return function(R){return this.isEmpty()?this:(W[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(R),W[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(R),W[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(R),W[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(R),W[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(R),W[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(R),W[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(R),W[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(R),this.setFromPoints(W),this)}}()});var Cb=_.Math.Sphere=function(L,_){this.center=L!==B?L:new Or,this.radius=_!==B?_:0};S.assign(Cb.prototype,{set:function(R,M){return this.center.copy(R),this.radius=M,this},setFromPoints:function(){var U=new $k;return function(b,$){var K=this.center;$!==B?K.copy($):U.setFromPoints(b).getCenter(K);for(var g=0,D=0,z=b.length;z>D;D++)g=Math.max(g,K.distanceToSquared(b[D]));return this.radius=Math.sqrt(g),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(E){return this.center.copy(E.center),this.radius=E.radius,this},empty:function(){return this.radius<=0},containsPoint:function(J){return J.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(b){return b.distanceTo(this.center)-this.radius},intersectsSphere:function(K){var E=this.radius+K.radius;return K.center.distanceToSquared(this.center)<=E*E},intersectsBox:function(j){return j.intersectsSphere(this)},intersectsPlane:function(y){return Math.abs(y.distanceToPoint(this.center))<=this.radius},clampPoint:function(z,L){var v=this.center.distanceToSquared(z);return L===B&&(L=new Or),L.copy(z),v>this.radius*this.radius&&(L.sub(this.center).normalize(),L.multiplyScalar(this.radius).add(this.center)),L},getBoundingBox:function(y){return y===B&&(y=new $k),y.set(this.center,this.center),y.expandByScalar(this.radius),y},applyMatrix4:function(d){return this.center.applyMatrix4(d),this.radius=this.radius*d.getMaxScaleOnAxis(),this},translate:function(j){return this.center.add(j),this},equals:function(Z){return Z.center.equals(this.center)&&Z.radius===this.radius}});var hj=_.Math.Frustum=function(s,p,t,V,D,H){this.planes=[s!==B?s:new jl,p!==B?p:new jl,t!==B?t:new jl,V!==B?V:new jl,D!==B?D:new jl,H!==B?H:new jl]};S.assign(hj.prototype,{set:function(m,v,X,z,U,u){var d=this.planes;return d[0].copy(m),d[1].copy(v),d[2].copy(X),d[3].copy(z),d[4].copy(U),d[5].copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(L){for(var A=this.planes,V=0;6>V;V++)A[V].copy(L.planes[V]);return this},setFromMatrix:function(l){var m=this.planes,H=l.el,a=H[0],c=H[1],h=H[2],V=H[3],I=H[4],j=H[5],s=H[6],X=H[7],b=H[8],r=H[9],d=H[10],O=H[11],i=H[12],p=H[13],n=H[14],M=H[15];return m[0].setComponents(V-a,X-I,O-b,M-i).normalize(),m[1].setComponents(V+a,X+I,O+b,M+i).normalize(),m[2].setComponents(V+c,X+j,O+r,M+p).normalize(),m[3].setComponents(V-c,X-j,O-r,M-p).normalize(),m[4].setComponents(V-h,X-s,O-d,M-n).normalize(),m[5].setComponents(V+h,X+s,O+d,M+n).normalize(),this},intersectsObject:function(){var P=new Cb;return function(o){var l=o.geometry;return null===l.boundingSphere&&l.computeBoundingSphere(),P.copy(l.boundingSphere).applyMatrix4(o.matrixWorld),this.intersectsSphere(P)}}(),intersectsSprite:function(){var w=new Cb;return function(t){return w.center.set(0,0,0),w.radius=.7071067811865476,w.applyMatrix4(t.matrixWorld),this.intersectsSphere(w)}}(),intersectsSphere:function(C){for(var c=this.planes,r=C.center,b=-C.radius,Q=0;6>Q;Q++){var s=c[Q].distanceToPoint(r);if(b>s)return!1}return!0},intersectsBox:function(){var U=new Or;return function(O){for(var j=this.planes,X=0;6>X;X++){var e=j[X];if(U.x=e.normal.x>0?O.max.x:O.min.x,U.y=e.normal.y>0?O.max.y:O.min.y,U.z=e.normal.z>0?O.max.z:O.min.z,e.distanceToPoint(U)<0)return!1}return!0}}(),containsPoint:function(B){for(var P=this.planes,F=0;6>F;F++)if(P[F].distanceToPoint(B)<0)return!1;return!0}});var vr=_.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};S.assign(vr.prototype,{isMatrix4:!0,set:function(D,j,k,N,n,m,O,x,c,P,A,B,i,q,w,t){var R=this.el;return R[0]=D,R[4]=j,R[8]=k,R[12]=N,R[1]=n,R[5]=m,R[9]=O,R[13]=x,R[2]=c,R[6]=P,R[10]=A,R[14]=B,R[3]=i,R[7]=q,R[11]=w,R[15]=t,this},clone:function(){return(new vr).fromArray(this.el)},fromArray:function(y,R){R===B&&(R=0);for(var i=this.el,V=0;16>V;V++)i[V]=y[V+R];return this},getElements:function(){return this.el},scale:function($){var x=this.el,R=$.x,z=$.y,t=$.z;return x[0]*=R,x[4]*=z,x[8]*=t,x[1]*=R,x[5]*=z,x[9]*=t,x[2]*=R,x[6]*=z,x[10]*=t,x[3]*=R,x[7]*=z,x[11]*=t,this},makeRotationFromEuler:function(W){var w=this.el,G=W._x,g=W._y,r=W._z,Y=W._order,b=Math.cos(G),u=Math.sin(G),X=Math.cos(g),M=Math.sin(g),H=Math.cos(r),e=Math.sin(r);if("XYZ"===Y){var z=b*H,x=b*e,K=u*H,N=u*e;w[0]=X*H,w[4]=-X*e,w[8]=M,w[1]=x+K*M,w[5]=z-N*M,w[9]=-u*X,w[2]=N-z*M,w[6]=K+x*M,w[10]=b*X}else if("YXZ"===Y){var o=X*H,m=X*e,D=M*H,V=M*e;w[0]=o+V*u,w[4]=D*u-m,w[8]=b*M,w[1]=b*e,w[5]=b*H,w[9]=-u,w[2]=m*u-D,w[6]=V+o*u,w[10]=b*X}else if("ZXY"===Y){var o=X*H,m=X*e,D=M*H,V=M*e;w[0]=o-V*u,w[4]=-b*e,w[8]=D+m*u,w[1]=m+D*u,w[5]=b*H,w[9]=V-o*u,w[2]=-b*M,w[6]=u,w[10]=b*X}else if("ZYX"===Y){var z=b*H,x=b*e,K=u*H,N=u*e;w[0]=X*H,w[4]=K*M-x,w[8]=z*M+N,w[1]=X*e,w[5]=N*M+z,w[9]=x*M-K,w[2]=-M,w[6]=u*X,w[10]=b*X}else if("YZX"===Y){var t=b*X,v=b*M,U=u*X,y=u*M;w[0]=X*H,w[4]=y-t*e,w[8]=U*e+v,w[1]=e,w[5]=b*H,w[9]=-u*H,w[2]=-M*H,w[6]=v*e+U,w[10]=t-y*e}else if("XZY"===Y){var t=b*X,v=b*M,U=u*X,y=u*M;w[0]=X*H,w[4]=-e,w[8]=M*H,w[1]=t*e+y,w[5]=b*H,w[9]=v*e-U,w[2]=U*e-v,w[6]=u*H,w[10]=y*e+t}return w[3]=0,w[7]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,this},makeRotationFromQuaternion:function(D){var Z=this.el,P=D._x,n=D._y,p=D._z,b=D._w,O=P+P,H=n+n,I=p+p,v=P*O,x=P*H,N=P*I,W=n*H,E=n*I,G=p*I,B=b*O,j=b*H,f=b*I;return Z[0]=1-(W+G),Z[4]=x-f,Z[8]=N+j,Z[1]=x+f,Z[5]=1-(v+G),Z[9]=E-B,Z[2]=N-j,Z[6]=E+B,Z[10]=1-(v+W),Z[3]=0,Z[7]=0,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(L){var O=this.el,m=L.el,k=m[0],U=m[1],F=m[2],Y=m[3],a=m[4],n=m[5],S=m[6],s=m[7],P=m[8],x=m[9],$=m[10],J=m[11],o=m[12],r=m[13],X=m[14],g=m[15],d=x*X*s-r*$*s+r*S*J-n*X*J-x*S*g+n*$*g,G=o*$*s-P*X*s-o*S*J+a*X*J+P*S*g-a*$*g,E=P*r*s-o*x*s+o*n*J-a*r*J-P*n*g+a*x*g,Q=o*x*S-P*r*S-o*n*$+a*r*$+P*n*X-a*x*X,w=k*d+U*G+F*E+Y*Q;if(0===w)return this.identity();var A=1/w;return O[0]=d*A,O[1]=(r*$*Y-x*X*Y-r*F*J+U*X*J+x*F*g-U*$*g)*A,O[2]=(n*X*Y-r*S*Y+r*F*s-U*X*s-n*F*g+U*S*g)*A,O[3]=(x*S*Y-n*$*Y-x*F*s+U*$*s+n*F*J-U*S*J)*A,O[4]=G*A,O[5]=(P*X*Y-o*$*Y+o*F*J-k*X*J-P*F*g+k*$*g)*A,O[6]=(o*S*Y-a*X*Y-o*F*s+k*X*s+a*F*g-k*S*g)*A,O[7]=(a*$*Y-P*S*Y+P*F*s-k*$*s-a*F*J+k*S*J)*A,O[8]=E*A,O[9]=(o*x*Y-P*r*Y-o*U*J+k*r*J+P*U*g-k*x*g)*A,O[10]=(a*r*Y-o*n*Y+o*U*s-k*r*s-a*U*g+k*n*g)*A,O[11]=(P*n*Y-a*x*Y-P*U*s+k*x*s+a*U*J-k*n*J)*A,O[12]=Q*A,O[13]=(P*r*F-o*x*F+o*U*$-k*r*$-P*U*X+k*x*X)*A,O[14]=(o*n*F-a*r*F-o*U*S+k*r*S+a*U*X-k*n*X)*A,O[15]=(a*x*F-P*n*F+P*U*S-k*x*S-a*U*$+k*n*$)*A,this},makeRotationAxis:function(F,G){var K=Math.cos(G),X=Math.sin(G),n=1-K,B=F.x,e=F.y,l=F.z,P=n*B,S=n*e;return this.set(P*B+K,P*e-X*l,P*l+X*e,0,P*e+X*l,S*e+K,S*l-X*B,0,P*l-X*e,S*l+X*B,n*l*l+K,0,0,0,0,1),this},multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(x){return this.multiplyMatrices(x,this)},multiplyMatrices:function(s,k){var U=s.el,F=k.el,l=this.el,Z=U[0],X=U[4],y=U[8],H=U[12],K=U[1],m=U[5],t=U[9],v=U[13],_=U[2],W=U[6],f=U[10],p=U[14],x=U[3],V=U[7],M=U[11],O=U[15],B=F[0],P=F[4],Y=F[8],A=F[12],g=F[1],N=F[5],u=F[9],E=F[13],S=F[2],d=F[6],Q=F[10],a=F[14],L=F[3],j=F[7],e=F[11],h=F[15];return l[0]=Z*B+X*g+y*S+H*L,l[4]=Z*P+X*N+y*d+H*j,l[8]=Z*Y+X*u+y*Q+H*e,l[12]=Z*A+X*E+y*a+H*h,l[1]=K*B+m*g+t*S+v*L,l[5]=K*P+m*N+t*d+v*j,l[9]=K*Y+m*u+t*Q+v*e,l[13]=K*A+m*E+t*a+v*h,l[2]=_*B+W*g+f*S+p*L,l[6]=_*P+W*N+f*d+p*j,l[10]=_*Y+W*u+f*Q+p*e,l[14]=_*A+W*E+f*a+p*h,l[3]=x*B+V*g+M*S+O*L,l[7]=x*P+V*N+M*d+O*j,l[11]=x*Y+V*u+M*Q+O*e,l[15]=x*A+V*E+M*a+O*h,this},lookAt:function(){var i=new Or;return function(Y,D,O){return i.subVectors(Y,D),this.lookAtDirection(i,O)}}(),lookAtDirection:function(){var $=new Or,t=new Or,l=new Or;return function(o,S){S||(S=Or.UP);var b=this.el;return l.copy(o),0===l.lengthSq()&&(l.z=1),l.normalize(),$.crossVectors(S,l),0===$.lengthSq()&&(1===Math.abs(S.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),$.crossVectors(S,l)),$.normalize(),t.crossVectors(l,$),b[0]=$.x,b[4]=t.x,b[8]=l.x,b[1]=$.y,b[5]=t.y,b[9]=l.y,b[2]=$.z,b[6]=t.z,b[10]=l.z,this}}(),extractScale:function(){var d;return function(a){d===B&&(d=new Or),a===B&&(a=new Or);var q=d.setFromMatrixColumn(this,0).length(),r=d.setFromMatrixColumn(this,1).length(),Z=d.setFromMatrixColumn(this,2).length();return a.set(q,r,Z),a}}(),extractRotation:function(){var u;return function(r){u===B&&(u=new Or),r===B&&(r=new vr);var Q=this.el,S=r.el,y=1/u.setFromMatrixColumn(r,0).length(),v=1/u.setFromMatrixColumn(r,1).length(),X=1/u.setFromMatrixColumn(r,2).length();return Q[0]=S[0]*y,Q[1]=S[1]*y,Q[2]=S[2]*y,Q[4]=S[4]*v,Q[5]=S[5]*v,Q[6]=S[6]*v,Q[8]=S[8]*X,Q[9]=S[9]*X,Q[10]=S[10]*X,this}}(),multiplyScalar:function(e){var h=this.el;return h[0]*=e,h[4]*=e,h[8]*=e,h[12]*=e,h[1]*=e,h[5]*=e,h[9]*=e,h[13]*=e,h[2]*=e,h[6]*=e,h[10]*=e,h[14]*=e,h[3]*=e,h[7]*=e,h[11]*=e,h[15]*=e,this},getPosition:function(z){return z===B&&(z=new Or),z.setFromMatrixColumn(this,3)},setPosition:function($){var m=this.el;return m[12]=$.x,m[13]=$.y,m[14]=$.z,this},toArray:function(u,d){u===B&&(u=[]),d===B&&(d=0);var k=this.el;return u[d]=k[0],u[d+1]=k[1],u[d+2]=k[2],u[d+3]=k[3],u[d+4]=k[4],u[d+5]=k[5],u[d+6]=k[6],u[d+7]=k[7],u[d+8]=k[8],u[d+9]=k[9],u[d+10]=k[10],u[d+11]=k[11],u[d+12]=k[12],u[d+13]=k[13],u[d+14]=k[14],u[d+15]=k[15],u},determinant:function(){var e=this.el,w=e[0],Q=e[4],h=e[8],S=e[12],W=e[1],D=e[5],r=e[9],C=e[13],b=e[2],R=e[6],a=e[10],y=e[14],s=e[3],o=e[7],P=e[11],d=e[15];return s*(+S*r*R-h*C*R-S*D*a+Q*C*a+h*D*y-Q*r*y)+o*(+w*r*y-w*C*a+S*W*a-h*W*y+h*C*b-S*r*b)+P*(+w*C*R-w*D*y-S*W*R+Q*W*y+S*D*b-Q*C*b)+d*(-h*D*b-w*r*R+w*D*a+h*W*R-Q*W*a+Q*r*b)},copy:function(M){var w=this.el,y=M.el;return w[0]=y[0],w[1]=y[1],w[2]=y[2],w[3]=y[3],w[4]=y[4],w[5]=y[5],w[6]=y[6],w[7]=y[7],w[8]=y[8],w[9]=y[9],w[10]=y[10],w[11]=y[11],w[12]=y[12],w[13]=y[13],w[14]=y[14],w[15]=y[15],this
},compose:function(w,D,T){var n=this.el,J=D._x,S=D._y,q=D._z,t=D._w,r=J+J,A=S+S,E=q+q,L=J*r,m=J*A,y=J*E,F=S*A,u=S*E,U=q*E,l=t*r,v=t*A,M=t*E,V=T.x,G=T.y,x=T.z;return n[0]=(1-(F+U))*V,n[1]=(m+M)*V,n[2]=(y-v)*V,n[3]=0,n[4]=(m-M)*G,n[5]=(1-(L+U))*G,n[6]=(u+l)*G,n[7]=0,n[8]=(y+v)*x,n[9]=(u-l)*x,n[10]=(1-(L+F))*x,n[11]=0,n[12]=w.x,n[13]=w.y,n[14]=w.z,n[15]=1,this},decompose:function(){var _=new Or,c=new vr;return function(o,l,m){var Z=this.el,R=_.set(Z[0],Z[1],Z[2]).length(),O=_.set(Z[4],Z[5],Z[6]).length(),e=_.set(Z[8],Z[9],Z[10]).length(),d=this.determinant();0>d&&(R=-R),o.x=Z[12],o.y=Z[13],o.z=Z[14],c.copy(this);var W=1/R,q=1/O,G=1/e;return c.el[0]*=W,c.el[1]*=W,c.el[2]*=W,c.el[4]*=q,c.el[5]*=q,c.el[6]*=q,c.el[8]*=G,c.el[9]*=G,c.el[10]*=G,l.setFromRotationMatrix(c),m.x=R,m.y=O,m.z=e,this}}()});var We=_.Math.Triangle=function(d,z,Q){this.a=d!==B?d:new Or,this.b=z!==B?z:new Or,this.c=Q!==B?Q:new Or};S.assign(We,{barycoordFromPoint:function(){var l=new Or,g=new Or,X=new Or;return function(B,u,o,b,I){l.subVectors(b,u),g.subVectors(o,u),X.subVectors(B,u);var M=l.dot(l),r=l.dot(g),y=l.dot(X),E=g.dot(g),t=g.dot(X),v=M*E-r*r,R=I||new Or;if(0===v)return R.set(-2,-1,-1);var Q=1/v,d=(E*y-r*t)*Q,K=(M*t-r*y)*Q;return R.set(1-d-K,K,d)}}(),uvIntersection:function(){var p=new Or;return function(e,c,Q,P,h,r,k){return We.barycoordFromPoint(e,c,Q,P,p),h.multiplyScalar(p.x),r.multiplyScalar(p.y),k.multiplyScalar(p.z),h.add(r).add(k),h.clone()}}()});var hs=_.Math.Euler=function(Z,Q,T,v,g){this.set(Z,Q,T,v,g)};hs.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],hs.DefaultOrder="XYZ",hs.ReverseOrder=function(){var Y={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(O){return Y[O]}}(),S.defineProperties(hs.prototype,{x:{get:function(){return this._x},set:function(I){this._x=I,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(O){this._y=O,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Y){this._z=Y,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(b){this._order=b,this.onChangeCallback()}}}),S.assign(hs.prototype,{set:function(f,q,C,A,t){return Jm(f)&&(t=C,A=q,C=f[2],q=f[1],f=f[0]),A?t&&(A=hs.ReverseOrder(A)):A="ZYX",this._x=f||0,this._y=q||0,this._z=C||0,this._order=A||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(X){return this._x=X._x,this._y=X._y,this._z=X._z,this._order=X._order,this.onChangeCallback(),this},setFromRotationMatrix:function(H,C,f){var Z=_.Math.clamp,p=H.el||H,c=p[0],a=p[4],I=p[8],j=p[1],J=p[5],i=p[9],z=p[2],m=p[6],A=p[10];return C=C||this._order,"XYZ"===C?(this._y=Math.asin(Z(I,-1,1)),Math.abs(I)<.99999?(this._x=Math.atan2(-i,A),this._z=Math.atan2(-a,c)):(this._x=Math.atan2(m,J),this._z=0)):"YXZ"===C?(this._x=Math.asin(-Z(i,-1,1)),Math.abs(i)<.99999?(this._y=Math.atan2(I,A),this._z=Math.atan2(j,J)):(this._y=Math.atan2(-z,c),this._z=0)):"ZXY"===C?(this._x=Math.asin(Z(m,-1,1)),Math.abs(m)<.99999?(this._y=Math.atan2(-z,A),this._z=Math.atan2(-a,J)):(this._y=0,this._z=Math.atan2(j,c))):"ZYX"===C?(this._y=Math.asin(-Z(z,-1,1)),Math.abs(z)<.99999?(this._x=Math.atan2(m,A),this._z=Math.atan2(j,c)):(this._x=0,this._z=Math.atan2(-a,J))):"YZX"===C?(this._z=Math.asin(Z(j,-1,1)),Math.abs(j)<.99999?(this._x=Math.atan2(-i,J),this._y=Math.atan2(-z,c)):(this._x=0,this._y=Math.atan2(I,A))):"XZY"===C?(this._z=Math.asin(-Z(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(m,J),this._y=Math.atan2(I,c)):(this._x=Math.atan2(-i,A),this._y=0)):console.warn("unsupported order: "+C),this._order=C,f!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var j=new vr;return function(z,Z,Q){return j.makeRotationFromQuaternion(z),this.setFromRotationMatrix(j,Z,Q)}}(),setFromVector3:function(j,t){return this.set(j.x,j.y,j.z,t||this._order)},reorder:function(){var Y=new eo;return function(X){return Y.setFromEuler(this),this.setFromQuaternion(Y,X)}}(),equals:function(M){return M._x===this._x&&M._y===this._y&&M._z===this._z&&M._order===this._order},fromArray:function(Q){return this._x=Q[0],this._y=Q[1],this._z=Q[2],Q[3]!==B&&(this._order=Q[3]),this.onChangeCallback(),this},toArray:function(Q,m){return Q===B&&(Q=[]),m===B&&(m=0),Q[m]=this._x,Q[m+1]=this._y,Q[m+2]=this._z,Q[m+3]=this._order,Q},toVector3:function(w){return w?w.set(this._x,this._y,this._z):new Or(this._x,this._y,this._z)},onChange:function(f){return this.onChangeCallback=f,this},onChangeCallback:function(){}});var Yh={ms_ac:function(i,D){for(var a=D.ms_ac,C=0;C<a.length;C++)Qg(i,a[C])},ms_listener:function(P){P.addListeners=function(){var O=this,C=$m;m.mockTouch&&(C=xh.concat(Xg).concat(Hm)),O.__events__=C;for(var a=0,c=C.length;c>a;a++){var J=C[a];"wheel"===J&&!O.handle_wheel&&O.handle_mousewheel&&(O.handle_wheel=function(w){Nn(O,w)}),O["handle_"+J]&&Uh(J,O.getView(),O)}},P.removeListeners=function(){var k=this,s=k.__events__;if(s){k.__events__=B;for(var K=0,N=s.length;N>K;K++)k["handle_"+s[K]]&&$i(s[K],k.getView(),k)}}},ms_fire:function(J){J.mp=function(_,C,A){this.addPropertyChangeListener(_,C,A)},J.ump=function(F,X){this.removePropertyChangeListener(F,X)},J.fp=function(H,u,J,l,c){return this.firePropertyChange(H,u,J,l,c)},J.addPropertyChangeListener=function(V,B,w){var a=this;a._62I||(a._62I=new Ji),a._62I.add(V,B,w)},J.removePropertyChangeListener=function(Y,g){this._62I&&this._62I.remove(Y,g)},J.firePropertyChange=function($,k,C,I,F){if(I){if(I(k,C))return!1}else if(k===C)return!1;var b=this,T=F||{};return T.property=$,T.oldValue=k,T.newValue=C,T.source=b,T.data=b,b._62I&&b._62I.fire(T),b.onPropertyChanged&&b.onPropertyChanged(T),!0}},ms_attr:function(n){n.a=function(M,l){var h=this;if(2===arguments.length)h.setAttr(M,l);else{if(!Th(M))return h.getAttr(M);for(var b in M)h.setAttr(b,M[b])}return h},n.getAttr=function(x,R){if(R===B&&(R=1),this._attrObject&&x in this._attrObject)return this._attrObject[x];if(this.getImage){var F=this.getImage();if(hq(F)&&(F=Rb[F]),Th(F)&&"dataBindings"in F)for(var m=F.dataBindings,C=m.length-1;C>=0;C--){var e=m[C];if(e.attr===x){if("defaultValue"in e)return e.defaultValue;break}}}return R?M[x]:B},n.setAttr=function(Y,T){var z=this;z._attrObject||(z._attrObject={});var Z=z._attrObject[Y];T===B?delete z._attrObject[Y]:z._attrObject[Y]=T,z.fp&&z.fp("a:"+Y,Z,T)&&z.onAttrChanged&&z.onAttrChanged(Y,Z,T)},n.getSerializableAttrs=function(){var L,N={};for(L in this._attrObject)N[L]=1;return N}},ms_bnb:function(G){G.getBodyColor=function(N){return N.s("body.color")},G.getBorderColor=function(l){return l.s("border.color")}},_51o:function(k){k.mi=function(I,Z,R){this.addInteractorListener(I,Z,R)},k.umi=function(d,r){this.removeInteractorListener(d,r)},k.fi=function(Q){this.fireInteractorEvent(Q)},k.addInteractorListener=function(V,z,W){var H=this;H._63I||(H._63I=new Ji),H._63I.add(V,z,W)},k.removeInteractorListener=function(N,E){this._63I&&this._63I.remove(N,E)},k.fireInteractorEvent=function(c){this._63I&&this._63I.fire(c)},k.setInteractors=function(K){var U=this,p=U._interactors;p&&p.each(function(S){S.tearDown()}),Jm(K)&&(K=new An(K)),U._interactors=K,K&&K.each(function(m){m.setUp()}),U.fp("interactors",p,K),U.invalidateSelection()},k.getInteractors=function(){return this._interactors}},_49o:function(N){N._44O=z,N._45O=z,N.getTopPainters=function(){return this._44O},N.getBottomPainters=function(){return this._45O},N.addTopPainter=function(P){var E=this;E._44O||(E._44O=new An),E._44O.contains(P)||(E._44O.add(P),E.redraw&&E.redraw())},N.removeTopPainter=function(k){var c=this;c._44O&&(c._44O.remove(k),c.redraw&&c.redraw())},N.addBottomPainter=function(h){var J=this;J._45O||(J._45O=new An),J._45O.contains(h)||(J._45O.add(h),J.redraw&&J.redraw())},N.removeBottomPainter=function(c){var P=this;P._45O&&(P._45O.remove(c),P.redraw&&P.redraw())},N._93db=function(m,t){var V=this;V._45O&&V._45O.each(function(i){i.draw?i.draw(m,t):i.call(V,m,t)})},N._92db=function(Z,u){var S=this;S._44O&&S._44O.each(function(T){T.draw?T.draw(Z,u):T.call(S,Z,u)})}},ms_sm:function(y){y.sm=function(){return this.getSelectionModel()},y.setSelectableFunc=function(w){this.sm().setFilterFunc(w)},y.getSelectableFunc=function(){return this.sm().getFilterFunc()},y.getSelectionModel=function(){var M=this;return M._selectionModel?M._selectionModel:M.dm().sm()},y.isSelectionModelShared=function(){return!this._selectionModel},y.setSelectionModelShared=function(G){var U=this,H=U.sm(),s=!U._selectionModel,M=U.handleSelectionChange,Z=U.dm();s!==G&&(U.invalidateSelection&&U.invalidateSelection(),G?(Z.sm().ms(M,U),U._selectionModel.ums(M,U),U._selectionModel.dispose(),U._selectionModel=z):(Z.sm().ums(M,U),U._selectionModel=new qh(Z),U._selectionModel.ms(M,U)),U.onSelectionModelSharedChanged(),U.fp("selectionModelShared",s,G),U.fireViewEvent({kind:"selectionModelSharedChange",oldValue:s,newValue:G,oldSelectionModel:H,newSelectionModel:U.sm()}))},y.onSelectionModelSharedChanged=function(){var r=this;r.redraw(),r.invalidateSelection&&r.invalidateSelection()},y.removeSelection=function(){var N=this.dm();N.beginTransaction(),this.sm().toSelection().each(N.remove,N),N.endTransaction()},y.selectAll=function(){var t=this;t.sm().ss(t.dm().toDatas(function(z){return t.isVisible(z)&&t.isSelectable(z)}))},y.isSelected=function(N){return this.sm().co(N)},y.isSelectedById=function(X){var j=this.dm().getDataById(X);return j?this.isSelected(j):!1},y.isSelectable=function(F){return this.sm().isSelectable(F)}},ms_tx:function(J){J._64I=0,J._65O=0,J.isScrollable=function(){return this.getWidth()<this._64I},J._40o=function(){return this.isScrollable()},J.getLogicalPoint=function(T){return Xi(T,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},J.tx=function(V){return V===B?this.getTranslateX():(this.setTranslateX(V),void 0)},J.getTranslateX=function(){return this._65O},J.setTranslateX=function(e){var G=this,A=G.getWidth()-G._64I;A>e&&(e=A),e>0&&(e=0),e=w(e);var h=G._65O;G._65O=e,G.fp(Kr,h,e)}},ms_ty:function(r){r._23Q=0,r._66O=0,r._41o=function(){return this.getHeight()<this._23Q},r.getLogicalPoint=function(U){return Xi(U,this._canvas||this._view,this.tx?this.tx():0,this.ty())},r.ty=function(d){return d===B?this.getTranslateY():(this.setTranslateY(d),void 0)},r.getTranslateY=function(){return this._66O},r.setTranslateY=function(o){var d=this,r=d.getHeight()-d._23Q;r>o&&(o=r),o>0&&(o=0),o=w(o);var b=d._66O;d._66O=o,d.fp(Kc,b,o)}},ms_txy:function($){$._65O=0,$._66O=0,$.tx=function(f){return f===B?this.getTranslateX():(this.setTranslateX(f),void 0)},$.ty=function(H){return H===B?this.getTranslateY():(this.setTranslateY(H),void 0)},$.onTranslateEnded=function(){},$.setTranslate=function(l,S,F){var x=this;if(F=vi(F)){x._65I&&x._65I.stop(!0);var e=x.tx(),$=x.ty();F.action=function(h){x.setTranslate(e+(l-e)*h,$+(S-$)*h)},F._37o=function(){delete x._66I,delete x._65I,x.onTranslateEnded()},x._66I=1,x._65I=om(F)}else x.tx(l),x.ty(S)},$.getTranslateX=function(){return this._65O},$.setTranslateX=function(K){var D=this;K=D.adjustTranslateX(K);var G=D._65O;D._65O=K,D.fp(Kr,G,K)},$.getTranslateY=function(){return this._66O},$.setTranslateY=function(Q){var g=this;Q=g.adjustTranslateY(Q);var P=g._66O;g._66O=Q,g.fp(Kc,P,Q)},$.adjustTranslateX=function(L){return w(L)},$.adjustTranslateY=function(v){return w(v)},$.translate=function(X,J,D){this.setTranslate(this.tx()+X,this.ty()+J,D)},$.getLogicalPoint=function(q){var n=this;return Xi(q,this._canvas||n._view,n.tx(),n.ty())}},ms_dm:function($){$.dm=function(U){return U?(this.setDataModel(U),void 0):this.getDataModel()},$.getDataModel=function(){return this._dataModel}},ms_lp:function(B){B.lp=function(F){return this.getLogicalPoint(F)}},ms_v:function(E){E._disabled=!1,E.setDisabled=function(i,s){var c=this,t=c._disabled;t!==i&&(t&&(zr(c._63O),delete c._63O),i&&(as(c._view,c._63O=ts(s)),c.iv()),c._disabled=i,c.fp("disabled",t,i))},E.isDisabled=function(){return this._disabled},E.getDisabledDiv=function(){return this._63O},E.getView=function(){return this._view},E.addToDOM=function(D){var N=this,b=N.getView(),Y=b.style;D=D||T.body,D.appendChild(b),Y.left="0",Y.right="0",Y.top="0",Y.bottom="0",C(d,"resize",function(){N.iv()}),N.iv()},E.setCursor=function(N){"default"===N&&(N=this._defaultCursor||N);var V=this.getView().style;V.cursor=N,V.cursor="-webkit-"+N,V.cursor="-moz-"+N},E.getWidth=function(){return this._view.clientWidth},E.getHeight=function(){return this._view.clientHeight},E.setWidth=function($){var M=this;M._view.style.width=$+Eq,M.iv(),M.fp&&M.fp(yb,z,$)},E.setHeight=function(B){var f=this;f._view.style.height=B+Eq,f.iv(),f.fp&&f.fp(bg,z,B)},E.setFocus=function(l){var u=this,U=u._currentEditor;return l&&U&&(U.getView&&(U=U.getView()),U.contains(l.target))?!1:(pk(u._view),u.endEditing&&u.endEditing(),u.fireViewEvent("focus"),!0)},E.iv=function(G){this.invalidate(G)},E.invalidate=function(J){var Q=this;Q._68I||(Q._68I=1,sg(Q.validate,Q,z,J),Q.onInvalidated&&Q.onInvalidated(),Q.fireViewEvent("invalidate"))},E.validate=function(){var A=this,N=A._view;if(A._68I&&(delete A._68I,N.parentNode))if(0===N.offsetWidth&&0===N.offsetHeight&&A._67I!==z)A._67I===B&&(A._67I=m.reinvalidateCount),A._67I>0?A._67I--:A._67I=z,A.iv();else{A.fireViewEvent("beginValidate"),A.validateImpl(),A.onValidated&&A.onValidated(),A.fireViewEvent("validate");var V=A._63O;V&&(N.lastChild!==V&&(zr(V),as(N,V)),fs(V,0,0,A.getWidth(),A.getHeight())),yk(A),Dc(A),pb(A)}},E.layout=function(_,J,z,e){1===arguments.length?fs(this,_):fs(this,_,J,z,e)},E.addViewListener=function(H,O,F){var Y=this;Y._67O||(Y._67O=new Ji),Y._67O.add(H,O,F)},E.removeViewListener=function(W,j){this._67O.remove(W,j)},E.fireViewEvent=function(N){var p=this;p._67O&&(hq(N)&&(N={kind:N}),p._67O.fire(N)),m.viewListener&&m.viewListener(p,N)}},ms_tip:function(_){_.setToolTipEnabled=function(j){var N=this;j?Xl||N._13o||(N.enableToolTip(),N.fp("toolTipEnabled",!1,!0)):N._13o&&(N.disableToolTip(),N.fp("toolTipEnabled",!0,!1))},_.isToolTipEnabled=function(){return!!this._13o},_.enableToolTip=function(){var K=this;if(!Xl&&!K._13o){K._13o=function(Q){if(!Q.toolTipView){Q.toolTipView=K;var w=K.getToolTip(Q);w!=z?(m.toolTipContinual&&m.isToolTipShowing()?Zb(Q,w):(yd(),on={timeout:Vr(Oq,Bi),e:Q,info:w}),Dj={e:Q,view:K}):yd()}};var R=K.getView();C(R,ph,K._13o),C(R,"mouseleave",m.hideToolTip)}},_.disableToolTip=function(){var $=this;if($._13o){var c=$.getView();v(c,ph,$._13o),v(c,"mouseleave",m.hideToolTip),delete $._13o}},_.getToolTip=function(C){var m=this;if(m.getDataAt){var j=m.getDataAt(C);return j?j.getToolTip():z}return m.getValue?m.getValue():void 0}},_52o:function(S){S._zoom=1,S._29I=ac,S.zoomIn=function(v,p){this.setZoom(this._zoom*rf,v,p)},S.zoomOut=function(R,V){this.setZoom(this._zoom/rf,R,V)},S.zoomReset=function(Y,v){this.setZoom(1,Y,v)},S.scrollZoomIn=function(N){this.setZoom(this._zoom*vh,z,N)},S.scrollZoomOut=function(l){this.setZoom(this._zoom/vh,z,l)},S.pinchZoomIn=function(v){this.setZoom(this._zoom*Sf,z,v)},S.pinchZoomOut=function(n){this.setZoom(this._zoom/Sf,z,n)},S.adjustZoom=function(U){return ag>U?ag:U>ie?ie:U},S.getZoom=function(){return this._zoom},S.setZoom=function(b,B,F){var h=this;if(B=vi(B)){h._14o&&h._14o.stop(!0);var n=h._zoom;B.action=function(P){h._96O(n+(b-n)*P,F)},B._37o=function(){delete h._zooming,delete h._14o,h.onZoomEnded()},h._zooming=1,h._14o=om(B)}else h._96O(b,F)},S._96O=function(V,e){var E=this;if(V=E.adjustZoom(V),V!==E._zoom){E.validate();var N=E._29I,$=E._zoom;0!==N.width&&0!==N.height&&(e=e?e:{x:N.x+N.width/2,y:N.y+N.height/2},E.tx((e.x-N.x)*$-e.x*V),E.ty((e.y-N.y)*$-e.y*V)),E._zoom=V,E.fp("zoom",$,V)}}},ms_edge:function(m){m._2I=function(x){var Z=this;Z._44I||(Z._44I=new An),Z._42I||(Z._42I=new An),Z._44I.add(x),Z._42I.add(x),Z._20I()},m._4I=function(b){var K=this;K._44I||(K._44I=new An),K._43I||(K._43I=new An),K._44I.add(b),K._43I.add(b),K._20I()},m._16I=function($){var r=this;r._44I.remove($),r._42I.remove($),r._44I.isEmpty()&&delete r._44I,r._42I.isEmpty()&&delete r._42I,r._20I()},m._18I=function(y){var z=this;z._44I.remove(y),z._43I.remove(y),z._44I.isEmpty()&&delete z._44I,z._43I.isEmpty()&&delete z._43I,z._20I()},m._20I=function(){var V=this;if(delete V._45I,!V._44I||V._44I.isEmpty())return delete V._70O,void 0;var b;V._44I.each(function(i){i.isLooped()&&(b||(b={}),b[i._id]||(V._45I||(V._45I=new An),V._45I.add(i),b[i._id]=i))}),b?(V._70O=new An,V._44I.each(function(P){b[P._id]?"A"===b[P._id]||(b[P._id]="A",V._70O.add(P)):V._70O.add(P)})):V._70O=V._44I},m.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},m.getSourceAgentEdges=function(){return this._46I},m.getTargetAgentEdges=function(){return this._47I},m._1I=function(o){var K=this;K._46I||(K._46I=new An),K._48I||(K._48I=new An),K._46I.add(o),K._48I.add(o),K._19I()},m._3I=function(V){var s=this;s._47I||(s._47I=new An),s._48I||(s._48I=new An),s._47I.add(V),s._48I.add(V),s._19I()},m._15I=function(u){var p=this;p._46I.remove(u),p._48I.remove(u),p._46I.isEmpty()&&delete p._46I,p._48I.isEmpty()&&delete p._48I,p._19I()},m._17I=function(d){var R=this;R._47I.remove(d),R._48I.remove(d),R._47I.isEmpty()&&delete R._47I,R._48I.isEmpty()&&delete R._48I,R._19I()},m._19I=function(){var s=this;delete s._49I;var W=s._48I;if(W&&!W.isEmpty()){var C={};W.each(function(B){C[B._id]?s._49I||(s._49I=new An):C[B._id]=B}),s._49I?W.each(function(f){C[f._id]&&(s._49I.add(f),delete C[f._id])}):s._49I=W}},m.getLoopedEdges=function(){return this._45I},m.getEdges=function(){return this._70O},m.getAgentEdges=function(){return this._49I},m.getSourceEdges=function(){return this._42I},m.getTargetEdges=function(){return this._43I},m._8I=function(){this._70O&&this._70O.each(function(x){x._7I()})}}};Lp(m,{getVersion:function(){return"7.2.8-dev11"}},!0);var en=function(p){return p.devicePixelRatio?p.devicePixelRatio:p.screen&&p.screen.logicalXDPI?p.screen.deviceXDPI/p.screen.logicalXDPI:1};Lp(m,{numberDigits:5,crossOrigin:"",baseZIndex:B,isTouchable:Xl,mockTouch:!0,devicePixelRatio:en(d),reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:g.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,extractPolylineTranslation:!1,extractVerticesTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return es},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(v){return v*v},labelColor:Pb,labelSelectColor:fr,labelFont:"12px arial, sans-serif",widgetIndent:Xl?30:20,widgetRowHeight:Xl?30:20,widgetHeaderHeight:Xl?32:22,widgetTitleHeight:Xl?34:24,scrollBarColor:an,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Xl?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:xg,intersectionLineLine:Zk,isEnter:Ud,isEsc:Vq,isDelete:xi,isSpace:sc,isLeft:kr,isUp:jc,isRight:Zg,isDown:Cg,isTouchEvent:wg,getTarget:Aq,isString:hq,isNumber:Aj,isBoolean:Zn,isArray:Jm,isSelectAll:jq,isFunction:Qr,isObject:Th,getPropertyValue:Zh,setPropertyValue:Ij,addMethod:Lp,createGradient:function(a,I,m,H,V,D,F,O){var x=ui[I];return x(a,m,H,V,D,F,O)},appendToScreen:function(Y){Y=Y.getView?Y.getView():Y,(T.fullscreenElement||T.mozFullScreenElement||T.webkitFullscreenElement||T.msFullscreenElement||T.body).appendChild(Y)},encodeString:function(f){return _.Math.encodeBase64(f,m.encodeStringKey)},decodeString:function(I){return _.Math.decodeBase64(I,m.encodeStringKey)},findView:function(q){var B=function(e,L){var P=L._ht;P&&e.push(P);var U=L.children,h=U.length;if(h)for(var a=0;h>a;a++)B(e,U[a])},Z=[];B(Z,T.body);var y=function(c,o){for(var b="2d"===o?xo.GraphView:ae.Graph3dView,Q=0,j=c.length;j>Q;Q++)if(c[Q]instanceof b)return Z[Q];return null};return"all"===q?Z:"2d"===q?y(Z,"2d"):"3d"===q?y(Z,"3d"):y(Z,"3d")||y(Z,"2d")},toggleFullscreen:function(s){var r=s.getView();if(T.fullscreenElement||T.mozFullScreenElement||T.webkitFullscreenElement||T.msFullscreenElement)T.exitFullscreen?T.exitFullscreen():T.msExitFullscreen?T.msExitFullscreen():T.mozCancelFullScreen?T.mozCancelFullScreen():T.webkitExitFullscreen&&T.webkitExitFullscreen();else{var w=!0;if(s.isSelfViewEvent){var f=s.getX(),E=s.getY(),V=s.getWidth(),j=s.getHeight(),P=r.style.background,S=r.style.backgroundColor;P||S||(r.style.backgroundColor="white"),r.requestFullscreen?r.requestFullscreen():r.msRequestFullscreen?r.msRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen();var Q=setInterval(function(){if(r!==(T.fullscreenElement||T.mozFullScreenElement||T.webkitFullscreenElement||T.msFullscreenElement))clearInterval(Q),s.setX(f),s.setY(E),s.setWidth(V),s.setHeight(j),s._fullscreen=!1,r.style.oldBackgroundColor=S,s.iv();else{var L=_.Default.getWindowInfo();(w||L.width!==s.getWidth()||L.height!==s.getHeight())&&(s.setX(L.left),s.setY(L.top),s.setWidth(L.width),s.setHeight(L.height),s._fullscreen=!0,s.iv(),w=!1)}},500)}else{var m=r.style.left,$=r.style.top,V=r.style.width,j=r.style.height,P=r.style.background,S=r.style.backgroundColor;P||S||(r.style.backgroundColor="white"),r.requestFullscreen?r.requestFullscreen():r.msRequestFullscreen?r.msRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen();var Q=setInterval(function(){if(r!==(T.fullscreenElement||T.mozFullScreenElement||T.webkitFullscreenElement||T.msFullscreenElement))clearInterval(Q),r.style.left=m,r.style.top=$,r.style.width=V,r.style.height=j,r.style.oldBackgroundColor=S,s.iv();else{var F=_.Default.getWindowInfo();(w||F.width!==s.getWidth()||F.height!==s.getHeight())&&(fs(s),w=!1)}},500)}}},appendTimeStamp:function(e){return e},setCompType:function(n,k){hq(k)&&k.substr(0,12)==Pm&&(k=m.parse(k)),Qr(k)||Th(k)?Ib[n]=k:Ph(n)},getCompType:function(d){var x=Ib[d];return x===B&&bp.test(d)&&Ph(d),x},getCompTypeMap:function(){return Ib},drawCompType:function(L,Y,a,G,y,K){L(Y,a,G,y,K)},numberListener:function(){var h={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(R){var o=R.keyCode;h[o]||65===o&&m.isCtrlDown(R)||86===o&&m.isCtrlDown(R)||67===o&&m.isCtrlDown(R)||88===o&&m.isCtrlDown(R)||o>=35&&40>=o||(R.shiftKey||48>o||o>57)&&(96>o||o>105)&&R.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(B){var a=B.target.tagName;("DIV"===a||"CANVAS"===a)&&!(m.ignoreKeyCodes.indexOf(B.keyCode)>=0)&&("keydown"!==B.type||kr(B)||Zg(B)||jc(B)||Cg(B)||xi(B)||65===B.keyCode&&(B.metaKey||B.ctrlKey))&&B.cancelable===!0&&(B.preventDefault(),B.preventManipulation&&B.preventManipulation())},getWindowInfo:function(){var p=T.documentElement,L=p&&(p.scrollLeft||p.scrollTop)?p:T.body;return{target:L,left:L.scrollLeft,top:L.scrollTop,width:d.innerWidth||L.clientWidth,height:d.innerHeight||L.clientHeight}},isDragging:function(){return!!es},isLeftButton:function(p){return wg(p)?!0:0===p.button},isMiddleButton:function(G){return wg(G)?!1:G&&(1===G.button||4&(G.buttons||0))},isRightButton:function(T){return wg(T)?!1:T&&(2===T.button||2&(T.buttons||0))},isInput:function(d){if(!d)return!1;var D=d.tagName;return"INPUT"===D||"TEXTAREA"===D||"SELECT"===D},getTouchCount:function(y){return wg(y)?y.touches.length:1},isDoubleClick:function(){function K(Z){Z.details=0,Z.timeout=null,Z.lastPoint=null}var V={};return vj=new Sc,Ch=vj.getTime(),function(l){if(js(l)>1)return!1;var t=l.button==z?"":l.button,E=l.type+t,X=E+"_isDoubleClick",Z=V[E];if(Z||(Z=V[E]={details:0,timeout:null,lastPoint:null}),l[X]===B){l[X]=!0;var s=el(l);Z.timeout&&(Eh(Z.timeout),Z.timeout=null);var O=wg(l)?m.doubleTouchRange:m.doubleClickRange;Z.lastPoint&&bh(Z.lastPoint,s)>O&&K(Z),Z.lastPoint=s,Z.details++,Z.timeout=Vr(function(){K(this)}.bind(Z),m.doubleClickSpeed)}return 2===Z.details}}(),isShiftDown:function(k){return k?k.shiftKey:nq["16"]},isCtrlDown:function(f){return f?kj?f.metaKey:f.ctrlKey:kj?nq["91"]:nq["17"]},getClientPoint:function(T){return wg(T)&&(T=$j(T)),{x:T.clientX,y:T.clientY}},isMouseEvent:function(V){return V instanceof MouseEvent||0===V.type.indexOf("mouse")},getTargetElement:function(z){var W,j=Hp(z);if(W=m.isMouseEvent(z)||!T.elementFromPoint?z.target:T.elementFromPoint(j.x,j.y),Md&&T.elementFromPoint){for(var r=[],$=[];"none"===W.style.pointerEvents;)r.push(W),$.push(W.style.display||""),W.style.display="none",W=T.elementFromPoint(j.x,j.y);r.forEach(function(V,g){V.style.display=$[g]})}return W},getPagePoint:function(H){return wg(H)&&(H=$j(H)),{x:H.pageX,y:H.pageY}},createObject:function(u,m){var M=new u;for(var q in m){var S=m[q];if(Qr(S))M[q]=S;else if(0===q.indexOf("s:"))M.s(q.substr(2),m[q]);else if(0===q.indexOf("a:"))M.a(q.substr(2),m[q]);else{var T=Tn(q),S=m[q];M[T]?(M[T](S),"setToolTip"===T&&M.enableToolTip&&M.enableToolTip()):M[q]=S}}return M},setImage:function(N,h,z,v){var n=arguments.length;4===n?$p(N,v,h,z):2===n?hq(h)?h.substr(0,12)==Pm?_o(N,m.parse(h)):$p(N,h):_o(N,h):1===n&&$p(N,N)},getImage:function(q,D,g){var e;if(q==z)return z;if(Th(q)?e=q:(e=Rb[q],q&&e===B&&(Bf&&Bf[q]||$p(q,q))),D&&e&&e.tagName){var b;b="override"===g?"colors_override":"override_rgb"===g?"colors_override_rgb":"override_a"===g?"colors_override_a":"colors",e[b]||(e[b]={__count__:0});var x=e[b][D];return x||(e[b].__count__>m.imageCacheThreshold&&(e[b]={__count__:0}),x=lh(e,Qk(D),e.width,e.height,g),e[b][D]=x,e[b].__count__++),x}return e},isImageComplete:function(H,j,P){var G=Om(H);if(!G)return!1;if(G.tagName)return G.complete;for(var d,H,F,Q=G.comps,p=!0,E=0,V=Q.length;V>E;E++)if(d=Q[E],F=d.type,"image"===d.type){H=d.name,H&&H.func&&(H=Gq(H,j));var u=Gj(H,j,P);if(!u){p=!1;break}}else if(bp.test(F)&&m.getCompType(F)===B){p=!1,Ph(F);break}return p},getId:function(){var x=1;return function(){return++x}}(),callLater:function(A,B,f,s){var J=function(){A.apply(B,f)};return s?Vr(J,s):d.requestAnimationFrame(J)},cancelLater:function(v,b){b?Eh(v):d.cancelAnimationFrame(v)},clone:function(K){if(null==K||"object"!=typeof K)return K;if(K instanceof Date){var c=new Date;return c.setTime(K.getTime()),c}if(K instanceof Array){for(var c=[],u=0,r=K.length;r>u;u++)c[u]=zs(K[u]);return c}if(K instanceof An){for(var c=new An,u=0,r=K.length;r>u;u++)c.set(u,zs(K.get(u)));return c}if(K instanceof fk)return K;if(K instanceof wp){var c=new wp;return c.deserialize(K.serialize()),c}if(K instanceof S){var c={};for(var M in K)K.hasOwnProperty(M)&&(c[M]=zs(K[M]));return c}return K},callWhenLoaded:function(V,u){u=u||100;var Y=ek(V,u);$l||($l={}),$l[Y]={tick:Y,cb:V,delay:u}},beforeLoadURL:function(x,o){if($l){var _={};for(var o in $l){var M=$l[o];Eh(M.tick);var W=ek(M.cb,M.delay);_[W]={tick:W,delay:M.delay,cb:M.cb}}$l=_}return m.convertURL?m.convertURL(x,o):x},convertURL:function(q){return q},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return m.getImage("default_blank")},resizeImage:function(c,o,h,L){h||(h=o),L||(L=km());var s=L.getContext("2d");return Eg(L,o,h,1),s.drawImage(c,0,0,o,h),L},resizeImagePOT:function(g,u,b){if(!g||!g.tagName)return g;var K=g.width,t=g.height;if(!K||!t)return g;if(_k.isPOT(K)&&_k.isPOT(t)&&(!u||K===t))return g;var F,j;return u?j=F=_k.nearestPOT(Math.min(K,t)):(F=_k.nearestPOT(K),j=_k.nearestPOT(t)),m.resizeImage(g,F,j,b)},sortFunc:function(Y,$){if(Y===$)return 0;if(Y==z&&$!=z)return 1;if(Y!=z&&$==z)return-1;if(Y==z&&$==z)return 0;var q,n=typeof Y,M=typeof $;return n===Xe&&M===Xe?q=Y.localeCompare($):n===tg&&M===tg&&(q=Y-$),q===B&&(q=(""+Y).localeCompare(""+$)),q>0?1:0>q?-1:0},getClassMap:function(){return Nq},getClass:function(G){if(hq(G)){var v,i=Nq[G];if(!i){v=G.split("."),i=d;for(var Z=0;Z<v.length;Z++)i=i[v[Z]];Nq[G]=i}return i}return G},def:function(U,G,A){var I,K,k,l=function(){};if(l.prototype=G.prototype,I=new l,hq(U)){if(Nq[U])throw"'"+U+"' already defined";k=Br(U),I.getClassName=function(){return U}}else k=U;if(I.constructor=k,I.getClass=function(){return k},I.getSuperClass=function(){return G},A)for(K in A)Yh[K]&&Yh.hasOwnProperty(K)?Yh[K](I,A):Vc(I,A,K);k.prototype=I,k.superClass=G.prototype},startAnim:function(){var _=function(M){M.duration&&(M.startTime=cr()),M.timeId=sg(M.tick,z,z,M.interval)};return function(c){return c=zs(c),c.easing=c.easing||m.animEasing,c.duration||c.frames||(c.duration=m.animDuration),c.t=0,c.duration?c.interval=0:(c.frame=0,c.interval=c.interval||10),c.tick=function(){if(c.duration){var $=(cr()-c.startTime)/c.duration;if($>1&&($=1),c.t=$,c.action(c.easing($),$),!c.isRunning())return;1===$?c.stop():c._isPaused||(c.timeId=sg(c.tick))}else{if(c.frame++,$=c.t=c.frame/c.frames,c.action(c.easing($),$),!c.isRunning())return;c.frame<c.frames?c._isPaused||(c.timeId=sg(c.tick,z,z,c.interval)):c.stop()}},c.resume=function(){c._isPaused&&(delete c._isPaused,c.duration?c.t<1&&(c.startTime=cr()-c.duration*c.t,c.timeId=sg(c.tick)):c.frame<c.frames&&(c.timeId=sg(c.tick,z,z,c.interval)))},c.pause=function(){Ig(c.timeId,!c.duration),c._isPaused=!0},c.isPaused=function(){return this._isPaused},c.stop=function(Y){c.isRunning()&&(Ig(c.timeId,!c.duration),delete c.timeId,c.duration?c.t<1&&Y&&(c.t=1,c.action(c.easing(1),1)):c.frame<c.frames&&Y&&(c.frame=c.frames,c.action(c.easing(1),1)),c._37o&&c._37o(),c.finishFunc&&c.finishFunc())},c.isRunning=function(){return c.timeId!=z},c.delay?sg(_,z,[c],c.delay):_(c),c}}(),getTextSize:function(){var A={},V=T?km().getContext("2d"):z;return function(O,Y){V.font=O?O:Fc;var J=A[V.font];return J||(J=2*V.measureText("e").width+4,A[V.font]=J),{width:V.measureText(Y).width+m.textExtraWidth,height:J}}}(),drawText:function(h,C,I,i,F,B,Z,f,d,c,A){if(C!=z){var S=nd(I,C),Y={};Y.y=c&&c!==rn?c===Ih?B+S.height/2:B+f-S.height/2:B+f/2,Y.x=d&&d!==Mq?d===ze?F+Z-S.width/2:F+Z/2:F+S.width/2,Uq(h,C,Y,I,i),A&&Yf(h,C,I,i,Y.x,Y.y,S.width,A)}},getDistance:function($,H){var i=$.length;return H?3===i?l(cp($[0]-H[0])+cp($[1]-H[1])+cp($[2]-H[2])):2===i?l(cp($[0]-H[0])+cp($[1]-H[1])):$.z===B?l(cp(H.x-$.x)+cp(H.y-$.y)):l(cp(H.x-$.x)+cp(H.y-$.y)+cp(H.z-$.z)):3===i?l(cp($[0])+cp($[1])+cp($[2])):2===i?l(cp($[0])+cp($[1])):void 0},brighter:function(o,X){return 0>X&&(X=-X),gj(o,X?X:40)},darker:function($,P){return P>0&&(P=-P),gj($,P?P:-40)},unionPoint:function(P,r){if(!P)return z;if(2===arguments.length)return P&&r?{x:H(P.x,r.x),y:H(P.y,r.y),width:n(P.x-r.x),height:n(P.y-r.y)}:z;var X=P;if(X._as&&(X=X._as),X.length===B)return z;var b=X.length;if(0>=b)return z;for(var c=1,O=X[0],G={x:O.x,y:O.y,width:0,height:0};b>c;c++){O=X[c];var C=H(G.x,O.x),L=$(G.x+G.width,O.x),K=H(G.y,O.y),E=$(G.y+G.height,O.y);G.x=C,G.y=K,G.width=L-C,G.height=E-K}return G},unionRect:function(h,V){if(h&&!V)return zs(h);if(!h&&V)return zs(V);if(h&&V){var y={x:H(h.x,V.x),y:H(h.y,V.y)};return y.width=$(h.x+h.width,V.x+V.width)-y.x,y.height=$(h.y+h.height,V.y+V.height)-y.y,y}return z},containsPoint:function(D,s,r,X){if(X!=z&&1!==X){var O=D.x+D.width/2,n=D.y+D.height/2;D={x:O-D.width/2*X,y:n-D.height/2*X,width:D.width*X,height:D.height*X}}if(r){var P=D.width/2,V=D.height/2,M=N(-r),e=c(-r),G=s.x-D.x-P,y=s.y-D.y-V;return s={x:e*G-M*y,y:M*G+e*y},tq({x:-P,y:-V,width:D.width,height:D.height},s)}return!(!D||s.x<D.x||s.y<D.y||s.x>D.x+D.width||s.y>D.y+D.height)},containsRect:function(b,v){if(!b||!v)return!1;var D=v.x,n=v.y,u=v.width,m=v.height,j=b.width,K=b.height;if(0>(j|K|u|m))return!1;var R=b.x,y=b.y;if(R>D||y>n)return!1;if(j+=R,u+=D,D>=u){if(j>=R||u>j)return!1}else if(j>=R&&u>j)return!1;if(K+=y,m+=n,n>=m){if(K>=y||m>K)return!1}else if(K>=y&&m>K)return!1;return!0},intersectsRect:function(c,f){if(!c||!f)return!1;var P=f.width,o=f.height,y=c.width,Z=c.height;if(0>=y||0>=Z||0>=P||0>=o)return!1;var N=f.x,l=f.y,b=c.x,C=c.y;
return y+=b,Z+=C,P+=N,o+=l,y>N&&Z>l&&P>b&&o>C},intersection:function(h,D){if(!h||!D)return z;var M=D.x,q=D.y,B=h.x,V=h.y,L=M,X=q,m=B,_=V;return L+=D.width,X+=D.height,m+=h.width,_+=h.height,B>M&&(M=B),V>q&&(q=V),L>m&&(L=m),X>_&&(X=_),L-=M,X-=q,0>=L||0>=X?z:{x:M,y:q,width:L,height:X}},grow:function(o,Q,t){t===B&&(t=Q),o.x-=Q,o.y-=t,o.width=o.width+2*Q,o.height=o.height+2*t},getScreenPoint:function(E,v,O,r,M,d,R){var g=O.getBoundingClientRect(),m=E*(d||1)-O.scrollLeft+(r||0),Q=v*(R||1)-O.scrollTop+(M||0),L=Ul(O,!1);if(L){var i=new Or(m,Q,0);return i.applyMatrix4(L),console.log(i),{x:i.x,y:i.y}}return{x:m+g.left,y:Q+g.top}},getLogicalPoint:function(d,N,i,$,M,U){var c,Y,J=N.getBoundingClientRect();d.target?(Wo(d)?kj?nq["91"]=!0:nq["17"]=!0:kj?nq["91"]=!1:nq["17"]=!1,nq["16"]=Vn(d)?!0:!1,d=wg(d)?$j(d):d,c=d.clientX,Y=d.clientY):(c=d.x,Y=d.y);var Z=Ul(N,!0);if(Z){var w=new Or(c,Y,0);w.applyMatrix4(Z);do{if(Math.abs(w.z)<=1e-6)break;var E=new Or(c,Y,1);if(E.applyMatrix4(matrix),Math.abs(E.z)<=1e-6){w=E;break}if(E.sub(w),Math.abs(E.z)<=1e-6)break;w.addScaledVector(E,-w.z/E.z)}while(!1);return{x:(w.x+N.scrollLeft-(i||0))/(M||1),y:(w.y+N.scrollTop-($||0))/(U||1)}}return{x:(c-J.left+N.scrollLeft-(i||0))/(M||1),y:(Y-J.top+N.scrollTop-($||0))/(U||1)}},removeHTML:function(){var p;return function(y){return y&&y.getView&&(y=y.getView()),y&&y.parentNode?p===y?!0:(p=y,y.parentNode.removeChild(y),p=z,!0):!1}}(),getToolTipDiv:function(){if(!Eo){Eo=fo(),Il=fo();var A=Eo.style;m.baseZIndex!=z&&(A.zIndex=Mm(m.baseZIndex)+3+""),A.whiteSpace="nowrap",A.color=m.toolTipLabelColor,A.background=m.toolTipBackground,A.font=m.toolTipLabelFont,A.padding="5px",A.boxShadow="0px 0px 3px "+m.toolTipShadowColor}return Eo},isToolTipShowing:function(){return Eo&&Eo.parentNode?!0:Il&&Il.parentNode?!0:!1},updateToolTipContent:function(P,e){if(m.isToolTipShowing()&&(e||(e=Dj&&Dj.view),P===B&&e&&Dj.e&&(P=e.getToolTip(Dj.e)),P!=z)){var Y;P.html?(P=P.html,Y=Il):Y=Eo,Y.innerHTML=P}},hideToolTip:function(){if(m.isToolTipShowing()){zr(Eo),zr(Il),Jc();var B=Dj&&Dj.view;B&&B.onHideToolTip&&B.onHideToolTip(),Dj=z}},showToolTip:function(b,s,x){if(!b||s==z)return yd(),void 0;m.getToolTipDiv();var L,F;if(s.html?(s=s.html,L=Il,zr(Eo)):(L=Eo,zr(Il)),F=L.style,L.innerHTML=s,L.parentNode||_.Default.appendToScreen(L),b.target){b=Hp(b);var q=Yr(),j=b.x,N=b.y,X=Xl?60:12;if(Xl){var w=L.getBoundingClientRect();F.left=j-w.width/2+Eq,F.top=N-w.height-X<q.top?N+X+Eq:N-w.height-X+Eq}else{F.left=j+X+Eq,F.top=N+X+Eq;var w=L.getBoundingClientRect();w.left+w.width>q.width&&(F.left=j-X-w.width+Eq),w.top+w.height>q.height&&(F.top=N-X-w.height+Eq),w.left<0&&(F.left=j+X+Eq),w.top<0&&(F.top=N+X+Eq)}}else F.left=b.x+Eq,F.top=b.y+Eq;Jc(),x===B?x=Dj&&Dj.view:Dj={e:b,view:x},x&&x.onShowToolTip&&x.onShowToolTip()},startDragging:function(E,p,j){j==B&&(j=!0),E!==es&&(es?j&&(wg(p)?es.handleWindowTouchEnd(p):es.handleWindowMouseUp(p)):wg(p)?(C(d,Ld,Xf),C(d,Dd,mk),C(d,"blur",mk)):(C(d,ph,oe),C(d,Hj,gc),C(d,"blur",gc)),es=E)},getImageMap:function(){return Rb},toBoundaries:function(C,i,v,N){var M=[];return Qf(C,i,v,N).forEach(function(R){var W=[];R.forEach(function(M){W.push(M.x,M.y)}),M.push(W)}),M},getCurrentKeyCodeMap:function(){return nq},drawCenterImage:function(y,K,A,v,H,B,R,_){!H&&B&&B.isSelfViewEvent&&(H=B);var f=To(K,H,B),m=Of(K,H,B);sl(y,K,w(A-f/2),w(v-m/2),f,m,H,B,R,_)},drawStretchImage:function(s,D,N,j,g,T,v,r,h,A,Z,P){!r&&h&&h.isSelfViewEvent&&(r=h);var R,o=To(D,r,h,T),S=Of(D,r,h,v);"uniform"===N?(R=H(T/o,v/S),o*=R,S*=R,j+=w((T-o)/2),g+=w((v-S)/2),T=o,v=S):"centerUniform"===N&&((o>T||S>v)&&(R=H(T/o,v/S),o*=R,S*=R),j+=w((T-o)/2),g+=w((v-S)/2),T=o,v=S);var d=s.interactiveInfo;if(d){var G;if(G="center"===N?{x:j+T/2-o/2,y:g+v/2-S/2,width:o,height:S}:{x:j,y:g,width:T,height:v},d.rect){var L=d.compInfos,k=L.length;k&&(L[k-1].rect.image=D)}else d.rect=G}if("center"===N){var U=Z!==!1&&(o>T||S>v);U&&(s.save(),s.beginPath(),s.rect(j,g,T,v),s.clip()),sl(s,D,j+T/2-o/2,g+v/2-S/2,o,S,r,h,A,P),U&&s.restore()}else sl(s,D,j,g,T,v,r,h,A,P)},toCanvas:function(d,p,I,K,f,c,s,S,W){d=Om(d,s),p=p||To(d,f),I=I||Of(d,f);var B=km(),L=rk(B);return S?(Eg(B,p,I,S),L.scale(S,S)):Eg(B,p,I,1),Le(L,d,K,0,0,p,I,f,c,s,W),d&&d.clampToEdge&&(B.clampToEdge=d.clampToEdge),L.restore(),B},toGrayColor:function(E){if(!E)return E;var R=ws(E),S=w(.299*R[0]+.587*R[1]+.114*R[2]);return"rgba("+S+","+S+","+S+","+R[3]/255+")"},createGradientImage:function(u,D,n,o){for(var J=["L",0,0,u,0,1,0,0,1,0,0],w=0,z=Math.min(D.length,n.length);z>w;w++)J.push(n[w],D[w]);var R=_.Default.toCanvas({width:u,height:u,clampToEdge:!0,comps:[{type:"shape",rotation:o||0,points:[0,0,u,0,u,u,0,u],background:"#ffffff",gradientPack:J}]});return R},createElement:function(V,n,b,e){var C=T.createElement(V);return tj(C,n||g.widgetBorder,2),C.style.font=b?b:Fc,e!=z&&(C.value=e),m.onElementCreated&&m.onElementCreated(C),C},containedInView:function($,N){var Z=Ll(N).getBoundingClientRect();return tq({x:Z.left,y:Z.top,width:Z.width,height:Z.height},el($))},isIsolating:function(){return Hc>0},setIsolating:function(h){h?Hc++:Hc--},getMSMap:function(){return Yh},stringify:function(F,w,M){var y=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var c=wp.prototype.toJSON;wp.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},w=M?0:w==z?2:w;var e=JSON.stringify(F,function(Z,M){return"function"==typeof M?"__ht__"+(M.__ht__||M.toString()):Aj(M)?Em(M):M instanceof _.List?"__ht__list"+(M.__ht__list||m.stringify(M._as)):M},w);return Date.prototype.toJSON=y,wp.prototype.toJSON=c,M&&(e=Pm+Dh(e)),e},parse:function(L,X){return hq(L)?L.substr(0,12)!=Pm||(L=ak(L.substr(12)),hq(L))?(X=X||{},JSON.parse(L,function(e,J){if(hq(J))if(X.ignoreFunction||"__ht__function"!=J.substr(0,14)){if(!X.ignoreDate&&"__ht__date"==J.substr(0,10))return new Date(Mm(J.substr(10)));if("__ht__list"===J.substr(0,10))return new An(m.parse(J.substr(10)));if(!X.ignoreDataModel&&"__ht__dataModel"===J.substr(0,15)){var s=new wp;return s.deserialize(m.parse(J.substr(15))),s}}else{var P=J.indexOf("{")+1,I=J.lastIndexOf("}"),G=J.indexOf("(")+1,y=J.indexOf(")");if(P&&I&&G&&y)try{var p=new Function(J.substring(G,y),J.substring(P,I));return p.__ht__=J.substr(6),p}catch(V){throw console.info("=== SyntaxError ===\n",J),V}}return J})):L:L},loadJS:function(B,N){N&&B.push(N);var $=B.shift();if(Jm($))B=$.contact(B),m.loadJS(B);else if(Qr($))$(),m.loadJS(B);else if(hq($)){var x=T.createElement("script");x.onload=function(){m.loadJS(B)},x.setAttribute("src",$),T.getElementsByTagName("head")[0].appendChild(x)}else B.length&&m.loadJS(B)},extendClass:function(M,p){var B=M.prototype;for(var Q in p)Yh[Q]&&Yh.hasOwnProperty(Q)?Yh[Q](B,p):B[Q]=p[Q]},toRoundedCorner:function(){function N(N,E,C){N.x=E.x,N.y=E.e||C,N.z=E.y}var j=new Or,w=new Or,X=new Or,Z=new Or;return function(E,r){var i,t=0;E.getPoints&&(t=E.getElevation(),E=E.getPoints()),i=E instanceof An?E:new An(E);var p=i.size();if(0>=r)return{points:i};var _=new An,P=new An,W=i.get(0);N(j,W,t),_.add(W),P.add(1);for(var o=1;p>o;o++)if(p>o+1){var v=i.get(o),K=i.get(o+1);N(w,v,t),N(X,K,t),Z.subVectors(j,w).setLength(Math.min(.99*Z.length(),r)).add(w),v.e!==B||W.e!==B?_.add({x:Z.x,y:Z.z,e:Z.y}):_.add({x:Z.x,y:Z.z}),_.add(v),Z.subVectors(X,w).setLength(Math.min(.99*Z.length(),r)).add(w),v.e!==B||K.e!==B?_.add(W={x:Z.x,y:Z.z,e:Z.y}):_.add(W={x:Z.x,y:Z.z}),j.copy(Z),P.addAll([2,3])}else _.add(i.get(o)),P.add(2);return{points:_,segments:P}}}(),toColorData:ws,setCanvas:Eg,createDiv:fo,createDisabledDiv:ts,createView:Oc,createCanvas:km,appendChild:as,initContext:rk,checkLoadingImage:yk,translateAndScale:tl,layout:fs,getPosition:Gb,drawPoints:Ff,drawRoundRect:lm,drawBorder:rl,setFocus:pk,getter:dc,setter:Tn,isEmptyObject:od,cameraPriority:function(){var E={skybox:0,main:1e4,top:1e7,infinity:1/0};return S.seal(S.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return E.skybox},set:function(I){if(I>=E.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");E.skybox=Number(I)}},main:{configurable:!1,enumerable:!1,get:function(){return E.main},set:function(Q){if(Q<=E.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(Q>=E.top)throw new RangeError("Main camera must have lower priority than the top camera.");E.main=Number(Q)}},top:{configurable:!1,enumerable:!1,get:function(){return E.top},set:function(S){if(S<=E.main)throw new RangeError("Top camera must have higher priority than the main camera.");E.top=Number(S)}}}))}()},!0),Lp(t,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Xn=m.disabledOpacity,Bi=m.toolTipDelay,sq=m.devicePixelRatio,yl=m.autoMakeVisible,Yn=m.autoHideScrollBar,Td=m.imageGradient,Zb=m.showToolTip,yd=m.hideToolTip,oc=m.dashPattern,qg=m.lineCap,Ec=m.lineJoin,ne=m.labelColor,_c=m.labelSelectColor,Fc=m.labelFont,Vp=m.widgetIndent,As=m.widgetRowHeight,Ki=m.widgetHeaderHeight,Ci=m.widgetTitleHeight,cg=m.scrollBarColor,Vf=m.scrollBarSize,Yc=m.scrollBarTimeout,Xq=m.scrollBarMinLength,eg=m.scrollBarInteractiveSize,rf=m.zoomIncrement,vh=m.scrollZoomIncrement,Sf=m.pinchZoomIncrement,ie=m.zoomMax,ag=m.zoomMin,Hn=m.createObject,pd=m.preventDefault,ej=m.setImage,Om=m.getImage,Gj=m.isImageComplete,Mn=m.drawCenterImage,Le=m.drawStretchImage,Ie=m.getId,sg=m.callLater,Ig=m.cancelLater,lp=m.sortFunc,zs=m.clone,Br=m.getClass,om=m.startAnim,Xj=m.brighter,Gg=m.darker,Rd=m.drawText,nd=m.getTextSize,ti=m.isLeftButton,Mi=m.isMiddleButton,hp=m.isRightButton,js=m.getTouchCount,ds=m.isDoubleClick,Vn=m.isShiftDown,Wo=m.isCtrlDown,el=m.getClientPoint,Hp=m.getPagePoint,bh=m.getDistance,sf=m.unionPoint,io=m.unionRect,tq=m.containsPoint,wi=m.containsRect,pn=m.intersectsRect,Li=m.intersection,Yr=m.getWindowInfo,gp=m.grow,Xi=m.getLogicalPoint,qk=m.getScreenPoint,Gk=m.startDragging,zr=m.removeHTML,ai=m.createElement,rp=m.segmentResolution,Lh=m.shapeResolution,Zo=m.shapeSide,Fm=m.def,Fh=function(X,L,E){Fm(j+"."+X,L,E)},Hi=function(D,B){D.childNodes.forEach(function(v){B(v),Hi(v,B)})};Lp(m,{toolTipLabelColor:ne,toolTipLabelFont:Fc,toolTipBackground:g.toolTipBackground,toolTipShadowColor:an,debugTipLabelFont:Fc,debugTipLabelColor:ne,debugTipBackground:g.toolTipBackground,drawBreakableText:Bc,setDevicePixelRatio:function(Z){sq=m.devicePixelRatio="number"==typeof Z?Z:en(d),Hi(T.body,function(V){var $=V._ht;$&&$._canvas&&(Eg($._canvas,$.getWidth(),$.getHeight()),$.redraw?$.redraw():$.iv())})},getPosition3dGap:function(){return zh()}},!0);var ic=1e-6,im="undefined"!=typeof Uint16Array?Uint16Array:Array,Er="undefined"!=typeof Uint32Array?Uint32Array:im,al="undefined"!=typeof Float32Array?Float32Array:Array,of=function(H,k,Z){var O=[H[0]-k[0],H[1]-k[1],H[2]-k[2]];if(Z){var B=bh(O);B>0&&(O[0]/=B,O[1]/=B,O[2]/=B)}return O},Qm=function(){var x="charCodeAt",Z=2*(2*hc.length+1);for(var y in d)if(y===j+Mq[0]+(Eq.length+2)){var G=d[y];if(!G)break;for(var n=G.length,B=0;n>B;B++)if(G[B][x](0)===Z&&G[B+1]!=z&&G[B+1]===Eq[0]&&G[B+2]!=z&&G[B+2][x](0)===Z){for(var e=B+3;n>e;e++)if(G[e][x](0)===Z){if(0==G[e+1])for(var L,$=e+2;n>$;$++){if(G[$][x](0)===Z){0==G[$-1]&&L&&(pc=L.substr(0,L.length-1));break}L==z?L=G[$]:L+=G[$]}break}break}break}return function(c){return[-c[0],-c[1],-c[2]]}}(),In=function(v,y){return 3===v.length?v[0]*y[0]+v[1]*y[1]+v[2]*y[2]:v[0]*y[0]+v[1]*y[1]},Cd=function(){var G=new Array(16);return G[0]=1,G[1]=0,G[2]=0,G[3]=0,G[4]=0,G[5]=1,G[6]=0,G[7]=0,G[8]=0,G[9]=0,G[10]=1,G[11]=0,G[12]=0,G[13]=0,G[14]=0,G[15]=1,G},Sb=Cd(),Cp=function(k){var v=new Array(16);return v[0]=k[0],v[1]=k[1],v[2]=k[2],v[3]=k[3],v[4]=k[4],v[5]=k[5],v[6]=k[6],v[7]=k[7],v[8]=k[8],v[9]=k[9],v[10]=k[10],v[11]=k[11],v[12]=k[12],v[13]=k[13],v[14]=k[14],v[15]=k[15],v},_b=function(O,i){return O[0]=i[0],O[1]=i[1],O[2]=i[2],O[3]=i[3],O[4]=i[4],O[5]=i[5],O[6]=i[6],O[7]=i[7],O[8]=i[8],O[9]=i[9],O[10]=i[10],O[11]=i[11],O[12]=i[12],O[13]=i[13],O[14]=i[14],O[15]=i[15],O},ss=function(j){return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},jd=function(r,V){var $=r[0],A=r[1],M=r[2];return r[0]=V[0]*$+V[4]*A+V[8]*M+V[12],r[1]=V[1]*$+V[5]*A+V[9]*M+V[13],r[2]=V[2]*$+V[6]*A+V[10]*M+V[14],r},ho=function(T,R){var H=T[0],J=T[1],a=T[2],L=T[3];return T[0]=R[0]*H+R[4]*J+R[8]*a+R[12]*L,T[1]=R[1]*H+R[5]*J+R[9]*a+R[13]*L,T[2]=R[2]*H+R[6]*J+R[10]*a+R[14]*L,T[3]=R[3]*H+R[7]*J+R[11]*a+R[15]*L,T},Ii=function(){var S,R,a,u,t=Pd(Ub[1]+Ub[7]),U=Pd(Ub[0]+Ub[3]-Ub[10]),d=Pd(Ub[8]+2),c=function(){return R=a.charAt(S),S+=1,R},V=function(){var B="";if(R===d)for(;c();){if(R===d)return c(),B;B+=R}else c()},K=function(){for(;R&&" ">=R;)c()},b=function(){var i,O={};if(R===t){if(c(),K(),R===U)return c(),O;for(;R;){if(i=V(),K(),c(),O[i]=u(),K(),R===U)return c(),O;c(),K()}}};return u=function(){switch(K(),R){case t:return b();default:return V()}},function(p){if(x={},p){var t;if(a=p,S=0,R=" ",t=u(),K(),!R)return t}}}(),zl=function(w,j){if(j){var I=N(j),n=c(j),R=w[4],D=w[5],o=w[6],A=w[7],_=w[8],G=w[9],V=w[10],U=w[11];w[4]=R*n+_*I,w[5]=D*n+G*I,w[6]=o*n+V*I,w[7]=A*n+U*I,w[8]=_*n-R*I,w[9]=G*n-D*I,w[10]=V*n-o*I,w[11]=U*n-A*I}},Uj=function(V,e){if(e){var G=N(e),O=c(e),S=V[0],I=V[1],Z=V[2],m=V[3],X=V[8],w=V[9],u=V[10],y=V[11];V[0]=S*O-X*G,V[1]=I*O-w*G,V[2]=Z*O-u*G,V[3]=m*O-y*G,V[8]=S*G+X*O,V[9]=I*G+w*O,V[10]=Z*G+u*O,V[11]=m*G+y*O}},vd=function(E,T){if(T){var r=N(T),M=c(T),D=E[0],j=E[1],Y=E[2],m=E[3],e=E[4],q=E[5],O=E[6],d=E[7];E[0]=D*M+e*r,E[1]=j*M+q*r,E[2]=Y*M+O*r,E[3]=m*M+d*r,E[4]=e*M-D*r,E[5]=q*M-j*r,E[6]=O*M-Y*r,E[7]=d*M-m*r}},vs=function(f,u,k){return ji(z,k===!1?z:f.getFinalScale3d(),f.getFinalRotation3d(),f.getRotationMode(),f.p3(),z,u)},ji=function(P,o,x,X,C,h,a){return h||(h=Cd()),C&&hk(h,C),wj(h,x,X),a&&zg(h,h,a),o&&Tl(h,o),P&&zg(h,h,P),h},jg=function(v,l,N){l=Mm(l),N=Mm(N);var P=this;P.g=v,P._84O=l,P._85O=N,P._70I=!0,P.F=0,P._83O=l+N,P.pen={x:0,y:0}},Vo="lineDashOffset",Hq="setLineDash",Nh=function(T){for(var x in T)1===x.length&&(Vo=T[x]);return x?1:0},Qo=function(Z,u,b){return Tc(u)?Z:Z[Hq]?(Z[Hq](u),b&&(Z.lineDashOffset=b),Z):new jg(Z,u[0],u.length>1?u[1]:u[0])},oq=function(V,d){!Tc(d)&&V[Hq]&&(V[Hq](Nr),V.lineDashOffset=0)};Fm(jg,S,{_69I:6,moveTo:function(L,v){var V=this,B=V.pen;B.x=L,B.y=v,V.g.moveTo(L,v),V.start||(V.start={x:L,y:v})},lineTo:function(T,j){var A=this,v=A.pen,Y=T-v.x,l=j-v.y,U=Wc(l,Y),i=c(U),B=N(U),k=A._23O(v.x,v.y,T,j),Z=A._85O,n=A._84O,m=A._83O;if(A.F){if(A.F>k)return A._70I?A._72I(T,j):A.moveTo(T,j),A.F-=k,void 0;if(A._70I?A._72I(v.x+i*A.F,v.y+B*A.F):A.moveTo(v.x+i*A.F,v.y+B*A.F),k-=A.F,A.F=0,A._70I=!A._70I,!k)return}var w=e(k/m);if(w){for(var _=i*n,V=B*n,J=i*Z,E=B*Z,F=0;w>F;F++)A._70I?(A._72I(v.x+_,v.y+V),A.moveTo(v.x+J,v.y+E)):(A.moveTo(v.x+J,v.y+E),A._72I(v.x+_,v.y+V));k-=m*w}A._70I?k>n?(A._72I(v.x+i*n,v.y+B*n),A.moveTo(T,j),A.F=Z-(k-n),A._70I=!1):(A._72I(T,j),k===n?(A.F=0,A._70I=!A._70I):(A.F=n-k,A.moveTo(T,j))):k>Z?(A.moveTo(v.x+i*Z,v.y+B*Z),A._72I(T,j),A.F=n-(k-Z),A._70I=!0):(A.moveTo(T,j),k===Z?(A.F=0,A._70I=!A._70I):A.F=Z-k)},quadraticCurveTo:function(t,$,n,p){var K,l=this,o=l.pen,M=o.x,J=o.y,f=l._22O(M,J,t,$,n,p),c=0,Z=0,i=l._85O,R=l._84O;if(l.F){if(l.F>f)return l._70I?l._71I(t,$,n,p):l.moveTo(n,p),l.F-=f,void 0;if(c=l.F/f,K=l._20O(M,J,t,$,n,p,c),l._70I?l._71I(K[2],K[3],K[4],K[5]):l.moveTo(K[4],K[5]),l.F=0,l._70I=!l._70I,!f)return}var A=f-f*c,P=e(A/l._83O),w=R/f,x=i/f;if(P)for(var L=0;P>L;L++)l._70I?(Z=c+w,K=l._21O(M,J,t,$,n,p,c,Z),l._71I(K[2],K[3],K[4],K[5]),c=Z,Z=c+x,K=l._21O(M,J,t,$,n,p,c,Z),l.moveTo(K[4],K[5])):(Z=c+x,K=l._21O(M,J,t,$,n,p,c,Z),l.moveTo(K[4],K[5]),c=Z,Z=c+w,K=l._21O(M,J,t,$,n,p,c,Z),l._71I(K[2],K[3],K[4],K[5])),c=Z;A=f-f*c,l._70I?A>R?(Z=c+w,K=l._21O(M,J,t,$,n,p,c,Z),l._71I(K[2],K[3],K[4],K[5]),l.moveTo(n,p),l.F=i-(A-R),l._70I=!1):(K=l._19O(M,J,t,$,n,p,c),l._71I(K[2],K[3],K[4],K[5]),f===R?(l.F=0,l._70I=!l._70I):(l.F=R-A,l.moveTo(n,p))):A>i?(Z=c+x,K=l._21O(M,J,t,$,n,p,c,Z),l.moveTo(K[4],K[5]),K=l._19O(M,J,t,$,n,p,Z),l._71I(K[2],K[3],K[4],K[5]),l.F=R-(A-i),l._70I=!0):(l.moveTo(n,p),A===i?(l.F=0,l._70I=!l._70I):l.F=i-A)},bezierCurveTo:function(){var u=arguments;this.pen={x:u[4],y:u[5]},this.g.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5])},arc:function(Q,I,V,X,Y,l){l||(X=-X,Y=-Y),lo(this,Q,I,X,Y-X,V,V,!1)},rect:function(t,C,o,A){var M=this;M.pen={x:t,y:C},M.moveTo(t,C),M.lineTo(t,C+A),M.lineTo(t+o,C+A),M.lineTo(t+o,C),M.lineTo(t,C)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(z,v,t,Q){var f=t-z,$=Q-v;return l(f*f+$*$)},_22O:function(X,k,K,M,T,l,Q){for(var Y,D,x,d,I,b,V,N=0,e=X,W=k,g=Q>0?Q:this._69I,q=1;g>=q;q++)x=q/g,d=1-x,I=d*d,b=2*x*d,V=x*x,Y=I*X+b*K+V*T,D=I*k+b*M+V*l,N+=this._23O(e,W,Y,D),e=Y,W=D;return N},_21O:function(K,T,B,N,C,P,n,g){var t=this;if(0===n)return t._20O(K,T,B,N,C,P,g);if(1===g)return t._19O(K,T,B,N,C,P,n);var Y=t._20O(K,T,B,N,C,P,g);return Y.push(n/g),t._19O.apply(t,Y)},_20O:function(B,e,U,E,G,z,L){if(1!==L){var N=U+(G-U)*L,D=E+(z-E)*L;U=B+(U-B)*L,E=e+(E-e)*L,G=U+(N-U)*L,z=E+(D-E)*L}return[B,e,U,E,G,z]},_19O:function(E,L,u,U,t,N,c){if(1!==c){var S=E+(u-E)*c,f=L+(U-L)*c;u+=(t-u)*c,U+=(N-U)*c,E=S+(u-S)*c,L=f+(U-f)*c}return[E,L,u,U,t,N]},_72I:function(t,_){var h=this.pen;(t!==h.x||_!==h.y)&&(h.x=t,h.y=_,this.g.lineTo(t,_))},_71I:function(r,I,s,q){var C=this.pen;(r!==s||I!==q||s!==C.x||q!==C.y)&&(C.x=s,C.y=q,this.g.quadraticCurveTo(r,I,s,q))}}),Yh.ms_quickVisible=function(Q){Q._4BQ=!1,Q._4CQ=function($){var i=$._4EQ;return i!==B?i:i=$._4EQ=this._4FQ($)},Q._4DQ=function(N){if(!N)return this.dm().each(function(c){c._4EQ=B}),void 0;N._4EQ=B;var Q=this;if(N instanceof Sm||Hh(N)||N instanceof rb||N.ISubGraph)N.eachChild(function(R){Q.invalidateQuickVisible(R)});else if(N.getEdges){var E=N.getEdges();E&&E.each(function(P){Q.invalidateQuickVisible(P)})}},Q.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},Q.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=uo)},Q.isQuickVisibleMode=function(){return this._4BQ},Q.invalidateQuickVisible=uo},Sk=Um()+1,dq&&d.console&&Sk&&!0&&(d.navigator&&d.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?d.console.log.apply(console,["Hightopo - Version"+_.Default.getVersion()+" - %cTrialhttp://hightopo.com/request.html","color: #f00;"]):d.console.log("Hightopo - Version"+_.Default.getVersion()+" - Trialhttp://hightopo.com/request.html"));var Fj=z,_n=z,Dc=m.checkLoadingCompType=function(q){Fj&&!q._72O_&&(_n||(_n={}),_n[q._72O_=Ie()]=q)},Ph=function(T,A){if(A||(A=T),A&&(Fj||(Fj={}),!Fj[T])){var K=new Bp;if(Fj[A]={request:K,url:A},A=m.beforeLoadURL(A,T),A.data){var U=m.parse(A.data);gs(T,U),m.handleCompTypeLoaded(T,U)}else{K.onload=function(){if(200===this.status||0===this.status){var P=m.parse(K.getResponseText());gs(T,P),m.handleCompTypeLoaded(T,P)}else gs(T,z)},K.onerror=function(){gs(T,z)};var X={};X.url=encodeURI(A),X.sync=!1,K.send(X)}}},gs=function(o,v){if(Ib[o]=v,delete Fj[o],od(Fj)&&(Fj=z,_n)){for(var e in _n){var i=_n[e];i.invalidateAll&&i.invalidateAll(B,"compTypeLoaded",o),i.redraw&&i.redraw(),i.iv(),delete i._72O_}_n=z}if(v&&_n)for(var e in _n){var i=_n[e];i.invalidateAll&&i.invalidateAll(B,"compTypeLoading",o),i.redraw&&i.redraw(),i.iv()}},bf=g.chart,sb="",Ar=!0,Pl=m.compStack=[],lj=/^style@/,ef=/^attr@/,qj=/^field@/,Hb={x:.5,y:.5},Wi=function(){Ar=!0},Ne=function(){return Ar},Pp=function(f,X,n){if(!f)return!1;var P;return n&&n.isImageFitSize&&(P=n.isImageFitSize(X,f)),P==z&&(P=Gq(f.fitSize,X,n)),P},To=function(m,n,B,Y){if(!m)return 0;if(Pp(m,n,B)&&Y)return Y;var k=Gq(m.width,n,B);return null==k?20:k},Of=function(m,P,u,z){if(!m)return 0;if(Pp(m,P,u)&&z)return z;var S=Gq(m.height,P,u);return null==S?20:S},Gq=function(n,i,x){if(!n||!n.func)return n;var A,w=n.func,C=n.value;return A=Qr(w)?x&&x.vectorDataBindingDisabled&&!n.isSafeFunc?C:w(i,x):i instanceof fk||(_.ui?i instanceof _.ui.View:0)?ef.test(w)?i.a(sb+w.slice(5)):lj.test(w)?i.s(sb+w.slice(6)):qj.test(w)?i[w.slice(6)]:i[w]?i[w](x):C:C,C!==B&&A==z?C:A},sl=m.drawImage=function(){var w,I,J,Z,Y,D,f=3,j=6,W=function(H,c){H.getValue&&H.getValue.compType===c||(H.getValue=function(t){var r=O(H,t);if(r===B&&c.properties){var R=c.properties[t];R&&(r=R.defaultValue)}return r},H.getColor=function(j,n){return n===!0?t(j):t(H.getValue(j))},H.getValue.compType=c)},O=function(Y,i,o){var L,R=!1;if(Y.prefix&&I instanceof fk){var s=I.a(sb+i);s!==B&&(R=!0,L=s)}return L===B&&(L=Y[i]),L&&L.func&&(R=!0,L=Gq(L,I,J)),o&&(L=o(L),R||(Y[i]=L)),L},t=function(b,E){var f;return f=E?O(b,E):b,w&&w.compGray&&f?m.toGrayColor(f):Y&&f?zp(f,Y,D):f},x=function(i){if(Jm(i)){for(var l=new An,Q=i.length,Z=0;Q>Z;Z+=2)l.add({x:i[Z],y:i[Z+1]});i=l}return i},K=function(V){var n=O(V,"anchorX"),w=O(V,"anchorY");if(n!==B||w!==B)return{x:n===B?Hb.x:n,y:w===B?Hb.y:w};var T=O(V,"type"),L=O(V,"name");if("image"!==T||!L)return Hb;var g=Om(L);return g&&g.anchorX!==B&&g.anchorY!==B?{x:g.anchorX,y:g.anchorY}:Hb},n=function(y,T){var g=O(y,Ol),w=K(y);if(Jm(g)){var Z=g.length,U=O(y,"relative"),X=T.width,_=T.height;if(4===Z)g={x:g[0],y:g[1],width:g[2],height:g[3]},U&&(g.x*=X,g.y*=_,g.width*=X,g.height*=_);else if(3===Z){var s=g[0];g={width:g[1],height:g[2]},U&&(g.width*=X,g.height*=_),"object"==typeof s?s.length&&(s={x:s[0],y:s[1]}):s=Gb(s,T,g),g.x=s.x-g.width*w.x,g.y=s.y-g.height*w.y}g.x+=O(y,"offsetX")||0,g.y+=O(y,"offsetY")||0,!U&&T.fitSize&&(g=r(y,g,T))}return g},r=function(I,F,J){if(F){var y,D,w,B={x:F.x,y:F.y,width:F.width,height:F.height},g=K(I),r=O(I,"layoutH"),V=O(I,"layoutV"),n=1,A=1,R=0,d=0,k=1,m=1;switch(r){case"left":break;case"right":B.x+=J.width-J.rw;break;case"center":B.x+=.5*(J.width-J.rw);break;case"scale":case"leftright":default:y=O(I,Qc)||0,y&&(R=Math.abs(d=Math.sin(y)),k=Math.abs(m=Math.cos(y))),"leftright"!==r?(n+=k*(J.widthScale-1),A+=R*(J.widthScale-1)):(n+=B.width?k*(J.width-J.rw)/B.width:0,A+=B.height?R*(J.width-J.rw)/B.height:0,D=-Math.min(-g.x*m+g.y*d,-g.x*m-(1-g.y)*d,(1-g.x)*m+g.y*d,(1-g.x)*m-(1-g.y)*d))}switch(V){case"top":break;case"bottom":B.y+=J.height-J.rh;break;case"center":B.y+=.5*(J.height-J.rh);break;case"scale":case"topbottom":default:y==z&&(y=O(I,Qc),y&&(R=Math.abs(d=Math.sin(y)),k=Math.abs(m=Math.cos(y)))),"topbottom"!==V?(n+=R*(J.heightScale-1),A+=k*(J.heightScale-1)):(n+=B.width?R*(J.height-J.rh)/B.width:0,A+=B.height?k*(J.height-J.rh)/B.height:0,w=-Math.min(-g.x*d-g.y*m,-g.x*d+(1-g.y)*m,(1-g.x)*d-g.y*m,(1-g.x)*d+(1-g.y)*m))}return(1!==n||1!==A)&&("scale"!==r&&r?"leftright"===r&&(B.x+=B.width*(1-n)*g.x+D*(J.width-J.rw)):B.x+=B.x*(J.widthScale-1)+g.x*B.width*(J.widthScale-n),"scale"!==V&&V?"topbottom"===V&&(B.y+=B.height*(1-A)*g.y+w*(J.height-J.rh)):B.y+=B.y*(J.heightScale-1)+g.y*B.height*(J.heightScale-A),B.width*=n,B.height*=A),B.width<0&&(B.width=0),B.height<0&&(B.height=0),B}},u=function(W){return Jm(W)?new An(W):W},l=function(g,h,q,i,K,L,W){var l=w.interactiveInfo,u=g.transform;if(u)return w.save(),w.setTransform(u.a,u.b,u.c,u.d,u.tx,u.ty),l&&l.compInfos.push({comp:g,rect:h,matrix:u.clone(),prefix:sb,refRect:l.refRect}),!0;K===B&&(K=1),L===B&&(L=1);var U=O(g,"clipPercentage"),I=Df(q,h);if(I&&!i&&1===K&&1===L&&U==B)return l&&l.compInfos.push({comp:g,rect:h,matrix:l.matrix.clone(),prefix:sb,refRect:l.refRect}),!1;W=W||Hb;var Y=h.x+h.width*W.x,J=h.y+h.height*W.y,F=q.x+q.width*W.x,s=q.y+q.height*W.y,D=q.width?K*(h.width/q.width):1,X=q.height?L*(h.height/q.height):1;if(w.save(),l&&(l.matrix.appendTranslate(Y,J).appendRotate(i).appendScale(D,X).appendTranslate(-F,-s),l.compInfos.push({comp:g,rect:h,matrix:l.matrix.clone(),prefix:sb,refRect:l.refRect})),Jo(w,Y,J),af(w,i||0),to(w,D,X),Jo(w,-F,-s),U!=B){var P=Ai(q,O(g,"clipDirection"),U);w.beginPath(),w.rect(P.x,P.y,P.width,P.height),w.clip()}return!0},A=function(){w.restore()},k=function(B,j,f){var h=O(B,"path"),$=O(B,Qc),b=O(B,"scaleX"),U=O(B,"scaleY"),V=K(B),S=z,p=te(null,h);if(f||(f=B.unionRect,f||(f=sf(p),B.path.func||(B.unionRect=f)),S=f),f){S||(S=B.unionRect,S||(S=sf(p),B.path.func||(B.unionRect=S)));var y=l(B,f,S,$,b,U,V),g=O(B,"borderPattern"),c=Qo(w,g),d=t(B,"background"),J=t(B,"borderColor"),u=O(B,"borderWidth"),D=O(B,"gradient"),G=t(B,"gradientColor"),Y=O(B,"border3d"),X=t(B,"border3dColor"),I=O(B,"border3dAccuracy"),v=w.lineJoin,m=w.lineCap;w.lineJoin=O(B,"borderJoin")||Ec,w.lineCap=O(B,"borderCap")||qg,d?(os(w,d,D,G,S),te(w,h),w.fill(),c!==w&&te(w,h)):te(w,h);var r=O(B,"borderWidthAbsolute");if(r&&(w.save(),w.setTransform(1,0,0,1,0,0)),u&&J&&(w.lineWidth=u,w.strokeStyle=J,w.stroke(),Y&&lf(w,J,X,u,Z,I)),oq(w,g),O(B,"dash")){var W=O(B,"dashWidth")||u;if(W>0){g=O(B,"dashPattern")||oc;var c=Qo(w,g,O(B,"dashOffset")),n=t(B,"dashColor")||t(Lk);c!==w&&te(w,h),w.strokeStyle=n,w.lineWidth=W,w.stroke(),O(B,"dash3d")&&lf(w,n,t(B,"dash3dColor"),W,Z,O(B,"dash3dAccuracy")),oq(w,g)}}r&&w.restore(),j===Ol&&fn(w,d,O(B,"depth"),S),w.lineJoin=v,w.lineCap=m,y&&A()}},F=function(c,k,i,F){var L=O(c,Bj,x),_=O(c,Qc),v=K(c);if(L&&F.fitSize){var R=new An,G=sf(L),p=r(c,G,F),h=G.x+v.x*G.width,m=G.y+v.y*G.height,T=p.x+v.x*p.width,d=p.y+v.y*p.height,S=G.width?p.width/G.width:1,W=G.height?p.height/G.height:1;L.each(function($){R.add({x:T+($.x-h)*S,y:d+($.y-m)*W})}),L=R,c.unionRect=null}var f=O(c,"scaleX"),N=O(c,"scaleY"),b=k===Sd,V=z;if(!i&&b&&(i=c.unionRect,i||(i=sf(L),c.points.func||(c.unionRect=i)),V=i),i){b?V||(V=c.unionRect,V||(V=sf(L),c.points.func||(c.unionRect=V))):V=i;var a,P,q,g,U=l(c,i,V,_,f,N,v),C=O(c,"borderPattern"),o=Qo(w,C),M=t(c,"background"),y=Om(O(c,"repeatImage"),Y,D),$=O(c,"gradientPack"),H=O(c,"borderGradientPack"),j=t(c,"borderColor"),X=O(c,"borderWidth"),Q=Om(O(c,"borderRepeatImage"),Y,D),s=O(c,"segments",u),n=O(c,"gradient"),E=t(c,"gradientColor"),e=O(c,"border3d"),Ei=t(c,"border3dColor"),wg=O(c,"border3dAccuracy"),Or=O(c,"closePath"),xi=O(c,"fillRule")||"nonzero",af=w.lineJoin,rc=w.lineCap;if(w.lineJoin=O(c,"borderJoin")||Ec,w.lineCap=O(c,"borderCap")||qg,b)if(M||y||$){var wm=O(c,"fillClipPercentage");if(wm!=B){var gm=Ai(V,O(c,"fillClipDirection"),wm);w.save(),w.beginPath(),w.rect(gm.x,gm.y,gm.width,gm.height),w.clip()}Ff(w,L,s,Or),$?No(w,$,t,!1,i):y?Tj(w,y,Y,D,I,J):os(w,M,n,E,V),w.fill(xi),$&&w.restore(),wm!=B&&w.restore(),o!==w&&Ff(o,L,s,Or)}else Ff(o,L,s,Or);else if("roundRect"===k?a=O(c,"cornerRadius"):"polygon"===k?(a=O(c,"polygonSide"),P=O(c,"cornerRadius"),q=O(c,"regular")):"arc"===k&&(a=O(c,"arcFrom"),P=O(c,"arcTo"),q=O(c,"arcClose"),g=O(c,"arcOval")),M||y||$){var wm=O(c,"fillClipPercentage");if(wm!=B){var gm=Ai(V,O(c,"fillClipDirection"),wm);w.save(),w.beginPath(),w.rect(gm.x,gm.y,gm.width,gm.height),w.clip()}np(w,k,V,a,P,q,g),$?No(w,$,t,!1,i):y?Tj(w,y,Y,D,I,J):os(w,M,n,E,V),w.fill(xi),$&&w.restore(),wm!=B&&w.restore(),w!==o&&np(o,k,V,a,P,q,g)}else np(o,k,V,a,P,q,g);var ek=O(c,"borderWidthAbsolute");if(ek&&(w.save(),w.setTransform(1,0,0,1,0,0)),X&&(j||Q||H)&&(w.lineWidth=X,H?No(w,H,t,!0,i):Q?us(w,Q,Y,D,I,J):w.strokeStyle=j,w.stroke(),H&&w.restore(),e&&lf(w,j,Ei,X,Z,wg)),oq(w,C),O(c,"dash")){var fp=O(c,"dashWidth")||X;if(fp>0){C=O(c,"dashPattern")||oc;var o=Qo(w,C,O(c,"dashOffset")),Hb=t(c,"dashColor")||t(Lk);o!==w&&(b?Ff(o,L,s,Or):np(o,k,V,a,P,q,g)),w.strokeStyle=Hb,w.lineWidth=fp,w.stroke(),O(c,"dash3d")&&lf(w,Hb,t(c,"dash3dColor"),fp,Z,O(c,"dash3dAccuracy")),oq(w,C)}}ek&&w.restore(),k===Ol&&fn(w,M,O(c,"depth"),V),w.lineJoin=af,w.lineCap=rc,U&&A()}},V=function(y,F){var o=Y||O(y,Wq),Q=D||O(y,"blendMode"),q=O(y,"name"),W=Om(q,o,Q);W&&W.cacheRule!=z&&(W=yh(w,W,O(y,"stretch"),F.width,F.height,I,J,o)),W?Le(w,W,O(y,"stretch"),F.x,F.y,F.width,F.height,I,J,o,null,Q):Ar=!1},b=function(D,_){var T=O(D,"text");if(T!=z){T+="";var o,H=O(D,"gradientPack"),f=O(D,"gradient"),Z=t(D,"gradientColor"),L=O(D,"font"),K=O(D,"vertical"),i=O(D,"verticalGap")||0,u=O(D,"align"),j=O(D,"vAlign"),V=O(D,"decoration"),S=O(D,"letterGap")||0,J=O(D,"wrap"),Y=O(D,"borderWidth"),s=O(D,"borderColor"),h=nd(L,T);if(H?(o=No(w,H,t,!1,_),w.restore()):o=t(D,Wq),!H&&f&&(o=m.createGradient(w,f,o||m.labelColor,Z||g.imageGradient,_.x,_.y,_.width,_.height)),Y&&Jm(s)&&(s=No(w,s,t,!1,_),w.restore()),K){null==i&&(i=1);var X,c,W,P=[],M=[];X=J?Jh(T,_.height,L,S,K,i):[T],w.textBaseline=Ih,w.font=L,X.forEach(function(b){for(var _=b.length,G=0,r=(_-1)*i,K=0;_>K;K++){var s=w.measureText(b[K]);P.push(s),r+=s.fontBoundingBoxDescent||h.height,G=$(G,s.width)}M.push({width:G,height:r})});var R=(X.length-1)*S;M.forEach(function(y){R+=y.width}),c=u&&u!==Mq?u===ze?_.x+_.width-R:_.x+(_.width-R)/2:_.x;var a=0;X.forEach(function(d,E){var l=M[E],C=d.length;W=j&&j!==rn?j===Ih?_.y:_.y+_.height-l.height:_.y+(_.height-l.height)/2;for(var z=0;C>z;z++){var v=d[z],D=P[a],K=D.fontBoundingBoxDescent||h.height;He(w,v,L,o,{x:c,y:W,width:l.width,height:K},Gp,j,V,S,Y,s),W+=K+i,a++}c+=l.width+S})}else{var X=J?Jh(T,_.width,L,S,K,i):T.split("\n"),r=X.length;if(r>1){var I=nd(L,T),Q=I.height,F=r*Q+i*(r-1),U=zs(_);return j&&j!==rn?j===Vd&&(U.y=_.y+_.height-F):U.y=_.y+(_.height-F)/2,U.height=F,Bc(w,X,U,L,o,u||Mq,V,S,Y,s),void 0}He(w,T,L,o,_,u,j,V,S,Y,s)}}},E=function(M,W){rl(w,t(M,Wq),W.x,W.y,W.width,W.height,O(M,"width"))},e=function(s,S){var n=O(s,dl),r=0;if(n&&(n.forEach(function(V){r+=V}),r>0)){for(var f=O(s,"colors")||bf,q=O(s,"startAngle")||0,l=O(s,"hollow"),i=O(s,dk),J=O(s,Ac),L=O(s,Mf),e=i?new An:z,B=S.x,$=S.y,y=S.width,o=S.height,A=B+y/2,h=$+o/2,_=H(y,o)/2,p=0,T=0;T<n.length;T++){var x=n[T],k=Q*x/r,G=q+k;if(w.fillStyle=f[p++],p===f.length&&(p=0),w.beginPath(),l){var U=A+c(q)*_/2,b=h+N(q)*_/2,C=A+c(G)*_,M=h+N(G)*_;w.moveTo(U,b),w.arc(A,h,_/2,q,G,!1),w.lineTo(C,M),w.arc(A,h,_,G,q,!0)}else w.moveTo(A,h),w.arc(A,h,_,G,q,!0);e&&(k=(q+G)/2,e.add({text:Qr(i)?i(x,T,r,I):x,x:A+.75*c(k)*_,y:h+.75*N(k)*_})),w.closePath(),w.fill(),q=G}e&&e.each(function(r){Rd(w,r.text,J,L,r.x,r.y,0,0,Gp)})}},P=function(D,v){var G=O(D,Rl);if(G&&G.length>0){var R=G.length,V=O(D,dk),g=O(D,Ac),r=O(D,Mf),o=V?new An:z,l=O(D,"minValue")||0,T=O(D,"maxValue");if(T==z&&(T=0,G.forEach(function(Q){O(Q,dl).forEach(function(d){T=$(T,d)})})),l===T)return;for(var P=v.height/(T-l),H=v.y+T*P,C=O(G[0],dl).length,A=v.width/(3*C+1),k=2*A/R,s=0,U=0;R>U;U++)for(var E=G[U],p=O(E,Wq),x=O(E,"colors"),q=O(E,dl),d=0;C>d;d++){x?w.fillStyle=x[d]:p?w.fillStyle=p:(w.fillStyle=bf[s++],s===bf.length&&(s=0));var m=q[d],W=m*P,b=v.x+(1+3*d)*A+U*k;if(rr(w,b,H-W,k,W),o){var X=Qr(V)?V(m,d,E,I):m,Y=nd(g,X).height;o.add({x:b,y:H-W-Y,width:k,height:Y,text:X})}}o&&o.each(function(Q){Rd(w,Q.text,g,r,Q.x,Q.y,Q.width,Q.height,Gp)})}},v=function(F,o){var e=O(F,Rl);if(e&&e.length>0){var i=e.length,L=O(e[0],dl).length,P=o.width/(3*L+1),M=0,s=O(F,"maxValue"),X=O(F,dk),m=O(F,Ac),d=O(F,Mf),a=X?new An:z;if(s==z){s=0;for(var W=0;L>W;W++){for(var y=0,T=0;i>T;T++)y+=O(e[T],dl)[W];s=$(s,y)}}if(s>0){for(var W=0;L>W;W++)for(var n=o.y+o.height,T=0;i>T;T++){var V=e[T],K=O(V,Wq),g=O(V,dl)[W],U=g/s*o.height;K?w.fillStyle=K:(w.fillStyle=bf[M++],M===bf.length&&(M=0)),n-=U;var u={x:o.x+(1+3*W)*P,y:n,width:2*P,height:U};rr(w,u.x,u.y,u.width,u.height),a&&(u.text=Qr(X)?X(g,W,V,I):g,a.add(u))}a&&a.each(function(c){Rd(w,c.text,m,d,c.x,c.y,c.width,c.height,Gp)})}}},y=function(P,Q){var m=O(P,Rl);if(m&&m.length>0){for(var g=m.length,L=O(m[0],dl).length,j=Q.width/(3*L+1),h=0,p=O(P,dk),y=O(P,Ac),v=O(P,Mf),J=p?new An:z,Y=0;L>Y;Y++){for(var s=0,n=0;g>n;n++)s+=O(m[n],dl)[Y];if(s>0){var F=Q.y+Q.height;for(n=0;g>n;n++){var E=m[n],H=O(E,Wq),X=O(E,dl)[Y],k=X/s*Q.height;H?w.fillStyle=H:(w.fillStyle=bf[h++],h===bf.length&&(h=0)),F-=k;var i={x:Q.x+(1+3*Y)*j,y:F,width:2*j,height:k};rr(w,i.x,i.y,i.width,i.height),J&&(i.text=Qr(p)?p(X,Y,E,I):X,J.add(i))}}}J&&J.each(function(i){Rd(w,i.text,y,v,i.x,i.y,i.width,i.height,Gp)})}},s=function(u,c){var k=O(u,Rl);if(k&&k.length>0){var m=k.length,j=O(u,"minValue")||0,X=O(u,"maxValue");if(X==z&&(X=0,k.forEach(function(c){O(c,dl).forEach(function(d){X=$(X,d)
})})),j===X)return;for(var F=c.height/(X-j),M=c.y+X*F,h=O(k[0],dl).length,t=c.width/(3*h+1),f=0,x=O(u,"lineWidth")||2,R=O(u,"line3d"),d=O(u,"linePoint"),o=O(u,dk),r=O(u,Ac),e=O(u,Mf),W=0;m>W;W++){var l=k[W],A=O(l,Wq),B=O(l,dl);A?w.strokeStyle=A:(A=w.strokeStyle=bf[f++],f===bf.length&&(f=0)),w.beginPath();for(var L=0;h>L;L++){var p=c.x+(2+3*L)*t,C=M-B[L]*F;0===L?w.moveTo(p,C):w.lineTo(p,C)}if(w.lineWidth=x,w.stroke(),R&&lf(w,A,z,x,Z),d||o){var H,E=x/2+2;for(L=0;h>L;L++){var n=B[L];if(p=c.x+(2+3*L)*t,C=M-n*F,Qr(d)?d(w,p,C,A,L,l,I):d&&(w.fillStyle=A,w.beginPath(),w.arc(p,C,E,0,Q,!0),w.fill()),Qr(o)?H=o(n,L,l,I):o&&(H=n),H){var D=nd(r,H).height,U=w.shadowBlur;if(U){var P=w.shadowOffsetX,K=w.shadowOffsetY,y=w.shadowColor;w.shadowOffsetX=0,w.shadowOffsetY=0,w.shadowBlur=0,w.shadowColor=z}Rd(w,H,r,e,p,C-D-E+2,0,D,Gp),U&&(w.shadowOffsetX=P,w.shadowOffsetY=K,w.shadowBlur=U,w.shadowColor=y)}}}}}},i=function(s){w=s[0],I=s[1],J=s[2],Z=s[3],Y=s[4],D=s[5]},o=function(){return[w,I,J,Z,Y,D]},a=function(b,v){var t;J&&J.getDrawableState?t=J.getDrawableState(I):J&&J.getState?t=J.getState(I):(t=I instanceof fk?I.s(sh):null,(t===B||null===t)&&(t=O(b,sh)));var C=O(v,sh);return C!==B&&null!==C&&C!==t?!1:O(v,xp)},M={border:E,image:V,text:b,pieChart:e,columnChart:P,stackedColumnChart:v,percentageColumnChart:y,lineChart:s};return function(v,H,h,c,N,b,r,e,S,C){if(H&&N&&b){var L=o();w=v,I=r,J=e,!I&&J&&J.isSelfViewEvent&&(I=J),Z=J?J._zoom?J._zoom:1:1,Y=S,D=C;var P=N,U=b;if(_d()){var $,Q,E,G,X,q,g;0===w[Bo]?_d[0]&&($=!0):$=!0,w.texureImage2D?_d[1]&&(Q=!0):Q=!0,w.texureImage3D?_d[2]&&(E=!0):E=!0,w.drawDNDState?_d[3]&&(X=!0):X=!0,w.drawRect?_d[Ac[2]]&&(g=!0):g=!0,_[gk[1]+Fd[0]+Ur[1]]?_d[Fd[0]]&&(q=!0):q=!0,Nb.widget[0]?_d[4]&&(G=!0):G=!0,$&&Q&&E&&G&&X&&q&&g&&(P=h,U=c)}if(H.tagName)return hq(pc)&&!d[pc]||w.drawImage(H,P,U,N,b),i(L),void 0;if(0==O(H,"visible"))return i(L),void 0;Y||(Y=Gq(H.color,I,J)),C||(D=Gq(H.blendMode,I,J)),hq(pc)&&!d[pc]&&(N=P,b=U);var T=To(H,I,J,N),R=Of(H,I,J,b),p={x:0,y:0,width:T,height:R,fitSize:Pp(H,I,J)},V=O(H,"clip"),s=O(H,"opacity");if(p.fitSize){var y=p.rw=Gq(H.width,I,J)||20;p.widthScale=T/y;var oo=p.rh=Gq(H.height,I,J)||20;p.heightScale=R/oo}if(w.save(),w.interactiveInfo){var Bn=w.interactiveInfo.matrix,Ke=Bn.clone();Bn.appendTranslate(P,U).appendScale(N/T,b/R),w.interactiveInfo.refRect=p}Jo(w,P,U),(T!==N||R!==b)&&w.scale(N/T,b/R),V&&(Qr(V)?V(w,T,R,I,J,H):(w.beginPath(),w.rect(0,0,T,R),w.clip())),s!=z&&(w.globalAlpha*=s),O(H,"comps").forEach(function(V){if(V.prefix){var q=sb,E=Gq(V.prefix,I,J);E&&(sb=sb+E+".")}if(0==a(H,V))return V.prefix&&(sb=q),void 0;if(Pl.splice(0,0,V),w.interactiveInfo)var s=w.interactiveInfo.matrix.clone();var h=O(V,"opacity"),g=O(V,"shadow"),Y=O(V,"type"),i=O(V,"refRect")||p,T=n(V,i);if(h!=z){var d=w.globalAlpha;w.globalAlpha*=h}if(g){var D=Z*m.devicePixelRatio,L=w.shadowOffsetX,N=w.shadowOffsetY,S=w.shadowBlur,e=w.shadowColor,Q=O(V,"shadowOffsetX"),v=O(V,"shadowOffsetY"),o=O(V,"shadowBlur"),U=t(V,"shadowColor");w.shadowOffsetX=(Q==z?f:Q)*D,w.shadowOffsetY=(v==z?f:v)*D,w.shadowBlur=(o==z?j:o)*D,w.shadowColor=U||t(Up)}if("save"===Y)w.save();else if("endClip"===Y||"restore"===Y)w.restore();else if("clip"===Y)w.save(),Ff(w,O(V,"points",x),O(V,"segments",u),!0),w.clip();else if(ui[Y]){if(T=T||{x:0,y:0,width:i.width,height:i.height},F(V,Y,T,i),V.prefix&&0===V.prefix.indexOf("ui.")&&J&&_.ui&&J instanceof _.ui.View){J._vectorCompInfo||(J._vectorCompInfo=[]);for(var y=!1,G=0;G<J._vectorCompInfo.length;G++){var R=J._vectorCompInfo[G];if(V.prefix===R.comp.prefix&&r===R.data){J._vectorCompInfo[G]={comp:V,type:Y,rect:T,compRefRect:i,data:r,image:H,transform:w.getTransform()},y=!0;break}}y||J._vectorCompInfo.push({comp:V,type:Y,rect:T,compRefRect:i,data:r,image:H,transform:w.getTransform()})}}else if(Y===Sd)F(V,Y,T,i);else if("SVGPath"===Y)k(V,Y,T);else{T=T||{x:0,y:0,width:i.width,height:i.height};var C=O(V,Qc),X=O(V,"scaleX"),b=O(V,"scaleY"),P=K(V),$=l(V,T,T,C,X,b,P);if(Qr(Y))W(V,Y),m.drawCompType(Y,w,T,V,I,J);else if(m.getCompType(Y)){var c=m.getCompType(Y),jr=c.func||c;W(V,c),m.drawCompType(jr,w,T,V,I,J)}else M[Y]?M[Y](V,T):m.getCompType(Y)===B&&bp.test(Y)&&(Ph(Y),Ar=!1);$&&A()}g&&(w.shadowOffsetX=L,w.shadowOffsetY=N,w.shadowBlur=S,w.shadowColor=e),h!=z&&(w.globalAlpha=d),w.interactiveInfo&&(w.interactiveInfo.matrix=s),V.prefix&&(sb=q),Pl.splice(0,1)}),w.interactiveInfo&&(w.interactiveInfo.matrix=Ke),w.restore(),i(L)}}}();m.getCurrentComp=function(){return Pl[0]},m.getParentComp=function(){return Pl[1]},m.getInternal=function(){return{isEnter:Ud,isEsc:Vq,isSpace:sc,isLeft:kr,isUp:jc,isRight:Zg,isDown:Cg,addMethod:Lp,superCall:mg,toPointsArray:Qf,translateAndScale:tl,appendArray:re,createWorldMatrix:ji,vec3TransformMat4:jd,setCanvas:Eg,createDiv:fo,createView:Oc,createCanvas:km,createImage:$c,initContext:rk,layout:fs,fillRect:rr,Mat:hg,drawBorder:rl,isString:hq,setBorder:tj,getPropertyValue:Zh,setPropertyValue:Ij,drawVerticalLine:ve,draw3DRect:fn,getPinchDist:vq,isSameRect:Df,getPosition:Gb,intersectionLineRect:xg,getNodeRect:Tb,getEdgeAgentPosition:tm,getEdgeHostPosition:qf,getImageWidth:To,getImageHeight:Of,initItemElement:Nk,drawPoints:Ff,createG2:Qo,closePopup:Nj,isH:Jl,createAnim:vi,createNormalMatrix:pq,makeUVMatrix:jb,toColorArray:Qk,createNormals:gq,toFloatArray:yj,glMV:Zm,glPop:nc,batchShape:xn,createNodeMatrix:vs,getShapeModel:qb,getFaceInfo:uh,transformAppend:vc,drawFaceInfo:_f,glUploadData:Cs,glUploadElementData:Wj,glDrawArray:am,glDrawElement:Ck,glBindTexture:cj,pickValueToColor:Vs,to3dPointsArray:Kj,setGLDebugMode:function(v){Ui=v},cube:function(){return{vs:On,is:lg,uv:gn}},ui:function(){return{DataUI:_l,NodeUI:Fb,EdgeUI:Im,GroupUI:zf,ShapeUI:Tg,GridUI:bn,Data3dUI:jt,Node3dUI:kt,Shape3dUI:nt}},getInternalVersion:function(){return"U2FsdGVkX1+e6W1MkPh+iprmEKVHOHjfkqE86qgDuss="},getDragger:function(){return es},addMSMap:function(u){Lp(Yh,u)},k:V,overrideTimerFunc:function($,M){sg=_.Default.callLater=$,Ig=_.Default.cancelLater=M},canEnterEditDetailMode:qi,addEventListener:C,removeEventListener:v,createGradientByPackedData:No}},function(n){function J(y,l){y!=z&&(l==z&&Xe!=typeof y?this._54O(y,256):this._54O(y,l))}function r(){return new J(z)}function b(B,z,b,D,Q,$){for(;--$>=0;){var y=z*this[B++]+b[D]+Q;Q=e(y/67108864),b[D++]=67108863&y}return Q}function G(t,z,p,W,Z,J){for(var L=32767&z,V=z>>15;--J>=0;){var q=32767&this[t],f=this[t++]>>15,S=V*q+f*L;q=L*q+((32767&S)<<15)+p[W]+(1073741823&Z),Z=(q>>>30)+(S>>>15)+V*f+(Z>>>30),p[W++]=1073741823&q}return Z}function B(E,F,n,H,s,C){for(var h=16383&F,m=F>>14;--C>=0;){var o=16383&this[E],B=this[E++]>>14,O=m*o+B*h;o=h*o+((16383&O)<<14)+n[H]+s,s=(o>>28)+(O>>14)+m*B,n[H++]=268435455&o}return s}function d(O){return zj.charAt(O)}function o(Y,S){var J=Bl[Y.charCodeAt(S)];return J==z?-1:J}function w(y){for(var H=this.t-1;H>=0;--H)y[H]=this[H];y.t=this.t,y.s=this.s}function P(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+this.DV:this.t=0}function D(c){var q=r();return q._58O(c),q}function L(s,U){var b,L=this;if(16==U)b=4;else if(8==U)b=3;else if(256==U)b=8;else if(2==U)b=1;else if(32==U)b=5;else{if(4!=U)return L.fromRadix(s,U),void 0;b=2}L.t=0,L.s=0;for(var Q=s.length,i=!1,T=0;--Q>=0;){var V=8==b?255&s[Q]:o(s,Q);0>V?"-"==s.charAt(Q)&&(i=!0):(i=!1,0==T?L[L.t++]=V:T+b>L.DB?(L[L.t-1]|=(V&(1<<L.DB-T)-1)<<T,L[L.t++]=V>>L.DB-T):L[L.t-1]|=V<<T,T+=b,T>=L.DB&&(T-=L.DB))}8==b&&0!=(128&s[0])&&(L.s=-1,T>0&&(L[L.t-1]|=(1<<L.DB-T)-1<<T)),L._57O(),i&&J.ZERO._78O(L,L)}function y(){for(var A=this,$=A.s&A.DM;A.t>0&&A[A.t-1]==$;)--A.t}function h(Y){var f=this;if(f.s<0)return"-"+f._85O()[qi](Y);var Z;if(16==Y)Z=4;else if(8==Y)Z=3;else if(2==Y)Z=1;else if(32==Y)Z=5;else{if(4!=Y)return f.toRadix(Y);Z=2}var j,h=(1<<Z)-1,g=!1,q="",M=f.t,K=f.DB-M*f.DB%Z;if(M-->0)for(K<f.DB&&(j=f[M]>>K)>0&&(g=!0,q=d(j));M>=0;)Z>K?(j=(f[M]&(1<<K)-1)<<Z-K,j|=f[--M]>>(K+=f.DB-Z)):(j=f[M]>>(K-=Z)&h,0>=K&&(K+=f.DB,--M)),j>0&&(g=!0),g&&(q+=d(j));return g?q:"0"}function m(){var F=r();return J.ZERO._78O(this,F),F}function U(){return this.s<0?this._85O():this}function x(q){var F=this,X=F.s-q.s;if(0!=X)return X;var A=F.t;if(X=A-q.t,0!=X)return F.s<0?-X:X;for(;--A>=0;)if(0!=(X=F[A]-q[A]))return X;return 0}function s(Q){var e,f=1;return 0!=(e=Q>>>16)&&(Q=e,f+=16),0!=(e=Q>>8)&&(Q=e,f+=8),0!=(e=Q>>4)&&(Q=e,f+=4),0!=(e=Q>>2)&&(Q=e,f+=2),0!=(e=Q>>1)&&(Q=e,f+=1),f}function g(){var I=this;return I.t<=0?0:I.DB*(I.t-1)+s(I[I.t-1]^I.s&I.DM)}function M(G,n){var V;for(V=this.t-1;V>=0;--V)n[V+G]=this[V];for(V=G-1;V>=0;--V)n[V]=0;n.t=this.t+G,n.s=this.s}function I(d,G){for(var Q=d;Q<this.t;++Q)G[Q-d]=this[Q];G.t=$(this.t-d,0),G.s=this.s}function p(u,c){var x,m=this,k=u%m.DB,s=m.DB-k,q=(1<<s)-1,X=e(u/m.DB),I=m.s<<k&m.DM;for(x=m.t-1;x>=0;--x)c[x+X+1]=m[x]>>s|I,I=(m[x]&q)<<k;for(x=X-1;x>=0;--x)c[x]=0;c[X]=I,c.t=m.t+X+1,c.s=m.s,c._57O()}function k(C,y){var g=this;y.s=g.s;var l=e(C/g.DB);if(l>=g.t)return y.t=0,void 0;var o=C%g.DB,r=g.DB-o,I=(1<<o)-1;y[0]=g[l]>>o;for(var W=l+1;W<g.t;++W)y[W-l-1]|=(g[W]&I)<<r,y[W-l]=g[W]>>o;o>0&&(y[g.t-l-1]|=(g.s&I)<<r),y.t=g.t-l,y._57O()}function C(_,C){for(var F=this,w=0,s=0,N=H(_.t,F.t);N>w;)s+=F[w]-_[w],C[w++]=s&F.DM,s>>=F.DB;if(_.t<F.t){for(s-=_.s;w<F.t;)s+=F[w],C[w++]=s&F.DM,s>>=F.DB;s+=F.s}else{for(s+=F.s;w<_.t;)s-=_[w],C[w++]=s&F.DM,s>>=F.DB;s-=_.s}C.s=0>s?-1:0,-1>s?C[w++]=F.DV+s:s>0&&(C[w++]=s),C.t=w,C._57O()}function v(M,e){var m=this.abs(),D=M.abs(),j=m.t;for(e.t=j+D.t;--j>=0;)e[j]=0;for(j=0;j<D.t;++j)e[j+m.t]=m.am(0,D[j],e,j,0,m.t);e.s=0,e._57O(),this.s!=M.s&&J.ZERO._78O(e,e)}function A(v){for(var p=this.abs(),w=v.t=2*p.t;--w>=0;)v[w]=0;for(w=0;w<p.t-1;++w){var I=p.am(w,p[w],v,2*w,0,1);(v[w+p.t]+=p.am(w+1,2*p[w],v,2*w+1,I,p.t-w-1))>=p.DV&&(v[w+p.t]-=p.DV,v[w+p.t+1]=1)}v.t>0&&(v[v.t-1]+=p.am(w,p[w],v,2*w,0,1)),v.s=0,v._57O()}function E($,M,U){var t=$.abs(),W=this;if(!(t.t<=0)){var E=W.abs();if(E.t<t.t)return M!=z&&M._58O(0),U!=z&&W._77O(U),void 0;U==z&&(U=r());var u=r(),h=W.s,A=$.s,I=W.DB-s(t[t.t-1]);I>0?(t._44O(I,u),E._44O(I,U)):(t._77O(u),E._77O(U));var Y=u.t,S=u[Y-1];if(0!=S){var k=S*(1<<W.F1)+(Y>1?u[Y-2]>>W.F2:0),X=W.FV/k,C=(1<<W.F1)/k,y=1<<W.F2,q=U.t,R=q-Y,m=M==z?r():M;for(u._59O(R,m),U._52O(m)>=0&&(U[U.t++]=1,U._78O(m,U)),J.ONE._59O(Y,m),m._78O(u,u);u.t<Y;)u[u.t++]=0;for(;--R>=0;){var H=U[--q]==S?W.DM:e(U[q]*X+(U[q-1]+y)*C);if((U[q]+=u.am(0,H,U,R,0,Y))<H)for(u._59O(R,m),U._78O(m,U);U[q]<--H;)U._78O(m,U)}M!=z&&(U._45O(Y,M),h!=A&&J.ZERO._78O(M,M)),U.t=Y,U._57O(),I>0&&U._46O(I,U),0>h&&J.ZERO._78O(U,U)}}}function a(s){var $=r();return this.abs()._49O(s,z,$),this.s<0&&$._52O(J.ZERO)>0&&s._78O($,$),$}function F(U){this.m=U}function O(O){return O.s<0||O._52O(this.m)>=0?O.mod(this.m):O}function R(B){return B}function q(e){e._49O(this.m,z,e)}function t(L,D,F){L._47O(D,F),this._74O(F)}function X(r,K){r._48O(K),this._74O(K)}function i(){if(this.t<1)return 0;var L=this[0];if(0==(1&L))return 0;var v=3&L;return v=15&v*(2-(15&L)*v),v=255&v*(2-(255&L)*v),v=65535&v*(2-(65535&(65535&L)*v)),v=v*(2-L*v%this.DV)%this.DV,v>0?this.DV-v:-v}function T(H){var O=this;O.m=H,O.mp=H._50O(),O.mpl=32767&O.mp,O.mph=O.mp>>15,O.um=(1<<H.DB-15)-1,O.mt2=2*H.t}function S(e){var Z=r();return e.abs()._59O(this.m.t,Z),Z._49O(this.m,z,Z),e.s<0&&Z._52O(J.ZERO)>0&&this.m._78O(Z,Z),Z}function f(B){var j=r();return B._77O(j),this._74O(j),j}function _(Y){for(var q=this;Y.t<=q.mt2;)Y[Y.t++]=0;for(var K=0;K<q.m.t;++K){var N=32767&Y[K],V=N*q.mpl+((N*q.mph+(Y[K]>>15)*q.mpl&q.um)<<15)&Y.DM;for(N=K+q.m.t,Y[N]+=q.m.am(0,V,Y,K,0,q.m.t);Y[N]>=Y.DV;)Y[N]-=Y.DV,Y[++N]++}Y._57O(),Y._45O(q.m.t,Y),Y._52O(q.m)>=0&&Y._78O(q.m,Y)}function Z(M,o){M._48O(o),this._74O(o)}function W(x,m,S){x._47O(m,S),this._74O(S)}function nc(){return 0==(this.t>0?1&this[0]:this.s)}function _p(I,A){if(I>4294967295||1>I)return J.ONE;var $=r(),N=r(),k=A._73O(this),i=s(I)-1;for(k._77O($);--i>=0;)if(A._76O($,N),(I&1<<i)>0)A._75O(N,k,$);else{var z=$;$=N,N=z}return A.revert($)}function Dn(b,c){var I;return I=256>b||c._51O()?new F(c):new T(c),this.exp(b,I)}function xd(){var X=this;if(X.s<0){if(1==X.t)return X[0]-X.DV;if(0==X.t)return-1}else{if(1==X.t)return X[0];if(0==X.t)return 0}return(X[1]&(1<<32-X.DB)-1)<<X.DB|X[0]}function fq(l,n){return new J(l,n)}function Pn(){var n=this;n.n=z,n.e=0,n.d=z,n.p=z,n.q=z,n.dmp1=z,n.dmq1=z,n._10A=z}function Kb(r){return r._53O(this.e,this.n)}function zn(u){var R,r,b,g="",o=0;for(R=0;R<u.length&&u.charAt(R)!=_g;++R)b=hs.indexOf(u.charAt(R)),0>b||(0==o?(g+=d(b>>2),r=3&b,o=1):1==o?(g+=d(r<<2|b>>4),r=15&b,o=2):2==o?(g+=d(r),g+=d(b>>2),r=3&b,o=3):(g+=d(r<<2|b>>4),g+=d(15&b),o=0));return 1==o&&(g+=d(r<<2)),g}function tq(I){var Q=I.split(""),A=zn(I);return Q.forEach(function(g){var u=g.length;u>0&&A&&(wm+=Mm(g))}),A}function fi(R,C){var m=Oh._4O.Util._56O(R,"ss"),o={},T=0;return o.v=m==C,o.t=1,o.s=0>T?-1:0,fp=o.v,T>0?o[0]=T:-1>T?o[0]=T+o.DV:o.t=0,[m,o]}function Ti(M){var t=38,P=M.substring(0,t);if(P&&30==P.indexOf("05000420")){var O=["ss",M.substring(t)];return O}return[]}function ho(T,k){k=k.replace(gh,""),k=k.replace(/[ \n]+/g,"");var Z=fq(k,16);if(Z._55O()>this.n._55O())return 0;var J=this._37O(Z),$=J[qi](16).replace(/^1f+00/,""),I=Ti($);if(0==I.length)return!1;for(var L,g,z,P=.5,E=Zo,d=[0,.5,.75,.875,.9375],H=[],j=[],q=[],v=Q/E,Y=I[1],r=fi(T,Y)[0],f=0,o=0;f<d.length;f++){var B=0===f%2?0:.5;for(L=0;E>=L;L++)g=(L+B)*v,z=1-d[f],H.push(c(g)*P*z,-P+2*d[f]*P,-N(g)*P*z),j.push((L+B)/E,z)}for(f=0;f<d.length-1;f++){var n=f*(E+1),m=(f+1)*(E+1);for(L=0;E>L;L++)q.push(n+L,m+L+1,m+L,n+L,n+L+1,m+L+1)}return q.forEach(function(k){o+=k}),Y==r&&o>10}var gf,Ul=0xdeadbeefcafe,rq=15715070==(16777215&Ul),qi="toString",Jk="",En="nat",pp=function(){};K=n["D"+11182[qi](Y(2,5))];var oq=J.prototype;Re+=Eb.substr(0,1);var jq=n.navigator?n.navigator.appName:"";rq&&"Microsoft Internet Explorer"==jq?(oq.am=G,gf=30):rq&&"Netscape"!=jq?(oq.am=b,gf=26):(oq.am=B,gf=28),oq.DB=gf,oq.DM=(1<<gf)-1,oq.DV=1<<gf;var Mf=52;oq.FV=Y(2,Mf),oq.F1=Mf-gf,oq.F2=2*gf-Mf;var tj,db,zj="0123456789abcdefghijklmnopqrstuvwxyz",Bl=[],rl=function(f){return String.fromCharCode(f)};for(tj="0".charCodeAt(0),db=0;9>=db;++db)Bl[tj++]=db;for(tj="a".charCodeAt(0),db=10;36>db;++db)Bl[tj++]=db;for(tj="A".charCodeAt(0),db=10;36>db;++db)Bl[tj++]=db;var tk=F.prototype;tk._73O=O,tk.revert=R,tk._74O=q,tk._75O=t,tk._76O=X;var qb=T.prototype;qb._73O=S,qb.revert=f,qb._74O=_,qb._75O=W,qb._76O=Z,oq._77O=w,oq._58O=P,oq._54O=L,oq._57O=y,oq._59O=M,oq._45O=I,oq._44O=p,oq._46O=k,oq._78O=C,oq._47O=v,oq._48O=A,oq._49O=E,oq._50O=i,oq._51O=nc,oq.exp=_p,oq.toString=h,oq._85O=m,oq.abs=U,oq._52O=x,oq._55O=g,oq.mod=a,oq._53O=Dn,J.ZERO=D(0),J.ONE=D(1),oq._86O=xd;var Lg=function(d,i){var s=this;s.isPublic=!0,typeof d!==Xe?(s.n=d,s.e=i):d!=z&&i!=z&&d.length>0&&i.length>0&&(s.n=fq(d,16),s.e=Mm(i,16))};Id=function(){var Q,L,D=tq(Bf),I=D.substr(0,4),_=D.substr(4,2),E=D.substr(6,2),U=1,F=!U,r=V,Y=[],n=Be.charAt(7);if(K&&(K[qi]().indexOf(En)<0||K[Re][qi]().indexOf(En)<0||!D?Q=z:(D=new K(I-0,_-U,E-0),L=D.setHours(9),K[Re]()>L?Q=$b[n]:F=!0)),D&&Q&&Q[0]&&Q[u(.5)]&&r){var W=Ii(Q[0]),N=Ii(Q[1]);for(var f in N)Y.push(f);var R,g=0,b=W[Y[g]],q=N[Y[g++]],d=N[Y[g++]],e=N[Y[g++]],i=N[Y[g++]],X=N[Y[g++]],p=N[Y[g++]],w=W[Y[g]],P=N[Y[g++]],v=un._27O(r);if(b===q&&v&&P){R=q+d+e+i+X+p;var J=!p||p===fj;if(!J&&p)for(var s,Z=0,M=p.length;M>Z;Z++)p[Z]===yp[g]?s===fj?J=!0:s[0]===cf[5]&&fj&&fj.indexOf(s.substr(1))>=0?J=!0:s=z:(s==z?s=p[Z]:s+=p[Z],Z===M-1&&(s===fj?J=!0:s[0]===cf[5]&&fj&&fj.indexOf(s.substr(1))>=0&&(J=!0)));R&&v._31O(R,P)&&v._31O(b,w)&&J&&(!X||K[Re]()<X)&&(F=!0)}}return F||(np=Tc),n};var uf=Pn.prototype;uf._37O=Kb,uf._38O=Lg;var hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_g="=",Xf=25,Kc=10,Bf="ICJxU===",Sj=Sj||function(b,K){var r={},D=r._7A={},o=D._6A=function(){function O(){}return{_80O:function(l){O.prototype=this;var y=new O;return l&&y._5A(l),y.hasOwnProperty("_82O")||(y._82O=function(){y.$super._82O.apply(this,arguments)}),y._82O.prototype=y,y.$super=this,y},_3A:function(){var Y=this._80O();return Y._82O.apply(Y,arguments),Y},_82O:function(){},_5A:function($){for(var v in $)$.hasOwnProperty(v)&&(this[v]=$[v]);$.hasOwnProperty(qi)&&(this.toString=$.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),R=D._39O=o._80O({_82O:function(b,v){b=this._84O=b||[],this._65O=v!=K?v:4*b.length},toString:function(S){return(S||g).stringify(this)},_89O:function(g){var F=this._84O,c=g._84O,H=this._65O,J=g._65O;if(this._57O(),H%4)for(var E=0;J>E;E++){var V=255&c[E>>>2]>>>24-8*(E%4);F[H+E>>>2]|=V<<24-8*((H+E)%4)}else if(c.length>65535)for(var E=0;J>E;E+=4)F[H+E>>>2]=c[E>>>2];else F.push.apply(F,c);return this._65O+=J,this},_57O:function(){var O=this._84O,l=this._65O;O[l>>>2]&=4294967295<<32-8*(l%4),O.length=u(l/4)},_88O:function(){var H=o._88O.call(this);return H._84O=this._84O.slice(0),H},_87O:function(S){for(var B=[],u=0;S>u;u+=4)B.push(0|4294967296*Um);return new R._82O(B,S)}}),L=r._2A={},g=L._69O={stringify:function(D){var o,i=D._84O,r=D._65O,S=[];for(o=0;r>o;o++){var K=255&i[o>>>2]>>>24-8*(o%4);S.push((K>>>4).toString(16)),S.push((15&K).toString(16))}return S.join("")},_68O:function(N){for(var Y=N.length,M=[],O=0;Y>O;O+=2)M[O>>>3]|=Mm(N.substr(O,2),16)<<24-4*(O%8);return new R._82O(M,Y/2)}},E=L._8A={stringify:function(S){var V,i=S._84O,B=S._65O,w=[];for(V=0;B>V;V++){var $=255&i[V>>>2]>>>24-8*(V%4);w.push(rl($))}return w.join("")},_68O:function(B){var q,I=B.length,F=[];for(q=0;I>q;q++)F[q>>>2]|=(255&B.charCodeAt(q))<<24-8*(q%4);return new R._82O(F,I)}},O=L._9A={stringify:function(w){try{return decodeURIComponent(escape(E.stringify(w)))}catch(B){throw new Error("")}},_68O:function(D){return E._68O(unescape(encodeURIComponent(D)))}},l=D._32O=o._80O({_1A:function(){this._83O=new R._82O,this._23O=0},_33O:function(l){typeof l==Xe&&(l=O._68O(l)),this._83O._89O(l),this._23O+=l._65O},_25O:function(N){var P=this._83O,t=P._84O,W=P._65O,k=this._79O,V=4*k,A=W/V;A=N?u(A):$((0|A)-this._22O,0);var L=A*k,O=H(4*L,W);if(L){for(var z=0;L>z;z+=k)this._20O(t,z);var U=t.splice(0,L);P._65O-=O}return new R._82O(U,O)},_88O:function(){var m=o._88O.call(this);return m._83O=this._83O._88O(),m},_22O:0});D._66O=l._80O({cfg:o._80O(),_82O:function(y){this.cfg=this.cfg._80O(y),this._1A()},_1A:function(){l._1A.call(this),this._34O()},_81O:function(D){return this._33O(D),this._25O(),this},_72O:function(H){H&&this._33O(H);var j=this._21O();return j},_79O:16,_26O:function(O){return function(D,$){return new O._82O($)._72O(D)}},_19O:function(j){return function(l,x){return new p._71O._82O(j,x)._72O(l)}}});var p=r._67O={};return r}();!function(){var s=Sj,z=s._7A,Z=z._39O,V=z._66O,f=s._67O,T=[],P=[];!function(){function W(h){for(var r=l(h),T=2;r>=T;T++)if(!(h%T))return!1;return!0}function N(m){return 0|4294967296*(m-(0|m))}for(var s=2,d=0;64>d;)W(s)&&(8>d&&(T[d]=N(Y(s,.5))),P[d]=N(Y(s,1/3)),d++),s++}();var h=[],M=f._41O=V._80O({_34O:function(){this._64O=new Z._82O(T.slice(0))},_20O:function(N,d){for(var b=this._64O._84O,R=b[0],u=b[1],B=b[2],I=b[3],J=b[4],e=b[5],W=b[6],j=b[7],T=0;64>T;T++){if(16>T)h[T]=0|N[d+T];else{var E=h[T-15],V=(E<<25|E>>>7)^(E<<14|E>>>18)^E>>>3,c=h[T-2],v=(c<<15|c>>>17)^(c<<13|c>>>19)^c>>>10;h[T]=V+h[T-7]+v+h[T-16]}var x=J&e^~J&W,o=R&u^R&B^u&B,F=(R<<30|R>>>2)^(R<<19|R>>>13)^(R<<10|R>>>22),k=(J<<26|J>>>6)^(J<<21|J>>>11)^(J<<7|J>>>25),X=j+k+x+P[T]+h[T],_=F+o;j=W,W=e,e=J,J=0|I+X,I=B,B=u,u=R,R=0|X+_}b[0]=0|b[0]+R,b[1]=0|b[1]+u,b[2]=0|b[2]+B,b[3]=0|b[3]+I,b[4]=0|b[4]+J,b[5]=0|b[5]+e,b[6]=0|b[6]+W,b[7]=0|b[7]+j},_21O:function(){var y=this._83O,o=y._84O,T=8*this._23O,n=8*y._65O;return o[n>>>5]|=128<<24-n%32,o[(n+64>>>9<<4)+14]=e(T/4294967296),o[(n+64>>>9<<4)+15]=T,y._65O=4*o.length,this._25O(),this._64O},_88O:function(){var y=V._88O.call(this);return y._64O=this._64O._88O(),y}});s._41O=V._26O(M),s._42O=V._19O(M)}();var gh=new RegExp("");gh.compile("[^0-9a-f]","gi"),Pn._28O=-1,Pn._29O=-2,uf._31O=ho,uf._63O=ho,Pn._43O=-2;var dl=new function(){var O=this;O._5O=function(p,b){if("8"!=p.substring(b+2,b+3))return 1;var w=Mm(p.substring(b+3,b+4));return 0==w?-1:w>0&&10>w?w+1:-2},O._13O=function($,o){var a=O._5O($,o);return 1>a?"":$.substring(o+2,o+2+2*a)},O._12O=function(s,Y){var k=O._13O(s,Y);if(""==k)return-1;var z;return z=Mm(k.substring(0,1))<8?new J(k,16):new J(k.substring(2),16),z._86O()},O._6O=function(N,j){var $=O._5O(N,j);return 0>$?$:j+2*($+1)},O._11O=function(r,U){var m=O._6O(r,U),l=O._12O(r,U);return r.substring(m,m+2*l)},O._10O=function(p,V){var W=O._6O(p,V),l=O._12O(p,V);return W+2*l},O._7O=function(P,L){var C=[],r=O._6O(P,L);C.push(r);for(var X=O._12O(P,L),v=r,B=0;;){var V=O._10O(P,v);if(V==z||V-r>=2*X)break;if(B>=200)break;C.push(V),v=V,B++}return C}};if(dl._90O=rl(Kc+24),dl._91O=j+rl(Kc*Kc+8),Oh==z||!Oh)var Oh={};Oh._4O!=z&&Oh._4O||(Oh._4O={});var Pr=Oh._4O;Oh._4O.Util=new function(){var d=this;d._56O=function(V){var A=new Oh._4O._3O;return A._30O(V)},d._4A=function(L){var o=new Oh._4O._3O;return o._36O(L)},d._11A=function(J){var p=new Pr._3O;return p._30O(J)}},Oh._4O._3O=function(){var f=this;f._8O=function(a,p){if("ss"==a&&"cj"==p){try{f.md=Sj._67O._41O._3A()}catch(B){pp(Jk)}f._24O=function(g){f.md._81O(g)},f._35O=function(m){var H=Sj._2A._69O._68O(m);f.md._81O(H)},f._60O=function(){var j=f.md._72O();return j[qi](Sj._2A._69O)},f._30O=function(B){return f._24O(B),f._60O()},f._36O=function(o){return f._35O(o),f._60O()}}},f._24O=function(){pp(Jk)},f._35O=function(){pp(Jk)},f._60O=function(){pp(Jk)},f._30O=function(){pp(Jk)},f._36O=function(){pp(Jk)},f._8O("ss","cj")},Wl=function(p){var h=Po[Nl[7]],W=1,E=!1;if(yn.a!=Po[tg])return yn.a;if(yn.forEach(function(A){W*=A}),p>W){if(h&&h[1]&&h[0]){var i=h[0],H=h[1];H=H.split(dl._90O),i=i.split(dl._90O);var w=H[3],x=i[3],k=H[7],q=H[11],M=H[15],t=H[19],N=H[23],A=H[27],j=i[7],U=w+k+q+M+t+N,K=N?!1:!0,G=x===w;if(N){var $=N&&N.split(Tn("firefox")[3]);if($)for(var o=0;o<$.length;o++){var y=$[o];if(y[0]===rm[8]&&(y=y.substring(1)),yf.indexOf(y)>=0){K=!0;break}}}E=G&&Gn()(x,j)&&Gn()(U,A)&&K&&(!t||t>p),E&&q.indexOf($h.length)>=0&&(Wl[$h.length]=$h),E&&q.indexOf($h.length+1)>=0&&(Wl[$h.length+1]=$h),E&&q.indexOf($h.length+3)>=0&&(Wl[$h.length+3]=$h),E&&q.indexOf(mj.length)>=0&&(Wl[mj.length]=mj)}E||(_l.prototype._42=Oq)}else E=!0,Wl[$h.length]=Wl[$h.length+1]=Wl[$h.length+3]=Wl[mj.length]=$h;return yn.a=E,E},Xf=String.fromCharCode(Xf+20);var Ci=function(P){return P=P.replace(gh,Jk),P=P.replace(/[ \n]+/g,Jk)},pc="30",xn="06",_n="02",Jj="03",Vc=fq,Cf=/^1f+00/,un=function(){var j;return j={_18O:function(I){var z=I,p=z.replace(/\s+/g,""),t=zn(p);return t},_14O:function(K){var p=this._18O(K),x=this._15O(p);return x},_15O:function(n){var e=this._17O(n);if("2a864886f70d010101"==e._61O){var I=this._16O(e.key),A=new Pn;return A._38O(I.n,I.e),A}pp(Jk)},_16O:function(s){var j={};s.substr(0,2)!=pc&&pp(Jk);var I=dl._7O(s,0);return 2!=I.length&&pp(Jk),s.substr(I[0],2)!=_n&&pp(Jk),j.n=dl._11O(s,I[0]),s.substr(I[1],2)!=_n&&pp(Jk),j.e=dl._11O(s,I[1]),j},_17O:function(y){var E={};E._40O=z;var U=dl._7O(y,0);2!=U.length&&pp(Jk);var I=U[0];y.substr(I,2)!=pc&&pp(Jk);var c=dl._7O(y,I);return 2!=c.length&&pp(Jk),y.substr(c[0],2)!=xn&&pp(Jk),E._61O=dl._11O(y,c[0]),y.substr(c[1],2)==xn?E._40O=dl._11O(y,c[1]):y.substr(c[1],2)==pc&&(E._40O={},E._40O.p=dl._70O(y,c[1],[0],_n),E._40O.q=dl._70O(y,c[1],[1],_n),E._40O.g=dl._70O(y,c[1],[2],_n)),y.substr(U[1],2)!=Jj&&pp(Jk),E.key=dl._11O(y,U[1]).substr(2),E}},j._17O?j:z}(),ir=un._27O=function(k){return un._14O(k)};Gn=function(){return function(a,D){if(a&&D){D=Ci(D);var p=Vc(D,Y(2,4)),r=this;if(!r||!r.n||p._55O()>r.n._55O())return 0;var z=r._37O(p),K=z[qi](Y(2,4)).replace(Cf,""),S=Ti(K);if(0==S.length)return!1;var B=S[0],n=S[1],$=function($){return Oh._4O.Util._56O($,B)},P=$(a);return n==P}}.bind(ir(V))};var xc,hr;return function(){var n=lr.length-cd.length;if(n>0)for(var C=0;n>C;C++)xc=Pr.Util,hr=Ci}(),Gi=function(t,F){F=hr(F);var L=ir(Vo),$=Eq.length,p=2*$,N=Vc(F,Y($,p)),r=L,B=!0;if(r){var z=r[Ip[0]];z&&N._55O()<=z._55O()&&(B=!1)}if(B)return 0;var i=r._37O(N),O=i[qi](Y($,p)).replace(Cf,""),b=Ti(O);if(0==b.length)return!1;var y=b[0],w=b[1],n=xc._11A(t,y);return w==n},un}(d,S),Lp(m,{load:function(){var g={},u=function(O){return O?"c_"+(O.sync?"1":"0")+"_"+(O.post?"1":"0")+"_"+(O.responseType||"H")+"_"+(O.mimeType||"H")+"_"+(O.data?JSON.stringify(O.data):"H"):""};return function(A,T,b){var p,o=g[A],M=u(b);return o&&(p=o[M])?(p.push(T),void 0):(g[A]||(o=g[A]={count:0}),p=o[M]=[T],o.count++,m.xhrLoad(A,function(Z){delete o[M],o.count--,o.count||delete g[A],p.forEach(function(s){s(Z)})},b),void 0)}}(),asyncEach:function(t,X,i){"function"!=typeof i&&(i=Function.prototype);var h=new Array(t.length),d=0,K=!1;t.forEach(function(q,N){X(q,function(I,B){return K?void 0:I?(K=!0,i(null)):(h[N]=B,d++,d===t.length?i(h):void 0)})})},xhrLoad:function(K,H,u){var X=!1;Jm(K)||(X=!0,K=[K]),u=u||{};var x=u.sync,s=null,g=u.method||"GET";return u.post&&(g="POST"),u.method=g,m.asyncEach(K,function(l,V){if(l=m.beforeLoadURL(l),l.data)V(null,l.data);else{u.url=encodeURI(l);var i=new Bp;i.onload=function(){200===this.status||0===this.status?V(null,i.getResponseText()):V(!0)},i.onerror=function(){V(!0)},i.send(u)}},function(Y){var T="function"==typeof H;(T||x)&&(s=X&&Y?Y[0]:Y,T&&H(s))}),x?s:void 0}});var gd=S.setPrototypeOf||function(v,n){return v.__proto__=n,v},Xk=S.getPrototypeOf||function(q){return q.__proto__},Lj=S.freeze;S.isFrozen;var Wk=function(){var v=function(U){return U};return function(z){return z&&z.length?new Function("o",["return o['",z.join("']['"),"'];"].join("")):v}}(),pr=function(){var $=function(T,k){return T=k};return function(d){return d&&d.length?new Function("o","v",["return o['",d.join("']['"),"'] = v;"].join("")):$}}();!function(){function j(k){var b=[];if(k)for(var $;($=w.exec(k))!=B;)b.push($[1]);return b}function o(s,V){var U=g.exec(V);this._cell=s,this._key=U[1],this._format=U[2],this._style=j(U[3])}function Y(V){for(var d=this._cellList=[],Q=this._paramList=[],J=V.split($),S=0,n=J.length;n>S;++S){var v=J[S];if("{{"!==v)for(var A=v.split(C),P=0,b=A.length;b>P;++P){var O=A[P];C.test(O)?(Q.push(new o(d.length,O)),d.push(B)):O.length>0&&d.push(O)}else d.push("{")}this._formatList=this._cellList.slice(0)}var s={},A={},$=/(\{\{)/,C=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,g=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,w=/\&([\w\.]*)/g;Y.prototype._73O=function(M){for(var j=this._paramList.length;j--;){var x=this._paramList[j],G=M[Mm(x._key)+1],k=A[x._format];k&&(G=k(G,x._style)),this._formatList[x._cell]=G}return this._formatList.join("")},Y.prototype._map=function(Q){for(var v=this._paramList.length;v--;){var d=this._paramList[v],a=Q[d._key],o=A[d._format];o&&(a=o(a,d._style)),this._formatList[d._cell]=a}return this._formatList.join("")};var J=function(G){var t=s[G];return t||(s[G]=t=new Y(G)),t._73O(arguments)};return J.map=function(I,U){var g=s[I];return g||(s[I]=g=new Y(I)),g._map(U)},J.setValueFormat=function(h,l){A[h]=l},J.gc=function(){s.length=0},J.__parsed=s,J}();var Ti=function(){function M(C,R,H,s){var c=C?C.path.slice(0):[];R&&c.push(R),this.desc=H,this.name=R,this.path=Lj(c),this.getter=Wk(c),this.setter=pr(c),this.isLeaf=s,this.parent=C,this.children=[],this.childMap={}}return M.create=function(){function e(G,c,V,P){var L=P(V),Q=new M(G,c,V,L);if(!L){for(var k=Q.children,t=Q.childMap,C=S.keys(V),o=0,x=C.length;x>o;++o){var w=C[o],I=e(Q,w,V[w],P);k.push(I),t[I.name]=I}Q.children=Lj(k),Q.childMap=Lj(t)}return Lj(Q),Q}return function(c,Q){return e(B,B,c,Q)}}(),M.prototype.forEach=function(Q,s){for(var K=this.children,n=0,I=K.length;I>n;++n){var X=K[n];Q(X,s)}},M}(),Lj=S.freeze,fq={main:{mask:1,priority:m.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:m.cameraPriority.top,ignore:!1}},Se="main",wq=fq[Se].mask,Gf=function(W,B){W=W||0;var Q;if(B in fq)Q=fq[B].mask;else{if(!(32>Bm))throw new Error("Only 31 render layer can be defined.");fq[B]={mask:1<<Bm++,priority:fq[Se].priority},Q=fq[B].mask,Ql=Ef(S.keys(fq)),Bm=Ql.length}return W|=Q},Ab=function(X){var F=0;if("string"==typeof X)F=Gf(F,X);else for(var H=0,r=X.length;r>H;++H)F=Gf(F,X[H]);return F},bk=function(C,X){return C&&X&&C&X},Ef=function(n){return n.sort(function(c,E){return fq[c].priority-fq[E].priority})},Ql=Ef(S.keys(fq)),Bm=Ql.length;Lp(m,{setRenderLayerInfo:function(p,W){if(Gf(0,p),W){for(var U in W)fq[p][U]=W[U];W.priority&&(Ql=Ef(S.keys(fq)))}},getRenderLayerInfo:function(o){return fq[o]}},!0);var An=_.List=function(){this._as=[];var i,A,O=arguments.length;if(1===O){var e=arguments[0];if(pj(e)&&(e=e._as),Jm(e))for(A=e.length,i=0;A>i;i++)this._as.push(e[i]);else e!=z&&this._as.push(e)}else if(O>1)for(i=0;O>i;i++)this._as.push(arguments[i])};Fh("List",S,{forEach:function(N,C){this.each(N,C)},push:function(){for(var h=0;h<arguments.length;h++)this.add(arguments[h])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(c,N){return N===B?this._as.push(c):this._as.splice(N,0,c)},addAll:function(z){pj(z)&&(z=z._as),Jm(z)?re(this._as,z):this._as.push(z)},get:function(G){return this._as[G]},slice:function(J,N){return new An(this._as.slice(J,N))},remove:function(u){var Z=this._as.indexOf(u);return Z>=0&&Z<this._as.length&&this.removeAt(Z),Z},removeAt:function(N){return this._as.splice(N,1)[0]},set:function(e,C){return this._as[e]=C},clear:function(){return this._as.splice(0,this._as.length)},contains:function(z){return this._as.indexOf(z)>=0},indexOf:function(b){return this._as.indexOf(b)},each:function(K,l){for(var m=0,B=this._as.length;B>m;m++){var u=this._as[m];l?K.call(l,u,m,this):K(u,m,this)}},reverseEach:function(j,W){for(var c=this._as.length-1;c>=0;c--){var V=this._as[c];W?j.call(W,V):j(V)}},getArray:function(){return this._as},toArray:function(g,J){if(g){for(var G,y=[],T=0,W=this._as.length;W>T;T++)G=this._as[T],J?g.call(J,G)&&y.push(G):g(G)&&y.push(G);return y}return this._as.concat()},toList:function(m,L){if(m){for(var w,U=new An,y=0,I=this._as.length;I>y;y++)w=this._as[y],L?m.call(L,w)&&U.add(w):m(w)&&U.add(w);return U}return new An(this)},reverse:function(){this._as.reverse()},sort:function(o){return this._as.sort(o?o:lp),this},toString:function(){return this._as.toString()}}),S.defineProperties(An.prototype,{length:{get:function(){return this._as.length},set:function(z){this._as.length=z}}});var Yg=new An;Lp(Yg,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:uo,each:uo,reverseEach:uo,toArray:function(){return[]},toList:function(){return new An},add:gm,addAll:gm,set:gm,remove:gm,removeAt:gm,clear:gm});var Ji=_.Notifier=function(){this._f=0};Fh("Notifier",S,{contains:function(l,X){if(this._ls)for(var U,I=0,N=this._ls.size();N>I;I++)if(U=this._ls.get(I),l===U.l&&X===U.s)return!0;return!1},add:function(Z,p,n){var m=this,K={l:Z,s:p,a:n};m._ls||(m._ls=new An),m._f?(m._as||(m._as=new An),m._as.add(K)):K.a?m._ls.add(K,0):m._ls.add(K)},remove:function(f,A){var r=this;r._ls&&(r._f?(r._rs||(r._rs=new An),r._rs.add({l:f,s:A})):r._remove(f,A))},_remove:function(Z,L){for(var O,Y=this._ls,S=0,G=Y.size();G>S;S++)if(O=Y.get(S),O.l===Z&&O.s===L)return Y.removeAt(S),void 0},fire:function(O){var J=this,Y=J._ls;if(J._b=1e4,Y){++J._f;try{for(var I,p=0,G=Y.size();G>p;p++)I=Y.get(p),I.s?I.l.call(I.s,O):I.l(O)}catch(O){Vr(function(){throw O})}finally{if(--J._f)return;if(J._rs){for(G=J._rs.size(),p=0;G>p;p++)I=J._rs.get(p),J._remove(I.l,I.s);delete J._rs}if(J._as){for(G=J._as.size(),p=0;G>p;p++)I=J._as.get(p),I.a?Y.add(I,0):Y.add(I);delete J._as}}}}});var fk=_.Data=function(){this._id=Ie()};Fh("Data",S,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:z,_parent:z,_children:Yg,_childMap:z,_styleMap:z,_layer:"0",_renderLayer:Se,_renderLayerMask:wq,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||wq},getRenderLayer:function(){return this._renderLayer||Se},setRenderLayer:function(t){var P=this,l=Gf(0,t);
P._renderLayerMask=l;var y=P._renderLayer;P._renderLayer=t,P.fp("renderLayer",y,P._renderLayer)},testRenderLayer:function(Q){var V=fq[Q];return V&&bk(this._renderLayerMask,fq[Q].mask)},getUIClass:function(){return z},_22Q:function(){return z},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(E,A){var h=this;if(2===arguments.length)h.setStyle(E,A);else{if(!Th(E))return h.getStyle(E);for(var z in E)h.setStyle(z,E[z])}return h},fp:function(n,E,S,L,v){return this.firePropertyChange(n,E,S,L,v)},firePropertyChange:function(R,B,M,d,P){if(d){if(d(B,M))return!1}else if(B===M)return!1;var D=this,O=P||{};return O.property=R,O.oldValue=B,O.newValue=M,O.data=D,D._dataModel&&D._dataModel.handleDataPropertyChange(O),D.onPropertyChanged(O),!0},onPropertyChanged:function(v){var D=this,l=D._parent,R=v.property;if(Hh(l)){var V=D.s(Dm),_="s:ingroup"===R;(V&&Bh[R]||R===_)&&l._81I(),(V||_)&&l.fp("childChange",!0,!1)}yq(l)&&(Bh[R]||"elevation"===R||Mk[R]||"scaleTall"===R||"tall"===R)&&l.updateFromChildren(),("s:alwaysOnTop"===R||"s:shape3d.alwaysOnTop"===R)&&(v.newValue?this.setRenderLayer("top"):this.setRenderLayer(B))},_21I:function(l){var w=this;if(l&&w._dataModel)throw"Remove data from dataModel before adding";w._dataModel=l},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var o=0,I=this._children.toArray(),A=I.length;A>o;o++)I[o].removeFromDataModel()},getId:function(){return this._id},setId:function(S){this._id=S},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(K,S){return this._children.toList(K,S)},eachChild:function(x,R){this._children.each(x,R)},addChild:function(C,_){var f=this;C!==f&&(f._children===Yg&&(f._children=new An,f._childMap={}),_>=0||(_=f._children.size()),f._childMap[C._id]||f.isDescendantOf(C)||(C._parent&&C._parent.removeChild(C),(0>_||_>f._children.size())&&(_=f._children.size()),f._children.add(C,_),f._childMap[C._id]=C,C.setParent(f),f.onChildAdded(C,_),f.fp(jn,z,C)))},onChildAdded:function(){},removeChild:function(H){var O=this;if(O._childMap&&O._childMap[H._id]){var g=O._children.remove(H);delete O._childMap[H._id],O.fp(jn,H,z),H.setParent(z,g),O.onChildRemoved(H,g)}},onChildRemoved:function(){},getChildAt:function(e){return this._children.get(e)},clearChildren:function(){var V=this;if(!V._children.isEmpty())for(var F=0,x=V._children.toArray(),g=x.length;g>F;F++)V.removeChild(x[F])},getParent:function(){return this._parent},setParent:function(H,N){var g=this;if(!(g._73I||g._parent===H||g===H||H&&H.isDescendantOf(g))){var d,E=g._parent;g._parent=H,g._73I=1,E?(N==z&&(N=E.getChildren().indexOf(g)),E.removeChild(g)):g._dataModel&&N==z&&(N=g._dataModel.getRoots().indexOf(g)),H&&(H.addChild(g),d=H.getChildren().indexOf(g)),delete g._73I,g.fp("parent",E,H,B,{oldIndex:N,newIndex:d}),g.onParentChanged(E,H)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(J){return J?this.isDescendantOf(J)||J.isDescendantOf(this):!1},isParentOf:function(o){return o&&this._childMap?!!this._childMap[o._id]:!1},isDescendantOf:function(J){if(!J||J.isEmpty())return!1;for(var s=this._parent;s;){if(J===s)return!0;s=s._parent}return!1},getStyle:function(Y,O){O===B&&(O=1);var s=this._styleMap?this._styleMap[Y]:B;return s===B&&O?b[Y]:s},setStyle:function(D,Q){var E=this;E._styleMap||(E._styleMap={});var s=E._styleMap[D];Q===B?delete E._styleMap[D]:E._styleMap[D]=Q,E.fp("s:"+D,s,Q)&&E.onStyleChanged(D,s,Q)},onStyleChanged:function(){},iv:function(J){this.invalidate(J)},invalidate:function(Z){this.fp(Z||"*",!1,!0)},toString:function(){var Y=this;return Y._displayName||Y._name||Y._tag||Y._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(o,l){var L=this,W=L.s(cs);L.beginTransaction(),W||L.s(cs,W={}),l?W[o]=l:delete W[o],L.fp(cs,z,W),L.endTransaction()},removeStyleIcon:function(r){var A=this.s(cs);if(A){var f=A[r];delete A[r],this.fp(cs,z,A)}return f},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(B){var r=this;if(r.hasOwnProperty("_anchor")||r.hasOwnProperty("_anchorElevation")){var T=r.getAnchor3d(),G={x:T.x-.5,y:T.y-.5,z:T.z-.5};hk(B,[-G.x,-G.y,-G.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var I,Y={};for(I in this._styleMap)Y[I]=1;return Y},getCurrentPrefix:function(){return this._interactPrefix||sb},ca:function(M,e){var m=this.getCurrentPrefix();return M=m+M,2===arguments.length?this.a(M,e):this.a(M)}});var wp=_.DataModel=function(){var c=this;c._isDeserializing=0,c._datas=new An,c._dataMap={},c._roots=new An,c._rootMap={},c._fsDataMap={},c._78O={},c._reflectorMap={},c._36I=new Ji,c._35I=new Ji,c._serializeNotifier=new Ji,c._selectionModel=new qh(c);var y=c._29Q=[],T=c._scheduleCallback=function(){for(var t=Date.now(),Y=0;Y<y.length;Y++){var K=y[Y];K.enabled&&t-K.lastTime>K.interval&&(K.beforeAction&&K.beforeAction(),K.action&&c.each(function(c){K.action(c)}),K.afterAction&&K.afterAction(),K.lastTime=t)}y.length&&(c._30Q=d.requestAnimationFrame(T))}};Fh("DataModel",S,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:B,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:B,_init:B,_envmap:B,_envmapType:B,_postProcessingData:B,sm:function(){return this.getSelectionModel()},mm:function(S,$,y){this.addDataModelChangeListener(S,$,y)},umm:function(d,S){this.removeDataModelChangeListener(d,S)},md:function(G,q,I){this.addDataPropertyChangeListener(G,q,I)},umd:function($,d){this.removeDataPropertyChangeListener($,d)},mh:function(R,B,Y){this.addHierarchyChangeListener(R,B,Y)},umh:function(Z,K){this.removeHierarchyChangeListener(Z,K)},getAttrObject:function(){return this._attrObject},setAttrObject:function(B){return this._attrObject=B},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(t){return this._dataMap[t]},removeDataById:function(j){this.remove(this.getDataById(j))},toDatas:function(g,p){return this._datas.toList(g,p)},each:function(I,U){this._datas.each(I,U)},getDataByTag:function(R){return this._78O[R]},getTagMap:function(){return this._78O},removeDataByTag:function(j){this.remove(this.getDataByTag(j))},add:function(s,S,W){var H=this,D=s._id,p=s._tag,L=H._roots;if(H._dataMap[D])throw"'"+D+"' already exists";p!=z&&(H._78O[p]=s),H._dataMap[D]=s,W>=0?H._datas.add(s,W):H._datas.add(s),s._parent||(H._rootMap[D]=s,S>=0?L.add(s,S):L.add(s)),s.s("fullscreen")!==B&&(H._fsDataMap[D]=s),s.s("shape3d.reflector")&&(H._reflectorMap[D]=s),s._21I(H),H.onAdded(s),H._36I.fire({kind:"add",data:s,rootsIndex:S,datasIndex:W})},onAdded:function(){},remove:function(P,Z){if(P){var F=this,s=P._id,j=Z&&Z.keepStructure,h=Z&&Z.keepChildren,M=P.getTag();if(P._dataModel===F){var x=P instanceof Sm;x&&m.setIsolating(!0),this.beginTransaction(),j?F._removingData||(F._removingData=P):F.prepareRemove(P),h||P.toChildren().each(function(W){F.remove(W,Z)},F),j?F._removingData===P&&(P._parent&&P._parent.removeChild(P),delete F._removingData):P._parent&&P._parent.removeChild(P);var H=F._datas.remove(P);delete F._dataMap[s],M!=z&&delete F._78O[M];var v;F._rootMap[s]&&(delete F._rootMap[s],v=F._roots.remove(P)),F._fsDataMap[s]&&delete F._fsDataMap[s],F._reflectorMap[s]&&delete F._reflectorMap[s],P._21I(z),F.onRemoved(P),F._36I.fire({kind:Zf,data:P,rootsIndex:v,datasIndex:H}),this.endTransaction(),x&&m.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var P=this;if(P._datas.size()){var G=P._historyManager?this.toJSON():B;P._datas.toArray().forEach(function(_){_._21I(z)}),P._datas.clear(),P._dataMap={},P._roots.clear(),P._rootMap={},P._fsDataMap={},P._reflectorMap={},P._78O={},P._36I.fire({kind:hm,json:G})}},contains:function(Z){return Z&&Z._dataModel===this},handleDataPropertyChange:function(S){var k=this,g=S.data,_=S.property;if("parent"===_){var P=g._id,H=k._rootMap,F=k._roots;g._parent?H[P]&&(delete H[P],F.remove(g)):H[P]||(H[P]=g,F.add(g))}else if("tag"===_){var X=S.oldValue,U=S.newValue,E=k._78O;X!=z&&delete E[X],U!=z&&(E[U]=g)}else if("s:fullscreen"===_){var P=g._id,Z=k._fsDataMap;S.oldValue!=z&&delete Z[P],S.newValue!=z&&(Z[P]=g)}else if("s:shape3d.reflector"===_){var P=g._id,o=k._reflectorMap;S.oldValue&&delete o[P],S.newValue&&(o[P]=g)}this.onDataPropertyChanged(g,S),this._35I.fire(S)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(M,j,a){this._36I.add(M,j,a)},removeDataModelChangeListener:function(m,t){this._36I.remove(m,t)},addSerializeListener:function(Z,z,H){this._serializeNotifier.add(Z,z,H)},removeSerializeListener:function(A,k){this._serializeNotifier.remove(A,k)},fireSerializeEvent:function(A){this._serializeNotifier.fire(A)},addDataPropertyChangeListener:function(R,K,S){this._35I.add(R,K,S)},removeDataPropertyChangeListener:function(Y,o){this._35I.remove(Y,o)},_38I:function(e,b,D){this._37I&&this._37I.fire({data:e,oldIndex:b,newIndex:D})},addHierarchyChangeListener:function(I,h,M){this._37I||(this._37I=new Ji),this._37I.add(I,h,M)},removeHierarchyChangeListener:function(E,Y){this._37I.remove(E,Y)},getSiblings:function(t){var x=t._parent;return x?x._children:this._roots},eachByHierarchical:function(M,W,H){if(W)return this._eachByHierarchical(M,W,H);for(var p=0,m=this._roots,e=m.size();e>p;p++)if(this._eachByHierarchical(M,m.get(p),H)===!1)return!1;return!0},_eachByHierarchical:function(n,y,_){if(_){if(n.call(_,y)===!1)return!1}else if(n(y)===!1)return!1;for(var J=y.size(),V=0;J>V;V++)if(this._eachByHierarchical(n,y.getChildAt(V),_)===!1)return!1;return!0},reverseEachByHierarchical:function($,z,H){if(z)return this._reverseEachByHierarchical($,z,H);for(var A=this._roots,e=A.size(),d=e-1;d>=0;d--)if(this._reverseEachByHierarchical($,A.get(d),H)===!1)return!1;return!0},_reverseEachByHierarchical:function(J,r,c){for(var e=r.size(),m=e-1;m>=0;m--)if(this._reverseEachByHierarchical(J,r.getChildAt(m),c)===!1)return!1;if(c){if(J.call(c,r)===!1)return!1}else if(J(r)===!1)return!1;return!0},eachByDepthFirst:function(W,S,c){if(S)return this._11I(W,S,c);for(var T=0,t=this._roots,$=t.size();$>T;T++)if(this._11I(W,t.get(T),c)===!1)return!1;return!0},_11I:function(Y,p,m){for(var r=p.size(),B=0;r>B;B++)if(this._11I(Y,p.getChildAt(B),m)===!1)return!1;if(m){if(Y.call(m,p)===!1)return!1}else if(Y(p)===!1)return!1;return!0},eachByBreadthFirst:function(P,f,K){var Y=new An;for(f?Y.add(f):this._roots.each(Y.add,Y);Y.size()>0;)if(f=Y.removeAt(0),f.eachChild(Y.add,Y),K){if(P.call(K,f)===!1)return!1}else if(P(f)===!1)return!1;return!0},moveTo:function(x,J){var w=this.getSiblings(x),l=w.indexOf(x);l===J||0>l||J>=0&&J<=w.size()&&(w.remove(x),J>w.size()&&J--,w.add(x,J),this._38I(x,l,J))},moveUp:function(c){this.moveTo(c,this.getSiblings(c).indexOf(c)-1)},moveDown:function(C){this.moveTo(C,this.getSiblings(C).indexOf(C)+1)},moveToTop:function(T){this.moveTo(T,0)},moveToBottom:function(C){this.moveTo(C,this.getSiblings(C).size())},moveSelectionUp:function(U){this.beginTransaction(),U||(U=this.sm());var L=new An;Ae(U,L,this._roots),L.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(C){this.beginTransaction(),C||(C=this.sm());var m=new An;Kn(C,m,this._roots),m.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(X){this.beginTransaction(),X||(X=this.sm());var n=new An;_m(X,n,this._roots),n.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(A){this.beginTransaction(),A||(A=this.sm());var p=new An;Kl(A,p,this._roots),p.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(B,Z,F){var C=this.getDatas();null==F&&(F=C.indexOf(B)),F===Z||0>F||Z>=0&&Z<=C.size()&&(C.remove(B),Z>C.size()&&Z--,C.add(B,Z),this._76I(B,F,Z))},bringForward:function(I){this.moveToIndex(I,this.getDatas().indexOf(I)+1)},bringToFront:function(o){this.moveToIndex(o,this.size())},sendBackward:function(v){this.moveToIndex(v,this.getDatas().indexOf(v)-1)},sendToBack:function(y){this.moveToIndex(y,0)},bringSelectionForward:function(j){this.beginTransaction(),j||(j=this.sm());for(var g=new An,n=this.getDatas(),I=!1,v=0;v<n.size();v++){var t=n.get(n.size()-1-v);j.contains(t)?I&&g.add(t):I=!0}g.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(v){this.beginTransaction(),v||(v=this.sm());for(var f=new An,j=this.getDatas(),z=0;z<j.size();z++){var Q=j.get(z);v.contains(Q)&&f.add(Q)}f.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(t){this.beginTransaction(),t||(t=this.sm());for(var s=new An,g=this.getDatas(),I=!1,J=0;J<g.size();J++){var l=g.get(J);t.contains(l)?I&&s.add(l):I=!0}s.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(f){this.beginTransaction(),f||(f=this.sm());for(var T=new An,Y=this.getDatas(),P=0;P<Y.size();P++){var i=Y.get(Y.size()-1-P);f.contains(i)&&T.add(i)}T.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(c){var Q=this;Q.removeScheduleTask(c),c.enabled==z&&(c.enabled=!0),c.interval==z&&(c.interval=10),c.lastTime=Date.now(),Q._29Q.push(c),Q._30Q==z&&(Q._30Q=d.requestAnimationFrame(Q._scheduleCallback))},removeScheduleTask:function(S){var l=this,F=l._29Q,c=F.indexOf(S);c>=0&&F.splice(c,1),F.length||l._30Q==z||(d.cancelAnimationFrame(l._30Q),delete l._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(A){this._historyManager||new _.HistoryManager(this),null!=A&&this._historyManager.setMaxHistoryCount(A),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(q){this._historyManager&&this._historyManager.undo(q)},redo:function(U){this._historyManager&&this._historyManager.redo(U)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(X){this._historyManager&&this._historyManager.addHistory(X)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(n){n?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(q){this.each(function(j){j instanceof Oe&&j.getImage()===q&&j.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){},setEnvmap:function(h){var _=this._envmap;this._envmap=h,"object"==typeof _&&"object"==typeof h&&(_=null),this.fp("envmap",_,h)}});var qh=_.SelectionModel=function(_){var q=this;q._68O=Ok,q._map={},q._73O=new An,q._74I=new Ji,q._21I(_)};Fh("SelectionModel",S,{ms_fire:1,ms_dm:1,ms:function(b,s,d){this.addSelectionChangeListener(b,s,d)},ums:function(T,L){this.removeSelectionChangeListener(T,L)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===bb},co:function(d){return this._map[d._id]!=z},ss:function(R){this.setSelection(R)},as:function(s){this.appendSelection(s)},rs:function(L){this.removeSelection(L)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(P){var O=this;if(O._68O!==P&&(P===Ip||P===bb||P===Ok)){O.cs();var o=O._68O;O._68O=P,O.fp("selectionMode",o,P)}},_21I:function(c){var G=this,_=G._dataModel;_!==c&&(_&&(G.cs(),_.umm(G.handleDataModelChange,G)),G._dataModel=c,c.mm(G.handleDataModelChange,G,!0),G.fp(Kd,_,c))},dispose:function(){var i=this;i.cs(),i._dataModel.umm(i.handleDataModelChange,i)},handleDataModelChange:function(V){var h=this;if(V.kind===Zf){var Q=V.data;h.co(Q)&&(h._73O.remove(Q),delete h._map[Q._id],h._75I(Zf,new An(Q)))}else V.kind===hm&&h.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(d){var P=this;if(P._filterFunc!==d){P.cs();var m=P._filterFunc;P._filterFunc=d,P.fp("filterFunc",m,P._filterFunc)}},_75I:function(A,q,k,b){k&&(this._73O.each(function(B){b[B._id]?k.remove(B):k.add(B)}),q=k.toList()),this._74I.fire({kind:A,datas:new An(q)})},addSelectionChangeListener:function(B,E,i){this._74I.add(B,E,i)},removeSelectionChangeListener:function(Y,F){this._74I.remove(Y,F)},_97O:function(x,k){for(var g,u=this,O=0,H=new An(x);O<H.size();O++)g=H.get(O),(u._filterFunc&&!u._filterFunc(g)||k&&u.co(g)||!k&&!u.co(g)||!u._dataModel.contains(g))&&(H.removeAt(O),O--);return H},appendSelection:function(n){var x=this;if(x._68O!==Ip){var J,S,q=x._73O,b=x._97O(n,!0);b.isEmpty()||(x.sg()&&(J=new An(q),S=x._map,q.clear(),x._map={},b=new An(b.get(b.size()-1))),b.each(function(L){q.add(L),x._map[L._id]=L}),x._75I("append",b,J,S))}},removeSelection:function(g){var F=this,I=F._97O(g),n=0,u=I.size();if(0!==u){for(;u>n;n++){var J=I.get(n);F._73O.remove(J),delete F._map[J._id]}F._75I(Zf,I)}},toSelection:function(A,F){return this._73O.toList(A,F)},getSelection:function(){return this._73O},each:function(E,Z){this._73O.each(E,Z)},setSelection:function(d){var o=this,$=o._73O;if(o._68O!==Ip&&!($.isEmpty()&&!d||1===$.size()&&o.ld()===d)){var H=new An($),P=o._map;$.clear(),o._map={};var M=o._97O(d,!0);o.sg()&&M.size()>1&&(M=new An(M.get(M.size()-1))),M.each(function(a){$.add(a),o._map[a._id]=a}),o._75I("set",z,H,P)}},clearSelection:function(){var o=this,c=o._73O;if(c.size()>0){var t=c.toList();c.clear(),o._map={},o._75I(hm,t)}},selectAll:function(){var J=this;if(J._68O!==Ip){var i,C,Y=J._dataModel.toDatas();if(J._filterFunc)for(i=0;i<Y.size();i++)C=Y.get(i),J._filterFunc(C)||(Y.removeAt(i),i--);var c=J._73O,g=new An(c),r=J._map;c.clear(),J._map={},J.sg()&&Y.size()>1&&(Y=new An(Y.get(Y.size()-1)));var y=Y.size();for(i=0;y>i;i++)C=Y.get(i),c.add(C),J._map[C._id]=C;J._75I("all",z,g,r)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(X){return this._map[X._id]!=z},getLastData:function(){var e=this._73O;return e.size()>0?e.get(e.size()-1):z},getFirstData:function(){var l=this._73O;return l.size()>0?l.get(0):z},isSelectable:function(F){var P=this;return F&&P._68O!==Ip?P._filterFunc?P._filterFunc(F):!0:!1},getTopSelection:function(){var c=this,R=new An;return c._73O.each(function(S){for(var T=S.getParent();T;){if(c.contains(T)){S=z;break}T=T.parent}S&&R.add(S)}),R}});var Tb=function(){return em(0),function(O,l){var C;if(Pc(l)){var b=O.getDataUI(l);b&&b._88I&&(C=b._88I.rect)}return C?C:l.getRect()}}();Lp(m,{edgeGroupAgentFunc:z,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:g.rectSelectBorder,graphViewRectSelectBackground:ep,graphViewEditPointSize:Xl?17:7,graphViewEditPointBorderColor:g.editPointBorder,graphViewEditPointBackground:g.editPointBackground,setEdgeType:function(u,_,p){zk[u]=_,Fi[u]=p},getEdgeType:function(V){return zk[V]},getEdgeTypeMap:function(){return zk},getNodeRect:Tb},!0);var ym={"layout.h":B,"layout.v":B,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":B,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,disableDoubleClick:!1,"image.stretch":"fill",icons:B,ingroup:!0,"body.color":B,"2d.gray":!1,fullscreen:B,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:B,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":B,"select.color":Up,"select.width":1,"select.padding":2,"select.type":Ol,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Up,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":B,"border.width":2,"border.padding":2,"border.type":Ol,label:B,"label.font":B,"label.color":ne,"label.background":B,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":B,"label.max":B,"label.opacity":B,"label.scale":1,"label.align":B,"label.selectable":!0,"label.decoration":B,label2:B,"label2.font":B,"label2.color":ne,"label2.background":B,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":B,"label2.max":B,"label2.opacity":B,"label2.scale":1,"label2.align":B,"label2.selectable":!0,"label2.decoration":B,note:B,"note.expanded":!0,"note.font":B,"note.color":_c,"note.background":Up,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":B,"note.toggleable":!0,"note.border.width":1,"note.border.color":B,"note.opacity":B,"note.scale":1,"note.align":B,note2:B,"note2.expanded":!0,"note2.font":B,"note2.color":_c,"note2.background":Up,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":B,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":B,"note2.opacity":B,"note2.scale":1,"note2.align":B,"group.type":B,"group.image":B,"group.image.stretch":"fill","group.repeat.image":B,"group.border.repeat.image":B,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":B,"group.title.color":_c,"group.title.background":g.groupTitleBackground,"group.title.align":Mq,"group.title.orientation":Ih,"group.background":g.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":B,"group.border.color":rg,"group.border.radius":B,"group.border.cap":qg,"group.border.join":Ec,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":z,"group.gradient.color":"#FFF",shape:B,"shape.background":rg,"shape.repeat.image":B,"shape.border.repeat.image":B,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":rg,"shape.border.3d":!1,"shape.border.3d.color":B,"shape.border.3d.accuracy":B,"shape.border.cap":qg,"shape.border.join":Ec,"shape.border.pattern":B,"shape.gradient":z,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":oc,"shape.dash.offset":0,"shape.dash.color":Lk,"shape.dash.width":B,"shape.dash.3d":!1,"shape.dash.3d.color":B,"shape.dash.3d.accuracy":B,"shape.polygon.side":6,"shape.arc.from":s,"shape.arc.to":Q,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":B,"shape.gradient.pack":B,"shape.border.gradient.pack":B,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":B,"shape.foreground":B,"shape.foreground.gradient":z,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":B,"shape.regular":!0,"autolayout.gap":B,"autolayout.hgap":B,"autolayout.vgap":B,"edge.type":B,"edge.points":B,"edge.segments":B,"edge.color":rg,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":B,"edge.3d.accuracy":B,"edge.cap":qg,"edge.join":Ec,"edge.source.position":17,"edge.source.anchor.x":B,"edge.source.anchor.y":B,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":B,"edge.target.anchor.y":B,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":B,"edge.dash":!1,"edge.dash.pattern":oc,"edge.dash.offset":0,"edge.dash.color":Lk,"edge.dash.width":B,"edge.dash.3d":!1,"edge.dash.3d.color":B,"edge.dash.3d.accuracy":B,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":B,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":B,"grid.column.percents":B,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":g.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":g.gridCellBorderColor,"grid.block":B,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":g.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":ne,"text.gradient.pack":B,"text.font":Fc,"text.shadow":!1,"text.shadow.color":Up,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":B,"text.gradient.color":"#FFF","text.decoration":B,"text.vertical":!1,"text.vertical.gap":1,"text.wrap":!1,"text.letter.gap":null,"text.border.color":Up,"text.border.width":0,keepPosition:!0};ym[sh]=B,Lp(b,ym,!0),Lp(wp,{_76I:function(B,h,a){this._39I&&this._39I.fire({data:B,oldIndex:h,newIndex:a})},addIndexChangeListener:function(M,v,S){var Y=this;Y._39I||(Y._39I=new Ji),Y._39I.add(M,v,S)},removeIndexChangeListener:function(r,C){this._39I.remove(r,C)},prepareRemove:function(E){Xr(E)&&(E.setSource(z),E.setTarget(z)),E._70O&&E._70O.toList().each(this.remove,this),E._69O&&E._69O.toList().each(function(A){A.setHost(z)}),E._host&&E.setHost(z)},onAdded:function(v){this.isAutoAdjustIndex()&&this.adjustIndex(v)},onDataPropertyChanged:function(H,m){_j[m.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(H)},isAdjustable:function(p){return Dk(p)||Xr(p)},isAdjustedToBottom:function(s){return Hh(s)?s.isExpanded()&&Np(s):!1},adjustIndex:function(T){var y=this;this.isHierarchicalRendering()||(y.isAdjustedToBottom(T)?(y.sendToBottom(T),T.eachChild(y.adjustIndex,y)):y.sendToTop(T))},sendToTop:function(i){var _=this;if(_.contains(i)&&_.isAdjustable(i)){var j=_._datas;if(i!==j.get(_.size()-1)){var K=j.indexOf(i);j.removeAt(K),j.add(i),_._76I(i,K,_.size()-1)}if(Xr(i)){var Q=i._40I;Q&&!_.isAdjustedToBottom(Q)&&_.sendToTop(Q),Q=i._41I,Q&&!_.isAdjustedToBottom(Q)&&_.sendToTop(Q)}i._69O&&i._69O.each(function(z){z.isRelatedTo(i)||Dk(i)&&z.isLoopedHostOn(i)||_.sendToTop(z)}),i.ISubGraph||(!Hh(i)||i.isExpanded())&&i._adjustChildrenToTop&&i.eachChild(function(z){Xr(z)||_.sendToTop(z)})}},sendToBottom:function(c,e){var L=this;if(c!==e&&L.contains(c)&&L.isAdjustable(c)&&(!e||L.contains(e))){var B=L._datas,v=B.remove(c),C=e?L._datas.indexOf(e):0;if(B.add(c,C),v!==C){L._76I(c,v,C);var p=c._parent;!p||p.ISubGraph||Xr(p)||L.sendToBottom(c._parent,c)}}}}),Lp(Yh,{ms_edit:function(p){p._46O=function(L){var p=this,P=p.gv.dm(),z=p._index,g=p._89I,O=p._node,y=p._shape,N=p._edge,G=p._77I;O&&g?(this.fi({kind:"endEditRect",event:L,data:O,direction:g}),P.endTransaction()):y&&z>=0?(p.fi({kind:"endEditPoint",event:L,data:y,index:z}),P.endTransaction()):N&&z>=0?(p.fi({kind:"endEditPoint",event:L,data:N,index:z}),P.endTransaction()):G&&(p.fi({kind:"endEditRotation",event:L,data:G}),P.endTransaction())},p._78I=function(Q){var q=this;q.autoScroll(Q);var a=q.gv.lp(Q),P=q._index,C=q._89I,g=q._node,I=q._shape,Z=q._edge,x=q._77I;if(g&&C)q._80O(a),q.fi({kind:"betweenEditRect",event:Q,data:g,direction:C});else if(I&&P>=0)a.e=I.getPoints().get(P).e,I.setPoint(P,a),q.fi({kind:"betweenEditPoint",event:Q,data:I,index:P});else if(Z&&P>=0){var l=Z.s(vp);a.e=l.get(P).e,l.set(P,a),Z.fp(vp,z,l),q.fi({kind:"betweenEditPoint",event:Q,data:Z,index:P})}else if(x){var M=x.p(),Y=x.getScale(),B=Yp+Wc(a.y-M.y,a.x-M.x);Y.y<0&&(B+=s),n(B)<.04&&(B=0),x.setRotation(B),q.fi({kind:"betweenEditRotation",event:Q,data:x})}},p._80O=function(m){var B=this,X=B._node,w=B._rect,v=w.x,d=w.y,G=w.width,b=w.height,Z=B._89I,e=B._anchor,y=B._matrix,m=y.tfi(m);"northwest"===Z?w=sf(m,{x:v+G,y:d+b}):Z===$h?w=sf({x:v,y:m.y},{x:v+G,y:d+b}):"northeast"===Z?w=sf({x:v,y:m.y},{x:m.x,y:d+b}):Z===Eb?w=sf({x:m.x,y:d},{x:v+G,y:d+b}):Z===lb?w=sf({x:v,y:d},{x:m.x,y:d+b}):"southwest"===Z?w=sf({x:m.x,y:d},{x:v+G,y:m.y}):"south"===Z?w=sf({x:v,y:d},{x:v+G,y:m.y}):"southeast"===Z&&(w=sf({x:v,y:d},m)),X.setPosition(y.tf(w.x+w.width*e.x,w.y+w.height*e.y)),X.setWidth(w.width),X.setHeight(w.height)},p._80I=function(b,G,C,v){var c=this,q=c.gv._zoom,D=(c.gv.getEditPointSize()+2)/q;return tq({x:G-D/2,y:C-D/2,width:D,height:D},b)?(c._89I!==v&&(c._89I=v),!0):!1},p._79I=function(x,o,C){var O=this,F=O.gv,B=o?F.getDataUI(o):z,j=B?B._55O:z;if(j){var P,A,r,y,M=F._zoom,l=(F.getEditPointSize()+2)/M,n=F.lp(x);if(Dk(o)){if(j._56O&&Dk(o)&&(A=j._98o,tq({x:A.x-l/2,y:A.y-l/2,width:l,height:l},n)))return O._77I=o,C&&O.fi({kind:"beginEditRotation",event:x,data:o}),O.setCursor("crosshair"),!0;if(j._43O&&o instanceof gf)for(r=o.getPoints(),P=r.size()-1;P>=0;P--)if(A=r.get(P),tq({x:A.x-l/2,y:A.y-l/2,width:l,height:l},n))return O._index=P,O._shape=o,C&&O.fi({kind:"beginEditPoint",event:x,data:o,index:P}),O.setCursor("crosshair"),!0;if(j._42O)for(var Q=o.getEditControlPoints(),H=["northwest",-1,-1,Eb,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,lb,1,0,"northeast",1,-1,$h,0,-1],P=0,y=Q.length;y>P;P++){var _=H[3*P],Y=Q[P];if(O._80I(n,Y.x,Y.y,_)){O._node=o;var J=o.getWidth(),X=o.getHeight(),d=o.getAnchor();O._rect={x:-J*d.x,y:-X*d.y,width:J,height:X},O._anchor=d,O._matrix=o.getMatrix();var S=o.getRotation(),I=c(S),Z=N(S),T=H[3*P+1]*ud(o.getScale().x),U=H[3*P+2]*ud(o.getScale().y),W=Math.atan2(-Z*T-I*U,I*T-Z*U),g=(Math.round(W/(Math.PI/4))+8)%8,G=[Cc,"nesw-resize",Be,"nwse-resize",Cc,"nesw-resize",Be,"nwse-resize"][g];return O.setCursor(G),C&&O.fi({kind:"beginEditRect",event:x,data:o,direction:O._89I}),!0}}}if(j._43O&&Xr(o)&&o.s(Ur)===Bj&&(r=o.s(vp)))for(P=r.size()-1;P>=0;P--)if(A=r.get(P),tq({x:A.x-l/2,y:A.y-l/2,width:l,height:l},n))return O._index=P,O._edge=o,C&&O.fi({kind:"beginEditPoint",event:x,data:o,index:P}),O.setCursor("crosshair"),!0}return!1}},ms_gv:function(S){S._currentSubGraph=z,S._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},S.upSubGraph=function(){this.setCurrentSubGraph(rs(this._currentSubGraph))},S.isVisible=function(M){var b=this;if(rs(M)!==b._currentSubGraph)return!1;if(Xr(M)){var r=M._40I,N=M._41I;if(!r||!N)return!1;if(!(M.s("edge.independent")||b.isVisible(r)&&b.isVisible(N)))return!1;if(M.isEdgeGroupHidden())return!1}else for(var E=M._parent;E&&!E.ISubGraph;){if(Hh(E)&&(!E.isExpanded()||!b.isVisible(E)))return!1;E=E._parent}if(M._parent instanceof Sm&&!b.isVisible(M._parent))return!1;if(M._refGraph instanceof rb&&!b.isVisible(M._refGraph))return!1;if(b instanceof Fs){if(!M.s("3d.visible"))return!1}else{var Q=b.getLayersInfo();if(Q){var T=Q[M._layer];if(T&&T.visible===!1)return!1}if(!M.s("2d.visible"))return!1}return b._visibleFunc?b._visibleFunc(M):!0},S.handleSelectionChange=function(v){var i=this;v.datas.each(function(B){i.invalidateData(B);var k=B._parent;Hh(k)&&Dk(B)&&B.s(Dm)&&(i.invalidateData(k),k._49I&&k._49I.each(function(v){i.invalidateData(v)}))}),i.onSelectionChanged(v)},S.onSelectionChanged=function(A){var x=this,g=x.sm();if(1===g.size()&&("set"===A.kind||"append"===A.kind)){var u=g.ld();x.isAutoMakeVisible()&&x.makeVisible(u),x.adjustIndex&&x._dataModel.isAutoAdjustIndex()&&x.adjustIndex(u)}},S.makeVisible=function(H){if(H){var s=this,T=s.getDataUI?s.getDataUI(H):s.getData3dUI(H);if(T){var g=H,A=rs(H);for(A!==s._currentSubGraph&&s.setCurrentSubGraph(A);(g=g._parent)&&g!==A;)Hh(g)&&g.setExpanded(!0);s._23I=H,s.iv()}}},S.getLabel=function(u){var I=u.getStyle(dk);return I===B?u.getName():I},S.getLabelBackground=function(V){return V.getStyle("label.background")
},S.getLabelColor=function(H){return H.getStyle("label.color")},S.getLabel2=function(Z){return Z.getStyle("label2")},S.getLabel2Background=function(v){return v.getStyle("label2.background")},S.getLabel2Color=function(n){return n.getStyle("label2.color")},S.getNote=function(A){return A.getStyle(kb)},S.getNoteBackground=function(s){return s.getStyle("note.background")},S.getNote2=function(P){return P.getStyle(Wb)},S.getNote2Background=function(X){return X.getStyle("note2.background")},S.handleClick=function(g,w,G){var e=this;w?(e.fi({kind:"clickData",event:g,data:w,part:G}),e.onDataClicked(w,g)):(e.fi({kind:"clickBackground",event:g}),e.onBackgroundClicked(g))},S.handleDoubleClick=function(V,d,R){var q=this;ti(V)&&(d?(q.fi({kind:"doubleClickData",event:V,data:d,part:R}),q.onDataDoubleClicked(d,V,R),q.checkDoubleClickOnNote(V,d,R)||q.checkDoubleClickOnRotation&&q.checkDoubleClickOnRotation(V,d,R)||(Xr(d)?q.onEdgeDoubleClicked(d,V,R):d.ISubGraph?q.onSubGraphDoubleClicked(d,V,R):Hh(d)?q.onGroupDoubleClicked(d,V,R):d.IDoorWindow?q.onDoorWindowDoubleClicked(d,V,R):d.ICSGBox&&q.onCSGBoxDoubleClicked(d,V,R))):(q.fi({kind:"doubleClickBackground",event:V}),q.onBackgroundDoubleClicked(V)))},S.onSubGraphDoubleClicked=function(L){this.setCurrentSubGraph(L)},S.onEdgeDoubleClicked=function(I,z){this.isEditable(I)||(I.ISubGraph&&!Wo(z)?this.setCurrentSubGraph(I):I.s("edge.toggleable")&&I.toggle())},S._39Q=function(t){return this.isInteractive(t)?this.preventDefaultWhenInteractive(t):!1},S.preventDefaultWhenInteractive=function(G){return G.s("preventDefaultWhenInteractive")},S.onGroupDoubleClicked=function(z){z.s("group.toggleable")&&z.toggle()},S.onDoorWindowDoubleClicked=function(R){R.s("dw.toggleable")&&R.toggle(!0)},S.onCSGBoxDoubleClicked=function(a,J){var Y=this;if(Y instanceof Fs){var z=Y.intersectObject(J,a);z&&a.s(z.part+".toggleable")&&a.toggleFace(z.part,!0)}},S.onBackgroundClicked=function(){},S.onBackgroundDoubleClicked=function(){this.upSubGraph()},S.onDataClicked=function(){},S.onDataDoubleClicked=function(){},S.onAutoLayoutEnded=function(){},S.onMoveEnded=function(){},S.onPanEnded=function(){},S.onPinchEnded=function(){},S.onRectSelectEnded=function(){},S.onZoomEnded=function(){},S.serialize=function(V){return this.dm().serialize(V)},S.toJSON=function(){return this.dm().toJSON()},S.deserialize=function(A,k){var Y=this;k=k instanceof fk?{rootParent:k}:Zn(k)?{setId:k}:Qr(k)?{finishFunc:k}:k||{},k.view=Y;var R=Y.dm();return k.reset&&(R.setAttrObject({}),R.setLayers(B),R.setName(B),R.setAutoAdjustIndex(!0),R.setHierarchicalRendering(!1),R.setBackground(B),R.setInit(B),R.setPostProcessingData(B),R.setEnvmap(B),R.setEnvmapType(B),Y.disableToolTip(),Y instanceof _.graph.GraphView?(Y.setZoomable(m.graphViewZoomable),Y.setPannable(m.graphViewPannable),Y.setRectSelectable(m.graphViewRectSelectable)):Y instanceof _.graph3d.Graph3dView&&(Y.shadowMap.resetProperties(),Y.setDashDisabled(m.graph3dViewDashDisabled),Y.setUvClipEnabled(m.graph3dViewUvClipEnabled),Y.getHighlightHelper().resetProperties(),Y.resetHeadlightProperties(),Y.resetFogProperties(),Y.setBatchInfoMap({}),Y.setBatchColorDisabled(m.graph3dViewBatchColorDisabled),Y.setBatchInstancedDisabled(m.graph3dViewBatchInstancedDisabled),Y.setBatchBlendDisabled(m.graph3dViewBatchBlendDisabled),Y.setBatchBrightnessDisabled(m.graph3dViewBatchBrightnessDisabled),Y.setFlowBlendMode(m.graph3dViewFlowBlendMode),Y.setMoveStep(m.graph3dViewMoveStep),Y.setRotateStep(m.graph3dViewRotateStep),Y.setSortable(m.graph3dViewSortable),Y.setSortFunc(B),Y.setSkybox(B),Rq(Y))),k.__innerHandler__=function(P){if(Zn(R.a("toolTipEnable"))&&(R.a("toolTipEnable")?Y.enableToolTip():Y.disableToolTip()),Y instanceof _.graph.GraphView&&(Zn(R.a("zoomable"))&&Y.setZoomable&&Y.setZoomable(R.a("zoomable")),Zn(R.a("pannable"))&&Y.setPannable&&Y.setPannable(R.a("pannable")),Zn(R.a("rectSelectable"))&&Y.setRectSelectable&&Y.setRectSelectable(R.a("rectSelectable")),R.a("fitContent")===!0&&Y.fitContent&&Y.fitContent(!0,0)),Y instanceof _.graph3d.Graph3dView){var X=P.scene;X&&X.shadow!=z&&Y.shadowMap.setShadow(X.shadow,X.shadowParams);var Z=R.a("sceneContext");Z?(Z.eye&&Y.setEye(Z.eye),Z.center&&Y.setCenter(Z.center),Aj(Z.far)&&Y.setFar(Z.far),Aj(Z.near)&&Y.setNear(Z.near)):(Aj(R.a("sceneNear"))&&Y.setNear(R.a("sceneNear")),Aj(R.a("sceneFar"))&&Y.setFar(R.a("sceneFar")),X&&(X.eye&&Y.setEye(X.eye),X.center&&Y.setCenter(X.center))),Zn(R.a("sceneShadowEnabled"))&&(R.a("sceneShadowEnabled")?Y.enableShadow():Y.disableShadow()),Aj(R.a("sceneShadowDegreeX"))&&Y.setShadowDegreeX(R.a("sceneShadowDegreeX")),Aj(R.a("sceneShadowDegreeZ"))&&Y.setShadowDegreeZ(R.a("sceneShadowDegreeZ")),Aj(R.a("sceneShadowIntensity"))&&Y.setShadowIntensity(R.a("sceneShadowIntensity")),R.a("sceneShadowQuality")!=z&&Y.setShadowQuality(R.a("sceneShadowQuality")),R.a("sceneShadowType")&&Y.setShadowType(R.a("sceneShadowType")),Aj(R.a("sceneShadowRadius"))&&Y.setShadowRadius(R.a("sceneShadowRadius")),Aj(R.a("sceneShadowBias"))&&Y.setShadowBias(R.a("sceneShadowBias")),Zn(R.a("sceneDashEnable"))&&Y.setDashDisabled(!R.a("sceneDashEnable")),Zn(R.a("sceneUvClipEnabled"))&&Y.setUvClipEnabled(R.a("sceneUvClipEnabled")),hq(R.a("sceneHighlightMode"))&&Y.setHighlightMode(R.a("sceneHighlightMode")),Aj(R.a("sceneHighlightWidth"))&&Y.setHighlightWidth(R.a("sceneHighlightWidth")),R.a("sceneHighlightColor")&&Y.setHighlightColor(R.a("sceneHighlightColor")),R.a("sceneHighlightType")&&Y.setHighlightType(R.a("sceneHighlightType")),R.a("sceneHighlightGlow")&&Y.setHighlightGlow(R.a("sceneHighlightGlow")),R.a("sceneHighlightStrength")&&Y.setHighlightStrength(R.a("sceneHighlightStrength")),Zn(R.a("sceneHeadlightEnable"))&&Y.setHeadlightDisabled(!R.a("sceneHeadlightEnable")),R.a("sceneHeadlightDirection")!=z&&Y.setHeadlightDirection(R.a("sceneHeadlightDirection")),Aj(R.a("sceneHeadlightRange"))&&Y.setHeadlightRange(R.a("sceneHeadlightRange")),R.a("sceneHeadlightColor")&&Y.setHeadlightColor(R.a("sceneHeadlightColor")),Aj(R.a("sceneHeadlightIntensity"))&&Y.setHeadlightIntensity(R.a("sceneHeadlightIntensity")),Aj(R.a("sceneHeadlightAmbientIntensity"))&&Y.setHeadlightAmbientIntensity(R.a("sceneHeadlightAmbientIntensity")),Aj(R.a("sceneHeadlightGroup"))&&Y.setHeadlightGroup(R.a("sceneHeadlightGroup")),Zn(R.a("sceneFogEnable"))&&Y.setFogDisabled(!R.a("sceneFogEnable")),R.a("sceneFogMode")&&Y.setFogMode(R.a("sceneFogMode")),Aj(R.a("sceneFogDensity"))&&Y.setFogDensity(R.a("sceneFogDensity")),R.a("sceneFogColor")&&Y.setFogColor(R.a("sceneFogColor")),Aj(R.a("sceneFogNear"))&&Y.setFogNear(R.a("sceneFogNear")),Aj(R.a("sceneFogFar"))&&Y.setFogFar(R.a("sceneFogFar")),Zn(R.a("sceneBatchBrightnessDisabled"))&&Y.setBatchBrightnessDisabled(R.a("sceneBatchBrightnessDisabled")),R.a("sceneFlowBlendMode")!==B&&Y.setFlowBlendMode(R.a("sceneFlowBlendMode")),Zn(R.a("sceneBatchBlendDisabled"))&&Y.setBatchBlendDisabled(R.a("sceneBatchBlendDisabled")),Zn(R.a("sceneBatchColorDisabled"))&&Y.setBatchColorDisabled(R.a("sceneBatchColorDisabled")),Zn(R.a("sceneBatchInstancedDisabled"))&&Y.setBatchInstancedDisabled(R.a("sceneBatchInstancedDisabled")),R.a("sceneBatchInfoMap")&&Y.setBatchInfoMap(R.a("sceneBatchInfoMap")),Aj(R.a("sceneMoveStep"))&&Y.setMoveStep(R.a("sceneMoveStep")),Aj(R.a("sceneRotateStep"))&&Y.setRotateStep(R.a("sceneRotateStep")),Zn(R.a("sceneSortable"))&&Y.setSortable(R.a("sceneSortable")),Qr(R.a("sceneSortFunc"))&&Y.setSortFunc(R.a("sceneSortFunc"));var e=R.a("sceneSkyboxType")||"sphere";if(e!=z){var b={},N=!1;if("sphere"===e){b.shape3d=e;var t=R.a("sceneSkyboxImage");t&&(b["shape3d.image"]=t,N=!0)}else"cube"===e?(b.shape3d=B,["front","back","left","right","top","bottom"].forEach(function(K){var v=K+".image",L=K.charAt(0).toUpperCase()+K.slice(1),u=R.a("sceneSkybox"+L+"Image");u&&(b[v]=u,N=!0)})):"color"===e&&(N=!0);if(N){var H=new Oe,k=R.a("sceneSkyboxDiameter");if(Aj(k)?H.s3(k,k,k):H.s3(20,20,20),b["body.color"]=R.a("sceneSkyboxBodyColor"),b.envmap=R.a("sceneSkyboxEnvmap"),b["envmap.probe"]=R.a("sceneSkyboxEnvmapProbe"),b.roughness=R.a("sceneSkyboxRoughness"),b["shape3d.light"]=b["all.light"]=R.a("sceneSkyboxLight"),b["light.mask"]=R.a("sceneSkyboxLightMask"),b["headlight.ambientIntensity"]=R.a("sceneSkyboxHeadLightAmbientIntensity"),b["texture.wrap"]="clampToEdge",b["3d.clipbox.mask"]=Wn,b["effect.flow.mask"]=Wn,"color"===e){b.shape3d="sphere";var O=2,G=1024,t=H.s("shape3d.image"),E=t&&_.Default.getImage(t);E&&"CANVAS"===E.tagName||(E=T.createElement("canvas"),t=_.Math.generateUUID(),_.Default.setImage(t,E)),t&&Y.getTextureMap()&&Y.deleteTexture(t),_.Default.setCanvas(E,O,G,1);var p=E.getContext("2d");p.clearRect(0,0,O,G),p.beginPath(),p.rect(0,0,O,G),No(p,R.a("sceneSkyboxColor"),function(w){return w},!1,{x:0,y:0,width:O,height:G}),p.fill(),p.restore(),b["shape3d.image"]=t}H.s(b),["X","Y","Z"].forEach(function(P){var $=R.a("sceneSkyboxRotation"+P);Aj($)&&H["setRotation"+P]($)}),Y.setSkybox(H)}}}},R.deserialize(A,k.rootParent,k)},S.isDebugTipShowing=function(){return!!this._debugDiv},S.showDebugTip=function(){var j=this,C=j._debugDiv;if(!C){C=j._debugDiv=T.createElement("div"),C.style.position="absolute",C.style.overflow="hidden",C.style.font=m.debugTipLabelFont,C.style.padding="6px",C.style.backgroundColor=m.debugTipBackground,C.style.color=m.debugTipLabelColor;var J=j.getView();j._79O?J.insertBefore(C,j._79O):J.appendChild(C);var r=function(){j.redraw();var V=j._canvas,Y="FPS: "+j._fpsInfo.fps+"<br/>"+"Datas: "+j.dm().getDatas().length+(V?"<br/>Size: "+V.width+" * "+V.height:""),Q=j.dm()._historyManager;Q&&(Y+="<br/>Undoes: "+Q.getHistories().length+" index: "+Q.getHistoryIndex());var z=j.getDebugTip();z&&(Y+="<hr>"+z),C.innerHTML=Y,j._isDebugging&&requestAnimationFrame(r)};requestAnimationFrame(r),j._isDebugging=!0}},S.hideDebugTip=function(){var L=this,Z=L._debugDiv;Z&&(delete L._debugDiv,L.getView().removeChild(Z),L._isDebugging=!1)},S.updateDOMAppendMatrix=function(){var $=this.getView();$&&($.updateAppendMatrix=!0)},S.countFrame=function(){if(this._isDebugging){var L=Date.now(),B=this._fpsInfo;L-B.time>1e3?(B.fps=Math.round(1e5*(B.frames+1)/(L-B.time))/100,B.time=L,B.frames=0):B.frames++}}},ms_icons:function($){$.getRotation=function(n){return n==z?0:n},$._15O=function(){var r=this,k=r.s(cs);if(k){var R=r,d=r.data||r._data,C=d.getRotation&&d.getRotation(),w=r._38o={icons:k,rects:{}};for(var I in k){var G=k[I],S=Gq(G.shape3d,d,R);if(!(Gq(G.visible,d,R)===!1||Gq(G.for3d,d,R)&&!r.I3d||S&&!r.I3d)){var D=S?[S]:Gq(G.names,d,R),q=D?D.length:0,_=Gq(G.position,d,R)||3,t=Gq(G.offsetX,d,R)||0,F=Gq(G.offsetY,d,R)||0,e=Gq(G.direction,d,R)||lb,l=Gq(G.gap,d,R),V=l!=z?l:1,W=Gq(G.rotation,d,R),M=Gq(G.keepOrien,d,R),n=Gq(G.rotationFixed,d,R)?W:r.getRotation(W,M,_),c=z,g=w.rects[I]=new Array(q);Aj(C)&&(Aj(n)?n+=C:n=C),g.rotation=n;for(var K=0;q>K;K++){var Z,v,O,m,j=D[K];if(S)O=0,m=0;else{var Q=Om(j);O=Gq(G.width,d,R),m=Gq(G.height,d,R),O==z&&(O=To(Q,d)),m==z&&(m=Of(Q,d))}if(c?e===lb?t+=O/2:e===Eb?t-=O/2:e===$h?F-=m/2:F+=m/2:c={width:O,height:m},r.I3d){var Y=-O/2,H=-m/2;v={width:O,height:m,mat:r._16O(Gq(G.autorotate,d,R),_,c,Gq(G.face,d,R)||Dn,Gq(G.t3,d,R),Gq(G.r3,d,R),Gq(G.rotationMode,d,R),t,F),vs:new al([Y,-H,0,Y,-H-m,0,Y+O,-H-m,0,Y+O,-H,0])}}else Z=r.getPosition(_,t,F,c,Gq(G.positionFixed,d,R)),v={x:Z.x-O/2,y:Z.y-m/2,width:O,height:m},r._68o(v,n);g[K]=v,e===lb?t+=O/2+V:e===Eb?t-=O/2+V:e===$h?F-=m/2+V:F+=m/2+V}}}}}}});var dg={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Jp={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},ur={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},_j={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Bh={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},lc={"edge.type":1,"edge.group":1},Mk={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},tb={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},ap={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Ak={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Fn={shape:1,thickness:1,position:1,anchor:1,scale:1},rs=function(t){if(!t)return z;if(Xr(t)){var l=t._40I,r=t._41I;if(!l||!r)return z;var F=rs(l),P=rs(r);return F===P?F:z}for(var Q=t._parent;Xr(Q)&&!Q.ISubGraph;)Q=Q._parent;return Q?Q.ISubGraph?Q:rs(Q):z},sr=function(d,H,m,K){var B=H.getStyle(m)*K;B&&gp(d,B),B=H.getStyle(m+".left")*K,B&&(d.x-=B,d.width+=B),B=H.getStyle(m+".right")*K,B&&(d.width+=B),B=H.getStyle(m+".top")*K,B&&(d.y-=B,d.height+=B),B=H.getStyle(m+".bottom")*K,B&&(d.height+=B),d.width<0&&(d.width=-d.width,d.x-=d.width),d.height<0&&(d.height=-d.height,d.y-=d.height)},Np=function(J){for(var W,d=0,i=J.size();i>d;d++)if(W=J.getChildAt(d),Dk(W)&&Np(W))return!0;return J.hasAgentEdges()},Yk=function(b){if(!b)return z;for(var Y=b._parent;Hh(Y);){if(!Hh(Y._parent))return Y.isExpanded()?b:Y;Y.isExpanded()||(b=Y),Y=Y._parent}return b},Qq=function(e,S){if(!e||!S)return z;var j,F,M,N=rs(e),L=rs(S);if(N!==L){for(;L&&N!==L;)L=rs(L);if(N===L)return e;j=new An,j.add(e,0);for(var X=e._parent;Dk(X)&&!S.isDescendantOf(X);)j.add(X,0),X=X._parent;for(M=j.size(),F=0;M>F;F++){var I=j.get(F);if(Hh(I)&&!I.isExpanded())return I;if(I.ISubGraph)return I}return e}return e},ns=function(w){if(w.isLooped())return w._source;var R=Yk(w._source),p=Yk(w._target);return R===p?w._source:Qq(R,p)},Un=function(l){if(l.isLooped())return l._target;var B=Yk(l._source),T=Yk(l._target);return B===T?l._target:Qq(T,B)},qf=function(y,P,T){"target"!==T&&(T="source");var B="target"===T?P.getTargetAgent():P.getSourceAgent(),t="edge."+T+".";if(Xr(B)){var R=y.getDataUI(B);R._79o();var j=P.s(t+"index");if(j>=0){var H=ik(R);return H[Math.max(0,Math.min(j,H.length-1))]}var I=P.s(t+"percent")||0;I=Math.max(0,Math.min(I,1));var Y=kn(R);return Sp(Y,100*I)}return tm(y,B,P.s(t+"position"),P.s(t+"offset.x"),P.s(t+"offset.y"),P.s(t+"anchor.x"),P.s(t+"anchor.y"))},tm=function(m,L,n,C,k,g,J){if(!L)return z;var i,_=L.getRotation?L.getRotation():0;if(g!==B||J!==B){g=g===B?.5:g,J=J===B?.5:J;var P=L.getScale();if(_&&!Pc(L,m)||P.x<0||P.y<0){var E=L.getPosition(),U=L.getWidth(),d=L.getHeight(),w=L.getAnchor(),F=new hg(_,E.x,E.y,P.x,P.y);n=F.tf((g-w.x)*U,(J-w.y)*d)}else i=Tb(m,L),n={x:i.x+g*i.width,y:i.y+J*i.height}}else n=Gb(n,Tb(m,L));if(_){var Z=c(_),l=N(_),u=C*Z-k*l;k=C*l+k*Z,C=u}return n.x+=C,n.y+=k,n},ld=function(Y,K){if(!Y||!K)return z;var v,h,l,c,Q,W;if(Y===K){if(c=Y.getLoopedEdges(),!c)return z;c=new An(c)}else{if(Q=Y.getAgentEdges(),W=K.getAgentEdges(),!Q||!W)return z;for(h=Q.size(),v=0;h>v;v++)l=Q.get(v),W.contains(l)&&(c||(c=new An),c.add(l))}if(c)for(v=0;v<c.size();v++)l=c.get(v),l.getStyle(Ur)===Bj&&(l._22I(z),c.removeAt(v),v--);return c},Jj=function(W,A){var $=ld(W,A);if($&&!$.isEmpty()){if(1===$.size())return $.get(0)._22I(z),void 0;var Z=new An,D=new An;$.each(function($){var P=$.s("edge.group");Z.contains(P)||Z.add(P)}),Z.sort(),Z.each(function(W){D.add(new _.EdgeGroup($.toList(function(e){return W===e.s("edge.group")}),D))}),D.each(function(u){u.each(function(t){t._22I(u)})})}},Oo=function(A,q,n){var v=A._canvas;A._zoom;var r=Xi(q,v),l=Xi(n,v);return{x:r.x-l.x,y:r.y-l.y}},aj=function(L,P){if(P){var T=P.rect,V=P.color,n=P.rotation,v=P.labelWidth,B=P.background,G=P.opacity,U=P.scale,h=U!=z&&1!==U;if(G!=z){var O=L.globalAlpha;L.globalAlpha*=G}if(n||h){L.save();var K=T.x+T.width/2,u=T.y+T.height/2;Jo(L,K,u),n&&af(L,n),h&&L.scale(U,U),Jo(L,-K,-u)}if(B&&rr(L,T.x,T.y,T.width,T.height,B),v){var f=T.width,Y=L.createLinearGradient(T.x,T.y,T.x+f,T.y);Y.addColorStop(0,V),Y.addColorStop(.9,V),Y.addColorStop(1,ki),V=Y,T.width=v}Bc(L,P.ss,T,P.font,V,P.align,P.decoration),v&&(T.width=f),(n||h)&&L.restore(),G!=z&&(L.globalAlpha=O)}},hi=function(r,l){if(l){var w=l.rect,B=w.x,b=w.y,e=w.width,p=w.height,S=l.background,O=l.backgroundImage,P=l.borderWidth,W=l.borderColor,o=l.labelWidth,N=l.opacity,C=l.scale,_=C!=z&&1!==C;if(N!=z){var J=r.globalAlpha;r.globalAlpha*=N}if(_){r.save();var h=w.x+w.width/2,Y=w.y+w.height/2;Jo(r,h,Y),r.scale(C,C),Jo(r,-h,-Y)}if(l.expanded){var K=H(8,e/4),q=b+p-8;if(r.fillStyle=S,r.beginPath(),r.moveTo(B,b),r.lineTo(B,q),r.lineTo(B+e/2,q),r.lineTo(B+e/2,b+p),r.lineTo(B+e/2+K,q),r.lineTo(B+e,q),r.lineTo(B+e,b),r.closePath(),r.fill(),P&&(r.lineWidth=P,r.lineJoin="round",r.lineCap="round",W?(r.strokeStyle=W,r.stroke()):(r.strokeStyle=Gg(S),r.beginPath(),r.moveTo(B+e,b),r.lineTo(B+e,q),r.lineTo(B+e/2+K,q),r.lineTo(B+e/2,b+p),r.stroke(),r.strokeStyle=Xj(S),r.beginPath(),r.moveTo(B+e,b),r.lineTo(B,b),r.lineTo(B,q),r.lineTo(B+e/2,q),r.lineTo(B+e/2,b+p),r.stroke())),O)Le(r,Om(O),cl,w.x,w.y,w.width,w.height-8,l.data,l.view);else{if(w.height-=8,S=l.color,o){var j=e,A=r.createLinearGradient(B,b,B+j,b);A.addColorStop(0,S),A.addColorStop(.9,S),A.addColorStop(1,ki),S=A,w.width=o}Bc(r,l.ss,w,l.font,S,l.align),o&&(w.width=j),w.height+=8}}else if(l.icon)sl(r,Om(l.icon),B,b,e,p,l.data,l.view);else{var y=e/2;P&&(r.lineWidth=P,r.lineJoin="round",r.lineCap="round",r.strokeStyle=W?W:Gg(S),r.beginPath(),r.arc(B+y,b+y,y,Yp,1.6*s,!0),r.moveTo(B+y,b+p),r.lineTo(B+e-y/5,b+y),r.stroke(),r.strokeStyle=W?W:Xj(S),r.beginPath(),r.arc(B+y,b+y,y,1.6*s,Yp,!0),r.moveTo(B+y,b+p),r.lineTo(B+y/5,b+y),r.stroke()),r.fillStyle=S,r.beginPath(),r.arc(B+y,b+y,y,0,Q,!0),r.moveTo(B+y,b+p),r.lineTo(B+e-y/5,b+y),r.lineTo(B+y/5,b+y),r.closePath(),r.fill(),r.fillStyle=l.color,r.beginPath(),r.arc(B+y,b+y,y/3,0,Q,!0),r.fill()}_&&r.restore(),N!=z&&(r.globalAlpha=J)}},we=function(n,z){return z>2*n?n:z/2},$g=function(x,C,Q,k){if(!x||!C)return 0;var t=Wc(C.y-x.y,C.x-x.x);return Q||(t=C.x<x.x?t+s:t),t+k},sj=function(Z,P,Q,q,G,R,z){z&&(Z.x>P.x||Z.x===P.x&&Z.y>P.y)&&(Q=nm[Q],G=-G);var j=Gb(Q,{x:0,y:0,width:bh(Z,P),height:0},R);return j.x+=q,j.y+=G,j=new hg(Wc(P.y-Z.y,P.x-Z.x)).tf(j),j.x+=Z.x,j.y+=Z.y,j},xk=function(l,K,V,n,I){if(l._19Q=!0,!V.getEdgeGroup())return n?V.s("edge.gap"):0;if(Xr(V.getSourceAgent())||Xr(V.getTargetAgent()))return 0;var s,B=0,q=0,P=0;if(V.getEdgeGroup().getSiblings().each(function(t){t.each(function(E){if(K.isVisible(E)&&E.s(Ur)==I){var U=E.s("edge.gap");s?(q+=P/2+U/2,P=U):(s=E,P=U),E===V&&(B=q)}})}),n)return q-B+P;var x=B-q/2;return s&&V._40I!==s._40I&&(l._19Q=!1),x},qi=function(s){var E=s._getValidSelection();if(1===E.length){var N=E[0],u=N instanceof _.Edge;if(N instanceof _.Shape||u){if(u){var C=N.s("edge.type");if(C&&"points"!==C)return}var K=s.gv;if((!K.isPointEditable||K.isPointEditable(N))&&K.isEditable(N))return N}}},Rj=function(){var j=function(u){var Y=[];return u.forEach(function($){Y.push({x:$.x,y:$.y}),Y.push({x:$.x+$.width,y:$.y+$.height}),Y.push({x:$.x+$.width,y:$.y}),Y.push({x:$.x,y:$.y+$.height})}),Y};return function(G,F,c){if("oval"===G){var A=0,h=c.height/c.width,C=h*h,Q=c.x+c.width/2,p=c.y+c.height/2,m=j(F);m.forEach(function(I){var K=I.x-Q,F=I.y-p,h=K*K+F*F/C;h>A&&(A=h)}),A=l(A);var v=h*A;return{x:Q-A,y:p-v,width:2*A,height:2*v}}if("circle"===G){var y=0,Q=c.x+c.width/2,p=c.y+c.height/2,m=j(F);return m.forEach(function(O){var $=O.x-Q,I=O.y-p,z=$*$+I*I;z>y&&(y=z)}),y=l(y),{x:Q-y,y:p-y,width:2*y,height:2*y}}return"roundRect"===G?(gp(c,H(c.width,c.height)/16),c):c}}(),xo=_.graph={},Ee=function(I,f,z){Fm(j+".graph."+I,f,z)};_.layout={};var Tm={},yh=function(K,r,M,J,o,b,R,v){var m=R._zoom;if(!m)return r;if(m!==R._cacheZoom&&(R._cacheZoom=m,R._cacheImage={}),m*=sq,J=Math.ceil(J),o=Math.ceil(o),J*m>2048||o*m>2048)return r;var U=[r.uuid,J,o,M].join("_");if(b instanceof _.Data){var C=r.dataBindings;if(C)for(var t=C.length-1;t>=0;t--){var h=b.a(C[t].attr);Th(h)||Jm(h)||(U+="_"+h)}}if(r.cacheRule){var k;k=Qr(r.cacheRule)?r.cacheRule(b,R):Gq(r.cacheRule,b,R),U+="_"+k}var d,W=1;o>=J&&W>J*m?(d=o/J,J=W/m,o=J*d):J>=o&&W>o*m&&(d=J/o,o=W/m,J=o*d),J=Math.ceil(J),o=Math.ceil(o);var B=R._cacheImage[U];if(!B){if(Wi(),B=_.Default.toCanvas(r,J,o,M,b,R,v,m),!Ne())return r;R._cacheImage[U]=B}return B};Lp(m,{setImageCacheRule:function(s,r){var v;r||"object"!=typeof s?(v={},v[s]=r):v=s;for(var n in v){var _=v[n];hq(n)?(Fm=Om(n),Fm?Fm.cacheRule=_:Tm[n]=_):n.cacheRule=_}}});var mr={comps:[{type:Sd,points:[85,50,70,115,100,71,86,107,88,49,56,49,97,51,106,101,79,48,67,100,66,114,43,78,69,116,114,113,85,43,111,103,106,105,79,117,76,56,54,74,82,70,69,61],borderWidth:1,borderColor:z}]};if(mr[yb]=mr[bg]=160,d.Image){var si=new d.Image;si.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",ej("default_blank",si)}ej("node_image",$c(30,30,[{type:Ol,rect:[4,5,22,16],gradient:Td,gradientColor:rc,background:rg},{type:Ol,rect:[2,3,26,20],borderWidth:1,borderColor:rg},{type:Ol,rect:[11,23,8,4],background:rg},{type:Ol,rect:[6,27,18,2],background:rg}])),ej("node_icon",$c(16,16,[{type:Ol,rect:[2,2,12,10],gradient:Td,gradientColor:rc,background:rg},{type:Kh,rect:[2,2,12,10],width:1,color:rg},{type:Ol,rect:[6,12,4,2],background:rg},{type:Ol,rect:[4,14,8,1],background:rg}])),ej("block_icon",$c(16,16,[{type:Kh,rect:[1,1,14,14],width:1,color:rg}])),ej("group_image",$c(66,39,[{type:Ol,rect:[44.3,18,18.1,12.8],gradient:Td,gradientColor:rc,background:rg},{type:Ol,rect:[3.3,17.8,18.1,12.8],gradient:Td,gradientColor:rc,background:rg},{type:Ol,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:rg,gradient:Td,gradientColor:rc,background:rg},{type:Ol,rect:[26.2,29.4,12.8,4.2],background:rg},{type:Ol,rect:[21.3,33.5,22.5,2.3],background:rg},{type:Ol,rect:[5.3,32.7,14.1,2.1],background:rg},{type:Ol,rect:[9,30.4,6.7,2.4],background:rg},{type:Ol,rect:[50,30.7,6.7,2.4],background:rg},{type:Ol,rect:[46.3,33,14.1,2.1],background:rg}])),ej("group_icon",$c(16,16,[{type:Ol,rect:[4,12,4,2],background:rg},{type:Ol,rect:[2,13,8,1],background:rg},{type:Ol,rect:[12,12,2,1],background:rg},{type:Ol,rect:[11,13,4,1],background:rg},{type:Ol,rect:[10,7,6,5],gradient:Td,gradientColor:rc,background:rg},{type:Ol,rect:[1,2,10,10],gradient:Td,gradientColor:rc,background:rg},{type:Kh,rect:[1,2,10,10],width:1,color:rg}])),ej("refGraph_icon",$c(16,16,[{type:"shape",borderWidth:1,borderColor:rg,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:rg,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),ej("edge_icon",$c(16,16,[{type:Ol,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Td,gradientColor:rc,background:rg},{type:Ol,rect:[10.8,1,4,4],background:rg},{type:Ol,rect:[1,11,4,4],background:rg}])),ej("subGraph_image",$c(72,45,[{type:Sd,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Td,gradientColor:rc,background:rg},{type:Ol,rect:[29.6,30.7,3.6,1.8],background:rg},{type:Ol,rect:[28.4,32.3,6,1.2],background:rg},{type:Ol,rect:[37.3,32,10.8,1.8],background:rg},{type:Ol,rect:[39.1,29.9,7.2,2.3],background:rg},{type:Ol,rect:[26.6,23.7,9.6,7.2],gradient:Td,gradientColor:rc,background:rg},{type:Ol,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:rg,gradient:Td,gradientColor:rc,background:rg}])),ej("subGraph_icon",$c(17,17,[{type:Sd,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Td,gradientColor:rc,background:rg}])),ej("shape_icon",$c(16,16,[{type:Sd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:rg}])),ej("polyline_icon",$c(16,16,[{type:Sd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:rg},xm(7.5,.4),xm(7.5,6.3),xm(13.6,6.3),xm(13.6,14),xm(.7,13.9),xm(.7,.3)])),ej("grid_icon",$c(16,16,[{type:Ol,rect:[1,1,4,4],background:rg,gradient:Td,gradientColor:rc},{type:Ol,rect:[6,1,4,4],background:rg,gradient:Td,gradientColor:rc},{type:Ol,rect:[11,1,4,4],background:rg,gradient:Td,gradientColor:rc},{type:Ol,rect:[11,6,4,4],background:rg,gradient:Td,gradientColor:rc},{type:Ol,rect:[6,6,4,4],background:rg,gradient:Td,gradientColor:rc},{type:Ol,rect:[1,6,4,4],background:rg,gradient:Td,gradientColor:rc},{type:Ol,rect:[11,11,4,4],background:rg,gradient:Td,gradientColor:rc},{type:Ol,rect:[6,11,4,4],background:rg,gradient:Td,gradientColor:rc},{type:Ol,rect:[1,11,4,4],background:rg,gradient:Td,gradientColor:rc}])),ej("light_icon",$c(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:rg},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:rg,gradient:Td,gradientColor:rc,background:{func:function(m){var W=m?m.s(wc):z;return Jm(W)?"rgb("+Mm(255*W[0])+","+Mm(255*W[1])+","+Mm(255*W[2])+")":W||rg}}}])),ej("text_icon",$c(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:rg}])),ej("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),ej("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),ej("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),ej("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var yg=function(d,G,m,H,q,l){var e,M,u,B,x,f,X,b,Q,n,N,L=[];if(Math.abs(H)>2*Math.PI&&(H=2*Math.PI),x=Math.ceil(Math.abs(H)/(Math.PI/4)),e=H/x,M=-e,u=-m,x>0){f=d+Math.cos(m)*q,X=G+Math.sin(-m)*l,L.push({x:f,y:X});for(var O=0;x>O;O++)u+=M,B=u-M/2,b=d+Math.cos(u)*q,Q=G+Math.sin(u)*l,n=d+Math.cos(B)*(q/Math.cos(M/2)),N=G+Math.sin(B)*(l/Math.cos(M/2)),L.push({x:n,y:N}),L.push({x:b,y:Q})}return L},Cq=function(i){if(i){var X=i._data;if(X instanceof _.Shape)return{points:X.getPoints(),segments:X.getSegments()};var O;if(X instanceof _.Edge&&(O=i._78o)){var c,h,o=O.type,p=O.points,L=O.segments,r=O.edgeTypeInfo;if(!o||p){var P=O.sourcePoint,A=P.x,V=P.y,Y=O.targetPoint,y=Y.x,K=Y.y;if(o)L?(c=new An({x:A,y:V}),c.addAll(p),c.add({x:y,y:K}),h=new An(L._as)):(c=new An({x:A,y:V}),p.each(function(M){c.add(M)}),c.add({x:y,y:K}));else if(O.looped){c=new An(yg(A,V,0,2*Math.PI,O.radius,O.radius)),h=new An([1]);for(var j=0;j<(c.size()-1)/2;j++)h.add(3)}else c=new An,O.center?(c.add({x:O.c1.x,y:O.c1.y}),c.add({x:A,y:V}),c.add({x:y,y:K}),c.add({x:O.c2.x,y:O.c2.y})):(c.add({x:A,y:V}),c.add({x:y,y:K}))}else r&&(c=new An(r.points._as),r.segments&&(h=new An(r.segments._as)));return{points:c,segments:h}}}},kn=function(m,l,K){if(null==l){var f=Cq(m);if(!f)return;l=f.points,K=f.segments}if(l){if(Array.isArray(l)&&(l=new An(l)),"number"==typeof l.get(0)){for(var P=new _.List,W=0;W<l.size();W+=2)P.add({x:l.get(W),y:l.get(W+1)});l=P}if(!K){K=[1];for(var s=l.length-1;s>0;s--)K.push(2)}Array.isArray(K)&&(K=new An(K));for(var H=Qf(l._as,K._as,50),q=H.length,T=[],W=0;q>W;W++){var N=H[W];N.length>1&&T.push(N)}return T}},Xp=function(C){for(var s=0,S=C.length-1,_=0;S>_;_++){var I=C[_],m=C[_+1],L=m.x-I.x,w=m.y-I.y;s+=Math.sqrt(L*L+w*w)}return s},zc=function(w,k){for(var R=0,z=k.length,Y=0;z>Y;Y++){var S=k[Y];if(R+=S,R>w)return Y}return Math.min(Y,z-1)},Ao=function(g,i){for(var f=0,$=0,Q=0,N=g.length-1,I=0;N>I;I++){var L=g[I],T=g[I+1],R=T.x-L.x,w=T.y-L.y;if(Q=Math.sqrt(R*R+w*w),f+=Q,f>i){f-=Q,$=I;break}}var c=g[$],F=g[$+1],e=Math.atan2(F.y-c.y,F.x-c.x),o=i-f,w=Math.sin(e)*o,R=Math.cos(e)*o;return{x:c.x+R,y:c.y+w}},Sp=function(Y,i){if(Y){var w;if(0===i)w=Y[0][0];else if(100===i)Y=Y[Y.length-1],w=Y[Y.length-1];else{for(var x=0,p=[],q=Y.length,Q=0;q>Q;Q++){var W=Y[Q],L=Xp(W);x+=L,p.push(L)}for(var f=x*i/100,H=zc(f,p),c=0,y=0;H>y;y++)c+=p[y];f-=c,w=Ao(Y[H],f)}return w}},ik=function(L){var T,t;if(L instanceof _l){var x=Cq(L);T=x.points,t=x.segments}else T=arguments[0],t=arguments[1];var Z,c,q,k,b=[],l=-1;for(c=0,q=t?t.length:T.length;q>c;c++){if(Z=t?t.get(c):1,3===Z)k=2;else if(4===Z)k=3;else{if(5===Z)continue;k=1}l+=k,b.push(T.get(l))}return b},Cf=function(z,K,X,U){function H(W){if(W>=0&&1>=W){D=K(W);var T=(z.x-D.x)*(z.x-D.x)+(z.y-D.y)*(z.y-D.y);return y>T?(y=T,V=W,!0):!1}}X=X||100,U=U||1e-5;for(var y=1/0,V=0,D=new sm,G=0;X>G;++G)H(G/X);for(var F=1/(2*X);F>U;)H(V-F)||H(V+F)||(F/=2);return V};Lp(m,{_edgeProtectMethod:{getStraightLinePoints:kn,calculateLineLength:Xp,calcSegmentIndexByDistance:zc,calculatePointAlongLine:Ao,getPercentPosition:Sp,getRealPointsFromDataUI:ik}});var jh=function(j,X){for(var h=j.vertices,$=0;$<h.length;$++){var m=h[$],f=m.y;m.y=m.z,m.z=-f,X&&(m.y+=X)}},nj=function(K){for(var i,s,O,I,C,E,l=[],J=[],$=[],p=K.faces,j=0,z=0,h=0,y=p.length;y>j;j++,z+=6,h+=9){var x=p[j];1===x.i?(i||(i=[],s=[],O=[]),Hf(x,j,z,h,K,i,O,s)):2===x.i?(I||(I=[],C=[],E=[]),Hf(x,j,z,h,K,I,E,C)):Hf(x,j,z,h,K,l,$,J)}return{vs:l,uv:J,ns:$,top_vs:i,top_uv:s,top_ns:O,bottom_vs:I,bottom_uv:C,bottom_ns:E}},Hf=function($,S,C,F,J,c,G,i){var R=J.vertices,g=J.faceVertexUvs,E=R[$.a],D=R[$.b],K=R[$.c];c.push(E.x,E.y,E.z,D.x,D.y,D.z,K.x,K.y,K.z);var k,Q,f,a=$.vertexNormals;3===a.length?(k=a[0],Q=a[1],f=a[2]):k=Q=f=$.normal,G.push(k.x,k.y,k.z,Q.x,Q.y,Q.z,f.x,f.y,f.z);var d=g[0][S][0],m=g[0][S][1],Y=g[0][S][2];i.push(d.x,d.y,m.x,m.y,Y.x,Y.y)},qm=function(z){var B;B=Jm(z)?z:[z];var e,o,P,w,X,A,U,v,i=1/0,n=1/0,M=1/0,s=-1/0,E=-1/0,u=-1/0,J=["vs","top_vs","bottom_vs"];for(e=0,o=B.length;o>e;e++)for(v=B[e],P=0,w=J.length;w>P;P++)if(U=v[J[P]])for(X=0,A=U.length;A>X;X+=3)i=H(i,U[X]),n=H(n,U[X+1]),M=H(M,U[X+2]),s=$(s,U[X]),E=$(E,U[X+1]),u=$(u,U[X+2]);var t={min:{x:i,y:n,z:M},max:{x:s,y:E,z:u}};return z.boundingBox=t,t},ml=function(){function u(w,T){return w.dot(T)>0}function D(H,L,N,U,G,i,K){for(var S,e,R=[L,N,U],k=[G,i,K],r=[],Y=R.length,Z=!0;Y--&&Z;){for(var E=R[Y],d=k.length,n=!1;d--;)if(E.equals(k[d])){k.splice(d,1),r.push(E),n=!0;break}if(!n){if(S){Z=!1;break}S=E}}return Z&&2===r.length&&(e=k[0],j.subVectors(S,r[0]),Q.subVectors(e,r[0]),P.subVectors(S,r[1]),j.x*P.y*Q.z+P.x*Q.y*j.z+Q.x*j.y*P.z-Q.x*P.y*j.z-Q.y*P.z*j.x-Q.z*P.x*j.y<1e-6&&(_.subVectors(e,r[1]),m.subVectors(r[1],r[0]),u(m,j)&&u(m,Q)&&(m.negate(),u(m,P)&&u(m,_))))?(H.push(r[1].x,r[1].y,r[1].z),H.push(S.x,S.y,S.z),H.push(S.x,S.y,S.z),H.push(r[0].x,r[0].y,r[0].z),H.push(r[0].x,r[0].y,r[0].z),H.push(e.x,e.y,e.z),H.push(e.x,e.y,e.z),H.push(r[1].x,r[1].y,r[1].z),2):(H.push(L.x,L.y,L.z),H.push(N.x,N.y,N.z),H.push(N.x,N.y,N.z),H.push(U.x,U.y,U.z),H.push(U.x,U.y,U.z),H.push(L.x,L.y,L.z),1)}function Y(){this._vertexMap={},this._lineMap={},this._lineList=[]
}function G(E,L,p,e,A,o,k){var v=[p,A];E[0]===e&&v.reverse();var S=[v[0]._key,v[1]._key].join("|"),G=E._triangles[S];G||(E._triangles[S]=G={});var $=[o._key,k._key].join("|");G[$]||(G[$]=[o,k])}function h(L,o,D){var $=L._planes[D._key];if(!$)for(var s in L._planes){var F=L._planes[s];if(F._normal.angleTo(D)<.001){$=F;break}}return $?($._vertices.indexOf(o)<0&&$._vertices.push(o),void 0):(L._planes[D._key]={_normal:D,_vertices:[o]},void 0)}function t(_,u){return 0===u?"0|0|0":1/0===Math.abs(u)?[_.x,_.y,_.z].join("|"):[Math.round(V.angleTo(_)*u),Math.round(H.angleTo(_)*u),Math.round(v.angleTo(_)*u)].join("|")}function U(S,W){var R=S._ctlineModel;if(R||(S._ctlineModel=R=[]),R[0])return R[0];var Q;Q=Jm(S)?S:[S];var J,X,K,i,x,k,Y,V,o,j,O,$,T,F,z,s,f,G,m,w=["","top_","bottom_"];R=[];var Z=[];for(Gd(Q,W,Z),J=0,X=Z.length;X>J;J++)if(j=Z[J])for(bj(j),K=0,i=w.length;i>K;K++)if(o=j[w[K]+"lvs"])for(f=R.length,G=o.length,R.length=f+G,m=0;G>m;++m,++f)R[f]=o[m];else if(Y=j[w[K]+"vs"]){V=j[w[K]+"is"],k=V?V.length:Y.length/3;for(var x=0;k-1>x;)V?(O=V[x],$=V[x+1],T=V[x+2],F=V[x+3],z=V[x+4],s=V[x+5]):(O=x,$=x+1,T=x+2,F=x+3,z=x+4,s=x+5),C.fromArray(Y,3*O),I.fromArray(Y,3*$),n.fromArray(Y,3*T),N.fromArray(Y,3*F),d.fromArray(Y,3*z),L.fromArray(Y,3*s),x+=3*D(R,C,I,n,N,d,L);k>x&&(V?(O=V[x],$=V[x+1],T=V[x+2]):(O=x,$=x+1,T=x+2),C.fromArray(Y,3*O),I.fromArray(Y,3*$),n.fromArray(Y,3*T),R.push(C.x,C.y,C.z),R.push(I.x,I.y,I.z),R.push(I.x,I.y,I.z),R.push(n.x,n.y,n.z),R.push(n.x,n.y,n.z),R.push(C.x,C.y,C.z))}return S._ctlineModel[0]=R,R}function f(M,d,A){var p=M._ctlineModel;p||(M._ctlineModel=p=[]);var f=p[1];if(f&&f.epsilon===A)return f;f=[],f.epsilon=A;var h;h=Jm(M)?M:[M];var Q,$,Z,L,t,T,z,i,g,s,P,F,n=["","top_","bottom_"],e=new Y,O=[];for(Gd(h,d,O),Q=0,$=O.length;$>Q;Q++)if(g=O[Q])for(bj(g),Z=0,L=n.length;L>Z;Z++)if(z=g[n[Z]+"vs"]){i=g[n[Z]+"is"],T=i?i.length:z.length/3;for(var t=0,t=0;T>t;t+=3)i?(s=i[t],P=i[t+1],F=i[t+2]):(s=t,P=t+1,F=t+2),e._addTriangle(z,B,s,P,F,A)}return e._toLineVS(f),M._ctlineModel[1]=f,f}function R(i,t,A){var f=i._ctlineModel;f||(i._ctlineModel=f=[]);var Z=f[2];if(Z&&Z.epsilon===A)return Z;Z=[],Z.epsilon=A;var g;g=Jm(i)?i:[i];var m,e,O,j,J,y,K,c,E,V,w,M,a,h=["","top_","bottom_"],C=new Y,Q=[];for(Gd(g,t,Q),m=0,e=Q.length;e>m;m++)if(V=Q[m])for(bj(V),O=0,j=h.length;j>O;O++)if(K=V[h[O]+"vs"]){c=V[h[O]+"is"],E=V[h[O]+"ns"],y=c?c.length:K.length/3;for(var J=0,J=0;y>J;J+=3)c?(w=c[J],M=c[J+1],a=c[J+2]):(w=J,M=J+1,a=J+2),C._addTriangle(K,E,w,M,a,A)}return C._toLineVS(Z),i._ctlineModel[2]=Z,Z}var C=new Or,I=new Or,n=new Or,N=new Or,d=new Or,L=new Or,j=new Or,P=new Or,Q=new Or,_=new Or,m=new Or,e=new Or;Y.prototype._findVertex=function(u,k){e.fromArray(u,3*k);var V=[e.x,e.y,e.z].join(","),s=this._vertexMap[V];if(!s){var W=e.clone();W._key=V,this._vertexMap[V]=s=W}return s},Y.prototype._findLine=function(I,k){var W=[I,k];I._key>k._key&&W.reverse(),W._key=[W[0]._key,W[1]._key].join("|");var X=this._lineMap[W._key];return X||(this._lineMap[W._key]=X=W,W._triangles={},W._planes={},this._lineList.push(W)),X};var V=new Or(1,0,0),H=new Or(0,1,0),v=new Or(0,0,1),K=new Or,i=new Or;return Y.prototype._addTriangle=function(n,p,W,z,v,l){var q,o,b,S=this._findVertex(n,W),L=this._findVertex(n,z),r=this._findVertex(n,v),k=this._findLine(S,L),J=this._findLine(L,r),m=this._findLine(r,S);p?(q=(new Or).fromArray(p,3*W),q._key=t(q,l),o=(new Or).fromArray(p,3*z),o._key=t(o,l),b=(new Or).fromArray(p,3*v),b._key=t(b,l),G(k,S,q,L,o,r,b),G(J,L,o,r,b,S,q),G(m,r,b,S,q,L,o)):(i.subVectors(r,L),K.subVectors(L,S),q=(new Or).crossVectors(K,i),q._key=t(q,l),h(k,r,q),h(J,S,q),h(m,L,q))},Y.prototype._toLineVS=function(t){for(var q=this._lineList,R=0,F=q.length;F>R;++R){var d=q[R],n=!1;for(var $ in d._triangles)if(1==S.keys(d._triangles[$]).length){t.push(d[0].x,d[0].y,d[0].z,d[1].x,d[1].y,d[1].z),n=!0;break}if(!n)for(var u in d._planes)if(1==d._planes[u]._vertices.length){t.push(d[0].x,d[0].y,d[0].z,d[1].x,d[1].y,d[1].z),n=!0;break}}},[U,f,R]}(),zd=function(R,y){var M=R._lineModel;if(M)return M;var r;r=Jm(R)?R:[R];var X,m,U,L,H,G,Q,V,v,x,$,W,Y=["","top_","bottom_"];M=[];var A=[];for(Gd(R,y,A),X=0,m=A.length;m>X;X++)if(v=A[X])for(U=0,L=Y.length;L>U;U++)if(Q=v[Y[U]+"vs"]){V=v[Y[U]+"is"],G=V?V.length:Q.length/3;for(var H=0;G>H;H+=3)V?(x=V[H],$=V[H+1],W=V[H+2]):(x=H,$=H+1,W=H+2),x*=3,$*=3,W*=3,M.push(Q[x],Q[x+1],Q[x+2],Q[$],Q[$+1],Q[$+2],Q[$],Q[$+1],Q[$+2],Q[W],Q[W+1],Q[W+2],Q[W],Q[W+1],Q[W+2],Q[x],Q[x+1],Q[x+2])}return R._lineModel=M,M},jo=function(Z,g,Y,N,u,w,K,O,o,s){Y==z&&(Y=!0),N==z&&(N=!0),K==z&&(K=1),O==z&&(O=0);var _=new Lg;Ff(_,Z,g,o),_=_.toShapes();var R=B;return s&&(s.length?R={minX:s[0],minY:-s[3],maxX:s[2],maxY:-s[1]}:(R={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},_.forEach(function(t){var Z=t.getBoundingBox();R.minX=H(Z.minX,R.minX),R.minY=H(Z.minY,R.minY),R.maxX=$(Z.maxX,R.maxX),R.maxY=$(Z.maxY,R.maxY)}))),nj(new iq(_,{top:Y,bottom:N,curveSegments:u,amount:K,repeatUVLength:w,boundingBox:R},-K/2+O))},Kq=function(O,d){this.repeatUVLength=O,this._bb=d};Kq.prototype={generateTopUV:function(L,D,h,b,P,i,z){var V,n,j,w,g=L.vertices,e=g[b].x,f=g[b].y,$=g[P].x,S=g[P].y,m=g[i].x,y=g[i].y,_=this.repeatUVLength;if(_)V=0,n=0,j=_,w=_;else{this._bb||(this._bb=D.getBoundingBox());var t=this._bb;V=t.minX,n=t.minY,j=t.maxX-V,w=t.maxY-n}return z?[new go((e-V)/j,(f-n)/w),new go(($-V)/j,(S-n)/w),new go((m-V)/j,(y-n)/w)]:[new go((e-V)/j,1-(f-n)/w),new go(($-V)/j,1-(S-n)/w),new go((m-V)/j,1-(y-n)/w)]},generateBottomUV:function(W,L,G,n,y,J){return this.generateTopUV(W,L,G,n,y,J,!0)},generateSideWallUV:function(A,q,d,n,x,N,B,H,_,S,L,V){if(!this._cl){for(var h,b,y=[],r=0,C=d.length,s=0;C>s;s++){h=d[s],b=d[(s+1)%C];var I=h.x-b.x,$=h.y-b.y,z=l(I*I+$*$);y.push(r),r+=z}for(var s=0;C>s;s++)y[s]/=r;this._cl=y}var y=this._cl,R=1-_/S,M=1-(_+1)/S,J=y[L],X=y[V];return X>J&&(J+=1),[new go(J,R),new go(X,R),new go(X,M),new go(J,M)]}};var dd=function(Z,C,y,A,V,B){this.a=Z,this.b=C,this.c=y,this.i=B,this.normal=A instanceof Yb?A:new Yb,this.vertexNormals=A instanceof Array?A:[]};dd.prototype={constructor:dd};var ro=[-8,14,-2,13,3,5,1,6,-1],_d=function(){if(_d[xe]!=z)return _d[xe];for(var s=yr[xe],N=ro,u=fk.prototype.getClassName(),n='"',Z=0,J="",q=!1,X=+new(d[u.substr(3,3)+Cc[Z]]),B=Z;B<N.length;B++){var Y=N.length-B;J+=B%2===Z?N[B]+Y+"":N[B]-Y+""}for(var B=Z;4>B;B++)J+=Z;if(J=J*J.length/J.length,X>J){if(s&&s[Z]&&s[4/Ol.length]){for(var D,G,m,e,h,l,C,F,c=s[0],$=s[1],a="",r=0,B=0;B<$.length;B++)$[B]===n?F?(F=!1,0!==r%2&&(D==z?D=a:G==z?G=a:m==z?m=a:e==z?e=a:h==z?h=a:l==z?l=a:C==z&&(C=a)),r++,a=""):F=!0:F&&(a+=$[B]);for(var k,R,V,v="",M=0,B=0;B<c.length;B++)c[B]===n?k?(k=!1,0!==M%2&&(R==z?R=v:V==z&&(V=v)),M++,v=""):k=!0:k&&(v+=c[B]);var p=D+G+m+e+h+l,S=!l||l===fj;if(!S&&l)for(var b,B=0,g=l.length;g>B;B++)l[B]===Yd[4]?b===fj?S=Qb:b[0]===ql[7]&&fj&&fj.indexOf(b.substr(1))>=0?S=uk:b=z:(b==z?b=l[B]:b+=l[B],B===g-1&&(b===fj?S=Qb:b[0]===ql[7]&&fj&&fj.indexOf(b.substr(1))>=0&&(S=uk)));(q=Gi(p,C)&&Gi(R,V)&&R===D&&S&&(!h||h>X))&&m.indexOf(nr[0])>=0&&(_d[nr[0]]=1),q&&m.indexOf(1)>=0&&(_d[1]=1),q&&m.indexOf(3)>=0&&(_d[2]=1),q&&m.indexOf(4)>=0&&(_d[3]=1),q&&m.indexOf(7)>=0&&(_d[4]=1),q&&m.indexOf(Kd[1])>=0&&(_d[Kd[1]]=1),q&&m.indexOf(wo[0])>=0&&(_d[wo[0]]=1)}}else q=!0,_d[nr[0]]=_d[1]=_d[2]=_d[3]=_d[4]=_d[Kd[1]]=_d[wo[0]]=1;return _d[xe]=q,q},nn=function(){},pf=nn.prototype;pf.getPointAt=function(w){var E=this.getUtoTmapping(w);return this.getPoint(E)},pf.getPoints=function(Q){Q||(Q=5);var L,G=[];for(L=0;Q>=L;L++)G.push(this.getPoint(L/Q));return G},pf.getSpacedPoints=function(I){I||(I=5);var f,D=[];for(f=0;I>=f;f++)D.push(this.getPointAt(f/I));return D},pf.getLength=function(){var x=this.getLengths();return x[x.length-1]},pf.getLengths=function(X){if(X||(X=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==X+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var r,F,_=[],C=this.getPoint(0),$=0;for(_.push(0),F=1;X>=F;F++)r=this.getPoint(F/X),$+=r.distanceTo(C),_.push($),C=r;return this.cacheArcLengths=_,_},pf.getUtoTmapping=function(Y,l){var i,x=this.getLengths(),D=0,h=x.length;i=l?l:Y*x[h-1];for(var k,r=0,d=h-1;d>=r;)if(D=e(r+(d-r)/2),k=x[D]-i,0>k)r=D+1;else{if(!(k>0)){d=D;break}d=D-1}if(D=d,x[D]==i){var A=D/(h-1);return A}var E=x[D],O=x[D+1],R=O-E,m=(i-E)/R,A=(D+m)/(h-1);return A},pf.getTangent=function(J){var R=1e-4,K=J-R,v=J+R;0>K&&(K=0),v>1&&(v=1);var L=this.getPoint(K),C=this.getPoint(v),M=C.clone().sub(L);return M.normalize()},pf.getTangentAt=function(e){var p=this.getUtoTmapping(e);return this.getTangent(p)},nn.create=function(g,v){return g.prototype=Wh(nn.prototype),g.prototype.getPoint=v,g};var xq=function(){this.curves=[],this.autoClose=!1},hb=xq.prototype=Wh(pf);hb.add=function(e){this.curves.push(e)},hb.closePath=function(){var w=this.curves[0].getPoint(0),u=this.curves[this.curves.length-1].getPoint(1);w.equals(u)||this.curves.push(new tk(u,w))},hb.getPoint=function(e){for(var x,X,C=e*this.getLength(),Y=this.getCurveLengths(),w=0;w<Y.length;){if(Y[w]>=C){x=Y[w]-C,X=this.curves[w];var Q=1-x/X.getLength();return X.getPointAt(Q)}w++}return null},hb.getLength=function(){var $=this.getCurveLengths();return $[$.length-1]},hb.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var I,b=[],A=0,G=this.curves.length;for(I=0;G>I;I++)A+=this.curves[I].getLength(),b.push(A);return this.cacheLengths=b,b},hb.getTransformedPoints=function(V){return this.getPoints(V)},hb.getBoundingBox=function(){var K,S,B,L,j,M,s=this.getPoints();K=S=Number.NEGATIVE_INFINITY,L=j=Number.POSITIVE_INFINITY;var R,p,J,T,e=s[0]instanceof Yb;for(T=e?new Yb:new go,p=0,J=s.length;J>p;p++)R=s[p],R.x>K&&(K=R.x),R.x<L&&(L=R.x),R.y>S&&(S=R.y),R.y<j&&(j=R.y),e&&(R.z>B&&(B=R.z),R.z<M&&(M=R.z)),T.add(R);var O={minX:L,minY:j,maxX:K,maxY:S};return e&&(O.maxZ=B,O.minZ=M),O};var Me=function(G){xq.call(this),this.actions=[],G&&this.fromPoints(G)},Ge=Me.prototype=Wh(xq.prototype),ln="moveTo",po="lineTo",Vl="quadraticCurveTo",vm="bezierCurveTo",Ni="arc",ug="ellipse";Ge.fromPoints=function(A){this.moveTo(A[0].x,A[0].y);for(var D=1,n=A.length;n>D;D++)this.lineTo(A[D].x,A[D].y)},Ge.moveTo=function(){var C=Array.prototype.slice.call(arguments);this.actions.push({action:ln,args:C})},Ge.lineTo=function(J,h){var g=Array.prototype.slice.call(arguments),e=this.actions[this.actions.length-1].args,f=e[e.length-2],W=e[e.length-1],l=new tk(new go(f,W),new go(J,h));this.curves.push(l),this.actions.push({action:po,args:g})},Ge.quadraticCurveTo=function(q,j,o,X){var a=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,D=g[g.length-2],B=g[g.length-1],w=new jr(new go(D,B),new go(q,j),new go(o,X));this.curves.push(w),this.actions.push({action:Vl,args:a})},Ge.bezierCurveTo=function(C,x,M,s,m,o){var E=Array.prototype.slice.call(arguments),X=this.actions[this.actions.length-1].args,J=X[X.length-2],h=X[X.length-1],k=new Oh(new go(J,h),new go(C,x),new go(M,s),new go(m,o));this.curves.push(k),this.actions.push({action:vm,args:E})},Ge.arc=function(R,S,X,u,F,P){var y=this.actions[this.actions.length-1].args,b=y[y.length-2],H=y[y.length-1];this.absarc(R+b,S+H,X,u,F,P)},Ge.absarc=function(F,p,i,$,Z,d){this.absellipse(F,p,i,i,$,Z,d)},Ge.ellipse=function(H,u,S,x,v,A,z){var J=this.actions[this.actions.length-1].args,V=J[J.length-2],i=J[J.length-1];this.absellipse(H+V,u+i,S,x,v,A,z)},Ge.absellipse=function(m,z,C,$,A,j,t){var Y=Array.prototype.slice.call(arguments),W=new yi(m,z,C,$,A,j,t);this.curves.push(W);var g=W.getPoint(1);Y.push(g.x),Y.push(g.y),this.actions.push({action:ug,args:Y})},Ge.getSpacedPoints=function(q){q||(q=40);for(var p=[],L=0;q>L;L++)p.push(this.getPoint(L/q));return p},Ge.getPoints=function(G,z){G=G||12;var F,$,_,C,T,K,y,O,A,M,s,I,u,v,P,i,W,f,D=[];for(F=0,$=this.actions.length;$>F;F++)switch(_=this.actions[F],C=_.action,T=_.args,C){case ln:D.push(new go(T[0],T[1]));break;case po:D.push(new go(T[0],T[1]));break;case Vl:for(K=T[2],y=T[3],M=T[0],s=T[1],D.length>0?(v=D[D.length-1],I=v.x,u=v.y):(v=this.actions[F-1].args,I=v[v.length-2],u=v[v.length-1]),P=1;G>=P;P++)i=P/G,W=er.b2(i,I,M,K),f=er.b2(i,u,s,y),D.push(new go(W,f));break;case vm:for(K=T[4],y=T[5],M=T[0],s=T[1],O=T[2],A=T[3],D.length>0?(v=D[D.length-1],I=v.x,u=v.y):(v=this.actions[F-1].args,I=v[v.length-2],u=v[v.length-1]),P=1;G>=P;P++)i=P/G,W=er.b3(i,I,M,O,K),f=er.b3(i,u,s,A,y),D.push(new go(W,f));break;case Ni:var d,e=T[0],k=T[1],Q=T[2],S=T[3],Y=T[4],p=!!T[5],H=Y-S,x=2*G;for(P=1;x>=P;P++)i=P/x,p||(i=1-i),d=S+i*H,W=e+Q*c(d),f=k+Q*N(d),D.push(new go(W,f));break;case ug:var d,e=T[0],k=T[1],m=T[2],j=T[3],S=T[4],Y=T[5],p=!!T[6],H=Y-S,x=2*G;for(P=1;x>=P;P++)i=P/x,p||(i=1-i),d=S+i*H,W=e+m*c(d),f=k+j*N(d),D.push(new go(W,f))}var R,g,X=b["shape3d.point.epsilon"],U=!1;for($=D.length,F=0,$=D.length;$>F;F++)R=D[F],g=F===$-1?D[0]:D[F+1],R&&g&&n(R.x-g.x)<X&&n(R.y-g.y)<X&&(U=!0,D[F]=null);if(U){var t=[];for(F=0;$>F;F++)D[F]&&t.push(D[F]);D=t}return z&&D.push(D[0]),D},Ge.toShapes=function(h,K){function a(T){var l,Z,K,a,f,y=[],I=new Me;for(l=0,Z=T.length;Z>l;l++)K=T[l],f=K.args,a=K.action,a==ln&&0!=I.actions.length&&(y.push(I),I=new Me),I[a].apply(I,f);return 0!=I.actions.length&&y.push(I),y}function i(s){for(var k=[],K=0,N=s.length;N>K;K++){var T=s[K],E=new Lg;E.actions=T.actions,E.curves=T.curves,k.push(E)}return k}function l(L,Q){for(var W=1e-10,I=Q.length,d=!1,v=I-1,M=0;I>M;v=M++){var N=Q[v],P=Q[M],U=P.x-N.x,O=P.y-N.y;if(n(O)>W){if(0>O&&(N=Q[M],U=-U,P=Q[v],O=-O),L.y<N.y||L.y>P.y)continue;if(L.y==N.y){if(L.x==N.x)return!0}else{var u=O*(L.x-N.x)-U*(L.y-N.y);if(0==u)return!0;if(0>u)continue;d=!d}}else{if(L.y!=N.y)continue;if(P.x<=L.x&&L.x<=N.x||N.x<=L.x&&L.x<=P.x)return!0}}return d}var V=a(this.actions);if(0==V.length)return[];if(K===!0)return i(V);var q,d,$,p=[];if(1==V.length)return d=V[0],$=new Lg,$.actions=d.actions,$.curves=d.curves,p.push($),p;var Y=!er.isClockWise(V[0].getPoints());Y=h?!Y:Y;var H,J=[],x=[],X=[],S=0;x[S]=B,X[S]=[];var e,F;for(e=0,F=V.length;F>e;e++)d=V[e],H=d.getPoints(),q=er.isClockWise(H),q=h?!q:q,q?(!Y&&x[S]&&S++,x[S]={s:new Lg,p:H},x[S].s.actions=d.actions,x[S].s.curves=d.curves,Y&&S++,X[S]=[]):X[S].push({h:d,p:H[0]});if(!x[0])return i(V);if(x.length>1){for(var s=!1,D=[],r=0,G=x.length;G>r;r++)J[r]=[];for(var r=0,G=x.length;G>r;r++){x[r];for(var W=X[r],c=0;c<W.length;c++){for(var A=W[c],N=!0,Z=0;Z<x.length;Z++)l(A.p,x[Z].p)&&(r!=Z&&D.push({froms:r,tos:Z,hole:c}),N?(N=!1,J[Z].push(A)):s=!0);N&&J[r].push(A)}}D.length>0&&(s||(X=J))}var w,k,u;for(e=0,F=x.length;F>e;e++)for($=x[e].s,p.push($),w=X[e],k=0,u=w.length;u>k;k++)$.holes.push(w[k].h);return p};var Lg=function(){Me.apply(this,arguments),this.holes=[]},vo=Lg.prototype=Wh(Ge);vo.getPointsHoles=function(Q){var r,d=this.holes.length,G=[];for(r=0;d>r;r++)G[r]=this.holes[r].getTransformedPoints(Q);return G},vo.extractAllPoints=function(q){return{shape:this.getTransformedPoints(q),holes:this.getPointsHoles(q)}},vo.extractPoints=function(O){return this.extractAllPoints(O)};var er={triangulateShape:function(M,R){function o(b,e,S){return b.x!=e.x?b.x<e.x?b.x<=S.x&&S.x<=e.x:e.x<=S.x&&S.x<=b.x:b.y<e.y?b.y<=S.y&&S.y<=e.y:e.y<=S.y&&S.y<=b.y}function G(G,f,s,t,h){var z=1e-10,V=f.x-G.x,b=f.y-G.y,w=t.x-s.x,S=t.y-s.y,J=G.x-s.x,X=G.y-s.y,$=b*w-V*S,d=b*J-V*X;if(n($)>z){var e;if($>0){if(0>d||d>$)return[];if(e=S*J-w*X,0>e||e>$)return[]}else{if(d>0||$>d)return[];if(e=S*J-w*X,e>0||$>e)return[]}if(0==e)return!h||0!=d&&d!=$?[G]:[];if(e==$)return!h||0!=d&&d!=$?[f]:[];if(0==d)return[s];if(d==$)return[t];var Y=e/$;return[{x:G.x+Y*V,y:G.y+Y*b}]}if(0!=d||S*J!=w*X)return[];var p=0==V&&0==b,A=0==w&&0==S;if(p&&A)return G.x!=s.x||G.y!=s.y?[]:[G];if(p)return o(s,t,G)?[G]:[];if(A)return o(G,f,s)?[s]:[];var F,N,T,i,D,l,g,E;return 0!=V?(G.x<f.x?(F=G,T=G.x,N=f,i=f.x):(F=f,T=f.x,N=G,i=G.x),s.x<t.x?(D=s,g=s.x,l=t,E=t.x):(D=t,g=t.x,l=s,E=s.x)):(G.y<f.y?(F=G,T=G.y,N=f,i=f.y):(F=f,T=f.y,N=G,i=G.y),s.y<t.y?(D=s,g=s.y,l=t,E=t.y):(D=t,g=t.y,l=s,E=s.y)),g>=T?g>i?[]:i==g?h?[]:[D]:E>=i?[D,N]:[D,l]:T>E?[]:T==E?h?[]:[F]:E>=i?[F,N]:[F,l]}function S(c,_,o,X){var Q=1e-10,v=_.x-c.x,p=_.y-c.y,g=o.x-c.x,S=o.y-c.y,T=X.x-c.x,E=X.y-c.y,M=v*S-p*g,A=v*E-p*T;if(n(M)>Q){var y=T*S-E*g;return M>0?A>=0&&y>=0:A>=0||y>=0}return A>0}function Z(O,u){function e(h,R){var T=r.length-1,d=h-1;0>d&&(d=T);var F=h+1;F>T&&(F=0);var M=S(r[h],r[d],r[F],g[R]);if(!M)return!1;var X=g.length-1,I=R-1;0>I&&(I=X);var N=R+1;return N>X&&(N=0),M=S(g[R],g[I],g[N],r[h]),M?!0:!1}function x(K,J){var e,z,v;for(e=0;e<r.length;e++)if(z=e+1,z%=r.length,v=G(K,J,r[e],r[z],!0),v.length>0)return!0;return!1}function i(i,R){var O,g,X,H,L;for(O=0;O<P.length;O++)for(g=u[P[O]],X=0;X<g.length;X++)if(H=X+1,H%=g.length,L=G(i,R,g[X],g[H],!0),L.length>0)return!0;return!1}for(var g,A,f,$,h,R,M,n,q,d,K,r=O.concat(),P=[],J=[],l=0,t=u.length;t>l;l++)P.push(l);for(var D=0,_=2*P.length;P.length>0&&(_--,!(0>_));)for(f=D;f<r.length;f++){$=r[f],A=-1;for(var l=0;l<P.length;l++)if(R=P[l],M=$.x+":"+$.y+":"+R,J[M]===B){g=u[R];for(var w=0;w<g.length;w++)if(h=g[w],e(f,w)&&!x($,h)&&!i($,h)){A=w,P.splice(l,1),n=r.slice(0,f+1),q=r.slice(f),d=g.slice(A),K=g.slice(0,A+1),r=n.concat(d).concat(K).concat(q),D=f;break}if(A>=0)break;J[M]=!0}if(A>=0)break}return r}for(var m,P,y,k,T,F,Q={},i=M.concat(),w=0,H=R.length;H>w;w++)Array.prototype.push.apply(i,R[w]);for(m=0,P=i.length;P>m;m++)T=i[m].x+":"+i[m].y,Q[T]!==B,Q[T]=m;var t=Z(M,R),e=ed.Triangulate(t,!1);for(m=0,P=e.length;P>m;m++)for(k=e[m],y=0;3>y;y++)T=k[y].x+":"+k[y].y,F=Q[T],F!==B&&(k[y]=F);return e.concat()},isClockWise:function(Z){return ed.Triangulate.area(Z)<0},b2p0:function(K,l){var X=1-K;return X*X*l},b2p1:function(y,i){return 2*(1-y)*y*i},b2p2:function(g,O){return g*g*O},b2:function(C,K,v,N){return this.b2p0(C,K)+this.b2p1(C,v)+this.b2p2(C,N)},b3p0:function(N,B){var r=1-N;return r*r*r*B},b3p1:function(F,z){var y=1-F;return 3*y*y*F*z},b3p2:function(W,h){var S=1-W;return 3*S*W*W*h},b3p3:function(E,j){return E*E*E*j},b3:function(T,u,_,m,y){return this.b3p0(T,u)+this.b3p1(T,_)+this.b3p2(T,m)+this.b3p3(T,y)}},ed={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var p=S.keys(this.faces);return p.length?p[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(t){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(L){var v=L.familyName.toLowerCase(),x=this;return x.faces[v]=x.faces[v]||{},x.faces[v][L.cssFontWeight]=x.faces[v][L.cssFontWeight]||{},x.faces[v][L.cssFontWeight][L.cssFontStyle]=L,L},drawText:function(V){var q,y=this.getFace(),u=this.size/y.resolution,F=0,L=String(V).split(""),h=L.length,J=[];for(q=0;h>q;q++){var e=new Me,Z=this.extractGlyphPoints(L[q],y,u,F,e);Z&&(F+=Z.offset*this.spacing,J.push(Z.path))}var f=F/2;return{paths:J,offset:f}},extractGlyphPoints:function(n,F,Y,r,i){var w,l,H,C,x,a,y,m,S,t,I,L,D,A,k,q,X,c,z,g=[],U=F.glyphs[n]||F.glyphs["?"];if(U){if(U.o)for(C=U._cachedOutline||(U._cachedOutline=U.o.split(" ")),a=C.length,y=Y,m=Y,w=0;a>w;)switch(x=C[w++]){case"m":S=C[w++]*y+r,t=C[w++]*m,i.moveTo(S,t);break;case"l":S=C[w++]*y+r,t=C[w++]*m,i.lineTo(S,t);break;case"q":if(I=C[w++]*y+r,L=C[w++]*m,k=C[w++]*y+r,q=C[w++]*m,i.quadraticCurveTo(k,q,I,L),z=g[g.length-1])for(D=z.x,A=z.y,l=1,H=this.divisions;H>=l;l++){var K=l/H;er.b2(K,D,k,I),er.b2(K,A,q,L)}break;case"b":if(I=C[w++]*y+r,L=C[w++]*m,k=C[w++]*y+r,q=C[w++]*m,X=C[w++]*y+r,c=C[w++]*m,i.bezierCurveTo(k,q,X,c,I,L),z=g[g.length-1])for(D=z.x,A=z.y,l=1,H=this.divisions;H>=l;l++){var K=l/H;er.b3(K,D,k,X,I),er.b3(K,A,q,c,L)}}return{offset:U.ha*Y,path:i}}}};ed.generateShapes=function(P,c){c=c||{};var L=c.font;if(L===B&&(L=ed.getDefaultFont(),!L))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var $=c.size!==B?c.size:1,S=c.curveSegments!==B?c.curveSegments:4,g=c.spacing!==B?c.spacing:1,p=c.weight!==B?c.weight:"normal",C=c.style!==B?c.style:"normal";ed.size=$,ed.divisions=S,ed.face=L,ed.weight=p,ed.style=C,ed.spacing=g;for(var o=ed.drawText(P),K=o.paths,l=[],T=0,Z=K.length;Z>T;T++)Array.prototype.push.apply(l,K[T].toShapes());return l},function(S){var N=1e-10,Z=function(z,D){var N=z.length;if(3>N)return null;var H,v,s,y=[],c=[],Q=[];if(h(z)>0)for(v=0;N>v;v++)c[v]=v;else for(v=0;N>v;v++)c[v]=N-1-v;var X=N,B=2*X;for(v=X-1;X>2;){if(B--<=0)return D?Q:y;if(H=v,H>=X&&(H=0),v=H+1,v>=X&&(v=0),s=v+1,s>=X&&(s=0),W(z,H,v,s,X,c)){var G,r,I,b,R;for(G=c[H],r=c[v],I=c[s],y.push([z[G],z[r],z[I]]),Q.push([c[H],c[v],c[s]]),b=v,R=v+1;X>R;b++,R++)c[b]=c[R];X--,B=2*X}}return D?Q:y},h=function(f){for(var c=f.length,G=0,Q=c-1,U=0;c>U;Q=U++)G+=f[Q].x*f[U].y-f[U].x*f[Q].y;return.5*G},W=function(T,I,n,R,a,x){var t,L,Y,g,F,v,r,$,w;if(L=T[x[I]].x,Y=T[x[I]].y,g=T[x[n]].x,F=T[x[n]].y,v=T[x[R]].x,r=T[x[R]].y,N>(g-L)*(r-Y)-(F-Y)*(v-L))return!1;var i,o,G,J,Z,p,_,h,K,y,f,W,X,q,z;for(i=v-g,o=r-F,G=L-v,J=Y-r,Z=g-L,p=F-Y,t=0;a>t;t++)if($=T[x[t]].x,w=T[x[t]].y,!($===L&&w===Y||$===g&&w===F||$===v&&w===r)&&(_=$-L,h=w-Y,K=$-g,y=w-F,f=$-v,W=w-r,z=i*y-o*K,X=Z*h-p*_,q=G*W-J*f,z>=-N&&q>=-N&&X>=-N))return!1;return!0};return S.Triangulate=Z,S.Triangulate.area=h,S}(ed),d._typeface_js={faces:ed.faces,loadFace:ed.loadFace};var Go=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},tp=Go.prototype={constructor:Go,computeFaceNormals:function(){for(var m=new Yb,h=new Yb,T=0,w=this.faces.length;w>T;T++){var r=this.faces[T],f=this.vertices[r.a],Y=this.vertices[r.b],K=this.vertices[r.c];m.subVectors(K,Y),h.subVectors(f,Y),m.cross(h),m.normalize(),r.normal.copy(m)}},computeVertexNormals:function(u){var v,c,d,r,h,k;for(k=new Array(this.vertices.length),v=0,c=this.vertices.length;c>v;v++)k[v]=new Yb;if(u){var V,t,Z,s=new Yb,l=new Yb;for(d=0,r=this.faces.length;r>d;d++)h=this.faces[d],V=this.vertices[h.a],t=this.vertices[h.b],Z=this.vertices[h.c],s.subVectors(Z,t),l.subVectors(V,t),s.cross(l),k[h.a].add(s),k[h.b].add(s),k[h.c].add(s)}else for(d=0,r=this.faces.length;r>d;d++)h=this.faces[d],k[h.a].add(h.normal),k[h.b].add(h.normal),k[h.c].add(h.normal);for(v=0,c=this.vertices.length;c>v;v++)k[v].normalize();for(d=0,r=this.faces.length;r>d;d++)h=this.faces[d],h.vertexNormals[0]=k[h.a].clone(),h.vertexNormals[1]=k[h.b].clone(),h.vertexNormals[2]=k[h.c].clone()},mergeVertices:function(){var W,x,y,D,r,b,t,c,M={},v=[],q=[],A=4,R=Y(10,A);for(y=0,D=this.vertices.length;D>y;y++)W=this.vertices[y],x=w(W.x*R)+"_"+w(W.y*R)+"_"+w(W.z*R),M[x]===B?(M[x]=y,v.push(this.vertices[y]),q[y]=v.length-1):q[y]=q[M[x]];var T=[];for(y=0,D=this.faces.length;D>y;y++){r=this.faces[y],r.a=q[r.a],r.b=q[r.b],r.c=q[r.c],b=[r.a,r.b,r.c];for(var e=0;3>e;e++)if(b[e]==b[(e+1)%3]){T.push(y);break}}for(y=T.length-1;y>=0;y--){var L=T[y];for(this.faces.splice(L,1),t=0,c=this.faceVertexUvs.length;c>t;t++)this.faceVertexUvs[t].splice(L,1)}var Q=this.vertices.length-v.length;return this.vertices=v,Q}},yi=function(J,S,d,z,L,_,D){this.aX=J,this.aY=S,this.xRadius=d,this.yRadius=z,this.aStartAngle=L,this.aEndAngle=_,this.aClockwise=D};yi.prototype=Wh(pf),yi.prototype.getPoint=function(Y){var d,K=this.aEndAngle-this.aStartAngle;0>K&&(K+=Q),K>Q&&(K-=Q),d=this.aClockwise===!0?this.aEndAngle+(1-Y)*(Q-K):this.aStartAngle+Y*K;var l=this.aX+this.xRadius*c(d),u=this.aY+this.yRadius*N(d);return new go(l,u)};var tk=function(T,D){this.v1=T,this.v2=D},bs=tk.prototype=Wh(pf);bs.getPoint=function(s){var _=this.v2.clone().sub(this.v1);return _.multiplyScalar(s).add(this.v1),_},bs.getPointAt=function(x){return this.getPoint(x)},bs.getTangent=function(){var p=this.v2.clone().sub(this.v1);return p.normalize()};var jr=function(H,G,D){this.v0=H,this.v1=G,this.v2=D};jr.prototype=Wh(pf),jr.prototype.getPoint=function(k){var r,M;return r=er.b2(k,this.v0.x,this.v1.x,this.v2.x),M=er.b2(k,this.v0.y,this.v1.y,this.v2.y),new go(r,M)};var Oh=function(Q,r,D,t){this.v0=Q,this.v1=r,this.v2=D,this.v3=t};Oh.prototype=Wh(pf),Oh.prototype.getPoint=function(X){var L,D;return L=er.b3(X,this.v0.x,this.v1.x,this.v2.x,this.v3.x),D=er.b3(X,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new go(L,D)},nn.create(function(Z,g){this.v1=Z,this.v2=g},function(e){var w=new Yb;return w.subVectors(this.v2,this.v1),w.multiplyScalar(e),w.add(this.v1),w});var db=nn.create(function(D,P,v){this.v0=D,this.v1=P,this.v2=v},function(x){var c,v,f;return c=er.b2(x,this.v0.x,this.v1.x,this.v2.x),v=er.b2(x,this.v0.y,this.v1.y,this.v2.y),f=er.b2(x,this.v0.z,this.v1.z,this.v2.z),new Yb(c,v,f)}),Ap=nn.create(function(h,n,s,x){this.v0=h,this.v1=n,this.v2=s,this.v3=x},function(j){var J,f,y;return J=er.b3(j,this.v0.x,this.v1.x,this.v2.x,this.v3.x),f=er.b3(j,this.v0.y,this.v1.y,this.v2.y,this.v3.y),y=er.b3(j,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Yb(J,f,y)}),Xo=function(V,O,t,m,X,_,C,W){Go.call(this),m=m!==B?m:.5,X=X!==B?X:.5,W=W!==B?W:1,V=V||8,_=_||0,C=C||Q;var T,R,M=1,w=W/2,L=[],q=[],K=this.vertices,n=this.faces,G=this.faceVertexUvs;for(R=0;M>=R;R++){var j=[],v=[],F=R/M,z=F*(X-m)+m;for(T=0;V>=T;T++){var h=T/V,x=new Yb,i=-(h*C+_);x.z=z*N(i),x.y=-F*W+w,x.x=z*c(i),K.push(x),j.push(K.length-1),v.push(new go(h,F))}L.push(j),q.push(v)}var o,s,Z=(X-m)/W;for(T=0;V>T;T++)for(0!==m?(o=K[L[0][T]].clone(),s=K[L[0][T+1]].clone()):(o=K[L[1][T]].clone(),s=K[L[1][T+1]].clone()),o.setY(l(o.x*o.x+o.z*o.z)*Z).normalize(),s.setY(l(s.x*s.x+s.z*s.z)*Z).normalize(),R=0;M>R;R++){var A=L[R][T],$=L[R+1][T],E=L[R+1][T+1],S=L[R][T+1],e=o.clone(),r=o.clone(),d=s.clone(),b=s.clone(),a=q[R][T].clone(),y=q[R+1][T].clone(),I=q[R+1][T+1].clone(),P=q[R][T+1].clone();n.push(new dd(A,$,S,[e,r,b])),G[0].push([a,y,P]),n.push(new dd($,E,S,[r.clone(),d,b.clone()])),G[0].push([y.clone(),I,P.clone()])}if(O&&m>0)for(this.vertices.push(new Yb(0,w,0)),T=0;V>T;T++){var A=L[0][T],$=L[0][T+1],E=this.vertices.length-1,e=new Yb(0,1,0),r=new Yb(0,1,0),d=new Yb(0,1,0),a=q[0][T].clone(),y=q[0][T+1].clone(),I=new go(y.x,0);n.push(new dd(A,$,E,[e,r,d],null,1));var f=T/V*Q,p=c(f),U=N(f),u=(T+1)/V*Q,k=c(u),H=N(u);G[0].push([new go(.5+.5*p,.5+.5*U),new go(.5+.5*k,.5+.5*H),new go(.5,.5)])}if(t&&X>0)for(this.vertices.push(new Yb(0,-w,0)),T=0;V>T;T++){var A=L[R][T+1],$=L[R][T],E=K.length-1,e=new Yb(0,-1,0),r=new Yb(0,-1,0),d=new Yb(0,-1,0),a=q[R][T+1].clone(),y=q[R][T].clone();n.push(new dd(A,$,E,[e,r,d],null,2));var f=T/V*Q,p=c(f),U=N(f),u=(T+1)/V*Q,k=c(u),H=N(u);G[0].push([new go(.5+.5*k,.5-.5*H),new go(.5+.5*p,.5-.5*U),new go(.5,.5)])}};Xo.prototype=Wh(tp);var id=function(e,L,m,O,t,P,o){Go.call(this),o=o||.5,e=e||16,L=L||16,m=(m!==B?m:0)-s,O=O!==B?O:Q,t=t!==B?t:0,P=P!==B?P:s;var R,$,_=[],h=[],j=this.vertices,V=this.faces,G=this.faceVertexUvs;for($=0;L>=$;$++){var z=[],x=[];for(R=0;e>=R;R++){var p=R/e,K=$/L,q=new Yb;q.x=-o*c(m+p*O)*N(t+K*P),q.y=o*c(t+K*P),q.z=o*N(m+p*O)*N(t+K*P),j.push(q),z.push(j.length-1),x.push(new go(p,K))}_.push(z),h.push(x)}for($=0;L>$;$++)for(R=0;e>R;R++){var f=_[$][R+1],d=_[$][R],J=_[$+1][R],Y=_[$+1][R+1],I=j[f].clone().normalize(),b=j[d].clone().normalize(),r=j[J].clone().normalize(),v=j[Y].clone().normalize(),F=h[$][R+1].clone(),H=h[$][R].clone(),D=h[$+1][R].clone(),X=h[$+1][R+1].clone();n(j[f].y)===o?(F.x=(F.x+H.x)/2,V.push(new dd(f,J,Y,[I,r,v])),G[0].push([F,D,X])):n(j[J].y)===o?(D.x=(D.x+X.x)/2,V.push(new dd(f,d,J,[I,b,r])),G[0].push([F,H,D])):(V.push(new dd(f,d,Y,[I,b,v])),G[0].push([F,H,X]),V.push(new dd(d,J,Y,[b.clone(),r,v.clone()])),G[0].push([H.clone(),D,X.clone()]))}};id.prototype=Wh(tp);var wl=function(K,q,D,r,I,W){Go.call(this),K=K||.33,q=q||.17,r=r||8,D=D||6,I=I||0,W=W||Q;for(var d=new Yb,w=[],v=[],M=0;r>=M;M++)for(var X=M/r*Q+s,j=0;D>=j;j++){var e=j/D*W+I;d.x=K*c(e),d.z=-K*N(e);var f=new Yb,U=K+q*c(X);f.x=U*c(e),f.z=-U*N(e),f.y=q*N(X),this.vertices.push(f),w.push(new go(j/D,1-M/r)),v.push(f.clone().sub(d).normalize())}for(var M=1;r>=M;M++)for(var j=1;D>=j;j++){var k=(D+1)*M+j-1,l=(D+1)*(M-1)+j-1,Y=(D+1)*(M-1)+j,h=(D+1)*M+j,R=new dd(k,l,h,[v[k].clone(),v[l].clone(),v[h].clone()]);this.faces.push(R),this.faceVertexUvs[0].push([w[k].clone(),w[l].clone(),w[h].clone()]),R=new dd(l,Y,h,[v[l].clone(),v[Y].clone(),v[h].clone()]),this.faces.push(R),this.faceVertexUvs[0].push([w[l].clone(),w[Y].clone(),w[h].clone()])}this.computeFaceNormals()};wl.prototype=Wh(tp);var iq=function(U,e,c){return U?(Go.call(this),U=U instanceof Array?U:[U],this.addShapeList(U,e),e.convertYZ!==!1&&jh(this,c),this.computeFaceNormals(),void 0):(U=[],void 0)},El=iq.prototype=Wh(Go.prototype);El.addShapeList=function(E,D){for(var P=E.length,B=0;P>B;B++){var X=E[B];this.addShape(X,D)}},El.addShape=function(d,T){function Y(){if(T.bottom)for(var g=0;s>g;g++)r=t[g],S(r[2],r[1],r[0],!0);if(T.top)for(g=0;s>g;g++)r=t[g],S(r[0]+k*e,r[1]+k*e,r[2]+k*e,!1)}function j(){var Z=0;for(P(J,Z),Z+=J.length,W=0,N=x.length;N>W;W++)A=x[W],P(A,Z),Z+=A.length}function P(E,o){for(var S,z,j=E.length;--j>=0;){S=j,z=j-1,0>z&&(z=E.length-1);var y=0,g=e;for(y=0;g>y;y++){var C=k*y,K=k*(y+1),_=o+S+C,R=o+z+C,m=o+z+K,r=o+S+K;M(_,R,m,r,E,y,g,S,z)}}}function K(i,n,j){y.vertices.push(new Yb(i,n,j))}function S(H,N,E,K){H+=l,N+=l,E+=l,y.faces.push(new dd(H,N,E,null,null,K?2:1));var L=K?Z.generateBottomUV(y,d,T,H,N,E):Z.generateTopUV(y,d,T,H,N,E);y.faceVertexUvs[0].push(L)}function M(e,P,p,s,G,u,D,i,o){e+=l,P+=l,p+=l,s+=l,y.faces.push(new dd(e,P,s)),y.faces.push(new dd(P,p,s));var J=Z.generateSideWallUV(y,d,G,T,e,P,p,s,u,D,i,o);y.faceVertexUvs[0].push([J[0],J[1],J[3]]),y.faceVertexUvs[0].push([J[1],J[2],J[3]])}var i,E,c,U,z,L=T.amount,n=T.curveSegments||Lh,e=T.steps||1,F=T.extrudePath,f=!1,Z=new Kq(T.repeatUVLength,T.boundingBox);F&&(i=F.getSpacedPoints(e),f=!0,E=T.frames!==B?T.frames:new eq.FrenetFrames(F,e,!1),c=new Yb,U=new Yb,z=new Yb);var A,W,N,y=this,l=this.vertices.length,$=d.extractPoints(n),o=$.shape,x=$.holes,q=!er.isClockWise(o);if(q){for(o=o.reverse(),W=0,N=x.length;N>W;W++)A=x[W],er.isClockWise(A)&&(x[W]=A.reverse());q=!1}var t=er.triangulateShape(o,x),J=o;for(W=0,N=x.length;N>W;W++)A=x[W],o=o.concat(A);for(var _,r,k=o.length,s=t.length,G=0;k>G;G++)_=o[G],f?(U.copy(E.normals[0]).multiplyScalar(_.x),c.copy(E.binormals[0]).multiplyScalar(_.y),z.copy(i[0]).add(U).add(c),K(z.x,z.y,z.z)):K(_.x,_.y,0);var m;for(m=1;e>=m;m++)for(G=0;k>G;G++)_=o[G],f?(U.copy(E.normals[m]).multiplyScalar(_.x),c.copy(E.binormals[m]).multiplyScalar(_.y),z.copy(i[m]).add(U).add(c),K(z.x,z.y,z.z)):K(_.x,_.y,L/e*m);Y(),j()};var eq=function(M,n,x,r,A){function y(w,G,M){return K.vertices.push(new Yb(w,G,M))-1}Go.call(this),n=n||64,x=x||1,r=r||8,A=A||!1;var p,e,o,U,i,f,I,B,t,b,q,g,u,F,G,Z,E,W,D,S,X=[],K=this,l=n+1,J=new Yb,Y=new eq.FrenetFrames(M,n,A),j=Y.tangents,P=Y.normals,H=Y.binormals;for(this.tangents=j,this.normals=P,this.binormals=H,t=0;l>t;t++)for(X[t]=[],U=t/(l-1),B=M.getPointAt(U),p=j[t],e=P[t],o=H[t],b=0;r>b;b++)i=b/r*Q,f=-x*c(i),I=x*N(i),J.copy(B),J.x+=f*e.x+I*o.x,J.y+=f*e.y+I*o.y,J.z+=f*e.z+I*o.z,X[t][b]=y(J.x,J.y,J.z);for(t=0;n>t;t++)for(b=0;r>b;b++)q=A?(t+1)%n:t+1,g=(b+1)%r,u=X[t][b],F=X[q][b],G=X[q][g],Z=X[t][g],E=new go(t/n,b/r),W=new go((t+1)/n,b/r),D=new go((t+1)/n,(b+1)/r),S=new go(t/n,(b+1)/r),this.faces.push(new dd(u,F,Z)),this.faceVertexUvs[0].push([E,W,S]),this.faces.push(new dd(F,G,Z)),this.faceVertexUvs[0].push([W.clone(),D,S.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};eq.prototype=Wh(tp),eq.FrenetFrames=function(G,o,d){function B(){j[0]=new Yb,K[0]=new Yb,k=Number.MAX_VALUE,g=n(Q[0].x),I=n(Q[0].y),b=n(Q[0].z),k>=g&&(k=g,r.set(1,0,0)),k>=I&&(k=I,r.set(0,1,0)),k>=b&&r.set(0,0,1),f.crossVectors(Q[0],r).normalize(),j[0].crossVectors(Q[0],f),K[0].crossVectors(Q[0],j[0])}var M,k,g,I,b,Z,a,r=new Yb,Q=[],j=[],K=[],f=new Yb,y=new vr,R=o+1,p=1e-4;for(this.tangents=Q,this.normals=j,this.binormals=K,Z=0;R>Z;Z++)a=Z/(R-1),Q[Z]=G.getTangentAt(a),Q[Z].normalize();for(B(),Z=1;R>Z;Z++)j[Z]=j[Z-1].clone(),K[Z]=K[Z-1].clone(),f.crossVectors(Q[Z-1],Q[Z]),f.length()>p&&(f.normalize(),M=L(jp(Q[Z-1].dot(Q[Z]),-1,1)),j[Z].applyMatrix4(y.makeRotationAxis(f,M))),K[Z].crossVectors(Q[Z],j[Z]);if(d)for(M=L(jp(j[0].dot(j[R-1]),-1,1)),M/=R-1,Q[0].dot(f.crossVectors(j[0],j[R-1]))>0&&(M=-M),Z=1;R>Z;Z++)j[Z].applyMatrix4(y.makeRotationAxis(Q[Z],M*Z)),K[Z].crossVectors(Q[Z],j[Z])
};var Wp=function(i,x,f,Y){Go.call(this),x=x||18,f=f||0,Y=Y==z?Q:Y;for(var R=1/(i.length-1),O=1/x,n=0,y=x;y>=n;n++)for(var q=f+n*O*Y,r=c(q),B=N(q),K=0,M=i.length;M>K;K++){var G=i[K],H=new Yb;H.x=r*G.x-B*G.y,H.y=B*G.x+r*G.y,H.z=G.z,this.vertices.push(H)}for(var t=i.length,n=0,y=x;y>n;n++)for(var K=0,M=i.length-1;M>K;K++){var d=K+t*n,T=d,o=d+t,r=d+1+t,b=d+1,V=n*O,k=K*R,P=V+O,I=k+R;this.faces.push(new dd(T,b,o)),this.faceVertexUvs[0].push([new go(V,k),new go(V,I),new go(P,k)]),this.faces.push(new dd(o,b,r)),this.faceVertexUvs[0].push([new go(P,k),new go(V,I),new go(P,I)])}this.mergeVertices(),jh(this),this.computeFaceNormals(),this.computeVertexNormals()};Wp.prototype=Wh(tp);var qo=function(x,n){n=n||{};var g=ed.generateShapes(x,n);n.amount=n.amount!==B?n.amount:.5,n.convertYZ=!1,n.fill!==!1&&(n.bottom=!0,n.top=!0),iq.call(this,g,n)};qo.prototype=Wh(El);var Oe=_.Node=function(){mg(Oe,this)},zj={X:zl,Y:Uj,Z:vd},nb={X:0,Y:1,Z:2},ig={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Zr=new eo,Ei="xzy",wj=function(I,v,x){if(v){var B=v[0],W=v[1],F=v[2];"xzy"===x?(Uj(I,W),vd(I,F),zl(I,B)):"xyz"===x?(vd(I,F),Uj(I,W),zl(I,B)):"yxz"===x?(vd(I,F),zl(I,B),Uj(I,W)):"yzx"===x?(zl(I,B),vd(I,F),Uj(I,W)):"zxy"===x?(Uj(I,W),zl(I,B),vd(I,F)):"zyx"===x?(zl(I,B),Uj(I,W),vd(I,F)):(Uj(I,W),vd(I,F),zl(I,B))}};Fh("Node",fk,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Ei,_64O:0,_rotationX:0,_53O:0,_host:z,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Fb},_22Q:function(){return kt},getX:function(){return this.p().x},setX:function(P){this.p(P,this.p().y)},getY:function(){return this.p().y},setY:function(G){this.p(this.p().x,G)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(T){this.setAnchor(T,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(y){this.setAnchor(this.getAnchor().x,y)},getScaleX:function(){return this.getScale().x},setScaleX:function(H){this.setScale(H,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(S){this.setScale(this.getScale().x,S)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(l){var q=(new hs).setFromQuaternion(l,hs.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(q.x,q.y,q.z)},getQuaternion:function(){var P=new hs,c=new hs,g=new eo;return function(s){return s||(s=new eo),this.getEuler(P),P.equals(c)?s.copy(g):s.copy(g.setFromEuler(c.copy(P)))}}(),getEuler:function(p){var a=this.r3();return p||(p=new hs),p.set(a[0],a[1],a[2],hs.ReverseOrder(this.getRotationMode()))},setEuler:function(N){return N=N.clone().reorder(hs.ReverseOrder(this.getRotationMode())),this.r3(N.x,N.y,N.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(B,Y){jd(B,ji(z,z,this.r3(),this.getRotationMode())),this.translate3d(B[0]*Y,B[1]*Y,B[2]*Y)},translateFront:function(B){this.translate3dBy([0,0,1],B)},translateBack:function(d){this.translate3dBy([0,0,-1],d)},translateLeft:function(q){this.translate3dBy([-1,0,0],q)},translateRight:function(s){this.translate3dBy([1,0,0],s)},translateTop:function(x){this.translate3dBy([0,1,0],x)},translateBottom:function(s){this.translate3dBy([0,-1,0],s)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(B,f,D){1===arguments.length&&(f=B[1],D=B[2],B=B[0]),this.p(B,D),this.setElevation(f)},translate3d:function(q,t,$){1===arguments.length&&(t=q[1],$=q[2],q=q[0]),this.translate(q,$),this.setElevation(this._54O+t)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(F,d,e){1===arguments.length&&(d=F[1],e=F[2],F=F[0]),this.setSize(F,e),this.setTall(d)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(n,o,b){var O=this;if(!O._updatingRotation3d){O._updatingRotation3d=1,1===arguments.length&&(o=n[1],b=n[2],n=n[0]);var A=[O._rotationX,-O._64O,O._53O];O._rotationX=n,O._64O=-o,O._53O=b,O.fp("rotation3d",A,[n,o,b]),delete O._updatingRotation3d}},_applyClosestR3:function(){function X(e){return e%=Q,0>e&&(e+=Q),e>s?Q-e:e}function c(o,e){return X(o[0]-e[0])+X(o[1]-e[1])+X(o[2]-e[2])}return function(n,y,K){var P,R,Y,r=this.r3(),o=this.getRotationMode();"xzy"===o||"yzx"===o?(P=n>0?n-s:n+s,R=y>0?y-s:y+s,Y=K>0?s-K:-s-K):"xyz"===o||"zyx"===o?(P=n>0?n-s:n+s,Y=K>0?K-s:K+s,R=y>0?s-y:-s-y):("yxz"===o||"zxy"===o)&&(Y=K>0?K-s:K+s,R=y>0?y-s:y+s,P=n>0?s-n:-s-n),c([P,R,Y],r)<c([n,y,K],r)?this.r3(P,R,Y):this.r3(n,y,K)}}(),setRotationY:function(s){this.setRotation(-s)},getRotationY:function(){return-this._64O},lookAtDirection:function(b,T){T=T||Dn;var G=this,Z=bh(b);T===Dn?(G.r3([-J(b[1]/Z),-Wc(b[2],b[0])+Yp,0]),G.setRotationMode("xzy")):T===ze?(G.r3(0,-Wc(b[2],b[0]),J(b[1]/Z)),G.setRotationMode("zyx")):T===Mq?(G.r3(0,-Wc(b[2],b[0])+s,-J(b[1]/Z)),G.setRotationMode("zyx")):T===Ih?(G.r3([-J(b[1]/Z)+Yp,-Wc(b[2],b[0])+Yp,0]),G.setRotationMode("xzy")):T===Vd&&(G.r3([-J(b[1]/Z)-Yp,-Wc(b[2],b[0])+Yp,0]),G.setRotationMode("xzy")),T===Zl&&(G.r3([-J(b[1]/Z)+s,-Wc(b[2],b[0])+Yp,s]),G.setRotationMode("zxy"))},lookAt:function(Y,X){return this.lookAtDirection(of(Y,this.p3()),X)},lookAtX:function(){var $=new Or,U=new Or,o=new Or,Y=new vr,g=new vr,b=new hs;return function(O,n){var p=vs(this);if(Y.fromArray(p),o.copy(this.p3()),$.copy(O).sub(o),!($.lengthSq()<1e-6)){$.normalize(),n=n||Dn,"string"==typeof n?n===Dn?U.set(0,0,1):n===Zl?U.set(0,0,-1):n===Mq?U.set(-1,0,0):n===ze?U.set(1,0,0):n===Ih?U.set(0,1,0):n===Vd&&U.set(0,-1,0):U.copy(n).normalize(),U.applyMatrix4(Y).sub(o).normalize();var Z=Math.acos($.dot(U));if(Z){var L=$.clone().cross(U);L.lengthSq()<1e-6&&(n===Ih||n===Vd||0===n[0]&&0===n[1]?L.set(0,0,1).applyMatrix4(Y).sub(o):L.set(0,1,0).applyMatrix4(Y).sub(o)),L.normalize(),b.set(this.r3(),this.getRotationMode(),!0),Y.makeRotationFromEuler(b),g.makeRotationAxis(L,-Z),b.setFromRotationMatrix(g.multiply(Y)),this._applyClosestR3(b.x,b.y,b.z)}}}}(),getHost:function(){return this._host},setHost:function(R){var d=this;if(d!==R&&d._host!==R){var k=d._host;k&&(k._removeAttach(d),k.updateLayoutAttaches()),d._host=R,d._host&&(d._host._addAttach(d),d._host.updateLayoutAttaches()),d.fp("host",k,R),d.onHostChanged(k,R)}},getAttaches:function(){return this._69O},_addAttach:function(V){var M=this;M._69O||(M._69O=new An),M._69O.add(V),M.fp("attaches",z,V)},_removeAttach:function(q){var Y=this;Y._69O.remove(q),Y._69O.isEmpty()&&delete Y._69O,Y.fp("attaches",q,z)},getImage:function(){if(this._pendingCheckImageJSON){var X=m.getImage(this._image);X&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof rb&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(J){var P=this,d=P._image,Q=P.getWidth(),S=P.getHeight();if(P._image=J,P.fp("image",d,J)){if(null!=J&&(Th(J)||hq(J)&&/\.json$/i.test(J))&&(this._pendingCheckImageJSON=!0),Hc)return;P.fp(yb,Q,P.getWidth()),P.fp(bg,S,P.getHeight())}},getElevation:function(){return this._54O},setElevation:function(j){var C=this;if(!C._50O){C._50O=1;var h=C._54O;C._54O=j,C.fp(mj,h,j),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(J){var c=this;if(!c._49O){c._49O=1;var H=c._64O;c._64O=J,c.fp(Qc,H,J),delete c._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(V){var f=this;if(!f._51O){f._51O=1;var W=f._rotationX;f._rotationX=V,f.fp("rotationX",W,V),delete f._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(Q){var J=this;if(!J._52O){J._52O=1;var N=J._53O;J._53O=Q,J.fp("rotationZ",N,Q),delete J._52O}},getPosition:function(){return this._position},setPosition:function(p,s){var k=this;if(!k._50I){k._50I=1;var x;if(x=2===arguments.length?{x:p,y:s}:p,x.x!==k._position.x||x.y!==k._position.y){var B=k._position;k._position=x,k.fp(Yq,B,x)}delete k._50I}},translate:function(T,K){var Z=this._position;this.p(Z.x+T,Z.y+K)},hasInheritedSize:function(){var S=this,o=S.getStyle("shape3d");if(o){var m=Tq(o);if(m&&m.rawS3)return!0;if(("billboard"===o||"plane"===o)&&Om(S.getStyle("shape3d.image")))return!0}return S.hasOwnProperty("_image")&&Om(S._image)?!0:!1},getWidth:function(){var K=this;if(K._width>=0)return K._width;var j=K.getStyle("shape3d");if(j){var B=Tq(j);if(B&&B.rawS3)return B.rawS3[0];if("billboard"===j||"plane"===j){var F=Om(K.getStyle("shape3d.image"));return F?To(F,K):20}}var F=Om(K._image);return F?To(F,K):20},setWidth:function(z){var e=this,m=e._width;e._width=z,e.fp(yb,m,z)},getHeight:function(){var V=this;if(V._height>=0)return V._height;var H=V.getStyle("shape3d");if(H){var W=Tq(H);if(W&&W.rawS3)return W.rawS3[2];if("plane"===H){var r=Om(V.getStyle("shape3d.image"));return r?Of(r,V):20}if("billboard"===H)return 2}var r=Om(V._image);return r?Of(r,V):20},setHeight:function(i){var T=this,y=T._height;T._height=i,T.fp(bg,y,i)},getTall:function(){var D=this;if(D._tall>=0)return D._tall;var g=D.getStyle("shape3d");if(g){var c=Tq(g);if(c&&c.rawS3)return c.rawS3[1];if("billboard"===g){var C=Om(D.getStyle("shape3d.image"));return C?Of(C,D):20}if("plane"===g)return 2}return 20},setTall:function(V){var d=this,J=d._tall;d._tall=V,d.fp("tall",J,V)},setSize:function(E,N){var a=this;2===arguments.length?(a.setWidth(E),a.setHeight(N)):(a.setWidth(E.width),a.setHeight(E.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(X,A,P,$,R){var H=this,i=H.getAnchor(),u=H.getScale();arguments.length<=2&&(R=A,A=X.y,P=X.width,$=X.height,X=X.x);var o=R&&u.x<0?1-i.x:i.x,T=R&&u.y<0?1-i.y:i.y;H.p(X+P*o,A+$*T),R&&(P/=Math.abs(u.x),$/=Math.abs(u.y)),H.setWidth(P),H.setHeight($)},getMatrix:function(){var D=this,j=D._64O,O=D._position,T=D.getScale();return new hg(j,O.x,O.y,T.x,T.y)},getMatrix4:function(){var N=new Or,s=new eo,n=new Or;return function(U){return this.getQuaternion(s),N.copy(this.p3()),n.copy(this.getFinalScale3d()),U||(U=new vr),U.compose(N,s,n)}}(),getAnchorRect:function(){var e=this,F=e.getWidth(),s=e.getHeight(),H=e.getAnchor();return{x:-F*H.x,y:-s*H.y,width:F,height:s}},toLocal:function(r){return this.getMatrix().tfi(r)},toGlobal:function(c){return this.getMatrix().tf(c)},getAttachPosition:function(){var z=new hg;return function(t,Z,c,X){c=c||0,X=X||0;var E=this,V=E.getAnchor(),d=E._64O,p=E._position,n=E.getScale();return z.setFromTransform(d,p.x,p.y).tf({x:c+n.x*E.getWidth()*(t-V.x),y:X+n.y*E.getHeight()*(Z-V.y)})}}(),isInRect:function(N){N=this.toLocal(N);var E=this.getWidth(),q=this.getHeight();return N.x+=E*this.getAnchorX(),N.y+=q*this.getAnchorY(),!(N.x<0||N.y<0||N.x>E||N.y>q)},getRect:function(){var l=this,f=l.getWidth(),q=l.getHeight(),U=l.getAnchor(),Q={x:-f*U.x,y:-q*U.y,width:f,height:q},o=l.getMatrix();return Q=sf([o.tf(Q.x,Q.y),o.tf(Q.x+Q.width,Q.y),o.tf(Q.x+Q.width,Q.y+Q.height),o.tf(Q.x,Q.y+Q.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var P=this,I=P.getAnchor(),e=P._anchorElevation;return{x:I.x,y:e,z:I.y}},setAnchorElevation:function(I){var u=this,a=u._anchorElevation;return a!==I?(u._anchorElevation=I,u.fp("anchorElevation",a,I),!0):!1},setAnchor3d:function(G,$,K,W){var p,B=this;"number"==typeof G?p={x:G,y:$,z:K}:(p=G.length?{x:G[0],y:G[1],z:G[2]}:G,W=$),B.beginTransaction();var L=B.getAnchor3d(),y=B.setAnchor(p.x,p.z);if(B.setAnchorElevation(p.y)&&(y=!0),y&&W&&!Hc){B.getAnchor3d();var m=vs(B),q=jd([p.x-L.x,p.y-L.y,p.z-L.z],m);B.p3(q)}return B.endTransaction(),y},getAnchor:function(){var b=this;if(b.hasOwnProperty("_anchor"))return b._anchor;var W=Om(b._image);return W&&W.anchorX!==B?{x:W.anchorX,y:W.anchorY}:b._anchor},setAnchor:function(m,C,U){var b,Y=this;"number"==typeof m?b={x:m,y:C}:(b=m.length?{x:m[0],y:m[1]}:m,U=C);var I=Y.getAnchor();if(I.x!==b.x||I.y!==b.y){if(Y.beginTransaction(),Y._anchor=b,Y.fp("anchor",I,b),U&&!Hc){var $=Y.getPosition(),t=Y.getSize(),l=Y.getRotation(),r=Y.getScale(),G=-t.width*(I.x-b.x)*r.x,f=-t.height*(I.y-b.y)*r.y,g=N(l),O=c(l);Y.setPosition($.x+O*G-g*f,$.y+g*G+O*f)}return Y.endTransaction(),!0}return!1},getLocalQuaternion:function(Z){var k=this,n=k.getHost();if(!n)return k.getQuaternion(Z);var y=n.getQuaternion(),r=k.getQuaternion();return Z||(Z=new eo),Z.copy(y).inverse().multiply(r)},setLocalQuaternion:function(S){var Q=this,N=Q.getHost();if(!N)return Q.setQuaternion(S);var o=N.getQuaternion();Q.setQuaternion(o.clone().multiply(S))},getLocalEuler:function(){var t=new eo;return function(C){var A=this,x=A.getHost();return x?(A.getLocalQuaternion(t),C||(C=new hs),C.setFromQuaternion(t,hs.ReverseOrder(this.getRotationMode()))):A.getEuler(C)}}(),setLocalEuler:function(){var V=new eo;return function(W){var U=this,x=U.getHost();return x?(V.setFromEuler(W),U.setLocalQuaternion(V)):U.setEuler(W)}}(),getLocalPosition3d:function(g){var L=this;g||(g=new Or),g.copy(L.p3());var e=L.getHost();if(!e)return g;var E=e.getMatrix4();return g.applyMatrix4(E.getInverse(E))},setLocalPosition3d:function(j){var R=this,E=R.getHost();if(!E)return j.x!==B?R.p3(j.x,j.y,j.z):R.p3(j),void 0;var z=E.getMatrix4(),D=new Or(j);D.applyMatrix4(z),R.p3(D.x,D.y,D.z)},getScale:function(){return this._scale},setScale:function($,a){var I,w=this;I=2===arguments.length?{x:$,y:a}:$;var O=w.getScale();(O.x!==I.x||O.y!==I.y)&&(w._scale=I,w.fp("scale",O,I))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var c=this,I=c._scaleTall,f=c.getScale();return[f.x,I,f.y]},getFinalScale3d:function(){var q=this,w=q.s3(),$=q._dynamicScale3d,W=q.getScale3d();return w&&(W[0]*=w[0],W[1]*=w[1],W[2]*=w[2]),$&&(W[0]*=$[0],W[1]*=$[1],W[2]*=$[2]),W},getFinalRotation3d:function(){var E=this;return E._dynamicRotation||E.r3()},setScaleTall:function(c){var L=this,F=L._scaleTall;F!==c&&(L._scaleTall=c,L.fp("scaleTall",F,c))},setScale3d:function(m,h,K){var b,l=this;b="number"==typeof m?{x:m,y:h,z:K}:m.length?{x:m[0],y:m[1],z:m[2]}:m,l.setScaleTall(b.y),l.setScale(b.x,b.z)},getCorners:function(Z,D){Z==z&&(Z=0),D==z&&(D=Z);var p=this,k=p.getAnchor(),C=p.getWidth(),r=p.getHeight(),T=-C*k.x-Z,X=-r*k.y-D,e=C+2*Z,$=r+2*D,q=p.getMatrix();return[q.tf(T,X),q.tf(T,X+$),q.tf(T+e,X+$),q.tf(T+e,X)]},getEditControlPoints:function(A,N,C){N==z&&(N=0),C==z&&(C=N);var f=this,J=f.getAnchor(),h=f.getWidth(),v=f.getHeight(),X=-h*J.x-N,D=-v*J.y-C,n=h+2*N,t=v+2*C;if(A)return[{x:X,y:D},{x:X,y:0},{x:X,y:D+t},{x:0,y:D+t},{x:X+n,y:D+t},{x:X+n,y:0},{x:X+n,y:D},{x:0,y:D}];var M=f.getMatrix();return[M.tf(X,D),M.tf(X,0),M.tf(X,D+t),M.tf(0,D+t),M.tf(X+n,D+t),M.tf(X+n,0),M.tf(X+n,D),M.tf(0,D)]},rotateAt:function(H,s,t){var x=this,E=x._position,X=x._64O,F=new hg(X,E.x,E.y).tf(H,s),K=l(H*H+s*s),u=Wc(E.y-F.y,E.x-F.x)+t;x.setRotation(X+t),x.p(F.x+K*c(u),F.y+K*N(u))},rotateAroundAxis:function(v,h){this.setQuaternion(this.getQuaternion().multiply(Zr.setFromAxisAngle(v,h)))},rotateAroundWorldAxis:function(E,q){this.setQuaternion(this.getQuaternion().premultiply(Zr.setFromAxisAngle(E,q)))},rotateX:function(F){return this.rotateAroundAxis(Or.AxisX,F)},rotateY:function(f){return this.rotateAroundAxis(Or.AxisY,f)},rotateZ:function(n){return this.rotateAroundAxis(Or.AxisZ,n)},onParentChanged:function(){Oe.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var J={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(f){J[f]=!0}),function(_){var n=this;Oe.superClass.onPropertyChanged.call(n,_);var w=_.property;if(J[w]&&!n._layoutUpdating&&n.updateLayoutParameters(null,w),n._69O&&n._69O.each(function(g){g.handleHostPropertyChange(_)}),n._49I&&n._49I.each(function(H){H.fp("agentChange",!0,!1)}),tb[w]&&this.updateLayoutAttaches(),"a:layout"===w.substring(0,8)){this.updateLayoutAttaches();var r=n._host;r&&r.updateLayoutAttaches()}("s:shape3d.autorotate"===w||"s:autorotate"===w||"s:shape3d.fixSizeOnScreen"===w||"s:fixSizeOnScreen"===w||"s:hide.overlapping.group"===w)&&(n._47Q=n.s("autorotate")||n.s("shape3d.autorotate")||n.s("fixSizeOnScreen")||n.s("shape3d.fixSizeOnScreen")||n.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(y){this.updateAttach(y)},onStyleChanged:function(R){Oe.superClass.onStyleChanged.apply(this,arguments),Ak[R]&&this.updateAttach()},updateLayoutAttaches:function(){if(!Hc&&this.s("vector.layoutable")){var j,v,C=this;return j=Om(C.getImage()),j&&j.layoutAttach&&(v=j.layoutAttach,v&&v(C))?!0:void 0}},updateAttach:function(o){var K=this;return Hc?(K.updateLayoutParameters(),void 0):(K._51I||(K._51I=1,K._71O(o),delete K._51I),void 0)},_71O:function(f){var A,Y,W,B,L,X,a=this,h=a._host,l=f?f.property:z,n=f?f.oldValue:z,V=f?f.newValue:z;if(h instanceof Oe&&(!f||tb[l])){var x;if(x=Om(h.getImage()),x&&x.layoutAttach)return}if(h instanceof _.Grid){if(l===mj)a.setElevation(a._54O+V-n);else if(!f||ap[l]){if(A=a.s("attach.row.index"),Y=a.s("attach.column.index"),W=h.getCellRect(A,Y),!W)return;B=a.s("attach.row.span"),L=a.s("attach.column.span"),(1!==B||1!==L)&&(W=io(W,h.getCellRect(A+B-1,Y+L-1))),sr(W,a,"attach.padding",1),a.setRect(W)}}else if(h instanceof gf&&(X=a.s("attach.index"))>=0&&(!f||Fn[l])){var S=a.s("attach.thickness"),G=h.getScale(),b=Math.max(G.x,G.y);S>0&&a.setHeight(h.getThickness()*S*b);var K=a.s("attach.offset"),Q=h.getPoints(),p=Q.size();if(p>X){var u=h.getPointsMatrix2d(),v=Q.get(X),T=p===X+1?Q.get(0):Q.get(X+1);v=u.apply(v),T=u.apply(T);var C=[T.x-v.x,T.y-v.y],E=bh(C);if(E){a.s("attach.offset.relative")&&(K*=E),a.s("attach.offset.opposite")&&(K=E-K);var P={x:v.x+C[0]/E*K,y:v.y+C[1]/E*K},U=a.s("attach.gap");U&&(a.s("attach.gap.relative")&&(U*=h.getThickness()*b),P=uq(z,P,T,U)),a.p(P),a.setRotation(Wc(C[1],C[0]))}}}else f&&(l===Yq?a.translate(V.x-n.x,V.y-n.y):l===mj?a.setElevation(a._54O+V-n):Mk[l]?"rotation3d"===l?a.syncRotation3d(h,V,n):a._11Q(h,l,V-n):("anchor"===l||"width"===l||"height"===l||"scale"===l)&&a.layout(h))},_11Q:function(){var P=new _.Math.Euler,R=_.Math.Euler.ReverseOrder,c=new _.Math.Vector2,v=new _.Math.Vector2;return function(O,p,C){var q=this,h=O.p3(),n=O.r3(),G=q.p3(),$=q.r3();if(p===Qc&&(p="rotationY",C=-C),(p===Qc||"rotationY"===p)&&0===$[0]&&0===$[2]&&0===n[0]&&0===n[2]&&0===G[1]&&0===h[1])return q.setRotation(-$[1]-C),c.set(G[0],G[2]).rotateAround(v.set(h[0],h[2]),-C),q.p(c.x,c.y),void 0;var r=ig[O.getRotationMode()],m=r[0],y=r[1],Y=r[2],z=zj[m],i=zj[y],g=zj[Y],K=Cd();p===Qc+m?(g(K,n[nb[Y]]),i(K,n[nb[y]]),z(K,C),i(K,-n[nb[y]]),g(K,-n[nb[Y]])):p===Qc+y?(g(K,n[nb[Y]]),i(K,C),g(K,-n[nb[Y]])):p===Qc+Y&&g(K,C);var A=of(G,h);jd(A,K),q.p3(h[0]+A[0],h[1]+A[1],h[2]+A[2]);var f=q.getRotationMode();wj(K,q.r3(),f),P.setFromRotationMatrix(K,R(f)),q.r3([P.x,P.y,P.z])}}(),syncRotation3d:function(){var L=new eo,c=new hs,b=new Or;return function(n,A,q){var y=this;if(q[0]!==A[0]||q[1]!==A[1]||q[2]!==A[2]){var e=hs.ReverseOrder(n.getRotationMode());Zr.setFromEuler(c.set(q[0],q[1],q[2],e)),L.setFromEuler(c.set(A[0],A[1],A[2],e)),L.multiply(Zr.inverse());var d=n.p3(),m=y.p3();b.set(m[0]-d[0],m[1]-d[1],m[2]-d[2]).applyQuaternion(L),y.p3(d[0]+b.x,d[1]+b.y,d[2]+b.z),y.setQuaternion(y.getQuaternion(Zr).premultiply(L))}}}(),isHostOn:function(V){var y=this;if(y._host&&V&&V._69O)for(var N={},d=y._host;d&&d!==y&&!N[d._id];){if(d===V)return!0;N[d._id]=d,d=d._host}return!1},isLoopedHostOn:function(N){return this.isHostOn(N)&&N.isHostOn(this)},getScaledSize:function(){var t=this.getSize(),p=this.getScale();return t.width*=Math.abs(p.x),t.height*=Math.abs(p.y),t},layout:function(g){if(g=g||this.getHost()){var E=this,C=E.s("layout.h")||"center",T=E.s("layout.v")||"center";if("center"!==C||"center"!==T){var H=new _.Math.Vector2,u=g.getPosition(),F=g.getAnchor(),k=g.getScaledSize();E.getPosition();var Q,m,U,I,R,j=1,D=1;switch(E._layoutUpdating=!0,C){case"left":H.setX(E._layoutHValue-F.x*k.width);break;case"right":H.setX((1-F.x)*k.width-E._layoutHValue);break;case"leftright":Q=k.width-E._layoutHValue[2],U=E.getRotation()-g.getRotation(),I=Math.abs(Math.sin(U)),R=Math.abs(Math.cos(U)),j+=R*Q/E._layoutHValue[3],D+=I*Q/E._layoutHValue[4],H.setX(E._layoutHValue[1]+(E._layoutHValue[5]-F.x)*k.width);break;case"center":H.setX((.5-F.x)*k.width-E._layoutHValue);break;case"scale":U=E.getRotation()-g.getRotation(),I=Math.abs(Math.sin(U)),R=Math.abs(Math.cos(U)),H.setX((.5-F.x)*k.width-E._layoutHValue[1]*k.width/E._layoutHValue[0]),m=k.width/E._layoutHValue[2]-1,j+=R*m,D+=I*m}switch(T){case"top":H.setY(E._layoutVValue-F.y*k.height);break;case"bottom":H.setY((1-F.y)*k.height-E._layoutVValue);break;case"topbottom":U||(U=E.getRotation()-g.getRotation(),I=Math.abs(Math.sin(U)),R=Math.abs(Math.cos(U))),Q=k.height-E._layoutVValue[2],j+=I*Q/E._layoutVValue[3],D+=R*Q/E._layoutVValue[4],H.setY(E._layoutVValue[1]+(E._layoutVValue[5]-F.y)*k.height);break;case"center":H.setY((.5-F.y)*k.height-E._layoutVValue);break;case"scale":U||(U=E.getRotation()-g.getRotation(),I=Math.abs(Math.sin(U)),R=Math.abs(Math.cos(U))),H.setY((.5-F.y)*k.height-E._layoutVValue[1]*k.height/E._layoutVValue[0]),m=k.height/E._layoutVValue[2]-1,j+=I*m,D+=R*m}if("leftright"===C||"scale"===C||"topbottom"===T||"scale"===T){var Z=this.getScale(),J=Math.abs(Z.x),x=Math.abs(Z.y);"leftright"===C||"scale"===C?E.setSize(E._layoutHValue[3]*j/J,E._layoutHValue[4]*D/x):E.setSize(E._layoutVValue[3]*j/J,E._layoutVValue[4]*D/x)}H.rotateAround(null,g.getRotation()),this.setPosition(H.x+u.x,H.y+u.y),E._layoutUpdating=B}}},updateLayoutParameters:function(V,o){if(V=V||this.getHost()){var n=this,R=n.s("layout.h"),N=n.s("layout.v");if(R||N){var C,r,T,y,l,A,h=new _.Math.Vector2,q=V.getPosition(),f=V.getAnchor(),F=V.getScaledSize(),k=n.getPosition(),H=n.getScaledSize();switch(h.set(k.x-q.x,k.y-q.y),h.rotateAround(null,-V.getRotation()),R){case"left":n._layoutHValue=h.x+f.x*F.width;break;case"right":n._layoutHValue=-h.x+(1-f.x)*F.width;break;case"center":n._layoutHValue=-h.x+(.5-f.x)*F.width;break;case"leftright":case"scale":"scale"===R?C=-h.x+(.5-f.x)*F.width:(r=n.getAnchor(),T=n.getRotation()-V.getRotation(),y=Math.cos(T),l=Math.sin(T),A=-Math.min(-r.x*y+r.y*l,-r.x*y-(1-r.y)*l,(1-r.x)*y+r.y*l,(1-r.x)*y-(1-r.y)*l),C=h.x-(A-f.x)*F.width),"position"===o&&"object"==typeof n._layoutHValue?(n._layoutHValue[0]=F.width,n._layoutHValue[1]=C):n._layoutHValue=[F.width,C,F.width,H.width,H.height,A]}switch(N){case"top":n._layoutVValue=h.y+f.y*F.height;break;case"bottom":n._layoutVValue=-h.y+(1-f.y)*F.height;break;case"center":n._layoutVValue=-h.y+(.5-f.y)*F.height;break;case"topbottom":case"scale":"scale"===N?C=-h.y+(.5-f.y)*F.height:(T||(r=n.getAnchor(),T=n.getRotation()-V.getRotation(),y=Math.cos(T),l=Math.sin(T)),A=-Math.min(-r.x*l-r.y*y,-r.x*l+(1-r.y)*y,(1-r.x)*l-r.y*y,(1-r.x)*l+(1-r.y)*y),C=h.y-(A-f.y)*F.height),"position"===o&&"object"==typeof n._layoutVValue?(n._layoutVValue[0]=F.height,n._layoutVValue[1]=C):n._layoutVValue=[F.height,C,F.height,H.width,H.height,A]}}}},getSerializableProperties:function(){var n=Oe.superClass.getSerializableProperties.call(this);return Lp(n,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),n}});var ke=_.Edge=function(F,l){var m=this;mg(ke,m),m.setSource(F),m.setTarget(l)};Fh("Edge",fk,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Im},_22Q:function(){return mt},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function($){if($===this)return!1;if(Dk($))return!0;for(var X,G,i,h,R,e=[this],t=-1,N=0;N>t;)if(t++,X=e[t],G=X._44I)for(G=G.getArray(),h=0,R=G.length;R>h;h++)if(i=G[h],Xr(i)&&!(e.indexOf(i)>=0)){if(i===$)return!1;e.push(i),N++}return!0},setSource:function(T){var X=this;if(X._source!==T&&X.canSetSourceTarget(T)){var f=X._source;X._source=T,f&&f._16I(X),T&&T._2I(X),X._7I(),X.fp("source",f,T)}},setTarget:function(B){var D=this;if(D._target!==B&&D.canSetSourceTarget(B)){var R=D._target;D._target=B,R&&R._18I(D),B&&B._4I(D),D._7I(),D.fp("target",R,B)}},isLooped:function(){var _=this;return _._source===_._target&&Dk(_._source)&&Dk(_._target)},onPropertyChanged:function(){var c={};return["source","target","sourceAgent","targetAgent","edgeGroup","agentChange","s:edge.width","s:edge.type","s:edge.offset","s:edge.center","s:edge.points","s:edge.segments","s:edge.gap","s:edge.source.t3","s:edge.target.t3","s:edge.color","s:edge.gradient.color","s:edge.pattern","s:edge.dash","s:edge.dash.color","s:edge.dash.pattern","s:edge.dash.offset","s:edge.dash","s:edge.dash","s:repeat.uv.length","s:body.color","s:shape3d","s:shape3d.visible","s:shape3d.image","s:shape3d.smooth","s:shape3d.resolution","s:shape3d.color","s:shape3d.blend","s:shape3d.side","s:shape3d.start.angle","s:shape3d.sweep.angle","s:shape3d.top.cap","s:shape3d.top.image","s:shape3d.top.visible","s:shape3d.top.color","s:shape3d.bottom.cap","s:shape3d.bottom.image","s:shape3d.bottom.visible","s:shape3d.bottom.color","s:shape3d.from.visible","s:shape3d.from.color","s:shape3d.to.visible","s:shape3d.to.color","s:shape3d.uv.union"].forEach(function(O){c[O]=!0}),function(O){var D=this;D._49I&&D._49I.each(function(c){c.fp("agentChange",!0,!1)}),("s:alwaysOnTop"===O.property||"s:shape3d.alwaysOnTop"===O.property)&&(O.newValue?this.setRenderLayer("top"):this.setRenderLayer(B)),c[O.property]&&(this._needChangeGeometry=!0)}}(),_7I:function(){var e,o=this,A=ns(o);o._40I!==A&&(e=this._40I,e&&e._15I(o),o._40I=A,A&&A._1I(o),o.fp("sourceAgent",e,A),Jj(e,o._41I),Jj(A,o._41I));var C=Un(o);o._41I!==C&&(e=o._41I,e&&e._17I(o),o._41I=C,C&&C._3I(o),o.fp("targetAgent",e,C),Jj(e,o._40I),Jj(C,o._40I))},_22I:function(F){this._52I=F,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var I=this;return I._52I&&I._52I.get(0)!==I&&!I.getStyle(ks)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var A=this,Y=A._52I;return Y&&!A.getStyle(ks)&&Y.size()>1&&A===Y.get(0)},toggle:function(){this.beginTransaction();var B=this._52I,M=!this.s(ks);B&&B.size()>1&&(B.each(function(X){X.s(ks,M)}),B.getSiblings().each(function(r){r!==B&&r.each(function(o){o.fp("edgeGroup",z,r)})})),this.endTransaction()},setStyle:function(R,H){(R===vp||"edge.segments"===R)&&(H=cq(H)),ke.superClass.setStyle.call(this,R,H)},onStyleChanged:function(J){ke.superClass.onStyleChanged.apply(this,arguments),lc[J]&&Jj(this._41I,this._40I)},getSerializableProperties:function(){var d=ke.superClass.getSerializableProperties.call(this);return Lp(d,{source:1,target:1}),d}});var ue=_.Group=function(){mg(ue,this)};Fh("Group",Oe,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return zf},onChildAdded:function(){ue.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){ue.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var b=this;if(!b._54I&&!Hc){var p=b.getChildrenRect();p&&(b._53I=1,b.p(Gb(b.s("group.position"),p,b.getSize())),delete b._53I)}},getChildrenRect:function(){var S,L=this;return L.eachChild(function(V){Dk(V)&&(S=io(S,L.getChildRect(V)))}),S},getChildRect:function(x){var J;return Dk(x)&&x.s(Dm)&&(Hh(x)&&x.isExpanded()&&x.eachChild(function(H){J=io(J,x.getChildRect(H))}),!J&&x.getRect&&(J=x.getRect())),J},setPosition:function(h,b){var u=this;if(!u._54I){var M;M=2===arguments.length?{x:h,y:b}:h,Hc||u._53I||(u._54I=1,Yj(u._children,M.x-u._position.x,M.y-u._position.y),delete u._54I),ue.superClass.setPosition.call(this,M)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(w){var G=this;if(G._57O!==w){var v=G._57O;G._57O=w,G.fp("expanded",v,G._57O),G._fireInvalidateDeep(),G._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(w){Hh(w)?w._fireInvalidateDeep():w.iv()})},_8I:function(){ue.superClass._8I.call(this),this.eachChild(function(y){Dk(y)&&y._8I()})},onStyleChanged:function(D){ue.superClass.onStyleChanged.apply(this,arguments),"group.position"===D&&this._81I()},getSerializableProperties:function(){var M=ue.superClass.getSerializableProperties.call(this);return M.expanded=1,M}});var Ze=_.Camera=function(){mg(Ze,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new _k.Matrix4,this._projectMatrix=new _k.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};Ze.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],Fh("Camera",Oe,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(n){this._projectMatrixDirty=!0,this.renderTarget=n},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(h){var e=h.split(",");this._cullingMask=Ab(e)},isLayerVisible:function(f){var s=fq[f];return s&&bk(this._cullingMask,s.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var L=new _.Math.Matrix4,w=new _.Math.Euler;return function(R){var f=this;R.isMatrix4?f._viewMatrix.copy(R):f._viewMatrix.fromArray(R),L.getInverse(f._viewMatrix),f.p3(L.getPosition().toArray()),w.set(0,0,0,f.getRotationMode(),!0).setFromRotationMatrix(L),f.r3([w.x,w.y,w.z])}}(),getViewMatrix:function(e){var b=this,K=ji(null,null,b.r3(),b.getRotationMode(),b.p3()),l=b._viewMatrix;return l.fromArray(K).getInverse(l),l.toArray(e)},setProjectMatrix:function(s){var C=this;s.isMatrix4?C._projectMatrix.copy(s):C._projectMatrix.fromArray(s),s=C._projectMatrix.getElements(),C.isOrtho()?C.s({"camera.near":(s[14]+1)/s[10],"camera.far":(s[14]-1)/s[10],"camera.ortho.width":2/s[0]}):C.s({"camera.near":s[14]/(s[10]-1),"camera.far":s[14]/(s[10]+1),"camera.fovy":2*Math.atan(1/s[5]),"camera.aspect":s[5]/s[0]}),C._projectMatrixDirty=!1},onPropertyChanged:function(R){var g=this;Ze.superClass.onPropertyChanged.call(g,R);var l=R.property;("s:camera.near"===l||"s:camera.far"===l||"s:camera.fovy"===l||"s:camera.aspect"===l||"s:camera.ortho.width"===l)&&(g._projectMatrixDirty=!0)},getProjectMatrix:function(){var K=this;if(K._projectMatrixDirty){var T=K.gv,W=K.isCube(),P=W?1:K.s("camera.aspect")||(T?T.getAspect():null)||m.graph3dViewAspect,t=K.s("camera.near")||(T?T.getNear():null)||m.graph3dViewNear,s=K.s("camera.far")||(T?T.getFar():null)||m.graph3dViewFar,v=Cd();if(K.isOrtho()){var r=K.s("camera.ortho.width")||(T?T.getOrthoWidth():null)||m.graph3dViewOrthoWidth,_=r/2,p=_/P;ms(v,-_,_,-p,p,t,s)}else{var U=W?Math.PI/2:K.s("camera.fovy")||(T?T.getFovy():null)||m.graph3dViewFovy;Ek(v,U,P,t,s)}K._projectMatrix.fromArray(v),K._projectMatrixDirty=!1}return K._projectMatrix.toArray()},lookAt:function(w,i){var q=this.p3();return w.x?this.lookAtDirection([w.x-q[0],w.y-q[1],w.z-q[2]],i):this.lookAtDirection([w[0]-q[0],w[1]-q[1],w[2]-q[2]],i)},lookAtDirection:function(){var d=new _.Math.Matrix4,m=new _.Math.Euler,h=new _.Math.Vector3,g=new _.Math.Vector3;return function(y,a){d.lookAtDirection(h.copy(y).multiplyScalar(-1),a?g.copy(a):g.set(0,1,0)),m.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(d),this.r3([m.x,m.y,m.z])}}(),updateAndRender:function(U){return U.syncRenderState(),U.updateScene(),this.render(U)},render:function(s){var K=this,x=s.getGL();if(!x)return!1;var V,M,X=K.renderTarget;if(X)V=X.width,M=X.height;else{var g=s.getDevicePixelRatio();
V=s.getWidth()*g,M=s.getHeight()*g}K.gv=s,s._camera=K,s._18Q=null;var H=s._frameState.renderState.glState,$=H.color.clear.slice(0);br(x,K.s("camera.background"));var t=s.getEye;if(s.getEye=function(){return K.p3()},K.isCube())for(var L=Ze.CubeDirectionParam,u=0;6>u;u++)X&&X.bind(x,u),K.lookAtDirection([L[6*u+0],L[6*u+1],L[6*u+2]],[L[6*u+3],L[6*u+4],L[6*u+5]]),K.s("camera.clear")!==!1&&x.clear(x.COLOR_BUFFER_BIT),s.setViewport(x,0,0,V,M),K.s("camera.onlySky")?s.renderSky():s.renderScene({renderAxis:K.s("camera.renderAxis"),renderGrid:K.s("camera.renderGrid"),renderEdit:K.s("camera.renderEdit"),renderReflector:!1}),X&&X.unbind(x);else X&&X.bind(x),K.s("camera.clear")!==!1&&x.clear(x.COLOR_BUFFER_BIT),s.overlappingBox.clear(),s.setViewport(x,0,0,V,M),K.s("camera.onlySky")?s.renderSky():s.renderScene({renderAxis:K.s("camera.renderAxis"),renderGrid:K.s("camera.renderGrid"),renderEdit:K.s("camera.renderEdit")}),X&&X.unbind(x);return s.getEye=t,br(x,$),s._18Q=null,s._camera=null,K.gv=null,!0}});var Sm=_.Block=function(){mg(Sm,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Fh("Block",Oe,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Wm},_22Q:function(){return lt},onChildAdded:function(){Sm.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Sm.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function I(z,f,O){b.fromArray(vs(f));var x=f.getAnchor3d();z.push((new Or).set(0-x.x,0-x.y,0-x.z).applyMatrix4(b).applyMatrix4(O)),z.push((new Or).set(0-x.x,0-x.y,1-x.z).applyMatrix4(b).applyMatrix4(O)),z.push((new Or).set(0-x.x,1-x.y,0-x.z).applyMatrix4(b).applyMatrix4(O)),z.push((new Or).set(0-x.x,1-x.y,1-x.z).applyMatrix4(b).applyMatrix4(O)),z.push((new Or).set(1-x.x,0-x.y,0-x.z).applyMatrix4(b).applyMatrix4(O)),z.push((new Or).set(1-x.x,0-x.y,1-x.z).applyMatrix4(b).applyMatrix4(O)),z.push((new Or).set(1-x.x,1-x.y,0-x.z).applyMatrix4(b).applyMatrix4(O)),z.push((new Or).set(1-x.x,1-x.y,1-x.z).applyMatrix4(b).applyMatrix4(O))}function t(v,b){var G=(new vr).makeRotationFromEuler(this.getEuler()).setPosition((new Or).fromArray(this.p3()));G.getInverse(G),v.forEach(function(k){Dk(k)&&I(b,k,G)})}var b=new vr;return function(Z,W){if(Z instanceof Oe&&(Z=[Z]),!Z||0===Z.length)return z;var W=[];t.call(this,Z,W);var E=[1/0,1/0,1/0],J=[-1/0,-1/0,-1/0];return W.forEach(function(l){E[0]=Math.min(l.x,E[0]),E[1]=Math.min(l.y,E[1]),E[2]=Math.min(l.z,E[2]),J[0]=Math.max(l.x,J[0]),J[1]=Math.max(l.y,J[1]),J[2]=Math.max(l.z,J[2])}),{min:E,max:J}}}(),updateFromChildren:function(){var O=this;if(!Hc&&!O._updatingToChildren&&O._syncSize&&0!==O.size()&&!O._freezeSyncFromChildren){var T=this._getBoundingBox(O.toChildren(Dk));if(T){O._updatingFromChildren=1;var J=(new Or).fromArray(this.getScale3d()),N=(new Or).fromArray(T.min),I=(new Or).fromArray(T.max),x=m.blockMinSize,K=new Or,y=I.clone().sub(N);0===y.x&&K.setX(.5),0===y.y&&K.setY(.5),0===y.z&&K.setZ(.5);var u=this._width==z||-1===this._width,Z=new Or(this.getAnchor3d()),R=J.clone().multiply((new Or).fromArray(this.s3())),j=y.clone();0===j.x&&j.setX(x),0===j.y&&j.setY(x),0===j.z&&j.setZ(x);var n=Z.clone().multiply(R),C=n.clone().multiplyScalar(-1).sub(N).divide(j).add(n.divide(j)).add(K),t=this.s("keepPosition");if(u||this._anchorChanged||this._scaleChanged||!t){!u&&t&&(Z=C);var E=Z.clone().multiply(y).add(N).applyEuler(this.getEuler()).add((new Or).fromArray(this.p3()));this.p3([E.x,E.y,E.z])}else this.setAnchor3d(C.x,C.y,C.z);var X=new Or(1,1,1).divide(J).multiply(y);this.s3(Math.abs(X.x),Math.abs(X.y),Math.abs(X.z)),delete O._updatingFromChildren}}},setPosition:function(a,d){var y=this;if(!y._updatingToChildren){var f;f=2===arguments.length?{x:a,y:d}:a,Hc||y._updatingFromChildren||(y._updatingToChildren=1,Yj(y._children,f.x-y._position.x,f.y-y._position.y),delete y._updatingToChildren),Sm.superClass.setPosition.call(this,f)}},setSize3d:function(){this.beginTransaction(),Sm.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(o){var k=this;if(!k._updatingToChildren){this.beginTransaction(),o=$(o,m.blockMinSize);var f=k.getTall();if(o!==f&&Sm.superClass.setTall.call(k,o),!Hc&&!k._updatingFromChildren){k._updatingToChildren=1;var M=o/f;k._adjustChildTallOrScale(M,"size"),delete k._updatingToChildren,k.updateFromChildren()}this.endTransaction()}},setWidth:function(Q){return this.setSize(Q,this.getHeight())},setHeight:function(e){return this.setSize(this.getWidth(),e)},setSize:function(v,L){var c=m.blockMinSize;v=$(v,c),L=$(L,c);var B=this;if(!B._updatingToChildren){2!==arguments.length&&(L=v.height,v=v.width),this.beginTransaction();var O=B.getWidth(),e=B.getHeight();if(v!==O&&Sm.superClass.setWidth.call(B,v),L!==e&&Sm.superClass.setHeight.call(B,L),!Hc&&!B._updatingFromChildren){B._updatingToChildren=1;var d=v/O,T=L/e;B._adjustChildScaleOrSize(d,T,"size"),delete B._updatingToChildren,B.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(Q,l,T){var V=this;if(V._syncSize){var w=V.getPosition(),G=V.getRotation();V.eachChild(function(e){if(Dk(e)){var b=e.getPosition(),p=e.getRotation(),I=e.getWidth(),R=e.getHeight(),f=e.getScale(),k=f.x*I,$=f.y*R;if(0!==k&&0!==$){0>Q*l&&e.setRotation(-1*p);var P=new hg(p,b.x,b.y,k,$);P.translate(-w.x,-w.y),P.rotate(-G),p=Wc(P.b*Math.sign(k),P.a*Math.sign(k)),P.scale(Q,l);var q,O,v,g=c(p);if(Math.abs(g)<.001?(q=N(p),O=P.b/q,v=-P.c/q):(O=P.a/g,v=P.d/g),"scale"===T)e.setScale(O/I,v/R);else if("size"===T){var J=O/f.x,Z=v/f.y;e.setScale(ud(O)*Math.abs(f.x),ud(v)*Math.abs(f.y)),e instanceof _.Shape?(e.setWidthForce(Math.max(Math.abs(J),1e-5)),e.setHeightForce(Math.max(Math.abs(Z),1e-5))):e.setSize(Math.max(.01,Math.abs(J)),Math.max(.01,Math.abs(Z)))}P.rotate(G),P.translate(w.x,w.y),e.setPosition(P.tx,P.ty)}}})}},_calcChangeFactor:function(q,x,u,o){var Y,b,F,Z;return Y=n(q),b=n(u),F=Y>b?Y/b:b/Y,Y=n(x),b=n(o),Z=Y>b?Y/b:b/Y,$(F,Z)},setElevation:function(O){var J=this;if(!J._updatingToChildren){var t=J.getElevation(),X=O-t;0!==X&&(Hc||J._updatingFromChildren||(J._updatingToChildren=1,Yj(J._children,0,X,0),delete J._updatingToChildren),Sm.superClass.setElevation.apply(J,arguments))}},setScaleTall:function(U){var w=this;if(!w._updatingToChildren){var d=w.getScaleTall();if(n(U)<.01&&(U=.01*(ud(U)||ud(d))),Sm.superClass.setScaleTall.call(w,U),!Hc&&!w._updatingFromChildren){w._updatingToChildren=1;var O=U/d;w._adjustChildTallOrScale(O,"scale"),delete w._updatingToChildren,w._scaleChanged=1,this.updateFromChildren(),delete w._scaleChanged}}},_adjustChildTallOrScale:function(W,h){var O=this;if(O._syncSize){var t=O.getElevation();O.eachChild(function(k){if(Dk(k)){if("size"===h){var f=k.getTall();0>W&&k.setScaleTall(-1*k.getScaleTall()),k.setTall(Math.max(.01,Math.abs(f*W)))}else{var c=k.getScaleTall();k.setScaleTall(c*W)}k.setElevation(t+(k.getElevation()-t)*W)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var c=Sm.superClass.setAnchor3d.apply(this,arguments);return c&&!Hc&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),c}},setAnchor:function(){var a=this;if(!a._updatingToChildren){var T=a.getAnchor(),p=Sm.superClass.setAnchor.apply(a,arguments);if(Hc||a._updatingFromChildren||!a._syncSize)return p;a._updatingToChildren=1;var c=a.getAnchor(),t=a.getSize(),d=t.width*(T.x-c.x),j=t.height*(T.y-c.y),u=(new vr).compose(new Or,this.getQuaternion(),new Or(this.getScale3d())),z=new Or(d,0,j).applyMatrix4(u);return a.eachChild(function(O){if(Dk(O)){var g=new Or(O.p3());O.p3(g.add(z).toArray())}}),delete a._updatingToChildren,p}},setAnchorElevation:function(){var w=this;if(!w._updatingToChildren){var h=w.getAnchorElevation(),M=Sm.superClass.setAnchorElevation.apply(w,arguments);if(Hc||w._updatingFromChildren||!w._syncSize)return M;w._updatingToChildren=1;var o=w.getAnchorElevation(),Q=w.getTall()*(h-o),i=(new vr).compose(new Or,this.getQuaternion(),new Or(this.getScale3d())),y=new Or(0,Q,0).applyMatrix4(i);return w.eachChild(function(H){if(Dk(H)){var O=new Or(H.p3());H.p3(O.add(y).toArray())}}),delete w._updatingToChildren,M}},setRotation:function(U){this._updateChildrenRotation3d("rotation",U)},setRotationX:function(h){this._updateChildrenRotation3d("rotationX",h)},setRotationZ:function(q){this._updateChildrenRotation3d("rotationZ",q)},setRotation3d:function(){var c=this;if(!c._updatingToChildren){var D=c.r3();Sm.superClass.setRotation3d.apply(c,arguments);var O=c.r3();Hc||c._updatingFromChildren||(c._updatingToChildren=1,c.eachChild(function(u){Dk(u)&&u.syncRotation3d(c,O,D)}),delete c._updatingToChildren)}},_updateChildrenRotation3d:function(K,u){var c=this;if(!c._updatingToChildren){var X=c[dc(K)]();Sm.superClass[Tn(K)].call(c,u),Hc||c._updatingFromChildren||this._updateRotationToChildren(K,u-X)}},_updateRotationToChildren:function(e,Z){var i=this;i._updatingToChildren=1,i.eachChild(function(G){Dk(G)&&G._11Q(i,e,Z)}),delete i._updatingToChildren},setScale:function(G,T){var Y=this;if(!Y._updatingToChildren){null==T&&(T=G.y,G=G.x);var r=Y.getScale();if(n(G)<.01&&(G=.01*(ud(G)||ud(r.x))),n(T)<.01&&(T=.01*(ud(T)||ud(r.y))),Sm.superClass.setScale.call(Y,G,T),!Hc&&!Y._updatingFromChildren){Y._updatingToChildren=1;var o=G/r.x,$=T/r.y;Y._adjustChildScaleOrSize(o,$,"scale"),delete Y._updatingToChildren,Y._scaleChanged=1,Y.updateFromChildren(),delete Y._scaleChanged}}},onPropertyChanged:function(_){Sm.superClass.onPropertyChanged.call(this,_),"s:3d.visible"===_.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(r){(r.s("batch")||r.s("wf.geometry")||r.s("wf.visible"))&&r.iv(),r instanceof Sm&&r._invalidateChildrenBatch()})},getSerializableProperties:function(){var r=Sm.superClass.getSerializableProperties.call(this);return r.clickThroughEnabled=1,r.syncSize=1,r}});var Oj=_.Grid=function(){mg(_.Grid,this)};Fh("Grid",Oe,{IRotatable:!1,_icon:"grid_icon",_image:z,getUIClass:function(){return bn},setRotation:function(){},getCellRect:function(S,G){var H=this,v=H.s("grid.row.count"),F=H.s("grid.column.count");if(0>=v||0>=F||0>S||S>=v||0>G||G>=F)return z;var W,t,k,f=H.getRect(),Y=H.s("grid.row.percents"),I=H.s("grid.column.percents");if(sr(f,H,"grid.border",-1),Y&&Y._as&&(Y=Y._as),I&&I._as&&(I=I._as),Y&&Y.length===v){for(k=0,W=0;S>W;W++)k+=f.height*Y[W];f.y+=k,f.height=f.height*Y[S]}else f.height=f.height/v,f.y+=f.height*S;if(I&&I.length===F){for(t=0,W=0;G>W;W++)t+=f.width*I[W];f.x+=t,f.width=f.width*I[G]}else f.width=f.width/F,f.x+=f.width*G;return gp(f,-H.s("grid.gap")),f}});var nf=_.Text=function(){mg(nf,this),this.setSize(100,50),this.s("text","TEXT")};Fh("Text",Oe,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return jk},setWidth:function(V){V||(V=.001),nf.superClass.setWidth.call(this,V)},setHeight:function(U){U||(U=.001),nf.superClass.setHeight.call(this,U)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),ej("__text__",{width:{value:100,isSafeFunc:!0,func:function(W){return W?W._width:100}},height:{value:50,isSafeFunc:!0,func:function(Q){return Q?Q._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"},wrap:{func:"style@text.wrap"},letterGap:{func:"style@text.letter.gap"},borderWidth:{func:"style@text.border.width"},borderColor:{func:"style@text.border.color"}}]});var gf=_.Shape=function(){mg(gf,this),this._59O=new An};gf.__de__=mr,Fh("Shape",Oe,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Tg},_22Q:function(){return nt},getLength:function(u){return ko(Qf(this._59O,this._58O,u,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var D=this._58O;return D?new An(D._as.slice(0)):D},setSegments:function(c){var Y=this._58O;c=c?Jm(c)?new An(c.slice(0)):new An(c._as.slice(0)):null,(Y&&c&&Y._as.join(",")!==c._as.join(",")||Y!==c)&&(this._58O=c,this.fp("segments",Y,c))},getPoints:function(){return this._59O},toPoints:function(){var i=this._59O;return new An(i._as.slice(0))},getPointsMatrix2d:function(){var h=this,b=new _k.Matrix2d,F=h.getPosition(),i=h.getScale(),H=h.getRotation();return b.translate(-F.x,-F.y).scale(i.x,i.y).rotate(H).translate(F.x,F.y),b},getPointsMatrix3d:function(){return function(){var I=this,t=new _k.Matrix4,G=t.getElements(),w=I.p3();hk(G,w),wj(G,I.getFinalRotation3d(),I.getRotationMode());var r=I.getScale3d(),F=I._dynamicScale3d;return F&&(r[0]*=F[0],r[1]*=F[1],r[2]*=F[2]),Tl(G,r),hk(G,Qm(w)),t}}(),setPoints:function(D,Y){var p=this,t=p._59O;D=D?Jm(D)?new An(D.slice(0)):new An(D._as.slice(0)):new An;var R,y,l,q,P,Z;Y&&(R=p.getPosition(),Z=new hg(p.getRotation(),0,0,p.getScale().x,p.getScale().y)),(t&&D&&t._as.join(",")!==D._as.join(",")||t!==D)&&(p._59O=D,p.fs(),p.fp("points",t,D)),Y&&(y=p.getPosition(),l=y.x-R.x,q=y.y-R.y,P=Z.tf(l,q),p.setPosition(y.x-l+P.x,y.y-q+P.y))},setPoints3d:function(Q,s){var H=new Or(this.p3()),r=this.getPointsMatrix3d();if(r.setPosition(new Or),Hl.superClass.setPoints.call(this,Q),s){var q=new Or(this.p3()),F=q.clone().sub(H).applyMatrix4(r);H.add(F),this.p3(H.x,H.y,H.z)}},addPoint:function(T,L,i){var M=this.toPoints();M.add(T,L),this.setPoints(M,i)},setPoint:function(p,F,$){var T=this.toPoints();T.set(p,F),this.setPoints(T,$)},removePointAt:function($){var d=this.toPoints();d.removeAt($),this.setPoints(d)},setWidthForce:function(A){var C=this;if(!C._55I&&!Hc&&C.getWidth()){C._55I=1;var k=C._position.x,w=A/C.getWidth(),y=C.toPoints(),j=new An;1!==w&&(y.each(function(U){j.add({x:(U.x-k)*w+k,y:U.y,e:U.e})}),C.setPoints(j),$b(C,[w,0,0,1,k*(1-w),0]),C.fs()),delete C._55I}gf.superClass.setWidth.call(C,A)},setWidth:function(b){return this.setWidthForce(ic>b?ic:b)},setHeightForce:function(k){var D=this;if(!D._55I&&!Hc&&D.getHeight()){D._55I=1;var u=D._position.y,g=k/D.getHeight(),W=D.toPoints(),F=new An;1!==g&&(W.each(function(P){F.add({x:P.x,y:(P.y-u)*g+u,e:P.e})}),D.setPoints(F),$b(D,[1,0,0,g,0,u*(1-g)]),D.fs()),delete D._55I}gf.superClass.setHeight.call(D,k)},setHeight:function(w){return this.setHeightForce(ic>w?ic:w)},setAnchorElevation:function(d){var p=this;p._55I=!0;var u=p._updatingAnchor3d,S=!Hc&&!u;if(S){var N,V=d,E=p.getAnchorElevation(),L=p.getTall();N=L*(E-V),0!==N&&p.shiftPointsElevation(N)}var c=gf.superClass.setAnchorElevation.apply(p,arguments);return u||delete p._55I,c},getShapeElevation:function(){var w=this,y=w._54O;return y-(w.getTall()||0)*(w._anchorElevation-.5)},setAnchor3d:function(t,O,r,G){var Z,f=this;if("number"==typeof t?Z={x:t,y:O,z:r}:(Z=t.length?{x:t[0],y:t[1],z:t[2]}:t,G=O),f._55I=!0,f._updatingAnchor3d=!0,f.beginTransaction(),!Hc){var c=f.getAnchor3d(),s=f.getSize(),b=f.getTall(),T=s.width*(c.x-Z.x),i=s.height*(c.z-Z.z),p=b*(c.y-Z.y);G||f.shiftPoints(T,i,p);var Y=f.p3()}var l=gf.superClass.setAnchor3d.apply(f,arguments);if(!Hc&&G){var S=f.p3();f.shiftPoints(S[0]-Y[0]+T,S[2]-Y[2]+i,S[1]-Y[1]+p)}return f.endTransaction(),delete f._updatingAnchor3d,delete f._55I,l},setAnchor:function(t,S,K){var O=this;O._55I=!0;var f=O._updatingAnchor3d,q=!Hc&&!f;if(q){var h,v,o;"number"==typeof t?o={x:t,y:S}:(o=t.length?{x:t[0],y:t[1]}:t,K=S);var T=O.getAnchor(),r=O.getSize();h=r.width*(T.x-o.x),v=r.height*(T.y-o.y),K||O.shiftPoints(h,v);var c=O.getPosition()}var i=gf.superClass.setAnchor.apply(O,arguments);if(q){var L=O.getPosition();K&&O.shiftPoints(L.x-c.x+h,L.y-c.y+v)}return f||delete O._55I,i},shiftPoints:function(i,C,W){if(i||C||W){var g=this,t=g.getElevation()||0,b=g.toPoints(),O=new An;b.each(function(I){var V=I.e;W&&(V=(V==z?t:V)+W),O.add({x:I.x+i,y:I.y+C,e:V})}),g.setPoints(O),g.fs()}},shiftPointsElevation:function(Y){return this.shiftPoints(0,0,Y)},setPosition:function(T,m){var $,A=this;if(!A._28Q){if(A._28Q=1,!A._55I&&!Hc){$=2===arguments.length?{x:T,y:m}:T;var f=$.x-A._position.x,w=$.y-A._position.y;if(0===f&&0===w)return delete A._28Q,void 0;A._55I=1,A.shiftPoints(f,w),$b(A,[1,0,0,1,f,w]),delete A._55I}gf.superClass.setPosition.apply(A,arguments),delete A._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var B=this;if(2!==B._59O.size())return!1;var M=B._58O;return M?2===M.size()&&1===M.get(0)&&2===M.get(1)?!0:!1:!0},fireShapeChange:function(){var Y=this;if(!Y._55I&&!Hc){var g=sf(Y._59O);g&&(Y._55I=1,Y.setRect(g),delete Y._55I)}Y.fp(Sd,!1,!0)},getSerializableProperties:function(){var n=gf.superClass.getSerializableProperties.call(this);return n.segments=1,n.points=1,n.thickness=1,n.closePath=1,n}});var Jk=_.Points=function(){mg(Jk,this)};Fh("Points",Oe,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return ot},getPoints:function(){return this._59O},setPoints:function(j){var T=this._59O;j=j?j.slice(0):[];var i=j[0];if(Aj(i)){var b=j;j=[];for(var w=0,o=b.length;o>w;w+=3)j.push({x:b[w],e:b[w+1],y:b[w+2]})}this._59O=j,this._pointsDirty=!0,this.fp("points",T,this._59O)},setPoint:function(L,r){var J=this._59O.slice(0);J[L]=r,this.setPoints(J)},addPoint:function(J){this.setPoint(this._59O.length,J)},getColors:function(){return this._colors},setColors:function(Z){var W=this._colors;Z=Z?Z.slice(0):[],this._colors=Z,this._colorsDirty=!0,this.fp("colors",W,Z)},setPointColor:function(f,J){var $=this._colors.slice(0);$[f]=J,this.setColors($)},getSizes:function(){return this._sizes},setSizes:function(F){var C=this._sizes;F=F?F.slice(0):[],this._sizes=F,this._sizesDirty=!0,this.fp("sizes",C,this._sizes)},setPointSize:function(M,p){var H=this._sizes.slice(0);H[M]=p,this.setSizes(H)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(u){var U=this._uvoffsets;u=u?u.slice(0):[],this._uvoffsets=u,this._offsetsDirty=!0,this.fp("uvoffsets",U,this._uvoffsets)},setPointUvoffset:function(y,l,j){var R;"object"==typeof l?(R=l[0],j=l[1]):R=l;var W=this._uvoffsets.slice(0);W[2*y+0]=R,W[2*y+1]=j,this.setUvoffsets(W)},getPointInfo:function(w){var S=this.getPoints();if(!S||S[w]==z)return z;var B=S[w],Y=[B.x,B.e,B.y],A=this.mat||vs(this),c=[Y[0],Y[1],Y[2]];jd(c,A);var T=this.getColors(),J=T[w]||this.s("points.color"),F=this.getSizes(),$=F[w];return{size:$==z?this.s("points.size"):$,color:J,local:Y,world:c}},getSerializableProperties:function(){var E=Jk.superClass.getSerializableProperties.call(this);return E.points=1,E.colors=1,E.sizes=1,E.uvoffsets=1,E},onPropertyChanged:function(J){Jk.superClass.onPropertyChanged.call(this,J);var G=J.property;"s:points.color"===G?this._colorsDirty=!0:"s:points.size"===G?this._sizesDirty=!0:"s:points.model"===G&&(this._modelDirty=!0)},getWidth:function(){var o=this;if(o._width>=0)return o._width;var D=o.getStyle("points.model");if(D){var w=Tq(D);if(w&&w.rawS3)return w.rawS3[0]}return 1},getHeight:function(){var $=this;if($._height>=0)return $._height;var T=$.getStyle("points.model");if(T){var z=Tq(T);if(z&&z.rawS3)return z.rawS3[2]}return 1},getTall:function(){var t=this;if(t._tall>=0)return t._tall;var N=t.getStyle("points.model");if(N){var Y=Tq(N);if(Y&&Y.rawS3)return Y.rawS3[1]}return 1}});var Hl=_.Polyline=function(){mg(Hl,this),this.s({"shape.background":null,"shape.border.width":2})};Fh("Polyline",gf,{_icon:"polyline_icon",_22Q:function(){return rt},getUIClass:function(){return uc},setClosePath:function(){},setTall:function(y){var j=this;if(j.beginTransaction(),!j._55I&&!j._24Q&&!Hc&&j.getTall()){j._24Q=1;var W=j._54O,V=y/j.getTall();if(1!==V){var _=j.toPoints(),I=new An;_.each(function(S){I.add({x:S.x,y:S.y,e:S.e==z?S.e:(S.e-W)*V+W})}),j.setPoints(I),j.fs()}delete j._24Q}Hl.superClass.setTall.call(j,y),j.endTransaction()},setElevation:function(o){var y=this;if(y.beginTransaction(),!y._55I&&!y._24Q&&!Hc){y._24Q=1;var u=o-y._54O;0!==u&&y.shiftPointsElevation(u),delete y._24Q}Hl.superClass.setElevation.apply(y,arguments),y.endTransaction()},fireShapeChange:function(){var Q=this,W=Q._59O;if(!Q._55I&&!Q._24Q&&!Hc){var o=W.size();if(o){var M=1,C=W.get(0),b=Q._54O;C.e==z&&(C.e=b);for(var x=C.e,m=0;o>M;M++){C=W.get(M),C.e==z&&(C.e=b);var w=H(x,C.e),y=$(x+m,C.e);x=w,m=y-w}Q._24Q=1,Q.setTall(m),Q.setElevation(x+m*Q._anchorElevation),delete Q._24Q}}Hl.superClass.fireShapeChange.apply(Q,arguments)},onPropertyChanged:function(){var M={};return["points","segments","thickness","position","elevation","rotation","rotationX","rotationZ","rotationMode","scale","scaleTall","s:shape.border.color","s:shape.border.gradient.color","s:shape.border.pattern","s:shape.dash","s:shape.dash.color","s:shape.dash.pattern","s:shape.dash.offset","s:shape.dash","s:shape.dash","s:3d.clip.direction","s:repeat.uv.length","s:body.color","s:shape3d","s:shape3d.visible","s:shape3d.image","s:shape3d.smooth","s:shape3d.resolution","s:shape3d.color","s:shape3d.blend","s:shape3d.side","s:shape3d.start.angle","s:shape3d.sweep.angle","s:shape3d.top.cap","s:shape3d.top.image","s:shape3d.top.visible","s:shape3d.top.color","s:shape3d.bottom.cap","s:shape3d.bottom.image","s:shape3d.bottom.visible","s:shape3d.bottom.color","s:shape3d.from.visible","s:shape3d.from.color","s:shape3d.to.visible","s:shape3d.to.color","s:shape3d.uv.union"].forEach(function(j){M[j]=!0}),function(i){Hl.superClass.onPropertyChanged.call(this,i),M[i.property]&&(this._needChangeGeometry=!0)}}()});var Rp=_.SubGraph=function(){mg(Rp,this)};Fh("SubGraph",Oe,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Rp.superClass._8I.call(this),this.eachChild(function(v){Dk(v)&&v._8I()})}}),m.loadingRefGraph=0;var rb=_.RefGraph=function(){mg(rb,this)};Fh("RefGraph",Sm,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(D){var V=this._ref;this._ref=D,this.fp("ref",V,D),this.updateRef()},_21I:function(){rb.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var q=this;if(m.loadingRefGraph++,q.clearChildrenFromDataModel(),m.loadingRefGraph--,q._ref&&q._dataModel){q._xhrLoadHandler&&(q._xhrLoadHandler.cancel=!0);var d=Hc,F=q._xhrLoadHandler=function(V){if(V&&q._dataModel){m.loadingRefGraph++;var z=q._pendingUpdateInfo={needToRestore:d};d&&(z.p3=q.p3(),z.s3=q.s3(),z.r3=q.r3(),z.anchor3d=q.getAnchor3d(),z.scale3d=q.getScale3d()),q.r3(0,0,0),q.setScale3d(1,1,1),q.setAnchor3d(.5,.5,.5),q.p3(0,0,0);var h=m.parse(V),X=q._dataModel.deserialize(h,q,{justDatas:!0});X.each(function(Y){Y._refGraph=q}),q.checkPendingUpdateInfo(),m.loadingRefGraph--,m.handleRefGraphLoaded(q,X,h)}};F.xhrLoadCalled=!1,m.load(q._ref,function(p){F.cancel||(F.xhrLoadCalled?F(p):sg(function(){F(p)}))}),F.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var Q=this,n=Q._pendingUpdateInfo;if(!n)return Q.onPendingUpdated&&(m.loadingRefGraph++,Q.onPendingUpdated(),m.loadingRefGraph--),void 0;var O=!0;this.eachChild(function(L){(L._pendingCheckImageJSON||L._pendingUpdateInfo)&&(O=!1)}),O&&(m.loadingRefGraph++,Q._pendingUpdateInfo=null,Q.updateFromChildren(),n.needToRestore&&(Q.setAnchor3d(n.anchor3d),Q.setScale3d(n.scale3d),Q.r3(n.r3),Q.p3(n.p3)),this.getParent()instanceof rb&&this.getParent().checkPendingUpdateInfo(),Q.onPendingUpdated&&Q.onPendingUpdated(),m.loadingRefGraph--)},getSerializableProperties:function(){var e=rb.superClass.getSerializableProperties.call(this);return e.ref=1,e}}),_.EdgeGroup=function(H,s){this._70O=H,this._siblings=s;for(var v,E,u=0,d=H.size(),G=b[ks];d>u;u++)if(v=H.get(u).getStyle(ks,!1),v!=z){G=v;break}G==z&&(G=!0);var Z=m.edgeGroupAgentFunc;for(Z&&(E=Z(H),E&&E!==H.get(0)&&(H.remove(E),H.add(E,0))),u=0;d>u;u++)H.get(u).s(ks,G)},Fh("EdgeGroup",S,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(S){return this._70O.get(S)},indexOf:function(m){return this._70O.indexOf(m)},each:function(x,V){this._70O.each(x,V)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(z,o){this._siblings.each(function(M){M._70O.each(z,o)})}});var nk=function(P,t,O){var Y=Kf[P]={type:P,action:t};if(O)for(var F in O)Y[F]=O[F]};Lp(m,{setConnectAction:nk,getConnectAction:function(B,E){if(!E){if(!B)return null;E=B.getCurrentConnectActionType()}return Kf[E]},doConnectAction:function(R,y,b,N){N=N||R.getCurrentConnectActionType();var T=Kf[N];if(!T)return!1;var L=T.action;return L?(y instanceof tn.Group?R.sm().getSelection().each(function(A){L.call(null,R,A,b)}):L.call(null,R,y,b),!0):!1},doDeleteConnectionAction:function(B,P,b){b=b||B.getCurrentConnectActionType();var T=Kf[b];if(!T||!T.delete)return!1;var d=T.delete.action;return d?(P instanceof tn.Group?B.sm().getSelection().each(function(N){d.call(null,B,N)}):d.call(null,B,P),!0):!1}});var mo=_.JSONSerializer=function(F,Q){this.dm=this._dataModel=F,this._hierarchical=m.forceHierarchicalSerialization?!0:Q==z?F.isHierarchicalRendering():Q};Fh("JSONSerializer",S,{ms_ac:["hierarchical"],serialize:function(Z){return m.stringify(this.toJSON(),Z)},toJSON:function(){var k,E=this,$=E.dm,N=$.getRoots(),S=E.json={v:m.getVersion(),p:{},a:{},d:[]},d=$.getSerializableAttrs();(k=$.getInit())&&(S.init=k),(k=$.getName())&&(S.p.name=k),(k=$.getBackground())&&(S.p.background=k),(k=$.getLayers())&&(S.p.layers=k),(k=$.getEnvmap())&&(S.p.envmap=k),(k=$.getEnvmapType())&&(S.p.envmapType=k),S.p.autoAdjustIndex=$.isAutoAdjustIndex(),S.p.hierarchicalRendering=$.isHierarchicalRendering();for(var I in d){var r=$.a(I);r!==B&&E[Nl](I,r,S.a)}return od(S.a)&&delete S.a,E._hierarchical?N.each(E.serializeData,this):$.each(function(q){E.serializeData(q)}),$.fireSerializeEvent({type:"serialize",json:S}),$.getPostProcessingData()&&(S.p.postProcessingData=$.getPostProcessingData()),S},isSerializable:function(){return!0},getProperties:function(H){return H.getSerializableProperties()},getStyles:function(P){return P.getSerializableStyles()},getAttrs:function(f){return f.getSerializableAttrs()},serializeData:function(q){var O=this;if(O.isSerializable(q)&&!q._refGraph){var L,N,g,w,I,y,l=Br(q.getClassName())||q.getClass(),V=new l,H={c:q.getClassName(),i:q.getId(),p:{},s:{},a:{}};O.json.d.push(H),L=O.getProperties(q);for(N in L)if(/^_/.test(N)){if(g=q[N],!("_width"!==N&&"_height"!==N||g!=z&&-1!==g)){if(I==B){var h;y=(q.s("layout.h")||q.s("layout.v"))&&q.getHost()||q instanceof _.Node&&(h=q.getParent())&&h instanceof _.Block||q.s("fullscreen"),I=q.hasInheritedSize()}y&&I&&(g=q[N]="_width"===N?q.getWidth():q.getHeight())}g!==V[N]&&O[Nl](N.substr(1),g,H.p)}else w=dc(N),q[w]&&(g=q[w](),g!==V[w]()&&O[Nl](N,g,H.p));L=O.getStyles(q);for(N in L)g=q.s(N),g!==V.s(N)&&O[Nl](N,g,H.s);L=O.getAttrs(q);for(N in L)g=q.a(N),g!==V.a(N)&&O[Nl](N,g,H.a);od(H.p)&&delete H.p,od(H.s)&&delete H.s,od(H.a)&&delete H.a}O._hierarchical&&q.getChildren().each(O.serializeData,O)},serializeValue:function(d,U,u){pj(U)?U={__a:U._as}:U instanceof fk?U={__i:U.getId()}:U instanceof wp&&(U={__dm:U.serialize(0)}),u[d]=U},deserialize:function(O,L,Z){var N=this;return hq(O)&&/.json$/.test(O)?(m.xhrLoad(O,function(f){N.deserializeImpl(f,L,Z)}),void 0):N.deserializeImpl(O,L,Z)},deserializeImpl:function(Y,M,K){var H=this,a=H.dm;a.setDeserializing(!0),K=Zn(K)?{setId:K}:Qr(K)?{finishFunc:K}:K||{},Y=H.json=hq(Y)?m.parse(Y):Y,!K.justDatas&&Y.a&&Y.a.onPreDeserialize&&!K.disableOnPreDeserialize&&Y.a.onPreDeserialize(Y,a,K.view),a.beginTransaction(),Hc++,H._82I={};var F=new An,d=new An,W=0,S=Y.d.length;if(K.justDatas||(!K.disableInit&&Qr(Y.init)&&Y.init(a),a.setInit(Y.init)),!K.justDatas){for(var I in Y.a)a.a(I,H[li](Y.a[I]));for(var s in Y.p)a[Tn(s)](Y.p[s])}for(;S>W;W++){var c=Y.d[W],y=Br(c.c),X=new y,r=c.i;K.setId&&r!=z&&(X._id=r),H._82I[r]=X,F.add(X),d.add(c)}for(W=0;S>W;W++)H.deserializeData(F.get(W),d.get(W));return F.each(function(Q){M&&!Q.getParent()&&Q.setParent(M),a.add(Q)}),K.__innerHandler__&&K.__innerHandler__(Y,a,K.view,F),a.fireSerializeEvent({type:"deserialize",json:Y}),Hc--,a.endTransaction(),!K.justDatas&&Y.a&&Y.a.onPostDeserialize&&!K.disableOnPostDeserialize&&Y.a.onPostDeserialize(Y,a,K.view,F),K.finishFunc&&K.finishFunc(Y,a,K.view,F),a.setDeserializing(!1),F},deserializeData:function(l,x){for(var R in x.p)l[Tn(R)](this[li](x.p[R]));for(R in x.s)l.s(R,this[li](x.s[R]));for(R in x.a)l.a(R,this[li](x.a[R]))},deserializeValue:function(c){if(Th(c)){var B=c.__i;if(B!=z)return this._82I[B];if(B=c.__dm,B!=z){var q=new _.DataModel;return q.deserialize(B),q}if(B=c.__a,Jm(B))return new An(B)}return c}}),Lp(wp,{serialize:function(r,F){return new mo(this,F).serialize(r)},toJSON:function(X){return new mo(this,X).toJSON()},deserialize:function(i,N,$){return new mo(this).deserialize(i,N,$)}});var Tk=_.OverlappingBox=function(w){this.gv=w,this.boxes={}};Fh("OverlappingBox",S,{clear:function(){var F,k,e=this.boxes;for(F in e)k=e[F],k.length=0},isOverlapping:function(B,z){var W,b,Z=this,r=Z.boxes,i=r[B];i?(W=i.rects,b=i.length):i=r[B]={rects:W=[],length:b=0};var j,Y,z;for(j=0;b>j;j++)if(Y=W[j],Y.x<z.x+z.w&&Y.x+Y.w>z.x&&Y.y<z.y+z.h&&Y.h+Y.y>z.y)return!0;return W.length<=b?(W.push(z),i.length++):W[i.length++]=z,!1}}),Lp(m,{fetch:function(p,A){A=A||{},p.open(A.method||"GET",A.url||"",!(null!=A.sync?A.sync:!1)),"json"===A.dataType&&p.setRequestHeader("Content-Type","application/json"),A.responseType&&(p.responseType=A.responseType),p.send(A.data)},convertImageSrc:function(M,F){F&&"function"==typeof F||(F=function(){}),F(M)}});var Bp=_.Request=function(){};Fh("Request",S,{_mimeType:B,getXhr:function(){return this._xhr||(this._xhr=new XMLHttpRequest,this.overrideMimeType("text/plain")),this._xhr},send:function(e){var f=this.getXhr();e.mimeType&&this.overrideMimeType(e.mimeType),f.onload=this.onload,f.onerror=this.onerror,m.fetch(f,e)},onload:function(){},onerror:function(){},getResponseType:function(){return this.getXhr().responseType},setOverrideMimeType:function(r){this.overrideMimeType(r)},getMimeType:function(){return this._mimeType},overrideMimeType:function(G){this.getXhr().overrideMimeType(this._mimeType=G)},getResponseHeader:function(G){return this.getXhr().getResponseHeader(G)},getResponseText:function(){var P=this.getXhr();return P.response||P.responseText},getStatus:function(){return this.getXhr().status}}),xo.GraphView=function(O){var a=this;a._24I={},a._34I=new An,a.enableDirtyRect(),a._25I={},a._56I={},a._view=Oc(1,a),a._canvas=km(a._view),a.dm(O?O:new wp),this._coreInteractor=new bm(this),a.setEditable(!1),a.setScrollBarVisible(m.graphViewScrollBarVisible),a._initView()},Ee("GraphView",S,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Di,gk,Fd,rm,"resettable","editInteractor",ql,"zoomable","pannable","rectSelectable","autoScrollZone",yp,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:m.graphViewZoomable,_resettable:m.graphViewResettable,_pannable:m.graphViewPannable,_rectSelectable:m.graphViewRectSelectable,_autoScrollZone:m.graphViewAutoScrollZone,_rectSelectBackground:m.graphViewRectSelectBackground,_rectSelectBorderColor:m.graphViewRectSelectBorderColor,_editPointSize:m.graphViewEditPointSize,_editPointBorderColor:m.graphViewEditPointBorderColor,_editPointBackground:m.graphViewEditPointBackground,_scrollBarColor:cg,_scrollBarSize:Vf,_autoHideScrollBar:Yn,_autoMakeVisible:yl,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()
},setLayers:function(q){this._dataModel.setLayers(q)},setEditable:function(C){var D=this,K=D.__interactorMap__;if(!K){var a=xo.XEditInteractor;K=D.__interactorMap__={scrollBar:new mb(D),select:new Qe(D),edit:a?new a(D):new pg(D),text:new Pk(D),move:new zo(D),"default":new cc(D),touch:new no(D,{editable:!1})}}C?(D._uieditable=!0,D.setInteractors([K.scrollBar,K.select,K.text,K.edit,K.move,K.default,K.touch])):(D._uieditable=!1,D.setInteractors([K.scrollBar,K.select,K.move,K.default,K.touch]))},getCanvas:function(){return this._canvas},_33I:function(M){var l=M.getUIClass();return l?new l(this,M):z},getDataUI:function(M){var b=this,f=b._25I[M._id];return f===B&&(f=b._33I(M),b._25I[M._id]=f),f},getNodeRect:function(_){return m.getNodeRect(this,_)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(A){var B=this.getDataUI(A);return B?(B._79o(),B._78o):null},getEdgeSourcePosition:function(m){var a=this,E=a.getDataUI(m),X=E.s,J=E._data._40I;return tm(a,J,X("edge.source.position"),X("edge.source.offset.x"),X("edge.source.offset.y"),X("edge.source.anchor.x"),X("edge.source.anchor.y"))},getEdgeTargetPosition:function(N){var e=this,U=e.getDataUI(N),Q=U.s,l=U._data._41I;return tm(e,l,Q("edge.target.position"),Q("edge.target.offset.x"),Q("edge.target.offset.y"),Q("edge.target.anchor.x"),Q("edge.target.anchor.y"))},invalidateAll:function(N){var w=this;if(N){for(var s in w._25I){var _=w._25I[s];_&&_.dispose()}w._25I={},w._56I={},w._24I={},w._34I.clear(),w.redraw()}else w.dm().each(function(Y){w.invalidateData(Y)})},invalidateSelection:function(){var k=this;k.sm().each(function(n){k.invalidateData(n)})},invalidateData:function(E){var C=this;C._24I[E._id]=E,C._21Q(E),C.iv()},_21Q:function(y){var i=this,N=i._24I;if(Xr(y)&&Fi[y.s(Ur)]){var p=y.getSourceAgent();p&&p.getAgentEdges().each(function(X){N[X._id]=X}),p=y.getTargetAgent(),p&&p.getAgentEdges().each(function(y){N[y._id]=y}),i.iv()}},redraw:function(z){var P=this;P._32I||(z?P._34I.add(z):(P._32I=1,P._34I.clear()),P.iv())},each:function(j,A){var l,F,f,y=0,k=this.getLayers(),O=this._dataModel,q=O._datas._as,o=q.length;if(k){var t,X={};O.isHierarchicalRendering()&&O.eachByHierarchical(function($){f=$._layer,t=X[f],t||(t=X[f]=[]),t.push($)});for(var s=k.length;s>y;y++)if(f=k[y],Th(f)&&(f=f.name),O.isHierarchicalRendering()){t=X[f];var S,l,H;if(t&&(S=t.length)>0)for(var d=0;S>d;d++)if(l=t[d],H=A?j.call(A,l):j(l),H===!1)return}else for(var d=0;o>d;d++)if(l=q[d],l._layer===f&&(F=A?j.call(A,l):j(l),F===!1))return}else if(O.isHierarchicalRendering())this._dataModel.eachByHierarchical(j,null,A);else for(;o>y;y++)if(l=q[y],F=A?j.call(A,l):j(l),F===!1)return},reverseEach:function(P,O){var j,G,B,X,N=this._dataModel,l=N._layers,o=N._datas._as,r=o.length;if(l){var W,t={};for(N.isHierarchicalRendering()&&N.reverseEachByHierarchical(function(U){X=U._layer,W=t[X],W||(W=t[X]=[]),W.push(U)}),j=l.length-1;j>=0;j--)if(X=l[j],Th(X)&&(X=X.name),N.isHierarchicalRendering()){W=t[X];var p,G,d;if(W&&(p=W.length)>0)for(var I=0;p>I;I++)if(G=W[I],d=O?P.call(O,G):P(G),d===!1)return}else for(var I=r-1;I>=0;I--)if(G=o[I],G._layer===X&&(B=O?P.call(O,G):P(G),B===!1))return}else if(N.isHierarchicalRendering())N.reverseEachByHierarchical(P,null,O);else for(j=r-1;j>=0;j--)if(G=o[j],B=O?P.call(O,G):P(G),B===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var g=this,x=g._84I;if(!x){var l=this.dm().a("width"),u=this.dm().a("height");l>0&&u>0?g._84I={x:0,y:0,width:l,height:u}:(g.each(function(u){g.isVisible(u)&&(x=io(x,g.getDataUIBounds(u)))}),g._84I=x?x:ac)}return g._84I},getScrollRect:function(){return io(this.getContentRect(),this._29I)},makeCenter:function(B,_,G){var I=this;if(!I.getWidth()||!I.getHeight())return G||sg(I.makeCenter,I,[B,_,!0],500),void 0;I.makeVisible(B),I.validate();var X=I.getDataUIBounds(B);if(X){var z=I.getWidth(),c=I.getHeight(),R=X.x+X.width/2,t=X.y+X.height/2,V=-R*I._zoom+z/2,L=-t*I._zoom+c/2;I.setTranslate(V,L,_)}},fitData:function(i,q,R,p,h){var H=this;if(!H.getWidth()||!H.getHeight())return h||sg(H.fitData,H,[i,q,R,p,!0],500),void 0;var G=function(){H.makeVisible(i),H.validate();var w=H.getDataUIBounds(i);w&&(w=zs(w),gp(w,R==z?20:R),H.fitRect(w,q,p))};q?m.callWhenLoaded(G):G()},fitContent:function(O,c,o,b){var T=this;if(!T.getWidth()||!T.getHeight())return b||sg(T.fitContent,T,[O,c,o,!0],500),void 0;var q=function(){T.validate();var q=zs(T.getContentRect());gp(q,c==z?20:c),T.fitRect(q,O,o)};O?m.callWhenLoaded(q):q()},fitRect:function(R,Y,X){var w=this,Z=w.getWidth(),S=w.getHeight(),u=R.x+R.width/2,v=R.y+R.height/2,q=H(Z/R.width,S/R.height),O=w._zoom,b=-u*O+Z/2,e=-v*O+S/2;0===q||isNaN(q)||(X&&(q=H(1,q)),Y?(w._65I&&(delete w._65I.finishFunc,w._65I.stop(!0)),w._14o&&w._14o.stop(!0),w.setTranslate(b,e,{finishFunc:function(){w.setZoom(q,Y)}})):(w.setTranslate(b,e),w.setZoom(q)))},fitSelection:function(s,L,x){var u=this,X=u.sm(),n=null;X.size()&&(X.each(function(O){n=io(u.getDataUIBounds(O),n)}),s&&gp(n,s),u.fitRect(n,L,x))},toCanvas:function(l,L,e){L=L||this._zoom,this.validateImpl();var m=this,o=m.getContentRect();e&&gp(o,e),o.width||(o.width=10),o.height||(o.height=10);var q=km(),g=o.x*L,u=o.y*L,Y=Math.ceil(o.width*L),C=Math.ceil(o.height*L);Eg(q,Y,C,1);var F=rk(q);l=l||this._dataModel.getBackground(),l&&rr(F,0,0,Y,C,l),Jo(F,-g,-u),F.scale(L,L);var T=this._zoom;return this._zoom=L,m._42(F),this._zoom=T,F.restore(),q},toDataURL:function(W,t,N,T){return this.toCanvas(W,N,T).toDataURL(t||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(s,x){var z=this,m=z.dm().getBackground();if(m){var c=z.dm().a("width"),P=z.dm().a("height");c>0&&P>0&&rr(s,0,0,c,P,m)}var V=z.__htmlOrderList,R=[],n=z._forcedLayoutHTML;if(z._93db(s,x),z.each(function(l){var O=z.getDataUI(l);if(O){var Z=z._56I[l._id],e=O._htmlView;if(Z){var K=O._79o();if(e=O._htmlView,_.HtmlNode&&l instanceof _.HtmlNode)O._42(s);else{var M=z.getViewRect(),B=e&&e.layoutHTML;!x||pn(x,K)?(B&&(e.layoutHTML(),O.__outerLayout&&delete O.__outerLayout),O._42(s)):pn(M,K)||!B||O.__outerLayout&&!n||(e.layoutHTML(),O.__outerLayout=!0)}}e&&(R.push(e),e.getView&&(e=e.getView()),e.style.display=Z?"block":Ip)}}),V&&R.length>0){var g=!1;if(V.length!==R.length)g=!0;else for(var a=0;a<R.length;a++)if(R[a]!==V[a]){g=!0;break}g&&(R.forEach(function(k){k.autoAdjustIndex!==!1&&z.appendHTML(k,!0)}),this.__htmlOrderList=R)}else this.__htmlOrderList=R;z._92db(s,x)},disableDirtyRect:function(){this._shouldRedrawAll=X},enableDirtyRect:function(){var d=this;d._shouldRedrawAll=function(){return d._32I}},validateImpl:function(){this.tryUpdateRootData();var k,V,o,x,J,B=this,n=B.tx(),N=B.ty(),_=B._zoom,L=B._canvas,h=this.getWidth(),U=this.getHeight(),t=B._29I,E={x:-n/_,y:-N/_,width:h/_,height:U/_},O={},y=B._34I,K=B._24I,A=B._shouldRedrawAll(),Y=B._23I;B._24I={},(h!==L.clientWidth||U!==L.clientHeight)&&(Eg(L,h,U),A=1,B._forcedLayoutHTML=1),A||Df(E,t)||(A=1,B._forcedLayoutHTML=1),B._29I=E,B.each(function(F){V=F._id;var b=O[V]=B.isVisible(F);b!==B._56I[V]&&(K[V]=F,o=B.getDataUI(K[V]),o&&o._84o(b),B._84o(F,b))},B);for(V in K)o=B.getDataUI(K[V]),o&&(!A&&B._56I[V]&&(J=o._79o(),J&&y.add(J)),o.invalidate()),B._83I=1;if(B._56I=O,!A)for(V in K)O[V]&&(o=B.getDataUI(K[V]),o&&(J=o._79o(),J&&y.add(J)));if(A?x=E:(y.each(function(K){pn(E,K)&&(x=io(x,K))}),x&&(gp(x,$(1,1/_)),x.x=e(x.x*_)/_,x.y=e(x.y*_)/_,x.width=u(x.width*_)/_,x.height=u(x.height*_)/_,x=Li(E,x))),B._74O=x,x&&0!==x.width&&0!==x.height){k=rk(L);var q=x.x,G=x.y,C=x.width,Q=x.height;q=Math.floor((q*_+n)*sq),G=Math.floor((G*_+N)*sq),C=Math.ceil(C*_*sq)+1,Q=Math.ceil(Q*_*sq)+1,A||(x.x=(q/sq-n)/_,x.y=(G/sq-N)/_,x.width=C/sq/_,x.height=Q/sq/_),k.beginPath(),k.rect(q,G,C,Q),k.clip(),k.clearRect(q,G,C,Q),tl(k,n,N,_),B._42(k,x),k.restore(),delete B._74O}if(y.clear(),delete B._32I,delete B._forcedLayoutHTML,Y&&h>0&&U>0){var o=B.getDataUI(Y);if(o){var J=o._79o(),r=B._29I,v=r.x,f=r.y,T=r.width,g=r.height,_=B._zoom;J&&!pn(J,r)&&(J.x+J.width<v&&B.tx(-J.x*_),J.x>v+T&&B.tx(-(J.x+J.width-T)*_),J.y+J.height<f&&B.ty(-J.y*_),J.y>f+g&&B.ty(-(J.y+J.height-g)*_))}delete B._23I}B._83I&&(delete B._83I,delete B._84I),B._98O(),B.countFrame(),od(B._24I)||sg(B.iv,B)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var p,F=this.getFullscreenDatas();for(var O in F)p=F[O],this.scaleRootData(p);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(R){var Q=R.s("fullscreen");if("uniform"===Q||"fill"===Q){R.getRotation()&&R.setRotation(0);var l=R.s("fullscreen.gap")||0,c=this.getWidth(),h=this.getHeight();if(c&&h){var G,$,F,d=c-2*l,s=h-2*l,j=R.getAnchor(),o=R.getScaledSize(),k=o.width,Y=o.height,Z=R.s("fullscreen.lock");if(Z)return"uniform"===Q?d/s>k/Y?(G=s/Y,k=Y*d/s):(G=d/k,Y=k*s/d):"v"===Z?(G=s/Y,k=d/G,R.getWidth()!==k&&R.setWidth(k)):(G=d/k,Y=s/G,R.getHeight()!==Y&&R.setHeight(Y)),this.setZoom(G),$=l-(R.getX()-j.x*k)*G,F=l-(R.getY()-j.y*Y)*G,$!==this.tx()&&this.tx($),F!==this.ty()&&this.ty(F),void 0;$=this.tx(),F=this.ty(),G=this._zoom;var b={x:(-$+l)/G,y:(-F+l)/G,width:d/G,height:s/G};if("uniform"===Q){var O=k/Y,q=Math.min(b.width,b.height*O),g=q/O;b.x+=.5*(b.width-q),b.y+=.5*(b.height-g),b.width=q,b.height=g}d=b.width/R.getScaleX(),s=b.height/R.getScaleY(),(R.getWidth()!=d||R.getHeight()!==s)&&R.setSize(d,s);var f=b.x+j.x*b.width,K=b.y+j.y*b.height,e=R.getPosition();(f!==e.x||K!==e.y)&&R.setPosition(f,K)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(U){var N=this;U!==N.isScrollBarVisible()&&(U?(as(N._view,N._79O=fo()),as(N._79O,N._27I=fo()),as(N._79O,N._28I=fo())):(zr(N._79O),delete N._79O,delete N._27I,delete N._28I),N.fp("scrollBarVisible",!U,U))},getDebugTip:function(){return""},showScrollBar:function(){var T=this;T._79O&&(T._85I||(Vr(function(){T._86I()},Yc),T.iv()),T._85I=new Date)},_86I:function(){var K=this;if(K._85I){var o=new Date,f=o.getTime();f-K._85I.getTime()>=Yc?(delete K._85I,K.iv()):Vr(function(){K._86I()},Yc)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var $=this,M=this._27I,y=this._28I;if($._79O){if($._autoHideScrollBar&&!$._85I)return M.style.visibility=kf,y.style.visibility=kf,void 0;var G=$.getScrollBarColor(),J=$._zoom,s=$.getScrollBarSize(),R=$.getViewRect(),Y=$.getScrollRect(),z=R.height*J,A=Y.height*J,F=R.width*J-s-2,m=z*((R.y-Y.y)*J/A),S=z*(z/A),T=M.style;A-.5>z?(Xq>S&&(m=m+S/2-Xq/2,0>m&&(m=0),m+Xq>z&&(m=z-Xq),S=Xq),fs(M,F,m,s,S),T.visibility=xp,T.background=G,T.borderRadius=s/2+Eq):T.visibility=kf;var I=R.width*J,f=Y.width*J,m=R.height*J-s-2,F=I*((R.x-Y.x)*J/f),B=I*(I/f),T=y.style;f-.5>I?(Xq>B&&(F=F+B/2-Xq/2,0>F&&(F=0),F+Xq>I&&(F=I-Xq),B=Xq),fs(y,F,m,B,s),T.visibility=xp,T.background=G,T.borderRadius=s/2+Eq):T.visibility=kf}},setDataModel:function(u){var c=this,U=c._dataModel,s=c._selectionModel;U!==u&&(U&&(U.ump(c.handleDataModelPropertyChange,c),U.umm(c.handleDataModelChange,c),U.umd(c.handleDataPropertyChange,c),U.removeIndexChangeListener(c._75O,c),U.removeHierarchyChangeListener(c.handleHierarchyChange,c),s||U.sm().ums(c.handleSelectionChange,c)),c._dataModel=u,u.mp(c.handleDataModelPropertyChange,c),u.mm(c.handleDataModelChange,c),u.md(c.handleDataPropertyChange,c),u.addIndexChangeListener(c._75O,c),u.addHierarchyChangeListener(c.handleHierarchyChange,c),s?s._21I(u):u.sm().ms(c.handleSelectionChange,c),c.invalidateAll(!0),c.fp(Kd,U,u),c.updateBackground())},getLayersInfo:function(){if(this._layersInfo===B){var _=this.getLayers();_?(this._layersInfo={},_.forEach(function(t){var f=Th(t)?t.name:t;this._layersInfo[f]=t},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(n,$,r){var p,g,F,c,R=this;n instanceof _.Data?(c=R.getDataUI(n),F=kn(c)):(F=kn(null,arguments[0],arguments[1]),$=arguments[2],r=arguments[3]),2===$.length&&($=new sm($[0],$[1]));var z=Cf($,function($){return Sp(F,100*$)},100,.001),U=Sp(F,100*z);if(!r){var Y=c?ik(c):ik(arguments[0],arguments[1]),W=new sm(U.x,U.y),C=49/(R._zoom*R._zoom);for(p=0,g=Y.length;g>p;p++)if(W.distanceToSquared(Y[p])<C)return{index:p,point:Y[p],distance:Math.sqrt((Y[p].x-$.x)*(Y[p].x-$.x)+(Y[p].y-$.y)*(Y[p].y-$.y))}}return{percent:z,point:U,distance:Math.sqrt((U.x-$.x)*(U.x-$.x)+(U.y-$.y)*(U.y-$.y))}},getPercentPositionOfPath:function(a,v){var B;if(a instanceof _.Data){var M=this.getDataUI(a);B=kn(M)}else B=kn(null,arguments[0],arguments[1]),v=arguments[2];return Sp(B,v)},getNeareastPositionOfPath:function(){return this.calculateEdgePosition.apply(this,arguments)},getPointsOfPath:function(){function N(g,j,W,z,u,J){var F=new sm(j.get(W)),s=J.apply(F);g.push({local:F,world:s,type:u,index:W,realIndex:z})}return function(g){var j,f;if(g instanceof _.Data){var x=this.getDataUI(g),P=Cq(x);j=P.points,f=P.segments}else j=arguments[0],f=arguments[1];var Q,V,p,J=g instanceof _.Shape?g.getPointsMatrix2d():new _k.Matrix2d,n=[],b=-1,R=-1;for(V=0,p=f?f.length:j.length;p>V;V++)Q=f?f.get(V):1,5!==Q&&(R++,3===Q?(N(n,j,b+1,R,"C",J),N(n,j,b+2,R,"M",J),b+=2):4===Q?(N(n,j,b+1,R-1,"R",J),N(n,j,b+2,R,"L",J),N(n,j,b+3,R,"M",J),b+=3):(N(n,j,b+1,R,"M",J),b+=1));return n}}(),calculateAttachPoint:function(){var n=new sm,y=new sm,a=new sm;return function(d,P){var C=this.getAttachPoints(d);if(!C||!C.length)return null;a.set(P.x,P.y);for(var J,u,U,e,S,t=1/0,O=0,i=C.length;i>O;O++)U=C[O],y.x=U.x,y.y=U.y,n.x=U.offsetX||0,n.y=U.offsetY||0,e=tm(this,d,0,n.x,n.y,y.x,y.y),u=a.distanceToSquared(e),t>u&&(J=O,t=u,S=e);t=Math.sqrt(t);var z=this.getAttachStyle(d);if("close"===z){var F=d.s("attach.close.threshold")/this._zoom;if(t>F)return null}return{index:J,distance:t,info:C[J],point:S}}}(),getAttachPoints:function(a){var $=a.s("attach.points");if($)return $;var E=Om(a._image);return E?Gq(E.attachPoints,a,this)||null:void 0},getAttachStyle:function(c){var m=c.s("attach.style");if(m)return m;var e=Om(c._image);return e?Gq(e.attachStyle,c,this)||"close":void 0},updateLayers:function(){this._layersInfo=B,this.invalidateSelection(),this.redraw()},updateBackground:function(){var v=this.dm().a("width"),w=this.dm().a("height");this._canvas.style.background=v>0&&w>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(H){if("background"===H.property){var w=this._canvas.style.background,C=H.newValue||"";this.updateBackground(),this.fp("canvasBackground",w,C),this.redraw()}else"a:width"===H.property||"a:height"===H.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===H.property?this.updateLayers():"hierarchicalRendering"===H.property&&this.redraw()},handleDataPropertyChange:function(G){this.dm().isHierarchicalRendering()&&"parent"===G.property&&G.data.hasChildren()&&this.redraw(),this.invalidateData(G.data)},onPropertyChanged:function(b){var m=this,E=b.property;if(m.redraw(),"zoom"===E){var z=m.sm().getSelection();z.size()&&z.each(function(W){W.invalidate()})}else"dataModel"===E&&(m._83I=1);ur[E]?m.showScrollBar():E===ql&&m.onCurrentSubGraphChanged(b)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(q){var C=this,B=q.kind,v=q.data;if(C._83I=1,"add"===B)C.invalidateData(v),Xr(v)&&v.getEdgeGroup()&&v.getEdgeGroup().eachSiblingEdge(C.invalidateData,C),v.getHost&&v.getHost()&&v.getHost().updateLayoutAttaches();else if(B===Zf){C._21Q(v);var P=v._id,a=C._25I[P];if(a){if(C._56I[P]){var f=a._79o();f&&C.redraw(f)}a.dispose(),delete C._25I[P],delete C._24I[P],delete C._56I[P]}v===C._currentSubGraph&&C.setCurrentSubGraph(z)}else B===hm&&(C.invalidateAll(!0),C.setCurrentSubGraph(z))},_75O:function(s){this.invalidateData(s.data)},handleHierarchyChange:function(J){this.dm().isHierarchicalRendering()&&J.data.hasChildren()&&this.redraw(),this.invalidateData(J.data)},adjustIndex:function(C){var G=this;if(G.isVisible(C)){G.dm().beginTransaction();for(var e=C;e._parent&&G.isVisible(e._parent);)e=e._parent;e&&e!==C&&G._dataModel.adjustIndex(e),G._dataModel.adjustIndex(C),G.dm().endTransaction()}},getImage:function(g){return g.getImage?g.getImage():B},getSelectWidth:function(H){var F=Om(this.getImage(H));return F&&Gq(F.disableSelectedBorder,H,this)?0:H.s("select.width")},getSelectColor:function(b){return b.s("select.color")},isSelectable:function(I,T){if(this.isSelected(I))return!0;if(!T&&I.getParent()instanceof Sm&&this.isSelectable(I.getParent(),!0)&&I.getParent().isSyncSize())return!1;var q=this.getLayersInfo();if(q){var n=q[I._layer];if(n&&n.selectable===!1)return!1}return I.s("2d.selectable")&&this.sm().isSelectable(I)},isMovable:function(Y){var N=this;if(Xr(Y)&&Y.getStyle(Ur)!==Bj)return!1;var Q=this.getLayersInfo();if(Q){var A=Q[Y._layer];if(A&&A.movable===!1)return!1}return Y.s("2d.movable")?N._movableFunc?N._movableFunc(Y):!0:!1},isEditable:function(k){var o=this;if(_._uiSerializing)return o._uieditable;if(!o._editInteractor||!o.isSelected(k))return!1;if(Hh(k)){var U=o.getDataUI(k);if(!U||U._88I)return!1}if(Xr(k)&&k.getStyle(Ur)!==Bj)return!1;var A=this.getLayersInfo();if(A){var I=A[k._layer];if(I&&I.editable===!1)return!1}return k.s("2d.editable")?o._editableFunc?o._editableFunc(k):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(g){return Dk(g)&&0!==g.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(g):!0},isRectEditable:function(u){return this._rectEditableFunc?this._rectEditableFunc(u):!0},isAnchorEditable:function(k){return this._anchorEditableFunc?this._anchorEditableFunc(k):!0},isRotationEditable:function(z){return z.setRotation&&z.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(z):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(N){var o=N.getAnchor(),n=N.getScale(),y=this._zoom,E=ij(N.getRotation(),0,-N.getHeight()*n.y*o.y-(n.y<0?-1:1)*(Xl?32:16)/y),s=N.p();return E.x+=s.x,E.y+=s.y,E},getLogicalPoint:function(Z){var H=this;return Xi(Z,H._canvas,H.tx(),H.ty(),H._zoom,H._zoom)},getScreenPoint:function(V,F){var y,P=this;return"object"==typeof V?V.x!==B?(y=V.x,F=V.y):(y=V[0],F=V[1]):y=V,qk(y,F,P._canvas,P.tx(),P.ty(),P._zoom,P._zoom)},getSelectedDataAt:function(z){var s=this;return this.getDataAt(z,function(j){return s.isSelected(j)})},getDataInfoAt:function(E,I,b){var s,Z=this.lp(E),A=this.getDataAt(Z,I,b);if(A){var P=this.getDataUI(A);s={data:A,ui:P,point:Z};var w=P._38o;if(w){var U=w.icons;for(var r in U){var t=U[r],V=w.rects[r];if(V)for(var J=Gq(t.names,A,this),j=J?J.length:0,K=V.rotation,i=j-1;i>=0;i--){var D=J[i],C=V[i];if(tq(C,Z,K))return s.part="icons",s.name=r,s.icon=D,s.rect=C,s.index=i,s.rotation=K,s}}}if(this.isNoteVisible(A)){if(P.note2Info&&tq(P.note2Info.clickRect,Z,z,P.note2Info.scale))return s.part="note2",s;if(P.noteInfo&&tq(P.noteInfo.clickRect,Z,z,P.noteInfo.scale))return s.part="note",s}if(this.isLabelVisible(A)){if(P.label2Info&&tq(P.label2Info.rect,Z,P.label2Info.rotation,P.label2Info.scale))return s.part="label2",s;if(P.labelInfo&&tq(P.labelInfo.rect,Z,P.labelInfo.rotation,P.labelInfo.scale))return s.part="label",s}if(A.isInRect&&A.isInRect(Z))return s.part="body",s}return s},getDataAt:function(V,m,s){V.target&&(V=this.lp(V));var X,P=this._zoom;return this.reverseEach(function(i){return(m?m(i):this.isSelectable(i))&&this.rectIntersects(i,Sq(V.x,V.y,s,P))?(X=i,!1):void 0},this),X},getIconInfoAt:function(s,Z){var W=this;if(s.target&&(s=W.lp(s)),Z||(Z=W.getDataAt(s)),Z){var M=W.getDataUI(Z);if(M&&M._38o){var e,F=M._38o,B=new An;for(e in F.icons)B.add(e);for(var J=B.size()-1;J>=0;J--){e=B.get(J);for(var R=F.rects[e],$=R.rotation,j=R.length-1;j>=0;j--){var t=R[j],O=t.width,f=t.height,u={x:s.x-t.x-O/2,y:s.y-t.y-f/2};$!=z&&(u=ij(-$,u.x,u.y));var t={x:-O/2,y:-f/2,width:O,height:f};if(tq(t,u))return{key:e,index:j,name:F.icons[e].names[j],rect:R[j],point:s,rotation:$,relativeRect:t,relativePoint:u,data:Z}}}}}return z},getDatasInRect:function(V,l,J){J===B&&(J=1);var e=this,t=new An;return e.reverseEach(function(R){J&&!e.isSelectable(R)||(l?e.rectIntersects(R,V):e.rectContains(R,V))&&t.add(R)}),t},moveSelection:function(k,e){var G=this;G.dm().beginTransaction(),Yj(G.sm().toSelection(G.isMovable,G),k,e),G.dm().endTransaction()},moveDatas:function(c,Q,I){var M=this;M.dm().beginTransaction(),c instanceof An||(c=new An(c)),Yj(c,Q,I),M.dm().endTransaction()},getDataUIBounds:function(B){var F=this.getDataUI(B);return F?F._79o():z},drawData:function(M,D,Q){var t=this.getDataUI(D);if(t){var G=t._79o();(!Q||pn(Q,G))&&(t._42(M),D instanceof _.Block&&D.eachChild(function(F){this.isVisible(F)&&this.drawData(M,F,Q)},this))}},getBoundsForGroup:function(k){return k.s(Dm)?this.getDataUIBounds(k):z},isPixelPerfect:function(R){return R.s("pixelPerfect")},rectIntersects:function(D,y){this.validate();var J=z;if(this._56I[D._id]){var Z=this._25I[D._id];if(Z){var h=Z._79o();if(wi(y,h))J=!0;else if((y=Li(y,h))&&(Z.rectIntersects&&(J=Z.rectIntersects(y)),J==z)){if(!this.isPixelPerfect(D))return!0;var X=y.x,n=y.y,G=y.width,r=y.height,k=this._zoom,S=m.hitMaxArea,E=G*r*k*k;if(E>S){var c=Math.sqrt(S/E);k*=c}G*=k,r*=k,2>G&&(G=2),2>r&&(r=2),X*=k,n*=k;var Q=ee(G,r);Jo(Q,-X,-n),Q.scale(k,k),this._drawForChecking=!0,this.drawData(Q,D,y),this._drawForChecking=!1;try{for(var M=0,I=Q.getImageData(0,0,G,r).data;M<I.length;M+=4)if(0!==I[M+3]){J=!0;break}Q.restore()}catch(i){Pj=z,J=!1}}}}return J?!0:!1},rectContains:function(i,$){if(this._56I[i._id]){var _=this._25I[i._id];if(_)return wi($,_._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(K){if(!m.isInput(K.target)){var y=this,S=y._focusData,J=S&&y._25I[S._id],G=0,A=y._dataModel._datas;if(!(S&&S._enabled&&S._editable&&J&&J.onKeyDown&&J.onKeyDown(K)===!0))if(9===K.keyCode&&(S&&(G=A.indexOf(S),Vn(K)?-1===--G&&(G=0):++G===A.size()&&(G=0)),y._focusData=S=A.get(G),y.sm().setSelection(S)),jq(K)?y.selectAll():sc(K)&&y.isResettable()&&y.reset(),y.sm().isEmpty()){if(y._editing)return;var l=y.tx(),s=y.ty(),C=!1,U=Vn()?100:10;kr(K)&&(l-=U,C=!0),jc(K)&&(s-=U,C=!0),Zg(K)&&(l+=U,C=!0),Cg(K)&&(s+=U,C=!0),C&&y.setTranslate(l,s)}else{xi(K)&&y.handleDelete(K);var u=Vn()?10:1;kr(K)&&(y.moveSelection(-u,0),y.fi({kind:"moveLeft"})),jc(K)&&(y.moveSelection(0,-u),y.fi({kind:"moveUp"})),Zg(K)&&(y.moveSelection(u,0),y.fi({kind:"moveRight"})),Cg(K)&&(y.moveSelection(0,u),y.fi({kind:"moveDown"}))}}},handleScroll:function(b,s){if(pd(b),this.isZoomable()){if(!this.getEditInteractor()){var E=this.getDataAt(b);if(E){var o=Om(this.getImage(E));if(o&&Gq(o.scrollable,E,this))return}}var Z=this.getFullscreenDatas();for(var F in Z)if(Z[F].s("fullscreen.lock"))return;var x=this.lp(b);s>0?this.scrollZoomIn(x):0>s&&this.scrollZoomOut(x)}},handlePinch:function(W,f,t){this.isZoomable()&&(Math.abs(f-t)<m.pinchZoomThreshold||(f>t?this.pinchZoomIn(W):this.pinchZoomOut(W)))},checkDoubleClickOnNote:function(h,d){var z=this,t=z.lp(h),D=z.getDataUI(d),y=D.note2Info;return y&&d.s("note2.toggleable")&&tq(y.clickRect,t)?(d.s(dn,!d.s(dn)),z.fi({kind:"toggleNote2",event:h,data:d}),!0):(y=D.noteInfo,y&&d.s("note.toggleable")&&tq(y.clickRect,t)?(d.s(Ag,!d.s(Ag)),z.fi({kind:"toggleNote",event:h,data:d}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(q,V){var I=this,L=I.getAutoScrollZone(),X=L/I.getZoom(),T=L/4,w=I._29I,i=I.lp(q),b={x:I.tx(),y:I.ty()};return i&&L>0&&w&&(i.x-w.x<X?I.translate(T,0):w.x+w.width-i.x<X&&I.translate(-T,0),i.y-w.y<X?I.translate(0,T):w.y+w.height-i.y<X&&I.translate(0,-T)),b.x=I.tx()-b.x,b.y=I.ty()-b.y,V&&(V.x+=b.x,V.y+=b.y),b},getMoveMode:function(o,z){var p=z.s("2d.move.mode");return p?p:nq["88"]?"x":nq["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(X,V,s){var U=this;return"currentSubGraph"===V?{__i:X.getId()}:s.serializeProperty(X,V,U)},deserializeProperty:function(K,I,k){var N=this;if("currentSubGraph"===I){var Y=N.dm(),f=Y.__idMap;return f[K.__i]}return k.deserializeProperty(K,I,N)},setDefaultCursor:function(W,A){this._defaultCursor=W,A!==!1&&this.setCursor(W)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(v){return v===z||m.getConnectAction(null,v)?(this._currentActionType=v,this.redraw(),!0):!1},getEditStyle:function(R){var I=this.getEditInteractor();return I?I.getStyle(R):B},setEditStyle:function(G,O,Y){var q=this.getEditInteractor();return q?(q.setStyle(G,O,Y),!0):!1},isConnectActionVisible:function(f){var q=m.getConnectAction(this);if(!q)return!1;var $=q.visible;return Qr($)&&($=$(this,f)),$},isInteractive:function(q){if(this._drawForChecking)return!1;var O=Om(this.getImage(q));return O&&Gq(O.interactive,q,this)?!0:q.s("interactive")},getRenderingStyleIconName:function(){return Wr},appendHTML:function(e,N){var b=this.getView();if(!(N||e&&e.parentNode!==b))return!1;var H=e.getView&&e.getView(),O=e.beforeCanvas;if(!N&&H&&H.parentNode===b)return!1;(e.getView||e.isSelfViewEvent)&&(e=e.getView());var h=this.getEditInteractor();return O?b.insertBefore(e,this.getCanvas()):h&&h._canvas?b.insertBefore(e,h._canvas):this.isScrollBarVisible()?b.insertBefore(e,this.getView().lastChild):as(b,e),!0},_layoutHTMLImpl:function(R,N,d){if(arguments.length>1){var T,K=this,Q=K._zoom;if(N.getView&&(T=N,N=N.getView()),N.style.position="absolute",d){var D=R.getRect();fs(T||N,K.tx()+D.x*Q,K.ty()+D.y*Q,D.width*Q,D.height*Q)}else{var w=new hf,D=R.getAnchorRect(),m=R.getPosition(),_=R.getScale(),V=N.style;fs(T||N,D),w.appendTranslate(K.tx(),K.ty()),w.appendScale(Q,Q),w.append(new hf(R.getRotation(),m.x,m.y,_.x,_.y)),Ir(V,"transform","matrix("+w.a.toFixed(5)+", "+w.b.toFixed(5)+", "+w.c.toFixed(5)+",\n    "+w.d.toFixed(5)+", "+w.tx.toFixed(5)+", "+w.ty.toFixed(5)+")"),Ir(V,"transformOrigin",(-D.x).toFixed(5)+"px "+(-D.y).toFixed(5)+"px"),N.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(X){return X instanceof nf?{name:"text",accessType:"s",font:X.s("text.font"),isMultiline:!0}:void 0},getState:function(y){var R="state",r=y.s(R);if(r)return r;var u=Om(y._image);return u?Gq(u[R],y,this)||null:void 0},getShape:function(h){return h.getStyle(Sd)}}),S.defineProperties(xo.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(r){this._layoutHTML=r}}});var _l=function(F,E){var Y=this;Y.gv=F,Y.s=function(u){return E.getStyle(u)},Y._data=E,Y._87I=new An},Wr=z;Fm(_l,S,{_6I:z,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var r=this,s=r.gv.isSelected(r._data);return!s||r.isShadowed()?0:r.gv.getSelectWidth(r._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(p){var y=this._data,$=this.gv.getBodyColor(y);return $?$:p?y.getStyle(p):z},_2Q:function(b){return this.s(b)},_1Q:function(M,h,R,X){var p=this.s,e=p("2d.gray"),V=p(h+".dash.color");if(e&&(V=m.toGrayColor(V)),M.strokeStyle=V,M.lineWidth=R,M.stroke(),p(h+".dash.3d")){var S=p(h+".dash.3d.color");lf(M,V,e?m.toGrayColor(S):S,R,this.gv._zoom,p(h+".dash.3d.accuracy"))}oq(M,X)},invalidate:function(){this._6I=z},_79o:function(){var M=this;if(!M._6I){var p=M._data,N=M.gv;M.labelInfo=M.label2Info=M.noteInfo=M.note2Info=M._38o=z,M._87I.clear(),M.interactiveInfo=N.isInteractive(p)?{}:z,M._3O(),M._55O=N.isEditable(p)?{_42O:N.isRectEditable(p),_43O:N.isPointEditable(p),_56O:N.isRotationEditable(p)}:z,M._6I=M._81o()}return M._6I},_3O:function(){},getPosition:function(){return ac},_68o:function(u,m){u&&this._87I.add(Al(u,m))},_81o:function(){var k=this,U=k.s;k._24O(dk,"getLabel"),k._24O(Sn,"getLabel2"),k._26O(kb,"getNote"),k._26O(Wb,"getNote2"),k._15O(),k._55O&&k._48O();var a;if(k._87I.each(function(x){a=io(a,x)}),a&&U("shadow.interactable")){var f=k.isShadowed(),G=U("shadow2"),N=zs(a);G?(N.x+=U("shadow2.offset.x"),N.y+=U("shadow2.offset.y"),gp(N,U("shadow2.blur"))):f&&(N.x+=U("shadow.offset.x"),N.y+=U("shadow.offset.y"),gp(N,U("shadow.blur"))),a=io(a,N)}return k._87I.clear(),a},_42:function(W){var F=this,Q=F._data,M=F.gv,n=F.s,S=n("opacity"),G=this.isShadowed(),K=n("shadow2");if(G||K){var V=W.shadowOffsetX,N=W.shadowOffsetY,Z=W.shadowBlur,t=W.shadowColor,J=M.getZoom()*m.devicePixelRatio,e=G?"shadow":"shadow2";W.shadowOffsetX=n(e+".offset.x")*J,W.shadowOffsetY=n(e+".offset.y")*J,W.shadowBlur=n(e+".blur")*J,W.shadowColor=G?F.getSelectColor():n(e+".color")}if(S!=z){var X=W.globalAlpha;W.globalAlpha=S}F._80o(W),M.isLabelVisible(Q)&&((!M._drawForChecking||n("label.selectable"))&&aj(W,F.labelInfo),(!M._drawForChecking||n("label2.selectable"))&&aj(W,F.label2Info)),M.isNoteVisible(Q)&&(hi(W,F.noteInfo),hi(W,F.note2Info)),F._99O(W),S!=z&&(W.globalAlpha=X),(G||K)&&(W.shadowOffsetX=V,W.shadowOffsetY=N,W.shadowBlur=Z,W.shadowColor=t)},_80o:function(){},_47O:function(){},_24O:function(t,x){var J=this,d=J._data,S=J.gv,$=J.s,Y=S[x](d);if(Y!=z){var B=$(t+".scale"),p=$(t+".max"),A=$(t+".position"),X=J[t+"Info"]={label:Y,scale:B,color:S[x+"Color"](d),font:$(t+".font"),opacity:$(t+".opacity"),align:$(t+".align"),decoration:$(t+".decoration"),rotation:J.getRotation($(t+".rotation"),!1,A),background:S[x+"Background"](d)},o=kp(X,Y);p>0&&p<o.width&&(X.labelWidth=o.width,o.width=p),1!==B&&(o.width*=B,o.height*=B);var O=J.getPosition(A,$(t+".offset.x"),$(t+".offset.y"),o,$(t+".position.fixed"));if(o.x=O.x-o.width/2,o.y=O.y-o.height/2,J._68o(X.rect=o,X.rotation),1!==B){var q=o.width/B,W=o.height/B;X.rect={x:O.x-q/2,y:O.y-W/2,width:q,height:W}}}},_26O:function(q,R){var r=this,e=r.gv,o=r._data,n=r.s,Q=e[R](o);if(Q!=z){var g,$,M=n(q+".scale"),a=r[q+"Info"]={note:Q,scale:M,data:o,view:e,expanded:n(q+".expanded"),font:n(q+".font"),color:n(q+".color"),opacity:n(q+".opacity"),align:n(q+".align"),icon:n(q+".icon"),backgroundImage:n(q+".backgroundImage"),borderWidth:n(q+".border.width"),borderColor:n(q+".border.color"),background:e[R+"Background"](o)},j=r.getPosition(n(q+".position"),n(q+".offset.x"),n(q+".offset.y")),K=j.x,k=j.y;if(a.expanded){var Z,h=n(q+".max"),i=n(q+".backgroundImage");i?(i=Om(i),Z={width:To(i,o),height:Of(i,o)}):Z=kp(a,Q),Z.width+=6,Z.height+=2,h>0&&h<Z.width&&(a.labelWidth=Z.width,Z.width=h),g=Z.width,$=Z.height+8,a.clickRect={x:K-g*M/2,y:k-$*M,width:g*M,height:$*M*Z.height/$}}else{var p=n(q+".icon");p?(p=Om(p),g=To(p,o),$=Of(p,o)):(g=12,$=18),a.clickRect={x:K-g*M/2,y:k-$*M,width:g*M,height:$*M}}a.rect={x:K-g/2,y:k-$*M/2-$/2,width:g,height:$};var L=u(a.borderWidth/2)*M;r._68o({x:K-g*M/2-L,y:k-$*M-L,width:g*M+2*L,height:$*M+2*L})}},_48O:function(){},_99O:function(J){var b=this,D=b._38o;if(D){var A=b.gv,V=b._data,e=D.icons,l=b.interactiveInfo;l&&(l._38o={});for(var k in e){var g=e[k],w=D.rects[k];if(w){l&&(l._38o[k]=[]);var x=Gq(g.opacity,V,A),i=Gq(g.names,V,A),U=i?i.length:0,s=w.rotation;if(x!=z){var E=J.globalAlpha;J.globalAlpha*=x}for(var X=0;U>X;X++){var K=i[X],q=Om(K),r=w[X];if(s){var R=r.x+r.width/2,y=r.y+r.height/2;J.save(),Jo(J,R,y),af(J,s),Jo(J,-R,-y)}l&&l._38o[k].push(J.interactiveInfo={compInfos:[],matrix:s?new hf(s,R,y).appendTranslate(-R,-y):new hf});var L=Wr;Wr=k,Le(J,q,Gq(g.stretch,V,A),r.x,r.y,r.width,r.height,b._data,b.gv),Wr=L,J.interactiveInfo=z,s&&J.restore()}x!=z&&(J.globalAlpha=E)}}}}});var Fb=function(o,X){mg(Fb,this,[o,X])};Fm(Fb,_l,{_checkEmptyRect:!0,_40O:function(F,R){var P=this,e=P.s,C=F.rect;
(F.borderColor=P.gv.getBorderColor(P._data))&&(F.borderType=e("border.type"),F.borderWidth=e("border.width"),F.borderPadding=e("border.padding"),R=$(R,F.borderPadding+F.borderWidth/2));var d=P._data.getScale(),U=$(1,$(n(d.x),n(d.y)));if(F.selectWidth=P.getSelectWidth()){var J=P.gv._zoom;F.selectType=e("select.type"),F._97o=P.getSelectColor(),F.selectPadding=e("select.padding"),R=$(R,(F.selectPadding+F.selectWidth/2/J)/U)}R>0&&(R*=U,C=zs(C),gp(C,R)),P._68o(C)},_39O:function(f,C){var y,u=this,k=C.rect;if(C.borderWidth>0&&(y=C.borderPadding,f.strokeStyle=C.borderColor,f.lineWidth=C.borderWidth,np(f,C.borderType,{x:k.x-y,y:k.y-y,width:k.width+2*y,height:k.height+2*y}),f.stroke()),C.selectWidth>0){var G=u.gv._zoom;if(y=C.selectPadding,f.strokeStyle=C._97o,f.lineWidth=C.selectWidth/G,C.rotation!=z){f.save(),f.translate(C.position.x,C.position.y),f.rotate(C.rotation);var F=u._data,o=F.getWidth(),Q=F.getHeight(),J=C.scale,R=C.anchor;k={x:J.x*-o*R.x,y:J.y*-Q*R.y,width:J.x*o,height:J.y*Q}}np(f,C.selectType,{x:k.x-y,y:k.y-y,width:k.width+2*y,height:k.height+2*y}),C.rotation!=z&&f.restore(),f.stroke()}},dispose:function(){var t=this,A=t._htmlView;Fb.superClass.dispose.call(t),A&&(A.onHTMLRemoved&&A.onHTMLRemoved(),zr(A))},_3O:function(){var r,e=this,s=e.s,U=e._data,c=e.gv,m=c.getShape(U),I=e.getBodyColor(),E=s("shape.border.color"),t=e._83o=m?{shape:m,_53o:e.getBodyColor("shape.background"),_27Q:Om(s("shape.repeat.image"),I),shapeGradientPack:s("shape.gradient.pack"),shapeBorderGradientPack:s("shape.border.gradient.pack"),_54o:s("shape.border.width"),_55o:E,shapeBorderRepeatImage:Om(s("shape.border.repeat.image"),E),_56o:s("shape.border.3d"),_57o:s("shape.border.3d.color"),_58o:s("shape.border.3d.accuracy"),shapeGradient:s("shape.gradient"),_59o:s("shape.gradient.color"),_60o:s("shape.border.pattern"),_61o:s("shape.border.cap"),_62o:s("shape.border.join"),shapeForeground:s("shape.foreground"),bodyColor:I,gray:s("2d.gray")}:{img:Om(c.getImage(U),I),bodyColor:I,gray:s("2d.gray"),stretch:s("image.stretch")},A=t.img;A&&A.renderHTML?(e._htmlInfo&&e._htmlInfo.img!==A&&(e._htmlInfo=z),e._htmlInfo||(e._htmlInfo={img:A,cache:{}}),r=A.renderHTML(U,c,e._htmlInfo.cache)):e._htmlInfo=z,e._htmlView&&e._htmlView!==r&&(e._htmlView.onHTMLRemoved&&e._htmlView.onHTMLRemoved(),zr(e._htmlView.getView?e._htmlView.getView():e._htmlView)),(e._htmlView=r)&&c.appendHTML(r)&&(r.onHTMLAddedSync&&r.onHTMLAddedSync(),r.onHTMLAdded&&sg(r.onHTMLAdded)),t.rect=U.getRect(),t.position=U.p(),t.scale=U.getScale(),t.anchor=U.getAnchor(),t.rotation=U.getRotation(),m===Ol&&(t._63o=s("shape.depth"));var i=0;if(m)i=yr(z,t._54o/2,t._62o),e.s("shape.dash")&&(i=$(i,(e.s("shape.dash.width")||t._54o)/2));else if(A&&A.boundExtend)if(i=Gq(A.boundExtend,U,c),A.boundExtendAbsolute){var F=U.getScale();i/=c._zoom*$(1,$(n(F.x),n(F.y)))}else if(!Gq(A.fitSize,U,c)){var Y=Gq(A.width,U,c),w=Gq(A.height,U,c);i*=$(U.getWidth()/Y,U.getHeight()/w)}e._40O(t,i);var x=s("clip.percentage");if(x!=B&&(t.clipRect=Ai(U.getAnchorRect(),s("clip.direction"),x)),m){var W=s("shape.fill.clip.percentage");W!=B&&(t.shapeClipRect=Ai(U.getAnchorRect(),s("shape.fill.clip.direction"),W));var M=s("shape.foreground.clip.percentage");M!=B&&(t.shapeForegroundClipRect=Ai(U.getAnchorRect(),s("shape.foreground.clip.direction"),M))}},getPosition:function(C,A,M,q){var V=Gb(C,this._83o.rect,q);return V.x+=A,V.y+=M,V},_80o:function(D){var p=this,M=p.s,e=p.gv,Q=p._data,h=p._83o,y=h.rect,k=h.position,T=h.rotation,u=h.anchor,a=h.scale,v=h.shape,n=h.clipRect;if(!p._checkEmptyRect||y.width>0&&y.height>0){var A=Q.getSize();if(A.x=-A.width*u.x,A.y=-A.height*u.y,fl&&!fd&&Jo(D,A.width,A.height),D.save(),Jo(D,k.x,k.y),af(D,T),to(D,a.x,a.y),n&&(D.beginPath(),D.rect(n.x,n.y,n.width,n.height),D.clip()),e._drawForChecking&&h.img&&Gq(h.img.pixelPerfect,Q,e)===!1)rr(D,A.x,A.y,A.width,A.height,"#888888");else if(p.freeDraw)p.freeDraw(D,A,h);else if(v){var S,Y,Z,V,g=h._60o,t=Qo(D,g),B=h._27Q,c=h._54o,E=h.shapeGradientPack,i=h.gray,H=D.lineJoin,q=D.lineCap,U=function(p){return i?m.toGrayColor(p):p};"roundRect"===v?S=M("shape.corner.radius"):"polygon"===v?(S=M("shape.polygon.side"),Y=M("shape.corner.radius"),Z=M("shape.regular")):"arc"===v&&(S=M("shape.arc.from"),Y=M("shape.arc.to"),Z=M("shape.arc.close"),V=M("shape.arc.oval")),D.lineJoin=h._62o,D.lineCap=h._61o;var r=U(h._53o);if(r||B||E){var L=h.shapeClipRect;L&&(D.save(),D.beginPath(),D.rect(L.x,L.y,L.width,L.height),D.clip()),np(D,v,A,S,Y,Z,V),E?No(D,E,function(u){return zp(u,h.bodyColor)},!1,A):B?Tj(D,B,U(h.bodyColor),null,Q,e):os(D,r,h.shapeGradient,U(h._59o),A),D.fill(),E&&D.restore(),L&&D.restore(),D!==t&&np(t,v,A,S,Y,Z,V)}else np(t,v,A,S,Y,Z,V);var x=h.shapeForeground;if(x){D.save();var O=h.shapeForegroundClipRect;O&&(D.beginPath(),D.rect(O.x,O.y,O.width,O.height),D.clip()),np(D,v,A,S,Y,Z,V),os(D,x,M("shape.foreground.gradient"),U(M("shape.foreground.gradient.color")),A),D.fill(),D.restore()}if(c>0){var G=M("shape.border.width.absolute");G&&(D.save(),D.setTransform(1,0,0,1,0,0)),D.lineWidth=c;var w=U(h._55o),_=h.shapeBorderGradientPack;_?No(D,_,U,!0,A):h.shapeBorderRepeatImage?us(D,h.shapeBorderRepeatImage,w,null,Q,e):D.strokeStyle=w,D.stroke(),_&&D.restore(),G&&D.restore(),h._56o&&lf(D,w,U(h._57o),c,e._zoom,h._58o)}if(oq(D,g),M("shape.dash")){var W=M("shape.dash.width")||c;if(W>0){g=M("shape.dash.pattern");var t=Qo(D,g,p._2Q("shape.dash.offset"));t!==D&&np(t,v,A,S,Y,Z,V),p._1Q(D,"shape",W,g)}}fn(D,r,h._63o,A),D.lineJoin=H,D.lineCap=q}else{var s=p.interactiveInfo;s&&(D.interactiveInfo=s.bodyInfo={compInfos:[],matrix:new hf(T,k.x,k.y,a.x,a.y)}),h.gray&&(D.compGray=!0);var l=h.img;l&&l.cacheRule!=z&&(l=yh(D,l,h.stretch,A.width,A.height,Q,e,h.bodyColor)),Le(D,l,h.stretch,A.x,A.y,A.width,A.height,Q,e,h.bodyColor),D.compGray=!1,D.interactiveInfo=z}D.restore()}p._39O(D,h)},_48O:function(){},_47O:function(){}});var Im=function(D,f){mg(Im,this,[D,f])},je=function(U,M,f,$){var R=bh(U,M);return f=$?H(f,R):we(f,R),R?f/=R:f=0,{x:U.x+(M.x-U.x)*f,y:U.y+(M.y-U.y)*f}};Fm(Im,_l,{_3O:function(){var Q,F=this,M=F._data,t=F.gv,y=F.s,k=y(Ur),b=M.isLooped(),Y=y("edge.width"),e=F.getBodyColor("edge.color"),O=y("edge.center"),J=y("edge.offset"),q=t.getBorderColor(M),W=q?y("border.width"):0,u=F.getSelectWidth(),n=M._40I,E=M._41I,X=F._78o=n&&E?{looped:b,type:k,width:Y,center:O,color:e,repeatImage:Om(y("edge.repeat.image"),e),borderColor:q,borderWidth:W,_97o:u?F.getSelectColor():z,selectWidth:u,pattern:y("edge.pattern"),cap:y("edge.cap"),join:y("edge.join"),is3d:y("edge.3d"),_67o:y("edge.3d.color"),_66o:y("edge.3d.accuracy"),gray:y("2d.gray")}:z;if(X){var G=m.getEdgeType(k);if(G){var R=G(M,xk(F,t,M,b,k),t,F._19Q);R.points&&R.points.size()>1?(X.edgeTypeInfo=R,Q=sf(X.edgeTypeInfo.points)):R[Uc]&&R.rect&&(X.edgeTypeInfo=R,Q=R.rect)}else{var P=y("edge.source.anchor.x"),v=y("edge.source.anchor.y"),x=y("edge.target.anchor.x"),j=y("edge.target.anchor.y"),a=qf(t,M,"source"),I=qf(t,M,"target");if(k===Bj){var _=X.points=y(vp)||Yg,g=_.size();X.segments=y("edge.segments");var T=P!==B||v!==B||Xr(n),w=x!==B||j!==B||Xr(E);if(!O)if(J)T||(a=je(a,g?_.get(0):I,J,g)),w||(I=je(I,g?_.get(g-1):a,J,g));else{var Z;T||(Z=xg(a,g?_.get(0):I,Tb(t,n)),Z&&(a={x:Z[0],y:Z[1]})),w||(Z=xg(g?_.get(g-1):a,I,Tb(t,E)),Z&&(I={x:Z[0],y:Z[1]}))}Q=io(sf(X.points),sf(a,I))}else{var V=xk(F,t,M,b,k);if(F._19Q||(V=-V),b)a=zs(a),a.x=t.getNodeRect(n).x,X.radius=V,Q={x:a.x-V,y:a.y-V,width:2*V,height:2*V};else{var H=bh(a,I),K=we(J,H),o={x:K,y:V},D={x:H-K,y:V},h=Wc(I.y-a.y,I.x-a.x),A=X.mat=new hg(h);if(X.orienAngle=h,X.angle=I.x<a.x?h+s:h,X.rect={x:o.x,y:o.y,width:D.x-o.x,height:0},X.origin=a,o=A.tf(o),o.x+=a.x,o.y+=a.y,D=A.tf(D),D.x+=a.x,D.y+=a.y,O){var c={x:H,y:0};c=A.tf(c),c.x+=a.x,c.y+=a.y,Q=sf([a,o,D,c]),X.c1=a,X.c2=c}else Q=sf(o,D);a=o,I=D}}X.sourcePoint=a,X.targetPoint=I,M._lastSourcePoint=a,M._lastTargetPoint=I}var i=0;y("edge.dash")&&(i=y("edge.dash.width")||Y);var S="square"===X.cap?.71:.5;yr(Q,$(i*S,Y*S+W+u),X.join),F._68o(Q)}},getRotation:function(Y,K,h){Y=Y||0;var F=this._78o;if(F){var x,n=F.angle,X=F.points,T=F.edgeTypeInfo;if(n!=z)return K?F.orienAngle+Y:n+Y;if(T&&T[Uc])return T.getRotation?T.getRotation(this,Y,K,h):0;if(T&&T.points){var b=T.points;return x=b.size(),Jp[h]?x&&0===x%2?$g(b.get(x/2-1),b.get(x/2),K,Y):Y:dg[h]?$g(b.get(0),b.get(1),K,Y):$g(b.get(x-2),b.get(x-1),K,Y)}if(X)return x=X.size(),Jp[h]?x&&0===x%2?$g(X.get(x/2-1),X.get(x/2),K,Y):0===x?$g(F.sourcePoint,F.targetPoint,K,Y):Y:dg[h]?$g(F.sourcePoint,x?X.get(0):F.targetPoint,K,Y):$g(x?X.get(x-1):F.sourcePoint,F.targetPoint,K,Y)}return Y},getPosition:function(c,o,N,R,P){var E=this._78o;if(E){var w,Q=E.type,q=E.points,e=E.edgeTypeInfo,n=E.sourcePoint,h=E.targetPoint;if(!Q)return E.looped?{x:n.x-E.radius+o,y:n.y+N}:(P&&n&&h&&(n.x>h.x||n.x===h.x&&n.y>h.y)&&(c=nm[c],N=-N),w=Gb(c,E.rect,R),w.x+=o,w.y+=N,w=E.mat.tf(w),w.x+=E.origin.x,w.y+=E.origin.y,w);if(e&&e[Uc])return e.getPosition?e.getPosition(this,c,o,N,R,P):{x:(n.x+h.x)/2,y:(n.y+h.y)/2};if(q){var w,v=q.size();if(Jp[c]){if(v){var k=v%2;if(0===k)return sj(q.get(v/2-1),q.get(v/2),c,o,N,R,P);w=q.get((v-k)/2)}else w={x:(n.x+h.x)/2,y:(n.y+h.y)/2};return w=Gb(c,{x:w.x,y:w.y,width:0,height:0},R),w.x+=o,w.y+=N,w}return dg[c]?sj(n,v?q.get(0):h,c,o,N,R,P):sj(v?q.get(v-1):n,h,c,o,N,R,P)}if(e){var m=e.points,v=m.size();if(Jp[c]){var k=v%2;return 0===k?sj(m.get(v/2-1),m.get(v/2),c,o,N,R,P):(w=m.get((v-k)/2),w=Gb(c,{x:w.x,y:w.y,width:0,height:0},R),w.x+=o,w.y+=N,w)}return dg[c]?sj(m.get(0),m.get(1),c,o,N,R,P):sj(m.get(v-2),m.get(v-1),c,o,N,R,P)}}return ac},_42:function(h){this._78o&&Im.superClass._42.call(this,h)},drawPath:function(x,z){x.beginPath();var r=z.type,E=z.points,i=z.segments,p=z.edgeTypeInfo;if(!r||E){var l=z.sourcePoint,k=l.x,B=l.y,R=z.targetPoint,s=R.x,Z=R.y;if(r)if(i){var T=new An({x:k,y:B});T.addAll(E),T.add({x:s,y:Z}),Ff(x,T,i)}else x.moveTo(k,B),E.each(function(G){x.lineTo(G.x,G.y)}),x.lineTo(s,Z);else z.looped?x.arc(k,B,z.radius,0,Q,!0):z.center?(x.moveTo(z.c1.x,z.c1.y),x.lineTo(k,B),x.lineTo(s,Z),x.lineTo(z.c2.x,z.c2.y)):(x.moveTo(k,B),x.lineTo(s,Z))}else p&&(p.points?Ff(x,p.points,p.segments):p[Uc]&&p[Uc](x,p))},_80o:function(K){var V=this,p=V.s,o=V._78o,L=o.width,I=o.selectWidth,k=o.borderWidth,Z=o.repeatImage,T=K.lineJoin,l=K.lineCap,C=o.gray,d=o.pattern;K.lineJoin=o.join,K.lineCap=o.cap,V.drawPath(Qo(K,d),o);var j=p("edge.width.absolute");j&&(K.save(),K.setTransform(1,0,0,1,0,0)),I&&(K.strokeStyle=o._97o,K.lineWidth=L+2*(k+I),K.stroke()),k&&(K.strokeStyle=C?m.toGrayColor(o.borderColor):o.borderColor,K.lineWidth=L+2*k,K.stroke());var b=C?m.toGrayColor(o.color):o.color;if(Z?us(K,Z,b,null,V._data,V.gv):K.strokeStyle=b,K.lineWidth=L,K.stroke(),o.is3d){var X=C?m.toGrayColor(o._67o):o._67o;lf(K,b,X,L,V.gv._zoom,o._66o)}if(p("edge.dash")){d=p("edge.dash.pattern");var G=Qo(K,d,V._2Q("edge.dash.offset"));G!==K&&V.drawPath(G,o),V._1Q(K,"edge",p("edge.dash.width")||L,d)}j&&K.restore(),oq(K,d),K.lineJoin=T,K.lineCap=l},_48O:function(){},_47O:function(){}});var zf=function(j,H){mg(zf,this,[j,H])};Fm(zf,Fb,{_3O:function(){var Q,n,F=this,_=F.s,d=F._data,j=F.gv;if(F._88I=z,d.isExpanded()&&d.eachChild(function(q){if(Dk(q)){var l=j.getBoundsForGroup(q);l&&(n||(n=[]),n.push(l),Q=io(Q,l))}}),Q){var V=j.getLabel(d),X=_("group.type"),B=_("group.border.width")||0,r=_("group.border.width.absolute"),K=B/2;r&&(B/=j._zoom),Q=Rj(X,n,Q),sr(Q,d,"group.padding",1),gp(Q,B);var M=F._88I={type:X,rect:Q,_64o:Q};if(!X&&V!=z){var H,C=F.labelInfo={label:V,color:_("group.title.color"),font:_("group.title.font"),align:_("group.title.align")},p=kp(C,V),I=p.width+B,J=p.height+B,R=_("group.title.align"),E=_("group.title.orientation");if(E===Ih||E===Vd?(Q.height+=B,I>Q.width&&(Q.width=I)):(E===Mq||E===ze)&&(Q.width+=B,I>Q.height&&(Q.height=I)),H=R===Mq?Q.x:R===ze?Q.x+Q.width-I:Q.x+Q.width/2-I/2,E===Vd)M.titleRect={x:Q.x,y:Q.y+Q.height,width:Q.width,height:J},M.rect={x:Q.x,y:Q.y,width:Q.width,height:Q.height+J},C.rect={x:H,y:Q.y+Q.height,width:I,height:J};else if(E===Mq){var U=M.titleRect={x:Q.x-J,y:Q.y,width:J,height:Q.height};M.rect={x:Q.x-J,y:Q.y,width:Q.width+J,height:Q.height},C.rect={x:U.x+J/2-Q.height/2,y:U.y+Q.height/2-J/2,width:Q.height,height:J},C.rotation=-Math.PI/2}else if(E===ze){var U=M.titleRect={x:Q.x+Q.width,y:Q.y,width:J,height:Q.height};M.rect={x:Q.x,y:Q.y,width:Q.width+J,height:Q.height},C.rect={x:U.x+J/2-Q.height/2,y:U.y+Q.height/2-J/2,width:Q.height,height:J},C.rotation=Math.PI/2}else M.titleRect={x:Q.x,y:Q.y-J,width:Q.width,height:J},M.rect={x:Q.x,y:Q.y-J,width:Q.width,height:Q.height+J},C.rect={x:H,y:Q.y-J-K,width:I,height:J+B}}F._40O(M,_("group.border.width")/2)}else zf.superClass._3O.call(F)},getPosition:function(r,R,Y,n){var Z=this._88I;if(Z){var L=Gb(r,Z.rect,n);return L.x+=R,L.y+=Y,L}return zf.superClass.getPosition.apply(this,arguments)},_24O:function(R,H){var B=this._88I;(!B||B.type||"label2"===R)&&zf.superClass._24O.call(this,R,H)},_80o:function(K){var Y=this,g=Y._88I;if(g){var B=Y._data,X=Y.s,c=Y.gv,U=g.type,k=g.rect,V=g._64o,o=g.titleRect,L=Y.getBodyColor(),i=Om(X("group.image"),L),u=X("group.image.stretch"),h=Y.getBodyColor("group.background"),T=Om(X("group.repeat.image"),L),D=X("group.gradient.pack"),A=X("group.gradient"),q=X("group.gradient.color"),P=X("group.border.width"),t=X("group.border.color"),W=X("group.border.pattern"),E=X("group.title.orientation"),y=X("group.depth"),F=X("group.border.radius"),N=X("group.border.join"),S=X("group.border.cap"),J=X("group.border.width.absolute");J&&(P/=c._zoom);var $=t,H=X("group.border.repeat.image");if(H&&(H=Om(H,t))&&($=gi(K,H,t,null,B,c)),U){var n=K.lineJoin,b=K.lineCap;if(K.lineJoin=N,K.lineCap=S,i){if(K.save(),np(K,U,k,F),K.clip(),Le(K,i,u,k.x,k.y,k.width,k.height,B,c,L),K.restore(),P>0){var C=Qo(K,W);np(C,U,k,F),K.lineWidth=P,K.strokeStyle=$,K.stroke(),oq(K,W)}}else{var C=Qo(K,W);h||T||D?(np(K,U,k,F),D?No(K,D,function(E){return zp(E,L)},!1,k):T?Tj(K,T,L,null,B,c):os(K,h,A,q,k),K.fill(),D&&K.restore(),K!==C&&np(C,U,k,F)):np(C,U,k,F),P>0&&(K.lineWidth=P,K.strokeStyle=$,K.stroke()),oq(K,W),U===Ol&&fn(K,h,y,k)}K.lineJoin=n,K.lineCap=b}else{var e=X("group.title.background");if((!F||0>F)&&(F=0),i)Le(K,i,u,V.x,V.y,V.width,V.height,B,c,Y.getBodyColor());else if(h||T)if(T?Tj(K,T,L,null,B,c):os(K,h,A,q,V),0===P)np(K,Ol,V),K.fill(),fn(K,h,y,V);else{switch(K.beginPath(),E){case Vd:lm(K,V.x,V.y,V.width,V.height,F,F,0,0);break;case Mq:lm(K,V.x,V.y,V.width,V.height,0,F,0,F);break;case ze:lm(K,V.x,V.y,V.width,V.height,F,0,F,0);break;case Ih:lm(K,V.x,V.y,V.width,V.height,0,0,F,F)}K.fill()}if(o&&e)if(0===P)rr(K,o.x,o.y,o.width,o.height,e),fn(K,e,y,o);else{switch(K.beginPath(),K.fillStyle=e,E){case Vd:lm(K,o.x,o.y,o.width,o.height,0,0,F,F);break;case Mq:lm(K,o.x,o.y,o.width,o.height,F,0,F,0);break;case ze:lm(K,o.x,o.y,o.width,o.height,0,F,0,F);break;case Ih:lm(K,o.x,o.y,o.width,o.height,F,F,0,0)}K.fill()}if(P>0){var C=Qo(K,W);if(np(C,"roundRect",k,F),K.save(),K.lineWidth=P,K.strokeStyle=$,K.lineJoin=N,K.lineCap=S,K.closePath(),K.stroke(),o&&X("group.splitLine")){var w=o.x,f=o.y,m=o.width,Z=o.height;K.beginPath(),E===Vd?(K.moveTo(w,f),K.lineTo(w+m,f)):E===Mq?(K.moveTo(w+m,f),K.lineTo(w+m,f+Z)):E===ze?(K.moveTo(w,f),K.lineTo(w,f+Z)):(K.moveTo(w,f+Z),K.lineTo(w+m,f+Z))}K.stroke(),K.restore(),oq(C,W)}}Y._39O(K,g)}else zf.superClass._80o.call(Y,K)}});var Wm=function(l,N){mg(Wm,this,[l,N])};Fm(Wm,Fb,{_80o:function(t){this._39O(t,this._83o)}});var Tg=function(L,K){mg(Tg,this,[L,K])};Fm(Tg,Fb,{_3O:function(){var O=this,Q=O._data,w=O.s,o=O.gv,Y=Q.getPoints(),d=o.getBorderColor(Q),e=d?w("border.width"):0,X=O.getSelectWidth(),M=w("shape.border.width"),G=Q.getRect(),E=Q.getAnchorRect(),j=o.getBodyColor(Q),g=w("shape.border.color"),N=O._99o=Y.isEmpty()?z:{rect:G,rotation:Q.getRotation(),fillRule:w("shape.fill.rule"),scale:Q.getScale(),position:Q.p(),points:Y,segments:Q.getSegments(),bodyColor:j,borderColor:d,borderWidth:e,_94o:w("shape.border.3d"),_95o:w("shape.border.3d.color"),_96o:w("shape.border.3d.accuracy"),_97o:X?O.getSelectColor():z,selectWidth:X,_53o:w("shape.background"),_27Q:Om(w("shape.repeat.image"),j),shapeGradientPack:w("shape.gradient.pack"),shapeBorderGradientPack:w("shape.border.gradient.pack"),_54o:M,_55o:g,shapeBorderRepeatImage:Om(w("shape.border.repeat.image"),g),shapeGradient:w("shape.gradient"),_59o:w("shape.gradient.color"),_60o:w("shape.border.pattern"),_61o:w("shape.border.cap"),_62o:w("shape.border.join"),shapeForeground:w("shape.foreground"),gray:w("2d.gray")};if(N){E.x+=N.position.x,E.y+=N.position.y,N.gradientRect=E;var I=Q.getScale(),p=$(1,$(n(I.x),n(I.y)));w("shape.dash")&&w("shape.dash.width")>M&&(M=w("shape.dash.width"));var v,f=w("shape.border.width.absolute");v=f?(M+e+X)/O.gv._zoom/p:M*("square"===N._61o?.71:.5)+e+X/O.gv._zoom/p,v&&(v*=p,G=zs(G),yr(G,v,N._62o)),O._68o(G);var P=w("clip.percentage");P!=B&&(N.clipRect=Ai(Q.getAnchorRect(),w("clip.direction"),P));var i=w("shape.fill.clip.percentage");i!=B&&(N.shapeClipRect=Ai(Q.getAnchorRect(),w("shape.fill.clip.direction"),i));var T=w("shape.foreground.clip.percentage");T!=B&&(N.shapeForegroundClipRect=Ai(Q.getAnchorRect(),w("shape.foreground.clip.direction"),T))}},getPosition:function(z,r,n,$){var X=this._99o;if(X){var i=Gb(z,X.rect,$);return i.x+=r,i.y+=n,i}return ac},_42:function(G){this._99o&&Tg.superClass._42.call(this,G)},_80o:function(G){var r,A=this,j=A.s,c=A._99o,I=c.position,x=c.scale,C=c.rotation,z=c.borderWidth,s=A.gv._zoom,F=c.selectWidth/s,N=c._27Q,t=c.shapeGradientPack,L=c._54o,P=c.clipRect,J=c.shapeClipRect,y=c.points,f=c.segments,k=A._data.isClosePath(),H=c.fillRule,i=c.gray,e=function(f){return i?m.toGrayColor(f):f},n=e(c._53o),X=n||N||t;G.save(),Jo(G,I.x,I.y),af(G,C),to(G,x.x,x.y),P&&(G.beginPath(),G.rect(P.x,P.y,P.width,P.height),G.clip()),X&&J&&(G.save(),G.beginPath(),G.rect(J.x,J.y,J.width,J.height),G.clip());var O=zs(c.rect);_.Default.extractShapeTranslation?(y=zs(y),y.forEach(function(H){H.x-=I.x,H.y-=I.y}),O.x-=I.x,O.y-=I.y):Jo(G,-I.x,-I.y);var U=j("shape.border.width.absolute"),w=c._60o;U&&w&&(w=w.map(function(e){return e*s}));var q=Qo(G,w),Q=G.lineJoin,l=G.lineCap;G.lineJoin=c._62o,G.lineCap=c._61o;var V=e(c.bodyColor);X?(Ff(G,y,f,k),t?No(G,t,function(U){return zp(U,c.bodyColor)},!1,O):N?Tj(G,N,V,null,A._data,A.gv):(r=V?V:n,os(G,r,c.shapeGradient,e(c._59o),c.gradientRect)),G.fill(H),t&&G.restore(),J&&(G.restore(),Jo(G,-I.x,-I.y)),q!==G&&Ff(q,y,f,k)):Ff(q,y,f,k);var W=c.shapeForeground;if(W){G.save();var d=c.shapeForegroundClipRect;d&&(Jo(G,I.x,I.y),G.beginPath(),G.rect(d.x,d.y,d.width,d.height),G.clip(),Jo(G,-I.x,-I.y)),Ff(G,y,f,k),os(G,W,j("shape.foreground.gradient"),e(j("shape.foreground.gradient.color")),c.gradientRect),G.fill(H),G.restore()}if(U&&(G.save(),G.setTransform(1,0,0,1,0,0)),F&&(G.strokeStyle=c._97o,G.lineWidth=L+2*(z+F),G.stroke()),z&&(G.strokeStyle=e(c.borderColor),G.lineWidth=L+2*z,G.stroke()),L){r=e(c._55o);var R=c.shapeBorderGradientPack;R?No(G,R,e,!0,O):c.shapeBorderRepeatImage?us(G,c.shapeBorderRepeatImage,r,null,A._data,A.gv):(!n&&V&&(r=V),G.strokeStyle=r),G.lineWidth=L,G.stroke(),R&&G.restore(),c._94o&&lf(G,r,e(c._95o),L,s,c._96o)}if(oq(G,w),j("shape.dash")){var h=j("shape.dash.width")||L;if(h>0){w=j("shape.dash.pattern"),U&&(w=w.map(function($){return $*s}));var q=Qo(G,w,A._2Q("shape.dash.offset"));q!==G&&Ff(q,y,f,k),A._1Q(G,"shape",h,w)}}U&&G.restore(),G.lineJoin=Q,G.lineCap=l,G.restore()},_48O:function(){},_47O:function(){}});var uc=function(f,Z){mg(uc,this,[f,Z])};Fm(uc,Tg,{getRotation:function(){var f=new sm,m=new sm,s=new hf;return function(p,r,T){p=p||0;var U=this._data,i=U.getPoints(),G=i.size();if(G>1){var c,H,Q=U.p(),x=U.getScale();if(s.identity().translate(-Q.x,-Q.y).scale(x.x,x.y).translate(Q.x,Q.y),Jp[T]){var t=G%2,n=(G-t)/2;c=i.get(n-1),H=i.get(n)}else dg[T]?(c=i.get(0),H=i.get(1)):(c=i.get(G-2),H=i.get(G-1));return s.apply(c,f),s.apply(H,m),$g(f,m,r,p)}return p}}(),getPosition:function(){var w=new sm,P=new sm,A=new sm;return function(z,e,S,I,m){var K=this._data,Z=K.getPoints(),l=Z.size();if(l>1){var Q,L,T=K.getPointsMatrix2d();if(Jp[z]){var J=l%2,U=(l-J)/2;if(Q=Z.get(U-1),L=Z.get(U),0!==J){var F=Gb(z,ac,I);return F.x+=e,F.y+=S,T.apply(Q,w),T.apply(L,P),T.identity().rotate(A.copy(P).sub(w).angle()).apply(F,w).add(P)}}else dg[z]?(Q=Z.get(0),L=Z.get(1)):(Q=Z.get(l-2),L=Z.get(l-1));return T.apply(Q,w),T.apply(L,P),sj(w,P,z,e,S,I,m)}return ac}}()});var bn=function(G,k){mg(bn,this,[G,k])};Fm(bn,Fb,{_3O:function(){var p=this;bn.superClass._3O.call(p);var A=p.s,t=p._83o;p._82o=t.img||t.shape?z:{background:p.getBodyColor("grid.background"),depth:A("grid.depth"),rect:t.rect,_88o:A("grid.cell.depth"),cellBorderColor:A("grid.cell.border.color"),_89o:A("grid.row.count"),_90o:A("grid.column.count"),block:A("grid.block"),_91o:A("grid.block.color"),_92o:A("grid.block.padding"),_93o:A("grid.block.width")}},_80o:function(F){var Z=this,w=Z._82o;if(!w)return bn.superClass._80o.call(Z,F),void 0;var v,m,W=Z._data,C=w.background,A=w.rect,J=w.block,L=w._91o,D=w._92o,T=w._93o,P=w._88o,n=w.cellBorderColor,x=w._89o,p=w._90o;if(C)if(rr(F,A.x,A.y,A.width,A.height,C),fn(F,C,w.depth,A),P)for(v=0;x>v;v++)for(m=0;p>m;m++)A=W.getCellRect(v,m),A&&fn(F,C,P,A);else if(n){for(F.beginPath(),v=0;x>v;v++)for(m=0;p>m;m++)A=W.getCellRect(v,m),A&&F.rect(A.x,A.y,A.width,A.height);F.strokeStyle=n,F.lineWidth=1,F.stroke()}if("h"===J)for(v=0;x>v;v++)A=io(W.getCellRect(v,0),W.getCellRect(v,p-1)),gp(A,D),rl(F,L,A.x,A.y,A.width,A.height,T);else if("v"===J)for(m=0;p>m;m++)A=io(W.getCellRect(0,m),W.getCellRect(x-1,m)),gp(A,D),rl(F,L,A.x,A.y,A.width,A.height,T);Z._39O(F,Z._83o)}});var jk=function(I,y){mg(jk,this,[I,y])},Ob=T?km().getContext("2d"):z;Fm(jk,Fb,{_checkEmptyRect:!1,_81o:function(){var D=this._data,i=jk.superClass._81o.call(this),n=D.s("text");if(n!=z){n+="";var A,e=D.s("text.font"),N=D.s("text.align"),S=D.s("text.vAlign"),W=D.s("text.wrap"),s=D.s("text.vertical"),y=D.s("text.vertical.gap"),l=D.s("text.letter.gap")||0,r=D.getWidth(),o=D.getHeight();if(null==y&&(y=1),s){var T;T=W?Jh(n,o,e,l,s,y):[n];var v=(T.length-1)*l,X=0;Ob.textBaseline=Ih,Ob.font=e,T.forEach(function(o){for(var O=o.length,r=0,B=(O-1)*y,E=0;O>E;E++){var i=Ob.measureText(o[E]);B+=i.fontBoundingBoxDescent||nd(e,o[E]).height,r=$(r,i.width)}v+=r,X=$(B,X)});var R=(T.length-1)*l;T.forEach(function(L){R+=L}),A={width:v,height:X}}else{var T=W?Jh(n,r,e,l,s,y):n.split("\n"),g=T.length;if(g>1){var E=nd(e,n).height,v=0,X=E*g+y*(g-1);T.forEach(function(A){v=$(v,nd(e,A).width)}),A={width:v,height:X}}else A=nd(e,n),l&&(A.width+=(n.length-1)*l)}var h,d,m=A.width,x=A.height,B=D.getAnchor();"left"===N?h=-r*B.x:"center"===N?h=-r*B.x+(r-m)/2:"right"===N&&(h=r*(1-B.x)-A.width),"top"===S?d=-o*B.y:"middle"===S?d=-o*B.y+(o-x)/2:"bottom"===S&&(d=o*(1-B.y)-A.height);var M,a=D.getMatrix();if(M=sf([a.tf(h,d),a.tf(h+m,d),a.tf(h+m,d+x),a.tf(h,d+x)]),i=io(i,M),i&&D.s("text.shadow")){var Q=zs(i);Q.x+=D.s("text.shadow.offset.x"),Q.y+=D.s("text.shadow.offset.y"),gp(Q,D.s("text.shadow.blur")),i=io(i,Q)}}return i}});var ib=xo.Interactor=function(c){this.gv=this._graphView=c};Ee("Interactor",S,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(I){this.gv.fi(I)},setCursor:function(n){Xl||this.gv.setCursor(n)},startDragging:function(r){var Z=this;Z._lastClientPoint=el(r),Z._lastLogicalPoint=Z.gv.lp(r),Gk(Z,r)},clearDragging:function(){var Y=this;Y._lastClientPoint=Y._lastLogicalPoint=Y._logicalPoint=z},autoScroll:function(_){return this.gv.autoScroll(_,this._lastClientPoint)}});var pm=z,Bq=function(r){pm.handleWindowTouchMove(r)},kd=function(r){pm.handleWindowTouchEnd(r),v(d,Ld,Bq),v(d,Dd,kd),pm=z},mq=function(r){pm.handleWindowMouseMove(r)},ir=function(U){pm.handleWindowMouseUp(U),v(d,ph,mq),v(d,Hj,ir),pm=z},oi=function(j,f){if(j!==pm){var I=wg(f);pm?I?pm.handleWindowTouchEnd(f):pm.handleWindowMouseUp(f):I?(C(d,Ld,Bq),C(d,Dd,kd)):(C(d,ph,mq),C(d,Hj,ir)),pm=j}},bm=function(Y){var P=this;P.gv=Y,P._is2d=Y instanceof xo.GraphView,P._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Rh,"wheel"].forEach(function(v){P.addListener(v)}),P.initImageResource()};Fm(bm,ib,{enableVR:function(X){var A=this;!!A._vrEnable!==X&&(A._vrEnable=X,X?A.gv.vr.mp(A.onVRControllerChange,A):A.gv.vr.ump(A.onVRControllerChange,A))},onVRControllerChange:function(j){var E=this,K=j.property,y=j.newValue,L=y.id,T=E.gv.vr.getController(L),e=T.getRay();if(e){e.controllerId=L;var p=E.gv.vr.getRayEventType(e,K,y._62O);switch(p){case"down":E.handle_mousedown(e);break;case"up":pm&&ir(e);break;case"move":E.handle_mousemove(e),pm&&E.handleWindowMouseMove(e)}}},setPreventEventDefault:function(n,s){var A=this,S=A._eventListeners[n];S?S._prevent=s:A._eventListeners[n]=S={_removal:B,_prevent:s}},removeListener:function(p){var g=this,O=g._eventListeners[p];O&&O._removal&&(O._removal(),O._removal=B)},addListener:function(b){var X=this,L=X._eventListeners[b];if(L||(X._eventListeners[b]=L={_removal:B,_prevent:!0}),!L||!L._removal){var $=function(g){L._prevent&&m.preventDefault(g),X.disabled||X.gv._48Q||("wheel"===b?Nn(X,g):X["handle_"+b](g))};C(X.gv.getView(),b,$),L._removal=function(){v(X.gv.getView(),b,$)}}},handleWindowTouchMove:function(l){this.handleWindowMouseMove(l)},handleWindowMouseMove:function(l){return!this.downInfo||wg(l)&&1!==js(l)?(this.isDragging&&(this.handleDownInfo("onEndDrag",l),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",l):(this.handleDownInfo("onBeginDrag",l),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(d){this.handleWindowMouseUp(d)},handleWindowMouseUp:function(a){if(this.isDragging&&(this.handleDownInfo("onEndDrag",a),this.isDragging=!1),this.downInfo){var j=this.handle("onUp",a);if(j&&j.data===this.downInfo.data){this.handleMissingUp(a);var N=this,e=2===a.button?"onContextMenu":"onClick",X=j.data;if(X.s("disableDoubleClick")||!N._dbclickTimer)return N._dbclickTimer=Vr(function(){delete N._dbclickTimer,N.handleClick(a,e,j),this.downInfo=z},m.clickDelay),void 0;Eh(N._dbclickTimer),delete N._dbclickTimer,e="onDoubleClick",N.handleClick(a,e,j)}else this.handleDownInfo("onUp",a);this.downInfo=z,this.downComps=z}},handle_mouseleave:function(o){var w=this,I=w.gv;w._hoverTimer&&(Eh(w._hoverTimer),delete w._hoverTimer);var V=w.currentInfo?w.currentInfo.data:z;if(V){V.s("onLeave")&&V.s("onLeave")(o,V,I),w.fire("data","onLeave",o,V);var Z=w.currentInfo?w.currentInfo.hits:z;if(Z)for(var i in Z)w.handleLeave(o,i);w.currentInfo=z}},handle_mousewheel:function(B){B.scrollDelta=B.wheelDelta/40,this.handle("onScroll",B)},handle_DOMMouseScroll:function(u){u.scrollDelta=2===u.axis?-u.detail:0,this.handle("onScroll",u)},handle_touchstart:function(F){this.handle_mousedown(F)},handle_touchmove:function(Q){this.handle("onMove",Q)},handle_mousedown:function($){this.isDragging&&(this.handleDownInfo("onEndDrag",$),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",$),this.downInfo&&oi(this,$)},handle_mousemove:function(B){var a=this,L=a.gv;if(a._hoverTimer&&(Eh(a._hoverTimer),delete a._hoverTimer),!L._panning&&!L._moving){var e,H,p,D=a.handle("onMove",B),l=this.currentInfo?this.currentInfo.data:z,u=this.currentInfo?this.currentInfo.hits:z;if(D&&(H=D.data,p=D.hits,a._hoverTimer=Vr(function(){Eh(a._hoverTimer),delete a._hoverTimer,a.handle("onHover",B,D)},L.getHoverDelay()||m.hoverDelay)),H!==l){if(l&&(l.s("onLeave")&&l.s("onLeave")(B,l,L),this.fire("data","onLeave",B,l)),H&&(H.s("onEnter")&&H.s("onEnter")(B,H,L),this.fire("data","onEnter",B,H)),u)for(e in u)this.handleLeave(B,e);if(p)for(e in p){var n=p[e],O=H._interactPrefix=n.prefix,r=O&&H.a(O+"onEnter")||n.target.onEnter;r&&r.call(n.target,B,H,L,n.point,n.width,n.height),this.fire(n.type,"onEnter",n.event,n.data,n.image,n.comp,n.point,n),H._interactPrefix=null}}else{if(u)for(e in u)p&&p[e]||this.handleLeave(B,e);if(p)for(e in p)if(!u||!u[e]){var n=p[e],O=H._interactPrefix=n.prefix,r=O&&H.a(O+"onEnter")||n.target.onEnter;r&&r.call(n.target,B,H,L,n.point,n.width,n.height),this.fire(n.type,"onEnter",n.event,n.data,n.image,n.comp,n.point,n),H._interactPrefix=null}}this.currentInfo=D}},handle:function(v,Q,c){var k,n=this,G=n.gv;if(n._is2d){if(c=c||G.getDataInfoAt(Q),!c||!G.isInteractive(c.data))return;if(k=c.ui.interactiveInfo){var R,V=c.data;if(V.s(v)&&V.s(v)(Q,V,G),this.fire("data",v,Q,V),"body"===c.part&&k.bodyInfo)R="body",c.hits=this.handleImage(R,G.getImage(V),v,Q,V,c.point,k.bodyInfo);else if("icons"===c.part&&k._38o){var u=k._38o[c.name];u&&u[c.index]&&(R="icons|"+c.name+"|"+c.index,c.hits=this.handleImage(R,c.icon,v,Q,V,c.point,u[c.index]))}}return c}var V,Y;if(!c)if(Q&&Q instanceof _.Math.Ray&&G.isVREnabled()){var X=G.vr.intersectWorld(Q);if(V=X.data,Y=X.intersect,G.vr.renderRayDuringInteraction(Q,V,Y),!V)return;var r=G.getData3dUI(V);if(k=r.interactiveInfo,!k)return;c={data:V,part:Y.part,ui:r}}else{if(c=this.getDataInfoAt(Q),!c)return;c&&(c={data:c.data,part:c.part})}if(G.isInteractive(c.data)){if(!Y){V=c.data;var r=G.getData3dUI(V);if(c.ui=r,k=r.interactiveInfo,!k)return c;if(Y=G.intersectObject(Q,V),!Y)return c}V.s(v)&&V.s(v)(Q,V,G),this.fire("data",v,Q,V);var l,A=Y.part;return"body"!==A&&(l=V.s(A+".image")||V.s("shape3d."+A+".image")),l||(l=V.s("all.image")||V.s("shape3d.image")),l?(k="object"==typeof l?k[l.uuid]:k[l],k&&k.bodyInfo?(c.part="body",c.interactiveInfo=k,c.point=this._convertUVToPoint(Y.uv,k),c.image=l,c.hits=this.handleImage("body",l,v,Q,V,c.point,k.bodyInfo),c):c):c}},_handleLeaveOrMissing:function(o,w,f){var s="leave"===o?this.currentInfo:this.downInfo;if(s){var g=s.interactiveInfo||s.ui.interactiveInfo;if(g){var A,C,b=s.data;if(this._is2d){if(C=this.gv.lp(w),"body"===s.part&&g.bodyInfo)A="body","leave"===o?this.handleLeaveImage(f,A,this.gv.getImage(b),w,b,C,g.bodyInfo):this.handleMissingUpImage(A,this.gv.getImage(b),w,b,C,g.bodyInfo);else if("icons"===s.part&&g._38o){var W=g._38o[s.name];W&&W[s.index]&&(A="icons|"+s.name+"|"+s.index,"leave"===o?this.handleLeaveImage(f,A,s.icon,w,b,C,W[s.index]):this.handleMissingUpImage(A,s.icon,w,b,C,W[s.index]))}}else{if(!g.bodyInfo)return;var a=this.gv.intersectObject(w,b);C=a&&a.uv?this._convertUVToPoint(a.uv,g):{x:1/0,y:1/0},"leave"===o?this.handleLeaveImage(f,"body",s.image,w,b,C,g.bodyInfo):this.handleMissingUpImage("body",s.image,w,b,C,g.bodyInfo)}}}},handleClick:function(C,D,X){var d=this,A=this.downInfo;if(A&&X){var K,u=X.interactiveInfo||X.ui.interactiveInfo,N=X.data,w=this.gv;if(N.s(D)&&N.s(D)(C,N,w),d.fire("data",D,C,N),u)if(this._is2d){if(A.part===X.part){var B=w.lp(C);"body"===X.part&&u.bodyInfo&&(K="body",this.handleClickImage(K,w.getImage(N),D,C,N,B,u.bodyInfo,X))}}else{if(!u.bodyInfo)return;var T=w.intersectObject(C,N);if(!T)return;B=this._convertUVToPoint(T.uv,u),this.handleClickImage("body",A.image,D,C,N,B,u.bodyInfo,X)}}},handleDownInfo:function(g,u){if(this.downInfo){var J=this.downInfo,F=this.gv,$=J.interactiveInfo||J.ui.interactiveInfo;if($){var t,y=J.data;if(y.s(g)&&y.s(g)(u,y,F),this.fire("data",g,u,y),this._is2d){var j=F.lp(u);if("body"===J.part&&$.bodyInfo)t="body",this.handleDownInfoImage(t,F.getImage(y),g,u,y,j,$.bodyInfo);else if("icons"===J.part&&$._38o){var s=$._38o[J.name];s&&s[J.index]&&(t="icons|"+J.name+"|"+J.index,this.handleDownInfoImage(t,J.icon,g,u,y,j,s[J.index]))}}else{if(!$.bodyInfo)return;var q;if("onBeginDrag"===g?(q=F._raycaster.intersectObjectAndRecordTriangle(u,y),q&&($.beginDragIntersectInfo=q.triangleInfo)):q=F.intersectObject(u,y),!q&&("onDrag"!==g&&"onEndDrag"!==g||!$.beginDragIntersectInfo||(q=F._raycaster.intersectLastTriangle(u,$.beginDragIntersectInfo)),!q))return;j=this._convertUVToPoint(q.uv,$),this.handleDownInfoImage("body",J.image,g,u,y,j,$.bodyInfo)}}}},fire:function(g,k,m,M,w,$,R,y){this.gv.fi({kind:k,type:g,event:m,data:M,image:w,comp:$,view:this.gv,point:R,width:y?y.width:B,height:y?y.height:B})},handleImage:function(D,x,K,c,N,S,s){var E={};if(x&&(x=Om(x))){var f=this.gv,u=s.rect,V=this.convertPoint(S,s);V.inRect&&(x[K]&&x[K](c,N,f,V,u.width,u.height),this.fire("image",K,c,N,x,B,V,u),E[D+"|image"]={target:x,type:"image",image:x,data:N,event:c,point:V,width:u.width,height:u.height});
for(var G,o=s.compInfos,R=x,r=o.length-1;r>=0;r--){var h=o[r],A=h.comp;if(V=this.convertPoint(S,h,R,A,f,N),V.inRect){u=h.rect;var C=N._interactPrefix=h.prefix,w=C&&N.a(C+K)||A[K];if(w&&(G=w.call(A,c,N,f,V,u.width,u.height)),this.fire("comp",K,c,N,x,A,V,u),G!==!0&&(x=u.image)&&(x[K]&&(G=x[K](c,N,f,V,u.width,u.height)),this.fire("image",K,c,N,x,B,V,u)),N._interactPrefix=null,E[D+"|"+r]={target:A,type:"comp",comp:A,image:x,data:N,event:c,point:V,width:u.width,height:u.height,prefix:C},this.downComps&&this.downComps.push(A),x&&(E[D+"|"+r+"|image"]={target:x,type:"image",image:x,data:N,event:c,point:V,width:u.width,height:u.height,prefix:C}),G===!0)break}}}return E},handleLeave:function(P,K){return this._handleLeaveOrMissing("leave",P,K)},handleMissingUp:function(Y){return this._handleLeaveOrMissing("missing",Y)},handleLeaveImage:function(b,U,c,D,V,Y,g){if(c&&(c=Om(c))){var j=this.gv,y=g.rect,R=this.convertPoint(Y,g);b===U+"|image"&&(c.onLeave&&c.onLeave(D,V,j,R,y.width,y.height),this.fire("image","onLeave",D,V,c,B,R,y));for(var F,f=g.compInfos,$=c,h=f.length-1;h>=0;h--){var T=f[h],Q=T.comp;R=this.convertPoint(Y,T,$,Q,j,V),y=T.rect;var n=V._interactPrefix=T.prefix;if(b===U+"|"+h){var r=n&&V.a(n+"onLeave")||Q.onLeave;r&&(F=r.call(Q,D,V,j,R,y.width,y.height)),this.fire("comp","onLeave",D,V,c,Q,R,y)}if(F!==!0&&(c=y.image)&&b===U+"|"+h+"|image"&&(c.onLeave&&(F=c.onLeave(D,V,j,R,y.width,y.height)),this.fire("image","onLeave",D,V,c,B,R,y)),V._interactPrefix=null,F===!0)break}}},handleMissingUpImage:function(i,U,u,L,w,R){var y="onUp",o=this.downInfo.hits;if(o&&U&&(U=Om(U))){var T=this.gv,z=R.rect,k=this.convertPoint(w,R);!k.inRect&&o[i+"|image"]&&(U[y]&&U[y](u,L,T,k,z.width,z.height),this.fire("image",y,u,L,U,B,k,z));for(var Z,Y=R.compInfos,E=U,p=Y.length-1;p>=0;p--){var S=Y[p],l=S.comp;if(k=this.convertPoint(w,S,E,l,T,L),!k.inRect){z=S.rect;var O=L._interactPrefix=S.prefix;if(o[i+"|"+p]){var j=O&&L.a(O+y)||l[y];j&&(Z=j.call(l,u,L,T,k,z.width,z.height)),this.fire("comp",y,u,L,U,l,k,z)}if(Z!==!0&&(U=z.image)&&o[i+"|"+p+"|image"]&&(U[y]&&(Z=U[y](u,L,T,k,z.width,z.height)),this.fire("image",y,u,L,U,B,k,z)),L._interactPrefix=null,Z===!0)break}}}},handleDownInfoImage:function(M,d,R,I,E,e,H){var p=this.downInfo.hits;if(p&&d&&(d=Om(d))){var $=this.gv,K=H.rect,Y=this.convertPoint(e,H);p[M+"|image"]&&(d[R]&&d[R](I,E,$,Y,K.width,K.height),this.fire("image",R,I,E,d,B,Y,K));for(var l,f=H.compInfos,Z=d,F=f.length-1;F>=0;F--){var N=f[F],a=N.comp;Y=this.convertPoint(e,N,Z,a,$,E),K=N.rect;var J=E._interactPrefix=N.prefix,n=["onDrag","onEndDrag"].indexOf(R)>=0;if(!n&&p[M+"|"+F]||n&&this.downComps&&this.downComps.indexOf(a)>=0){var c=J&&E.a(J+R)||a[R];c&&(l=c.call(a,I,E,$,Y,K.width,K.height)),this.fire("comp",R,I,E,d,a,Y,K)}if(l!==!0&&(d=K.image)&&p[M+"|"+F+"|image"]&&(d[R]&&(l=d[R](I,E,$,Y,K.width,K.height)),this.fire("image",R,I,E,d,B,Y,K)),E._interactPrefix=null,l===!0)break}}},handleClickImage:function(y,q,R,t,x,m,F,Q){var u=this.downInfo.hits,D=Q.hits;if(u&&q&&(q=Om(q))){var T=this.gv,e=F.rect,V=this.convertPoint(m,F);u[y+"|image"]&&(q[R]&&q[R](t,x,T,V,e.width,e.height),this.fire("image",R,t,x,q,B,V,e));for(var H,c=F.compInfos,E=q,k=c.length-1;k>=0;k--){var l=c[k],W=l.comp;V=this.convertPoint(m,l,E,W,T,x),e=l.rect;var d=x._interactPrefix=l.prefix;if(u[y+"|"+k]&&D[y+"|"+k]){var U=d&&x.a(d+R)||W[R];U&&(H=U.call(W,t,x,T,V,e.width,e.height)),this.fire("comp",R,t,x,q,W,V,e)}if(H!==!0&&(q=e.image)&&u[y+"|"+k+"|image"]&&(q[R]&&(H=q[R](t,x,T,V,e.width,e.height)),this.fire("image",R,t,x,q,B,V,e)),x._interactPrefix=null,H===!0)break}}},initImageResource:function(){m.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(e,x){if(!e)return{x:1/0,y:1/0};var S=x.bodyInfo.rect,A=e.clone(),K=e.multiply({x:S.width,y:S.height});return K.local=A,K},convertPoint:function(k,T,W,O,x,o){var y=T.rect,g=T.matrix.applyInverse(k).sub(y),c=g.x>=0&&g.y>=0&&g.x<=y.width&&g.y<=y.height;if(!c)return g;if(O&&Gq(O.pixelPerfect,o,x)){var y,i=1;this._is2d?(i=x.getZoom(),y=Sq(k.x,k.y,B,i)):y=Sq(k.x,k.y);var w=!1,C=y.x,d=y.y,e=y.width,U=y.height,Z=m.hitMaxArea,f=e*U*i*i;if(f>Z){var D=Math.sqrt(Z/f);i*=D}e*=i,U*=i,2>e&&(e=2),2>U&&(U=2),C*=i,d*=i;var R=ee(e,U),t=new hf(0,-C,-d,i,i);t.append(T.matrix),x._drawForChecking=!0,O.transform=t;var S=W.fitSize;T.refRect&&T.refRect.fitSize?(O.refRect=T.refRect,W.fitSize=!0):W.fitSize=!1;var N=W.comps;W.comps=[O],sl(R,W,0,0,e,U,o,self),W.comps=N,W.fitSize=S,delete O.refRect,delete O.unionRect,delete O.transform,x._drawForChecking=!1;try{for(var p=0,j=R.getImageData(0,0,e,U).data;p<j.length;p+=4)if(0!==j[p+3]){w=!0;break}R.restore()}catch(a){Pj=z,w=!1}g.inRect=w}else g.inRect=!0;return g},getDataInfoAt:function(u,j){return Ps.prototype.getDataInfoAt.call(this,u,j)}});var cc=xo.DefaultInteractor=function(L){mg(cc,this,[L])};Ee("DefaultInteractor",ib,{handle_mousedown:function(f){pd(f);var x=this,H=x.gv,L=H.getDataAt(f);if(H.setFocus(f)&&!H._editing&&!H._scrolling){ds(f)?H.handleDoubleClick(f,L):H.handleClick(f,L);var n=Mi(f);!sc()&&!n&&L&&(H.isMovable(L)||H._39Q(L))||!H.isPannable()||!ti(f)&&!n||Wo(f)||(x._tx=H.tx(),x._ty=H.ty(),x.startDragging(f))}},handleWindowMouseUp:function(Z){var A=this,B=A.gv;B._panning&&(delete B._panning,B.onPanEnded(),A.fi({kind:"endPan",event:Z})),delete A._tx,delete A._ty,A.clearDragging()},handle_mousemove:function(w){var F=this,r=F.gv;F._hoverTimer&&(Eh(F._hoverTimer),delete F._hoverTimer),F._hoverTimer=Vr(function(){F.fi({kind:"hover",event:w}),Eh(F._hoverTimer),delete F._hoverTimer},r.getHoverDelay()||m.hoverDelay)},handle_mouseleave:function(){var R=this;R._hoverTimer&&(Eh(R._hoverTimer),delete R._hoverTimer)},handleWindowMouseMove:function(N){var V=this,g=V.gv;V.fi({kind:g._panning?"betweenPan":"beginPan",event:N}),g._panning=1;var k=Oo(g,N,V._lastClientPoint);g.setTranslate(V._tx+k.x,V._ty+k.y)},handle_mousewheel:function(c){this.gv.handleScroll(c,c.wheelDelta)},handle_DOMMouseScroll:function(L){2===L.axis&&this.gv.handleScroll(L,-L.detail)},handle_keydown:function(u){this.gv.handleKeyDown(u)}});var Qe=xo.SelectInteractor=function(h){mg(Qe,this,[h])};Ee("SelectInteractor",ib,{_42:function(){var b=this,$=b.gv,l=$.getZoom(),I=b.mark,C=b.div;C||(C=b.div=fo(),as(b.getView(),C));var n={};n.x=I.x*l+$.tx(),n.y=I.y*l+$.ty(),n.width=I.width*l,n.height=I.height*l,fs(C,n),this.intersects()?(C.style.border="",C.style.background=$.getRectSelectBackground()):(C.style.background="",C.style.border="1px solid "+$.getRectSelectBorderColor())},handle_mousedown:function(Z){var Q=this,u=Q.gv;if(Q._57I=z,Q.pendingClickThrough=z,!(u._editing||u._scrolling||sc()||Mi(Z))){var X=u.getDataAt(Z),S=u.sm();X?Wo(Z)?S.co(X)?S.rs(X):S.as(X):S.co(X)?X instanceof Sm&&X.isClickThroughEnabled()&&ti(Z)&&(Q.pendingClickThrough=el(Z)):S.ss(X):Wo(Z)||!u.isPannable()?ti(Z)&&(Wo(Z)||S.cs(),u.isRectSelectable()&&(Q.startDragging(Z),u._77O=1)):ti(Z)&&(Q._57I=el(Z))}},handle_mouseup:function(n){var Q=this,j=Q.gv,O=Q._57I;if(O&&(bh(O,el(n))<=1&&j.sm().cs(),Q._57I=z),Q.pendingClickThrough){if(bh(Q.pendingClickThrough,el(n))<=1){var X=j.getDataAt(n);if(X instanceof Sm&&X.isClickThroughEnabled()){var F=j.getDataAt(n,function(q){var W=q.getParent()===X&&j.isSelectable(q,!0);return W});F&&(n.clickThrough=!0,j.sm().ss(F))}}Q.pendingClickThrough=z}},handleWindowMouseUp:function(L){this.clear(L)},handleWindowMouseMove:function(v){var R=this,g=R.gv;R._logicalPoint=g.lp(v),R.mark?(R.fi({kind:"betweenRectSelect",event:v}),g.isPannable()&&R.autoScroll(v),R.redraw()):R.fi({kind:"beginRectSelect",event:v}),R.mark=sf(R._lastLogicalPoint,R._logicalPoint),R.redraw()},intersects:function(){var d=this,Z=d._lastLogicalPoint,H=d._logicalPoint;return Z.x>H.x||Z.y>H.y},clear:function(T){var b=this,$=b.gv,k=b.mark;if(b._57I=z,b.pendingClickThrough=z,b._lastLogicalPoint){if(k){if(0!==k.width&&0!==k.height){var l=$.getDatasInRect(k,b.intersects());if(!l.isEmpty()){var d=$.sm(),t=d.toSelection(),y=Vn(T),N=T.altKey;l.each(function(r){d.co(r)?(!y||y&&N)&&t.remove(r):(!N||y&&N)&&t.add(r)}),d.ss(t)}}zr(b.div),delete b.div,delete b.mark,b.redraw(),b.fi({kind:"endRectSelect",event:T}),$.onRectSelectEnded()}b.clearDragging(),delete $._77O}},redraw:function(){var c=this;c._draw||(c._draw=1,Vr(function(){c.mark&&c._42(),delete c._draw},16))}});var zo=xo.MoveInteractor=function(F){mg(zo,this,[F])};Ee("MoveInteractor",ib,{handle_mousedown:function(Q){var L=this,M=L.gv;if(ti(Q)&&!M._editing&&!M._scrolling&&!sc()){var T=M.getSelectedDataAt(Q);!T||M._39Q(T)&&!M.isMovable(T)?M._focusData=z:(L._data=T,M.handleMouseDown&&M.handleMouseDown(Q,T),L.startDragging(Q),M.isMovable(T)&&(M._moving=1))}},handleWindowMouseUp:function(v){var m=this,$=m.gv;$.handleMouseUp&&$.handleMouseUp(v,m._data),m.clear(v)},handleWindowMouseMove:function(H){var Z=this,r=Z._data,B=Z.gv;if((!B._93O||!B._93O(H,r))&&B._moving){Z._logicalPoint||Z.fi({kind:"prepareMove",event:H});var D=Z._logicalPoint?"betweenMove":"beginMove",b={kind:D,event:H},s=Z._logicalPoint=B.lp(H);"beginMove"!==D||Z._alreadyBeginTransaction||(Z._alreadyBeginTransaction=!0,B.getDataModel().beginTransaction());var Y=Z._calcShift(D,H),V=Y.x,K=Y.y,l=Z.gv.getMoveMode(H,r);l&&("x"===l?K=0:"y"===l?V=0:"xy"!==l&&(V=K=0)),B.moveSelection(V,K),Z._lastLogicalPoint=s,Z.autoScroll(H),Z.fi(b)}},_calcShift:function(){var n=this,J=n._logicalPoint,G=n._lastLogicalPoint,O=J.x-G.x,i=J.y-G.y;return{x:O,y:i}},clear:function(s){var H=this,b=H.gv;H._lastLogicalPoint&&(H._lastLogicalPoint=H._data=b._moving=z,H._logicalPoint&&(H.fi({kind:"endMove",event:s}),b.onMoveEnded()),H.clearDragging()),H._alreadyBeginTransaction&&(H._alreadyBeginTransaction=!1,b.getDataModel().endTransaction())}});var Pk=xo.TextEditInteractor=function(p){mg(Pk,this,[p]),this.init()};Ee("TextEditInteractor",ib,{setUp:function(){var u=this;Pk.superClass.setUp.call(u),u.gv.mp(u.handleGvPropertyChange,u)},teatDown:function(){var v=this;Pk.superClass.teatDown.call(v),v.gv.ump(v.handleGvPropertyChange,v)},handleGvPropertyChange:function(){this._editTarget&&this.endTextEdit()},init:function(){var X=this,K=this.input=T.createElement("input"),H=K.style;K.text="text",H.border="1px solid #d8d8d8",H.position="absolute",H.padding="2px 3px",H.outline="none",H.marginLeft="-90px",H.marginTop="-16px",H.backgroundColor="rgba(255,255,255, 1)",H.fontSize="14px",H.width="180px",H.height="32px",H.boxShadow="0 0 13px rgba(16,142,233, 0.5)",H.textAlign="center",H.boxSizing="border-box",C(K,"keyup",function(J){return Ud(J)&&X.endTextEdit(),Vq(J)?(X.endTextEdit(!0),void 0):void 0}),C(K,"focus",function(){K.select()});var o=this.textarea=T.createElement("textarea"),M=this.wrap=T.createElement("div");M.appendChild(o),H=o.style,H.margin=0,H.padding="4px",H.overflow="hidden",H.boxSizing="border-box",H.position="absolute",H.outline="none",H.backgroundColor="transparent",H.resize="none",H.textAlign="center",H.fontSize="14px",H.borderWidth=0,H.width="100%",H=M.style,H.boxSizing="border-box",H.margin=0,H.padding=0,H.position="absolute",H.boxShadow="0 0 13px rgba(16,142,233, 0.5)",H.border="1px solid #d8d8d8",H.backgroundColor="rgba(255,255,255, 1)",H.zIndex="10",C(o,"keydown",function(T){return(Vn()||Wo())&&Ud(T)?(X.endTextEdit(),void 0):Vq(T)?(X.endTextEdit(!0),void 0):(X._editTarget instanceof nf||X.calculateTextareaHeight(String.fromCharCode(T.keyCode)),void 0)}),C(o,"focus",function(){o.select()});var L=function(a){a.stopPropagation()};C(K,"mousedown",L),C(K,"touchstart",L),C(o,"mousedown",L),C(o,"touchstart",L),C(o,"click",L),X.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],X.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",X.handleWindowClick=function(o){var N=X._editingDOM;if(N){var x=N.getBoundingClientRect(),k=el(o);tq(x,k)||X.endTextEdit()}}},handle_mousedown:function(f){var m=this,t=m.gv;if(ds(f)&&!t._editing){var $=t.getDataAt(f);if($){var K=t.getTextEditInfo($);K&&(this._editInfo=K,this._editTarget=$,t._editing=!0,K.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var x=this,p=x.gv,w=x._editTarget,q=x.getTargetValue(),l=x.textarea,g=x.wrap,F=this._editInfo;this.hiddenTextarea||this.createHiddenTextarea(),(null===q||q===B)&&(q=""),l.value=q,F.font&&(l.style.font=F.font),x._editingDOM=l,p.appendHTML(g),this.layoutHTML(g,w),w instanceof nf?l.style.height="100%":(l.style.height="auto",this.calculateTextareaHeight()),Vr(function(){l.focus(),C(d,"mousedown",x.handleWindowClick),C(d,"touchstart",x.handleWindowClick)},10)},handleTextEdit:function(){var p=this,W=p.gv,r=p._editTarget,k=p.getTargetValue(),V=p.input;(null===k||k===B)&&(k=""),V.value=k,p._editingDOM=V,W.getView().appendChild(V),this.layoutHTML(V,r),Vr(function(){V.focus(),C(d,"mousedown",p.handleWindowClick),C(d,"touchstart",p.handleWindowClick)},10)},layoutHTML:function(j,o){var l=this.gv,T=l.getZoom();if(o instanceof nf){var x=l.getDataUI(o),d=x._6I,e=o.getScale(),q=j.style;j.style.left=d.x*T+l.tx()+"px",j.style.top=d.y*T+l.ty()+"px",j.style.width=x._6I.width+"px",j.style.height=x._6I.height+"px",Ir(q,"transform","scale("+T*e.x+","+T*e.y+")"),Ir(q,"transformOrigin","0px 0px")}else if(o instanceof Oe){var d=o.getRect(),r=d.width*T;j.style.left=(d.x+d.width/2)*T+l.tx()+"px",j.style.top=(d.y+d.height/2)*T+l.ty()+"px",j.style.width=r+"px",j.style.marginLeft=-r/2+"px"}else if(o instanceof _.Edge){var x=l.getDataUI(o),d=x._6I;j.style.left=(d.x+d.width/2)*T+l.tx()+"px",j.style.top=(d.y+d.height/2)*T+l.ty()+"px"}},endTextEdit:function(J){var p=this,u=p._editInfo.isMultiline?p.wrap:p.input,_=p._editInfo.isMultiline?p.textarea:p.input;J||p.setTargetValue(_.value),p.gv.getView().removeChild(u),p.gv._editing=!1,delete p._editingDOM,delete p._editTarget,v(d,"mousedown",p.handleWindowClick),v(d,"touchstart",p.handleWindowClick)},setTargetValue:function(g){var u=this,E=u._editTarget,v=u._editInfo,S=v.accessType,s=v.name;if(s&&S||(S="p",s="name"),"p"===S){var L=_.Default.setter(s);E[L](g)}else"a"===S?E.a(s,g):E.s(s,g)},getTargetValue:function(){var J=this,O=J._editTarget,g=J._editInfo,m=g.accessType,N=g.name;if(N&&m||(m="p",N="name"),"p"===m){var V=_.Default.getter(N);return O[V]()}return"a"===m?O.a(N):O.s(N)},createHiddenTextarea:function(){this.hiddenTextarea=T.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;pointer-events: none;opacity:0;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(y,t){if(t&&this.computedStyleCache)return this.computedStyleCache;var l=this,E=d.getComputedStyle(y),s=E.getPropertyValue("box-sizing")||E.getPropertyValue("-moz-box-sizing")||E.getPropertyValue("-webkit-box-sizing"),J=parseFloat(E.getPropertyValue("padding-bottom"))+parseFloat(E.getPropertyValue("padding-top")),S=parseFloat(E.getPropertyValue("border-bottom-width"))+parseFloat(E.getPropertyValue("border-top-width")),B=l.SIZING_STYLE.map(function(A){return A+":"+E.getPropertyValue(A)}).join(";"),z={sizingStyle:B,paddingSize:J,borderSize:S,boxSizing:s};return t&&(this.computedStyleCache=z),z},calculateTextareaHeight:function(Z){Z=Z||"";var z=this,n=z.textarea,B=z.hiddenTextarea,$=z.wrap,C=32,F=z.calculateHTMLStyle(n,!1),R=F.paddingSize,O=F.borderSize,t=F.boxSizing,J=F.sizingStyle;B.setAttribute("style",J+";"+z.HIDDEN_TEXTAREA_STYLE),B.value=n.value+Z;var w=B.scrollHeight;"border-box"===t?w+=O:"content-box"===t&&(w-=R),n.style.height=w+"px",$.style.height=Math.max(w,C)+"px",$.style.marginTop=w*-.5+"px"}});var mb=xo.ScrollBarInteractor=function(l){mg(mb,this,[l])};Ee("ScrollBarInteractor",ib,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(G){var w=this.gv.getViewRect();return this._41o()&&(w.x+w.width-this.gv.lp(G).x)*this.gv.getZoom()<eg},isH:function(F){var V=this.gv.getViewRect();return this._40o()&&(V.y+V.height-this.gv.lp(F).y)*this.gv.getZoom()<eg},handle_mousemove:function(K){this.handle_touchmove(K)},handle_touchmove:function(r){if(!es&&ti(r)&&this.gv.isScrollBarVisible()){var G=this,t=G.isV(r),y=G.isH(r);(t||y)&&G.gv.showScrollBar(),G.gv._scrolling=t||y}},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(q){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=z,this.fi({kind:"endScroll",event:q})},handle_mousedown:function(E){this.handle_touchstart(E)},handle_touchstart:function(p){var W=this;if(W.gv.setFocus(p),pd(p),W.handle_touchmove(p),!(js(p)>1)&&W.gv._scrolling&&W.gv.isScrollBarVisible()){W._cp=el(p),W._tx=W.gv.tx(),W._ty=W.gv.ty();var Y=W.isV(p);W._state=Y?"vScroll":"hScroll",Gk(W,p),W.fi({kind:"beginScroll",event:p})}},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(X){var v=el(X),l=this.gv.getViewRect(),w=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-v.y)*w.height/l.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-v.x)*w.width/l.width),this.fi({kind:"betweenScroll",event:X})}});var no=xo.TouchInteractor=function(G,E){E=E||{},E.selectable===B&&(E.selectable=!0),E.movable===B&&(E.movable=!0),E.pannable===B&&(E.pannable=!0),E.pinchable===B&&(E.pinchable=!0),E.editable===B&&(E.editable=!0),this.params=E,mg(no,this,[G])};Ee("TouchInteractor",ib,{ms_edit:1,setUp:function(){var Q=this;no.superClass.setUp.call(Q),Xl&&Q.params.editable&&Q.gv.setEditInteractor(Q)},tearDown:function(){var g=this;no.superClass.tearDown.call(g),Xl&&g.params.editable&&g.gv.setEditInteractor(z)},clear:function(I){var f=this,A=f.gv;A._moving&&(f.fi({kind:"endMove",event:I}),delete A._moving,A.onMoveEnded(),A.dm().endTransaction()),A._panning&&(f.fi({kind:"endPan",event:I}),delete A._panning,A.onPanEnded()),A._pinching&&(f.fi({kind:"endPinch",event:I}),delete A._pinching,A.onPinchEnded()),A._editing&&(f._46O(I),f._77I=f._node=f._edge=f._shape=f._rect=f._89I=f._index=A._editing=z),f.pendingClickThrough=f._moving=f._panning=f._pinching=f._editing=f._57I=f._data=f._beginHistory=z,f.clearDragging()},handle_touchstart:function(y){var P=this;if(!P.gv._editing){pd(y),P._57I=z,P.pendingClickThrough=z;var D=P.params,k=P.gv,v=k.sm(),x=k.getDataAt(y),G=js(y);if(1===G){if(ds(y))return k.handleDoubleClick(y,x),void 0;k.handleClick(y,x),x&&(k.handleMouseDown&&k.handleMouseDown(y,x),P._data=x),D.selectable||(x=z),x&&(v.co(x)?x instanceof Sm&&x.isClickThroughEnabled()&&(P.pendingClickThrough=el(y)):v.ss(x),D.editable&&k.isEditable(x)&&P._79I(y,x,!0)?(P._editing=1,P.startDragging(y)):D.movable&&k.isMovable(x)&&(P._moving=1,P.startDragging(y))),x&&(k.isMovable(x)||k._39Q(x))||(P._57I=el(y),D.pannable&&k.isPannable()&&(P._panning=1,P.startDragging(y),P._translate={x:k.tx(),y:k.ty()}))}else if(D.pinchable&&2===G){if(!k.getEditInteractor()&&x){var J=Om(k.getImage(x));if(J&&Gq(J.scrollable,x,this))return}P._pinching=1,P.startDragging(y);var e=k.getView(),H=k.getZoom(),t=e.getBoundingClientRect(),O=y.touches[0],d=y.touches[1],s={x:(O.clientX+d.clientX)/2-t.left,y:(O.clientY+d.clientY)/2-t.top};s.x-=k.tx(),s.y-=k.ty(),s.x/=H,s.y/=H,P._p=s,P._d=vq(y)}}},handle_touchend:function(W){var f=this,x=f.gv,I=f._57I,c=f._data;if(I&&(bh(I,el(W))<=1&&!x.getDataAt(W)&&x.sm().cs(),f._57I=z),c&&x.handleMouseUp&&x.handleMouseUp(W,c),f.pendingClickThrough){if(bh(f.pendingClickThrough,el(W))<=1){var c=x.getDataAt(W);if(c instanceof Sm&&c.isClickThroughEnabled()){var m=x.getDataAt(W,function(E){var f=E.getParent()===c&&x.isSelectable(E,!0);return f});m&&(W.clickThrough=!0,x.sm().ss(m))}}f.pendingClickThrough=z}},handleWindowTouchEnd:function(B){this.clear(B)},handleWindowTouchMove:function(h){var l=this,x=l.gv,I=js(h);if(1===I){var Y=el(h),s=Oo(x,Y,l._lastClientPoint),n=bh({x:0,y:0},s);if(l._editing&&(l._beginHistory||(l._beginHistory=1,x.dm().beginTransaction()),x._editing=1,l._78I(h)),l._moving){if(!x._moving&&n<m.touchMoveThreshold)return;l._beginHistory||(l._beginHistory=1,x.dm().beginTransaction()),l.handleMove(h)}else if(l._panning){if(!x._panning&&n<m.touchMoveThreshold)return;x.setTranslate(l._translate.x+s.x,l._translate.y+s.y),l.fi({kind:x._panning?"betweenPan":"beginPan",event:h}),x._panning=1}}else if(2===I&&l._pinching){var c=vq(h);x.handlePinch(l._p,c,l._d),l._d=c,l.fi({kind:x._pinching?"betweenPinch":"beginPinch",event:h}),x._pinching=1}},handleMove:function(e){var $=this,h=$.gv,S=h.lp(e);h._93O&&h._93O(e,$._data)||(h.moveSelection(S.x-$._lastLogicalPoint.x,S.y-$._lastLogicalPoint.y),$._lastLogicalPoint=S,$.autoScroll(e),$.fi({kind:h._moving?"betweenMove":"beginMove",event:e}),h._moving=1)}});var _=d.ht,tn=_.graph._editor={Math:_.Math,Guide:{}};tn.getStyle=function(Y){var G,e=tn.StyleMap;return e&&(G=e[Y],G!==B)?G:tn.DefaultStyleMap[Y]},tn.setStyle=function($,L){var R=tn.StyleMap;R||(R=tn.StyleMap={}),R[$]=L},tn.inEdit=function(P){return P._inXEdit===!0},tn.startEdit=function(Q){Q._inXEdit=!0,tn.Inject.doInject(Q)},tn._46O=function(h){h._inXEdit=!1,tn.Inject.undoInject(h)},tn.toScreenPosition=function(O,w){var T=O.tx(),S=O.ty(),P=O._zoom;return new tn.Math.Vector2(w.x*P+T,w.y*P+S)},tn.checkHit=function(G,J,Q){return G.distanceTo(J)<Q?!0:!1},tn.toWorldPosition=function(c,I){var U=c.tx(),C=c.ty(),R=c._zoom;return{x:(I.x-U)/R,y:(I.y-C)/R}},tn.setAntialias=function(D,Z){for(var _,J=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],B=0,N=J.length;N>B&&(_=J[B],!(_ in D));B++);D[_],D[_]=Z},tn.getTargetCornersOnScreen=function(a,V){if(!V)return null;var $,G=[];if(Pc(V,a)){var F=Tb(a,V);$=[{x:F.x,y:F.y},{x:F.x+F.width,y:F.y},{x:F.x+F.width,y:F.y+F.height},{x:F.x,y:F.y+F.height}]}else{if(!V.getCorners)return null;$=V.getCorners()}return $.forEach(function(I){var j=tn.toScreenPosition(a,I);G.push(j.x,j.y)}),G},tn.log=function(){};var Af;tn.updateTipInfo=function(W,r,d){if(d){var f=_.Default.getLogicalPoint(W,r._canvas);f.x+=tn.Icons.TipShiftX,f.y+=tn.Icons.TipShiftY,Af={helperPos:f,text:d,size:d.length}}else Af=z},tn.drawTip=function(Z,A){Af&&tn.Icons.DrawIcon(A,Z,tn.Icons.TipHelper,Af)};var eh=tn.Inject={_modules:[]};eh.registAsModule=function(a,h){var K={},d={};for(var v in a){var z=h.prototype[v];K[v]=z}a.getBackup=function(H){return K[H]},a.getBackups=function(){return K},d.doInject=function(){for(var O in a)"getBackup"!==O&&(h.prototype[O]=a[O])},d.undoInject=function(){for(var s in a)"getBackup"!==s&&(h.prototype[s]=K[s])},eh._modules.push(d)},eh.doInject=function(y){for(var h,N=eh._modules,$=0,s=N.length;s>$;$++)h=N[$],h.doInject(y)},eh.undoInject=function(M){for(var $,H=eh._modules,y=0,Y=H.length;Y>y;y++)$=H[y],$.undoInject(M)};var ib=_.graph.EditInteractor=function(b){var H=this,s=T.createElement("canvas");s.className="editCanvas",s.style.position="absolute",H._uuid=_.Math.generateUUID(),H._styleMap={},H._canvas=s,H._context=s.getContext("2d"),ib.superClass.constructor.call(H,b),this._editDetail=!1,tn.setAntialias(H._context,!1),H._subModules=H.initSubModule(),H._gridGuide=new tn.Guide.Grid(H),H._rectGuide=new tn.Guide.Rect(H),H._hoverGuide=new tn.Guide.Hover(H)},pg=ib;_.Default.def(ib,_.graph.Interactor,{ms_edit:1,ms_fire:1}),S.defineProperties(ib.prototype,{editDetail:{get:function(){var R=!!this._editDetail;return R},set:function(X){var p=this,K=p._editDetail;K!==X&&(p._editDetail=X,p.gv._editing=X,p.fp("editDetail",K,X),p.fp("pointsEditingMode",K,X),p.fi({kind:X?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(h){(!this._editDetail||h)&&(this.gv._editing=h,h||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(x){this._editing=x,this.gvEditing=x}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(p){var E=this;E.editDetail!==p&&(p?E._tryEnterEditDetailMode():E._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var r=this._gridEnabled;if(!r)return!1;var J=this.gv;return J?!0:!0},set:function(S){S!==this._gridEnabled&&(this._gridEnabled=S,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(c){c!==this._agEnabled&&(this._agEnabled=c,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),ib.prototype.initSubModule=function(){var C=this;return[new tn.Anchor(C),new tn.RotateX(C),new tn.MoveDummy(C),new tn.Rect(C),new tn.Curve(C),new tn.MoveHelper(C)]},ib.prototype.getSubModule=function(S){var f,L,z,K=this._subModules;for(L=0,z=K.length;z>L;L++)if(f=K[L],f.catalog===S)return f},ib.prototype.invokeSubModule=function(Z,k){for(var e,n,Y,i=this,V=i._subModules,R=Array.prototype.slice.call(arguments,2),U=0,z=V.length;z>U;U++)if(e=V[U],n=e[Z],n&&(Y=n.apply(e,R),Y!=B&&k))return e},ib.prototype.invokeSubModuleInverse=function(d,$){var A=this,t=A._subModules;if(t)for(var O,n,F,J=Array.prototype.slice.call(arguments,2),g=t.length-1;g>=0;g--)if(O=t[g],n=O[d],n&&(F=n.apply(O,J),F!=B&&$))return O},ib.prototype.setUp=function(){tn.log("setUp");var R=this,s=R.gv,E=s.getView(),A=R._canvas;ib.superClass.setUp.call(R),s.setEditInteractor(R),s._79O?E.insertBefore(A,s._79O):E.appendChild(A),tn.startEdit(s),R.invokeSubModule("setUp"),s.dm().mm(R._onDataModelChanged,R),s.dm().md(R._onDataPropertyChanged,R)},ib.prototype.tearDown=function(){tn.log("tearDown");var p=this,$=p.gv,T=$.getView();p._resetCustomCursorStyle(),ib.superClass.tearDown.call(p),$.dm().umm(p._onDataModelChanged,p),$.dm().umd(p._onDataPropertyChanged,p),$.setEditInteractor(null),T.removeChild(p._canvas),p._drawTimer&&(Eh(p._drawTimer),p._drawTimer=null),tn._46O($),p.invokeSubModule("tearDown")},ib.prototype._onDataModelChanged=function(V){var M=this;("clear"===V.kind||"remove"===V.kind&&M.editDetail&&V.data===M.getSubModule("Curve").target)&&(M.editDetail=!1,M._42())},ib.prototype._onDataPropertyChanged=function(e){var F=this;if(F.editDetail){var C=F.getSubModule("Curve"),L=e.data;L===C.target&&(L._writing||C._handleDataChanged(e))}},ib.prototype.clear=function(){tn.log("clear")},ib.prototype.redraw=function(){this._42()},ib.prototype._42=function(){var B=this;B._drawTimer||(B._drawTimer=Vr(function(){B._drawTimer=null,B.drawImpl()},0))},ib.prototype.drawImpl=function(){var V;for(V in{_42:!0})break;return function(){var $=this,a=$._canvas,k=$.gv,j=k.getWidth(),D=k.getHeight(),y=$._context,o=_.Default.getInternal(),l=m.devicePixelRatio;(a.width!==j||a.height!==D)&&o.setCanvas(a,j,D,l),y.clearRect(0,0,a.width,a.height);var S=$._getValidSelection();y.save(),y.scale(l,l),$._gridGuide._42(),$.invokeSubModuleInverse(V,!1,y,k,S),$._rectGuide._42(),$._hoverGuide._42(),y.restore()}}(),ib.prototype._getValidSelection=function(){var l=this,m=l.gv,H=m.sm().getSelection(),M=[];return H.each(function(l){m.isVisible(l)&&m.isEditable(l)&&M.push(l)}),M},ib.prototype.handle_touchmove=function(x){return this.handle_mousemove(x)},ib.prototype.handle_mousemove=function(L){if(!_.Default.isDragging()){var K=this;if((K.editDetail||!sc()&&!Mi(L))&&!K.gv._externalEditing){if(K.gvEditing=!1,K._checkEdit(L))K.gvEditing=!0;else{if(!K.getStyle("hoverGuideVisible"))return;K.hoverData=K.gv.getDataAt(L)}K._42()}}},ib.prototype.handle_touchstart=function(k){return this.handle_mousedown(k)},ib.prototype.handle_mousedown=function(U){pd(U);var p=this;if((p.editDetail||!sc()&&!Mi(U))&&!p.gv._externalEditing){if(ds(U)&&!U.clickThrough){if(p.editDetail){if(p._tryQuitEditDetailMode(U))return}else if(p._tryEnterEditDetailMode())return;p.gv.dm().beginTransaction();var O=p.invokeSubModule("handleDoubleClick",!0,U);if(p.gv.dm().endTransaction(),O)return}var z=p._checkEdit(U);z&&(p._downPosition=p._getLogicalPoint(U),p.gv.dm().beginTransaction(),z.startEdit(p,U),p.editing=!0)}},ib.prototype._checkEdit=function(a){var E=this,V=E.gv,c=E._getLogicalPoint(a),Z=E.invokeSubModule("check",!0,V,a,c)||null;return E._editMod=Z,Z},ib.prototype.handleWindowTouchMove=function(K){return this.handleWindowMouseMove(K)},ib.prototype.handleWindowMouseMove=function(C){var g=this,z=g._downPosition;if(z){var A=g._getLogicalPoint(C);if(A.distanceTo(z)<g.getStyle("moveSensitivity"))return;delete g._downPosition}var p=g._editMod;p&&p.handleEdit(g.gv,C),g.redraw()},ib.prototype._getLogicalPoint=function(O){var J=this,w=_.Default.getLogicalPoint(O,J._canvas);return new tn.Math.Vector2(w)},ib.prototype.handleWindowTouchEnd=function(W){return this.handleWindowMouseUp(W)},ib.prototype.handleWindowMouseUp=function(){var V;for(V in{_46O:!0})break;return function(E){var W=this;W.editing=!1,W.setCursor("default"),W.invokeSubModule(V,!1,E),W._42(),W.gv.dm().endTransaction()}}(),ib.prototype.handle_mousewheel=function(K){var d=this;pd(K),d.invokeSubModule("preHandleScroll",!0)||d.gv.handleScroll(K,K.wheelDelta)},ib.prototype.handleDelete=function(){var W=this;if(!W.editDetail){W.gv.dm().beginTransaction();var E=W.invokeSubModule("handleNormalStateDelete",!0);return W.gv.dm().endTransaction(),E||W.gv.removeSelection(),void 0}W.gv.dm().beginTransaction(),W.invokeSubModule("handleDelete",!0),W.gv.dm().endTransaction(),W._42()},ib.prototype.handle_keydown=function(L){var i=this;if((L.metaKey||L.ctrlKey)&&i._42(),sc(L)&&!i.editing)return i.gvEditing=!1,i.setCursor("default"),i._42(),void 0;var k=Ud(L);return i.editDetail?((k||Vq(L))&&(i.editDetail=!1,i._42()),i.gv.dm().beginTransaction(),i.invokeSubModule("handle_keydown",!0,L),i.gv.dm().endTransaction(),void 0):(i.gv.dm().beginTransaction(),i.invokeSubModule("handleNormalStateKeyDown",!0,L),i.gv.dm().endTransaction(),k&&i._tryEnterEditDetailMode(),void 0)},ib.prototype.handle_keyup=function(Z){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,Z),this.gv.dm().endTransaction()},ib.prototype._tryEnterEditDetailMode=function(){var H=this;return!H.editDetail&&H.invokeSubModule("canEnterEditDetailMode",!0)&&1===H._getValidSelection().length?(H.editDetail=!0,H._42(),!0):void 0},ib.prototype._tryQuitEditDetailMode=function(P){var f=this;return f.editDetail?!P||f.invokeSubModule("canQuitEditDetailMode",!0,P)?(f.editDetail=!1,f._42(),!0):!1:!1},ib.prototype.setStyle=function(F,f,L){var Y=this;L?tn.setStyle(F,f):Y._styleMap[F]=f,"baseColor"===F&&(Oi=f),Y.fp("styleChanged",null,{key:F,value:f,base:L}),Y._42()},ib.prototype.getStyle=function(G){var w=this,m=w._styleMap[G];return m!==B?m:tn.getStyle(G)},ib.prototype.setCursor=function(Q){this._resetCustomCursorStyle(),_.graph.EditInteractor.superClass.setCursor.call(this,Q)},ib.prototype._drawHostGuide=function(j){var i=this,x=i._context,C=i.gv;tn.Icons.DrawIcon(i,x,tn.Icons.NodeHoverGuide,j.corners);var L=j.host;if(L){var z=C.getAttachPoints(L);if(z&&z.length)for(var q=0,v=z.length;v>q;q++){var T=z[q],t=tm(C,L,0,T.offsetX||0,T.offsetY||0,T.x,T.y);t=tn.toScreenPosition(C,t),t.isAttach=j.attach===q,tn.Icons.DrawIcon(i,x,tn.Icons.AttachPoint,t)}}},ib.prototype._resetCustomCursorStyle=function(){var P=this;if(P._customStyle){var u=this.gv.getView();u.classList&&u.classList.remove&&u.classList.remove(P._customStyle),P._customStyle=null}},ib.prototype._setRotateCursor=function(p){var N=this,d=N._cursorFactory;d||(d=N._cursorFactory=new tn.CursorFactory(N));var q=d.getRotateCursor(p),J=N.gv.getView();N._resetCustomCursorStyle(),N._customStyle=q,J.classList&&J.classList.add&&J.classList.add(q)
};var wb=tn.Group=function(N){var B=this;B._entities=N,B._64O=0,B._position={x:0,y:0},B._scale={x:1,y:1},B._anchor={x:.5,y:.5},B._anchor2={x:.5,y:.5}};wb.prototype={},wb.prototype.constructor=wb;var pp=null,_i=null;wb.findOrCreateGroup=function(u,w){if(_i===w&&pp&&pp.checkIsMe(u))return pp;_i=w;var j=new tn.Group(u);return j.getKeyOb()?(pp=j,j):void 0},wb.prototype.checkIsMe=function(v){var x=this._entities;if(x.length!==v.length)return!1;var D,f={},j=v.length;for(D=0;j>D;D++)f[v[D]._id]=!0;for(D=0;j>D;D++)if(!f[x[D]._id])return!1;return!0},wb.prototype.getRotation=function(){return this._64O},wb.prototype.getPosition=function(){return this._position},wb.prototype.getAnchor=function(){return this._anchor},wb.prototype.getWidth=function(){return this._width},wb.prototype.getScale=function(){return this._scale},wb.prototype.getSize=function(){return{width:this._width,height:this._height}},wb.prototype.getHeight=function(){return this._height},wb.prototype.getKeyOb=function(){for(var B=this._entities,K=B.length-1;K>=0;K--){var r=B[K];if(this.isNode(r))return r}},wb.prototype.getAnchor2=function(){var z=this,j=z.rotateCenter;if(j)return j;var Q=z.getKeyOb();if(!Q)return z._anchor;var k=z._anchor2,Y=Q.getMatrix();return Y.tf({x:Q.getWidth()*(k.x-Q.getAnchor().x),y:Q.getHeight()*(k.y-Q.getAnchor().y)})},wb.prototype.setAnchor2=function(d,Z){var l=this,q=l.getKeyOb();if(q){var P,o=q.getMatrix();P="number"==typeof d?{x:d,y:Z}:d;var h=o.tfi(P);l._anchor2={x:q.getAnchor().x+h.x/q.getWidth(),y:q.getAnchor().y+h.y/q.getHeight()}}},wb.prototype.setRotation=function(){},wb.prototype.beginRotate=function(m){this.rotateCenter=m.pos,this.rotateMode=m.groupRotateMode},wb.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},wb.prototype.addRotation=function(p,R,r){return"batch"===R?this._addRotationInBatchMode(p,r):"block"===R?this._addRotationInBlockMode(p,r):void 0},wb.prototype._addRotationInBlockMode=function(z,x){var p=this,k=p.rotateCenter||p.getPosition();p._entities.forEach(function(X){if(p.isNode(X)&&(!x||x(X))){var a=X.getMatrix();a.translate(-k.x,-k.y),a.rotate(z),a.translate(k.x,k.y);var C=Math.sign(X.getScale().x);X.setRotation(Wc(a.b*C,a.a*C)),X.setPosition(a.tx,a.ty)}})},wb.prototype._addRotationInBatchMode=function(t,D){var Y=this,j=Y._anchor2;Y._entities.forEach(function(Z){if(Y.isNode(Z)&&(!D||D(Z))){var K=Z.getAnchor(),y=Z.getMatrix(),u=y.tf({x:Z.getWidth()*(j.x-K.x),y:Z.getHeight()*(j.y-K.y)}),V=new tn.Math.Matrix2d;V.set(y.a,y.b,y.c,y.d,y.tx,y.ty),V.translate(-u.x,-u.y),V.rotate(t),V.translate(u.x,u.y);var $=Math.sign(Z.getScale().x);Z.setRotation(Wc(V.b*$,V.a*$)),Z.setPosition(V.tx,V.ty)}})},wb.prototype.setPosition=function(T){var L,u,F,U,I=this,Y=I._position,v=T.x-Y.x,n=T.y-Y.y,z=I._entities;for(u=0,F=z.length;F>u;u++)L=z[u],Dk(L)&&(U=L.getPosition(),L.setPosition(U.x+v,U.y+n));I._position=T},wb.prototype.setScale=function(A,g){var V=this,l=A/V._scale.x,S=g/V._scale.y;V._adjustChildScaleOrSize(l,S,"size"),V._scale={x:A,y:g}},wb.prototype.getRect=function(){var a=this,q=a._position,R=a._width,v=a._height;return{x:q.x-R/2,y:q.y-v/2,width:R,height:v}},wb.prototype.setSize=function(T,C){var M=this,T=Math.max(1,T),C=Math.max(1,C),u=T/M._width,U=C/M._height;M._adjustChildScaleOrSize(u,U,"size"),M._width=T,M._height=C},wb.prototype._adjustChildScaleOrSize=function(P,A,y){var $,L,V,Z,D,B,u,m,v,a,K,h,o,f,i=this,e=i._position,q=i._entities,j=new tn.Math.Matrix2d;for(L=0,V=q.length;V>L;L++)if($=q[L],i.isNode($)){if(Z=$.getPosition(),D=$.getRotation(),B=$.getWidth(),u=$.getHeight(),m=$.getScale(),K=m.x*B,h=m.y*u,j.identity().scale(K,h).rotate(D).translate(Z.x,Z.y).translate(-e.x,-e.y).rotate(-i._64O),D=Wc(j.b*Math.sign(K),j.a*Math.sign(K)),j.scale(P,A),v=Math.cos(D),a=Math.sin(D),Math.abs(v)<.001?(o=j.b/a,f=-j.c/a):(o=j.a/v,f=j.d/v),"scale"===y)$.setScale(o/B,f/u);else if("size"===y){var s=o/m.x,G=f/m.y;$.setScale(ud(o)*Math.abs(m.x),ud(f)*Math.abs(m.y)),$.setSize(Math.max(.1,Math.abs(s)),Math.max(.1,Math.abs(G)))}j.rotate(i._64O).translate(e.x,e.y),$.setPosition(j.tx,j.ty)}},wb.prototype.getMatrix=function(){var l=this,s=l._position,m=_.Default.getInternal(),n=l._scale;return new m.Mat(l._64O,s.x,s.y,n.x,n.y)},wb.prototype.toGlobal=function(H){return this.getMatrix().tf(H)},wb.prototype.getCorners=function(){var E=this,X=E._width,M=E._height,R=E._anchor,c=-X*R.x,K=-M*R.y,r=E.getMatrix();return[r.tf(c,K),r.tf(c,K+M),r.tf(c+X,K+M),r.tf(c+X,K)]},wb.prototype.calcInfo=function(){var E,F,R,I,X,D,P=this,Z=[],L=P._entities,t=P._64O;for(I=0,X=L.length;X>I;I++)D=L[I],P.isNode(D)&&D.getCorners&&Z.push.apply(Z,D.getCorners());if(Z.length){var A=Math.cos(-t),v=Math.sin(-t),m=1/0,g=-1/0,u=1/0,U=-1/0;for(I=0,X=Z.length;X>I;I++)R=Z[I],E=R.x,F=R.y,R.x=A*E-v*F,R.y=v*E+A*F,m=Math.min(m,R.x),g=Math.max(g,R.x),u=Math.min(u,R.y),U=Math.max(U,R.y);P._width=(g-m)/P._scale.x,P._height=(U-u)/P._scale.y,A=Math.cos(t),v=Math.sin(t);var n=P._anchor;E=m+(g-m)*n.x,F=u+(U-u)*n.y,P._position={x:A*E-v*F,y:v*E+A*F}}},wb.prototype.isNode=function(s){return Dk(s)?Pc(s)?s.size()?!1:!0:!0:!1},wb.prototype._42=function(n,A,q){var d,x,b,o,$,R,F,E,e=this,U=e._entities,H=e.rotateMode;for("batch"===H&&(E=e.getKeyOb()),d=0,x=U.length;x>d;d++)b=U[d],e.isNode(b)&&(R=b.getRect(),o=tn.toScreenPosition(q,{x:R.x,y:R.y}),$=tn.toScreenPosition(q,{x:R.x+R.width,y:R.y+R.height}),F={min:o,max:$},b===E&&(F.isKeyOb=!0),tn.Icons.DrawIcon(n,A,tn.Icons.GroupSubEntityRect,F))};var fb=tn.CurveActiving=function(m,F){this._curve=m,this._interactor=m._interactor,this.silent=!0;for(var E in F)this[E]=F[E];delete this.silent};fb.prototype={},fb.prototype.constructor=fb,S.defineProperties(fb.prototype,{point:{get:function(){return this._point},set:function(E){var C=this;C._point=E,C.editingCtrl||C.silent||C._firePointChange()}},pairs:{get:function(){return this._pairs},set:function($){var p=this;p._pairs=$,p.editingCtrl&&!p.silent&&p._firePointChange()}}}),fb.prototype._firePointChange=function(){var a=this,p=a.getCurrentEditingPoint(),t=a._interactor;if(!p)return t.fi({kind:"selectPoint"}),void 0;var C=this._curve.target;if(C){var H=tn.getDataMatrix(C).invert(),U=p.e;p=H.apply(tn.toWorldPosition(t.gv,p)),p.e=U;var j=a._lastFirePoint;j&&Math.abs(p.x-j.x)<1e-5&&Math.abs(p.y-j.y)<1e-5&&(p.e==B&&j.e==B||Math.abs(p.e-j.e)<1e-5)||(a._lastFirePoint=p,t.fi({kind:"selectPoint",x:p.x,y:p.y,e:p.e}))}},fb.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},fb.prototype.getCurrentEditingPoint=function(){var Z=this,p=Z.editingCtrl;if(p){var D=Z.pairs;if(D){var u=D[p.pairId];if(u){var k=u[p.type];if(k)return k}}}return Z._point};var Ah=tn.CursorFactory=function(O){var M=this;M._interactor=O,M._rotateCursorStyles={}};Ah.prototype={},Ah.prototype.constructor=Ah,Ah.prototype.getRotateCursor=function(G){var B=this;0>G&&(G+=2*Math.PI);var j=B._interactor,P=j.getStyle("rotateCursorSize"),o=j.getStyle("rotateCursorRound"),t=Math.round(180*(G/Math.PI)/o);t*o>=360&&(t=0);var $=B._rotateCursorStyles,Q="htCustomRotateStyle_"+P+"_"+o+"_"+t;return $[Q]||(B._produceRotateCursor(Q,P,o,t),$[Q]=!0),Q},Ah.prototype._produceRotateCursor=function(p,v,x,e){var F=this;F._interactor;var B=F._canvas;B||(B=F._canvas=T.createElement("canvas"));var j=m.devicePixelRatio;B.width=B.height=v*j,B.style.width=B.style.height=v+" px";var h=B.getContext("2d");tn.setAntialias(h,!1),h.scale(j,j);var f,R,Q,s,J,y=Math.round(v/2),g=""+y+" "+y+",auto !important;",W=4;f=Math.PI/180*e*x,h.clearRect(0,0,v,v),h.save(),h.scale(v/32,v/32),h.translate(16,15),h.rotate(f+Math.PI/2),h.beginPath(),h.moveTo(-8,0),h.lineTo(-8,W),h.lineTo(-8+W,W),h.moveTo(8,0),h.lineTo(8,W),h.lineTo(8-W,W),h.moveTo(-8,W),h.quadraticCurveTo(0,-6,8,W),h.restore(),h.lineCap="round",h.lineJoin="miter",h.strokeStyle="white",h.lineWidth=4,h.stroke(),h.strokeStyle="black",h.lineWidth=2,h.stroke(),R=JSON.stringify(B.toDataURL()),s="cursor:url("+R+")"+g,1!==j&&(Q='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+v+'px" height="'+v+'px"><image xlink:href='+R+' width="'+v+'" height="'+v+'"/></svg>',s+="cursor:url(data:image/svg+xml;base64,"+btoa(Q)+")"+g,s+="cursor:-webkit-image-set(url("+R+")"+j+"x,url("+R+")1x)"+g),J=T.createElement("style"),J.textContent="body."+p+" *, ."+p+"{"+s+"}",T.head.appendChild(J)};var Oj=tn.Guide.Grid=function(c){var V=this;V._interactor=c,V._alignmentGuideId=0,V._xAlignmentGuide=[],V._yAlignmentGuide=[]};Oj.prototype={},Oj.prototype.constructor=Oj,S.defineProperties(Oj.prototype,{gridBlockSize:{get:function(){var W=this;return W._gridBlockSize||W._interactor.getStyle("gridBlockSize")},set:function(q){this._gridBlockSize=q,this._interactor._42()}},gridThickLinesEvery:{get:function(){var m=this;return m._gridThickLinesEvery||m._interactor.getStyle("gridThickLinesEvery")},set:function($){this._gridThickLinesEvery=$,this._interactor._42()}},gridEnabled:{get:function(){var i=this,s=i._interactor;return s.gridEnabled&&i.isValidGrid()}}}),Oj.prototype._42=function(){var O=this,j=O._interactor;O.gridEnabled&&O.drawGrid(),j.alignmentGuideEnabled&&O.drawAlignmentGuide()},Oj.prototype.makeMatrix=function(){var k=this,w=k._interactor.getStyle("gridAngle"),g=k._interactor.getStyle("gridRotation"),o=new tn.Math.Matrix2d,P=Math.sin(w),C=Math.cos(w);return o.set(1,0,C,P,0,0),o.rotate(g),o},Oj.prototype.isValidGrid=function(){var t=this,y=Math.PI,C=t._interactor,f=C.gv;if(f._zoom<C.getStyle("gridZoomThreshold"))return!1;var x=C.getStyle("gridAngle"),N=Math.abs(180*(x%y/y)),G=1-1e-8;return G>N||N>180-G?!1:!0},Oj.prototype.drawAlignmentGuide=function(){var E=this,O=E._interactor,c=O.gv,A=O._canvas,s=O._context,M=A.width,d=A.height,B=c.tx(),e=c.ty(),G=c._zoom;s.beginPath(),s.strokeStyle=O.getStyle("gridAlignmentGuideColor"),s.lineWidth=1,E._xAlignmentGuide.forEach(function(L){var D=L.p*G+B;s.moveTo(D,0),s.lineTo(D,d)}),E._yAlignmentGuide.forEach(function(b){var E=b.p*G+e;s.moveTo(0,E),s.lineTo(M,E)}),s.stroke()},Oj.prototype.drawGrid=function(){function O(l,D,s,k){var r=tn.toScreenPosition(H,I.apply({x:l,y:D})),B=tn.toScreenPosition(H,I.apply({x:s,y:k}));N.moveTo(r.x,r.y),N.lineTo(B.x,B.y)}var B=this,s=B._interactor,r=B.gridBlockSize,P=B.gridThickLinesEvery,p=s.getStyle("gridThickColor"),K=s.getStyle("gridLightColor"),H=s.gv,c=s._canvas,N=s._context,a=c.width,j=c.height,I=B.makeMatrix(),C=I.applyInverse(tn.toWorldPosition(H,{x:0,y:0})),h=I.applyInverse(tn.toWorldPosition(H,{x:a,y:0})),R=I.applyInverse(tn.toWorldPosition(H,{x:0,y:j})),o=I.applyInverse(tn.toWorldPosition(H,{x:a,y:j})),T=Math.min(C.x,h.x,R.x,o.x),Y=Math.max(C.x,h.x,R.x,o.x),J=Math.min(C.y,h.y,R.y,o.y),M=Math.max(C.y,h.y,R.y,o.y);a=Y-T,j=M-J;var i=Math.ceil(T/r),A=Math.floor(Y/r),d=Math.ceil(J/r),z=Math.floor(M/r);H.tx(),H.ty(),H._zoom;var S,l,e;for(N.save(),N.lineWidth=1,N.beginPath(),N.strokeStyle=p,e=Math.ceil(i/P)*P;A>=e;e+=P)S=e*r,O(S,J,S,M);for(e=Math.ceil(d/P)*P;z>=e;e+=P)l=e*r,O(T,l,Y,l);for(N.stroke(),N.beginPath(),N.strokeStyle=K,e=i;A>=e;e++)0!==e%P&&(S=e*r,O(S,J,S,M));for(e=d;z>=e;e++)0!==e%P&&(l=e*r,O(T,l,Y,l));N.stroke(),N.restore()},Oj.prototype.getAlignmentGuides=function(){var l=this;return{x:l._xAlignmentGuide,y:l._yAlignmentGuide}},Oj.prototype.addAlignmentGuide=function(j,D,V){var P=this,y="x"===j?P._xAlignmentGuide:P._yAlignmentGuide,V=V?V:++P._alignmentGuideId,h={p:D,id:V};if(y.length){var W=P._findClosestAlignmentGuide(h.p,y);W.dis<0?y.splice(W.index+1,0,h):y.splice(W.index,0,h)}else y.push(h);return P._interactor._42(),V},Oj.prototype.findClosest=function(F,C,R){var O=this,r=O._interactor,Z=r.gv;R&&(F=tn.toWorldPosition(Z,F));var w,P,V,h=1/0,k=1/0,u=F.x,K=F.y;if(O.gridEnabled){var g=O.gridBlockSize,Q=O.makeMatrix(),I=Q.applyInverse(F);I=Q.apply({x:Math.round(I.x/g)*g,y:Math.round(I.y/g)*g}),h=I.x-u,k=I.y-K,V=!0}if(r.alignmentGuideEnabled&&(w=O._findClosestAlignmentGuide(u,O._xAlignmentGuide).dis,P=O._findClosestAlignmentGuide(K,O._yAlignmentGuide).dis,Math.abs(w)<Math.abs(h)&&(h=w,V=!0),Math.abs(P)<Math.abs(k)&&(k=P,V=!0)),V){V=!1;var m=Z._zoom,n=r.getStyle("smartGuideThreshold")/m,E={};if(Math.abs(h)<n&&"y"!==C&&(E.x=R?h*m:h,V=!0),Math.abs(k)<n&&"x"!==C&&(E.y=R?k*m:k,V=!0),V)return E}},Oj.prototype._findClosestAlignmentGuide=function($,D){if(!D.length)return{dis:1/0};for(var x,c=0,A=D.length-1;A-c>1;)x=Math.floor((c+A)/2),D[x].p<$?c=x:A=x;var E=D[c].p-$,W=D[A].p-$;return Math.abs(E)<=Math.abs(W)?{line:D[c],dis:E,index:c}:{line:D[A],dis:W,index:A}},Oj.prototype.removeAllAlignmentGuide=function(o){var v=this;"y"!==o&&(v._xAlignmentGuide=[]),"x"!==o&&(v._yAlignmentGuide=[]),v._interactor._42()},Oj.prototype.removeAlignmentGuide=function(c){for(var j,e,Z,W=this,u=W._xAlignmentGuide,C=0;2>C;C++)for(u=0===C?W._xAlignmentGuide:W._yAlignmentGuide,j=0,e=u.length;e>j;j++)if(Z=u[j],Z.id===c)return u.splice(j,1),W._interactor._42(),{axis:0===C?"x":"y",position:Z.p};return!1},Oj.prototype.adjustAlignmentGuide=function(T,v){var H=this,a=H.removeAlignmentGuide(T);return a?(H.addAlignmentGuide(a.axis,v,T),!0):!1};var Rg=tn.Guide.Rect=function(S){var Z=this;Z._interactor=S};Rg.prototype={},Rg.prototype.constructor=Rg,Rg.prototype.gatherRects=function(){var O,A,i,c,s=this,t=s._interactor.gv,Z=[],Q=[],M={x:Z,y:Q},f={},_=t.getDataModel(),m=_.a("width"),N=_.a("height");m&&N&&(O=0,A=0,i=m,c=N,Z.push({node:_,type:0,p:O},{node:_,type:1,p:O+i/2},{node:_,type:2,p:O+i}),Q.push({node:_,type:0,p:A},{node:_,type:1,p:A+c/2},{node:_,type:2,p:A+c}),f[_._id||0]={x:O,y:A,width:i,height:c}),_.each(function(Y){if(Dk(Y)&&!t.isSelected(Y)&&t.isVisible(Y)&&t.isValidGuideLineSource(Y)){var m=!1;if(t.sm().getSelection().each(function(B){m||(Y.isHostOn(B)?m=!0:Y.isDescendantOf(B)&&(m=!0))}),!m){var u=Y.getRect();O=u.x,A=u.y,i=u.width,c=u.height,Z.push({node:Y,type:0,p:O},{node:Y,type:1,p:O+i/2},{node:Y,type:2,p:O+i}),Q.push({node:Y,type:0,p:A},{node:Y,type:1,p:A+c/2},{node:Y,type:2,p:A+c}),f[Y._id]=u}}}),Z.sort(function(t,N){return t.p-N.p}),Q.sort(function(T,p){return T.p-p.p}),s._grid=M,s._87I=f},Rg.prototype.gatherLines=function(M,E,L){var r,T,p,m,U,o,u,Y,O,S,t,D,C=this,b=[C.findClosest({x:M.x,y:M.y},E),C.findClosest({x:M.x+M.w/2,y:M.y+M.h/2},E),C.findClosest({x:M.x+M.w,y:M.y+M.h},E)],Q={},c=C._87I;L=L||255;var R,v;for(C._guideLine=[],r=0;2>r;r++)for(Q={},0===r?(m="y",Y=M.x,O=Y+M.w):(m="x",Y=M.y,O=Y+M.h),T=0;3>T;T++)U=b[T],U&&isFinite(U[m])&&(R=1<<3*r+T,L&R&&(o=U[m+"Line"],u=o.node,v=u._id||0,Q[v]||(Q[v]=!0,D=c[v],"y"===m?(S=D.x,t=D.x+D.width):(S=D.y,t=D.y+D.height),p=o.p,C._guideLine.push({type:m,a:Y,b:O,c:S,d:t,p:p,center:1===o.type}))))},Rg.prototype._binarySearchClosest=function(Z,I){if(!I.length)return{dis:1/0};for(var n,O=0,s=I.length-1;s-O>1;)n=Math.floor((O+s)/2),I[n].p<Z?O=n:s=n;var C=I[O].p-Z,q=I[s].p-Z;return Math.abs(C)<=Math.abs(q)?{line:I[O],dis:C}:{line:I[s],dis:q}},Rg.prototype.findClosest=function(y,C,S){var L=this,h=L._interactor,o=h.gv,M=L._grid;S&&(y=tn.toWorldPosition(o,y));var _,q=L._binarySearchClosest(y.x,M.x),I=L._binarySearchClosest(y.y,M.y),m=q.dis,Z=I.dis,D=o._zoom,V=h.getStyle("smartGuideThreshold")/D,X={};return Math.abs(m)<V&&"y"!==C&&(X.x=S?m*D:m,X.xLine=q.line,_=!0),Math.abs(Z)<V&&"x"!==C&&(X.y=S?Z*D:Z,X.yLine=I.line,_=!0),_?X:void 0},Rg.prototype._42=function(){var A=this,w=A._guideLine;if(w&&!_.Default.isCtrlDown()){var r=A._interactor;if(r.getStyle("guideLineVisible")){var z,I,n,X,E,G,q,M,o,C,F,s,J,v,R,H,W,g=r.gv,i=r._context,D=g.tx(),j=g.ty(),Q=g._zoom,k=r.getStyle("guideLineTextSpacing");for(z=0,I=w.length;I>z;z++)n=w[z],M=n.type,o=n.p,C=n.a,F=n.b,s=n.c,J=n.d,v=Math.min(C,s),R=Math.max(F,J),"x"===M?(X=o*Q+D,E=v*Q+j,G=X,q=R*Q+j):(X=v*Q+D,E=o*Q+j,G=R*Q+D,q=E),tn.Icons.DrawIcon(r,i,tn.Icons.MoveLineGuide,{rect:[X,E,G,q],center:n.center}),J>=C&&F>=s||(v=C>J?J:F,R=C>J?C:s,W=R-v,"x"===M?(n.center2center||(X-=k,G=X),E=v*Q+j,q=R*Q+j,H=tn.Icons.MoveLineGuideDistanceV):"y"===M&&(n.center2center||(E-=k,q=E),X=v*Q+D,G=R*Q+D,H=tn.Icons.MoveLineGuideDistanceH),tn.Icons.DrawIcon(r,i,H,{x0:X,y0:E,x1:G,y1:q,dis:W}))}}},Rg.prototype.clear=function(){this._guideLine=null};var Uo=tn.Guide.Hover=function(V){var m=this;m._interactor=V};Uo.prototype={},Uo.prototype.constructor=Uo,S.defineProperties(Uo.prototype,{}),Uo.prototype._42=function(){var d=this._interactor;if(d.getStyle("hoverGuideVisible")&&!d.gvEditing){var B=d.hoverData,u=d.gv;if(!Dk(B)||u.isSelected(B))return d.hoverData=null,void 0;var b=Tb(u,B),O=tn.toScreenPosition(u,{x:b.x,y:b.y}),t=tn.toScreenPosition(u,{x:b.x+b.width,y:b.y+b.height});tn.Icons.DrawIcon(d,d._context,tn.Icons.HoverDataRect,{min:O,max:t,color:d.getStyle("hoverGuideColor")||d.getStyle("baseColor"),borderWidth:d.getStyle("hoverGuideBorderWidth")||1,borderPattern:d.getStyle("hoverGuideBorderPattern")||[1,4]})}},tn.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Nf=tn.Icons={},ul=1e4,Zp=null,Oi=tn.DefaultStyleMap.baseColor,Nd="rgb(183,232,135)",le="rgb(255,204,153)",sp=6;_.Default.setImage("Icons.RectPoint",{width:sp,height:sp,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Oi}},rect:[0,0,sp,sp]}]}),Nf.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var W=Nf.GroupSubEntityRect.data;if(!W)return[];var u=W.min,M=W.max;return[u.x,u.y,u.x,M.y,M.x,M.y,M.x,u.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Nf.GroupSubEntityRect.data.isKeyOb?Oi:Oi}}}]};var or=4;Nf.HoverDataRect={comps:[{type:"shape",points:{func:function(){var R=Nf.HoverDataRect.data;if(!R)return[];var $=R.min,k=R.max,p=or;return $.x-=p,$.y-=p,k.x+=p,k.y+=p,[$.x,$.y,$.x,k.y,k.x,k.y,k.x,$.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Nf.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Nf.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Nf.HoverDataRect.data.borderPattern}}}]},Nf.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Nf.Line.data.P1.x,Nf.Line.data.P1.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Nf.Line.data.P2.x,Nf.Line.data.P2.y],sp,sp]}}}]},Nf.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Nf.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Nf.Rect={comps:[{type:"shape",points:{func:function(){var Q=Nf.Rect.data;if(!Q)return[];var U=Q.LT,D=Q.LB,F=Q.RB,l=Q.RT;return[U.x,U.y,D.x,D.y,F.x,F.y,l.x,l.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Oi}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nf.Rect.data.rotation}},rect:{func:function(){return[[Nf.Rect.data.LT.x,Nf.Rect.data.LT.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nf.Rect.data.rotation}},rect:{func:function(){return[[Nf.Rect.data.LB.x,Nf.Rect.data.LB.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nf.Rect.data.rotation}},rect:{func:function(){return[[Nf.Rect.data.RB.x,Nf.Rect.data.RB.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nf.Rect.data.rotation}},rect:{func:function(){return[[Nf.Rect.data.RT.x,Nf.Rect.data.RT.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nf.Rect.data.rotation}},visible:{func:function(){return Nf.Rect.data.L?!0:!1}},rect:{func:function(){return[[Nf.Rect.data.L.x,Nf.Rect.data.L.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nf.Rect.data.rotation}},visible:{func:function(){return Nf.Rect.data.R?!0:!1}},rect:{func:function(){return[[Nf.Rect.data.R.x,Nf.Rect.data.R.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nf.Rect.data.rotation}},visible:{func:function(){return Nf.Rect.data.T?!0:!1}},rect:{func:function(){return[[Nf.Rect.data.T.x,Nf.Rect.data.T.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Nf.Rect.data.rotation}},visible:{func:function(){return Nf.Rect.data.B?!0:!1}},rect:{func:function(){return[[Nf.Rect.data.B.x,Nf.Rect.data.B.y],sp,sp]}}}]};var nh=16;_.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Oi}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Oi}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Nf.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Nf.Anchor.data.POS.x,Nf.Anchor.data.POS.y],nh,nh]}}}]},Nf.TipShiftX=12,Nf.TipShiftY=12;var Gl=[8,28];Nf.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Nf.TipHelper.data.helperPos.x,Nf.TipHelper.data.helperPos.y,Gl[0]*Nf.TipHelper.data.size,Gl[1]]}},background:{func:function(){return Zp.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Nf.TipHelper.data.text}},rect:{func:function(){return[Nf.TipHelper.data.helperPos.x,Nf.TipHelper.data.helperPos.y,Gl[0]*Nf.TipHelper.data.size,Gl[1]]}},color:{func:function(){return Zp.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var wf=7;Nf.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Nf.ShapePoint.data.dynamicVisible}},rect:{func:function(){var o=Nf.ShapePoint.data.point,P=Nf.ShapePoint.data.size||wf;return[o,P+10,P+10]}},background:{func:function(){var G=Date.now(),m=Nf.ShapePoint.data.dynamicPeriod||1500,j=Math.sin(G%m/m*Math.PI);return"rgba(27,124,22,"+.5*j+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var H=Nf.ShapePoint.data.point,w=Nf.ShapePoint.data.size||wf;return[H,w,w]}},background:{func:function(){var M=Nf.ShapePoint.data.isEnd;return M?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Nf.ShapePoint.data.color||Oi}}},{type:"rect",visible:{func:function(){return!!Nf.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Oi}},rect:{func:function(){var S=5;return[Nf.ShapePoint.data.point,S,S]}}}]},Nf.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Nf.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Nf.ShapeBgCurve.data.P}},segments:{func:function(){return Nf.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var s=Date.now(),V=Nf.ShapeBgCurve.data.dynamicPeriod||1500,I=Math.sin(s%V/V*Math.PI);return"rgba(27,124,22,"+.3*I+")"}}},{type:"shape",points:{func:function(){return Nf.ShapeBgCurve.data.P}},segments:{func:function(){return Nf.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Nf.ShapeBgCurve.data.color||Oi}}}]};var $q=8;Nf.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var i=Nf.ShapeHighlighPoint.data;return[[i.x,i.y],$q,$q]}},background:{func:function(){return Zp.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var rj=10;Nf.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var V=Nf.ShapeHighlighRealPoint.data;return[[V.x,V.y],rj,rj]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Oi}}}]};var fe=8;Nf.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var $=Nf.ShapeHighlighCtrlPoint.data,t=$.x,P=$.y,W=fe/2;return[t-W,P-W,t-W,P+W,t+W,P+W,t+W,P-W]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Zp.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Zp.getStyle("shapeCtrlPointBorderColor")||Oi}}}]};var oh=3;Nf.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Nf.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:oh,borderColor:{func:function(){return Zp.getStyle("curveHighlightColor")}}}]},Nf.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Nf.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Nf.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Nf.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Nf.MoveLineGuide.data.center?Nd:le}}}]};var Zi=5;Nf.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var q=Nf.MoveLineGuideDistanceH.data,J=q.x0,D=q.y0;return[J,D-Zi,J,D+Zi]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:le},{type:"shape",points:{func:function(){var U=Nf.MoveLineGuideDistanceH.data,Y=U.x1,f=U.y1;return[Y,f-Zi,Y,f+Zi]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:le},{type:"text",text:{func:function(){return Math.round(Nf.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var X=Nf.MoveLineGuideDistanceH.data;return[[(X.x0+X.x1)/2,X.y0-10],20,20]}},color:le,font:"12px Arial",align:"center"}]},Nf.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var Y=Nf.MoveLineGuideDistanceV.data,W=Y.x0,_=Y.y0;return[W-Zi,_,W+Zi,_]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:le},{type:"shape",points:{func:function(){var P=Nf.MoveLineGuideDistanceV.data,n=P.x1,R=P.y1;return[n-Zi,R,n+Zi,R]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:le},{type:"text",text:{func:function(){return Math.round(Nf.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var Y=Nf.MoveLineGuideDistanceV.data;return[[Y.x0-10,(Y.y0+Y.y1)/2],20,20]}},color:le,font:"12px Arial",align:"center"}]},_.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Nf.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var W=Nf.EdgeElevationGuide.data,E=W.x,b=W.y,Y=Zp.getStyle("curveElevationIntersectSize"),q=Zp.getStyle("curveElevationGuideShift");return E+=q[0],b+=q[1],[E-Y,b-Y,2*Y,2*Y]}}}]},_.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),_.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Nf.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Nf.ConnectGuide.data.rotation}},rect:{func:function(){var Y=Nf.ConnectGuide.data.connect;Y.x,Y.y;var M=Zp.getStyle("connectGuideIntersectSize");return[[Y.x,Y.y],2*M,2*M]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var P=Nf.ConnectGuide.data.cursorPos||Nf.ConnectGuide.data.connect,h=Zp.getStyle("connectGuideIntersectSize");return[[P.x,P.y],2*h-2,2*h-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var f=Nf.ConnectGuide.data.connect,g=Nf.ConnectGuide.data.cursorPos||f;return[f.x,f.y,f.x+.5*(g.x-f.x),f.y,g.x+.5*(f.x-g.x),g.y,g.x,g.y]}}}]},_.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),_.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Nf.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var g=Nf.ConnectGuideGarbage.data.hover;return g?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var C=Nf.ConnectGuideGarbage.data,t=Zp.getStyle("connectGuideGarbageIntersectsize");return C.hover&&(t+=5),[[C.x,C.y],2*t,2*t]}}}]};var ri=6;Nf.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Nf.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var o=Nf.ShapeActivingCtrl.data;return[o.point.x,o.point.y,o.c1.x,o.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Oi}}},{type:"shape",visible:{func:function(){return Nf.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var O=Nf.ShapeActivingCtrl.data;return[O.point.x,O.point.y,O.c2.x,O.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Oi
}}},{type:"shape",visible:{func:function(){return Nf.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var w=Nf.ShapeActivingCtrl.data.c1,c=w.x,G=w.y,i=ri/2;return"c1"===Nf.ShapeActivingCtrl.data.hl&&(i+=.5),[c-i,G-i,c-i,G+i,c+i,G+i,c+i,G-i]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Zp.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Nf.ShapeActivingCtrl.data.hl?Zp.getStyle("shapeCtrlPointHighlightBorder")||Oi:Zp.getStyle("shapeCtrlPointBorderColor")||Oi}}},{type:"shape",visible:{func:function(){return Nf.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var v=Nf.ShapeActivingCtrl.data.c2,g=v.x,r=v.y,e=ri/2;return"c2"===Nf.ShapeActivingCtrl.data.hl&&(e+=.5),[g-e,r-e,g-e,r+e,g+e,r+e,g+e,r-e]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Zp.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Nf.ShapeActivingCtrl.data.hl?Zp.getStyle("shapeCtrlPointHighlightBorder")||Oi:Zp.getStyle("shapeCtrlPointBorderColor")||Oi}}}]},Nf.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Oi}},rect:{func:function(){return[[Nf.RoundPoint.data.x,Nf.RoundPoint.data.y],sp,sp]}}}]},Nf.AttachPoint={comps:[{type:"rect",background:{func:function(){return Nf.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Oi}},rect:{func:function(){var m=Nf.AttachPoint.data.isAttach?sp+4:sp;return[[Nf.AttachPoint.data.x,Nf.AttachPoint.data.y],m,m]}}}]},Nf.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Nf.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Nf.SimpleRect.data.color||Oi}},rect:{func:function(){var H=Nf.SimpleRect.data;return[H.x,H.y,H.width,H.height]}}}]},_.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Nf.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var Z=Nf.MoveDummy.data;return[[Z.pos.x,Z.pos.y],2*Z.size,2*Z.size]}}}]},tn.Icons.DrawIcon=function(w,R,e,u){e.width=e.height=ul,e.data=u,Zp=w,_.Default.drawImage(R,e,0,0,ul,ul),Zp=B},tn.Icons.MapPoints=function(q,H){for(var Z=0,D=q.length;D>Z;Z++)q[Z]/=H},tn.roundTo=function(b,P,R){var H=Math.abs(b%P);return R>H||R>P-H?P*Math.round(b/P):b},tn.toFixed=function(w){return Math.round(100*w)/100},tn.getDataMatrix=function(B){if(B instanceof _.Shape){var g=new _.Math.Matrix2d,b=B.getPosition();return g.translate(-b.x,-b.y).scale(B.getScale().x,B.getScale().y).rotate(B.getRotation()).translate(b.x,b.y),g}return B.getMatrix?B.getMatrix():new _.Math.Matrix2d};var Yo=tn.Math.Curve=function(){this._curves=[]};Yo.prototype={},Yo.prototype.constructor=Yo,Yo.prototype.createFromHtShape=function(h,J,M){J instanceof _.List&&(J=J.toArray());var m,p,N,W,v,q,j,e=this,Y=null,y=null,P=0,C=tn.Math.Vector2,V=tn.Math.CubicBezier,d=function(S){return new C(h[S],h[S+1],M?M[S/2]:B)};for(p=0,N=J.length;N>p;p++){switch(W=J[p],v=null,W){case 1:y=d(P),Y=y,P+=2;break;case 2:m=d(P),P+=2,v=new V(y,y.clone(),m.clone(),m),y=m;break;case 3:q=d(P),m=d(P+2),P+=4,v=new V(y,q.clone().sub(y).multiplyScalar(2/3).add(y),q.clone().sub(m).multiplyScalar(2/3).add(m),m),y=m;break;case 4:q=d(P),j=d(P+2),m=d(P+4),P+=6,v=new V(y,q,j,m),y=m;break;case 5:if(!Y)break;v=new V(y,y.clone(),Y.clone(),Y),y=null,Y=null}v&&(v._index=e._curves.length,e._curves.push(v))}},Yo.prototype.checkPoint=function(f,A){var G,F,g,D,p,_=this,K=_._curves;for(G=0,F=K.length;F>G;G++)if(D=K[G],p=D.intersectRect(f,A,A),p.length)return g=0,p.forEach(function(l){g+=l.t}),g/=p.length,f=D.getPointAt(g),f.t=g,{bezier:D,intersection:f}},Yo.prototype.insertKnot=function(G,N){var v=G.insertKnot(N),X=this,w=X._curves;w.splice(G._index,1,v[0],v[1])},Yo.prototype._isCloseEnough=function(W,c){return Math.abs(W.x-c.x)<1e-6&&Math.abs(W.y-c.y)<1e-6},Yo.prototype._isSamePoint=function(g,Q){return g===Q},Yo.prototype.moveRealPoint=function(w,q){var C=this,k=C._curves,Z=q.clone().sub(w);k.forEach(function(m){var i=m._p1;m._p2,m._p3;var z=m._p4;C._isSamePoint(i,w)&&(m._p2.add(Z),m._p1=q),C._isSamePoint(z,w)&&(m._p3.add(Z),m._p4=q)})},Yo.prototype.moveCtrlDueToRealPointMovement=function(A,p){var X=this,V=X._curves,u=function(P){P.add(p),P.e&&p.e&&(P.e+=p.e)};V.forEach(function(F){var $=F._p1;F._p2,F._p3;var c=F._p4;X._isSamePoint($,A)&&u(F._p2),X._isSamePoint(c,A)&&u(F._p3)})},Yo.prototype.moveCtrlPoint=function(L,j,O){var f=L[O];if(f){f.e!==B&&(j.e=f.e);var e=this,x=e._curves;j.clone().sub(f),x.forEach(function(k){var W;"c2"===O?W="_p2":"c1"===O&&(W="_p3"),e._isSamePoint(k[W],f)&&(k[W]=j)}),L[O]=j}},Yo.prototype.deleteRealPoint=function(W,v){var E,b,p,M,x,o,A,J=this,Y=J._curves,I={},$=[],S=tn.Math.CubicBezier;for(b=0,p=Y.length;p>b;b++)E=Y[b],M=E._p1,x=E._p2,o=E._p3,A=E._p4,(I[b]||!J._isSamePoint(M,W))&&(J._isSamePoint(A,W)?p>b+1&&J._isSamePoint(Y[b+1]._p1,W)&&(v||$.push(new S(M,x,Y[b+1]._p3,Y[b+1]._p4))):$.push(E));J._curves=$},Yo.prototype.findPairs=function(p,$){var R,T,z,a,J,c,Y,D,d=this,i=d._curves,A={},I=[];for(T=0,z=i.length;z>T;T++)R=i[T],a=R._p1,J=R._p2,c=R._p3,Y=R._p4,!A[T]&&d._isSamePoint(a,p)&&($?I.push({point:a,r2:Y}):I.push({point:a,c2:J})),d._isSamePoint(Y,p)&&(D=$?{point:Y,r1:a}:{point:Y,c1:c},z>T+1&&d._isSamePoint(i[T+1]._p1,p)&&($?D.r2=i[T+1]._p4:D.c2=i[T+1]._p2,A[T+1]=!0),I.push(D));return I},Yo.prototype.toHtShape=function(){var Z=this,k=Z._curves,z=[],x=[],w={x:1/0,y:1/0};return k.forEach(function(l){var e=l._p1,F=l._p2,j=l._p3,i=l._p4;return Z._isCloseEnough(e,w)||(z.push(1),x.push(e.clone())),w=i,Z._isCloseEnough(e,F)&&Z._isCloseEnough(j,i)?(z.push(2),x.push(i.clone()),void 0):(z.push(4),x.push(F.clone(),j.clone(),i.clone()),void 0)}),{segments:z,points:x}};var _h=tn.Math.CubicBezier=function(T,I,e,F){var m=this;m._id=tn.Math.CubicBezier._globalId++,m._p1=T,m._p2=I,m._p3=e,m._p4=F};_h._globalId=1,_h.prototype={},_h.prototype.constructor=_h,_h.prototype.toString=function(){return this._id},_h.prototype.intersectRect=function(g,U,F){var q=U/2,b=F/2,y=g.x,A=g.y,V=tn.Math.Vector2,I=new V(-q+y,-b+A),c=new V(q+y,b+A),O=new V(c.x,I.y),n=new V(I.x,c.y),K=this,$=K.intersectLine(I,O),t=K.intersectLine(O,c),D=K.intersectLine(c,n),j=K.intersectLine(n,I),P=$.concat(t).concat(D).concat(j);return P},_h.prototype.intersectLine=function(F,o){var E,J,W,m,C,X,V,Q,s,$,A,u,I,L=this,h=F.clone().min(o),y=F.clone().max(o);m=L._p1,C=L._p2,X=L._p3,V=L._p4,E=m.clone().multiplyScalar(-1),J=C.clone().multiplyScalar(3),W=X.clone().multiplyScalar(-3),A=E.add(J).add(W).add(V),E=m.clone().multiplyScalar(3),J=C.clone().multiplyScalar(-6),W=X.clone().multiplyScalar(3),$=E.add(J).add(W),E=m.clone().multiplyScalar(-3),J=C.clone().multiplyScalar(3),s=E.add(J),Q=m.clone(),I=new tn.Math.Vector2(F.y-o.y,o.x-F.x),u=F.x*o.y-o.x*F.y;for(var S=L.getRoots(I.dot(A),I.dot($),I.dot(s),I.dot(Q)+u),G=new Array,K=0,H=S.length;H>K;K++){var T=S[K];if(!(0>T||T>1)){var R=L.getPointAt(T);R.t=T,F.x==o.x?h.y<=R.y&&R.y<=y.y&&G.push(R):F.y==o.y?h.x<=R.x&&R.x<=y.x&&G.push(R):R.x>=h.x&&R.y>=h.y&&R.x<=y.x&&R.y<=y.y&&G.push(R)}}return G},_h.prototype.solveTForPoint=function(L){var P,R,w,x,N=this;P=N._p1.x-L.x,R=N._p2.x-L.x,w=N._p3.x-L.x,x=N._p4.x-L.x;for(var A=N.getRoots(x-3*w+3*R-P,3*w-6*R+3*P,3*R-3*P,P),T=B,D=1/0,C=0,$=A.length;$>C;C++){var z=A[C];if(!(0>z||z>1)){var s=N.getPointAt(z);s.t=z;var H=Math.abs(s.y-L.y);D>H&&(D=H,T=s)}}return T},_h.prototype.getPointAt=function(A){var C=this,V=C._p1,Z=C._p2,x=C._p3,s=C._p4,z=V.clone().lerp(Z,A),k=Z.clone().lerp(x,A),D=x.clone().lerp(s,A),T=z.lerp(k,A),f=k.lerp(D,A);return T.lerp(f,A)},_h.prototype.getPointByPercentage=function(o){var q=this.length*o,R=this._cacheLength,a=R.length;if(0===q)return R[0].point;if(o>=1)return R[a-1].point;for(var y=0;a>y;y++){var T=R[y];if(!(T.len<q)){var e=R[y-1];return T.point.clone().sub(e.point).setLength(q-e.len).add(e.point)}}},_h.prototype.getTByPercentage=function(O){var X=this.length*O,w=this._cacheLength,i=w.length;if(0===X||0>=O)return w[0].t;if(O>=1)return w[i-1].t;for(var x=0;i>x;x++){var y=w[x];if(!(y.len<X)){var q=w[x-1];return(X-q.len)/(y.len-q.len)*(y.t-q.t)+q.t}}},_h.prototype.getRoots=function(w,d,x,n){var k,G,Q,q,u,$=new Array;if(Math.abs(w)<1e-6){var k=d,G=x/k,Q=n/k,q=G*G-4*Q;if(q>0){var u=Math.sqrt(q);$.push(.5*(-G+u)),$.push(.5*(-G-u))}else 0==q&&$.push(.5*-G)}d/=w,x/=w,n/=w,k=(3*x-d*d)/3,G=(2*d*d*d-9*x*d+27*n)/27;var W=d/3,j=G*G/4+k*k*k/27,C=G/2;if(Math.abs(j)<=1e-6&&(j=0),j>0){var V,L,u=Math.sqrt(j);V=-C+u,L=V>=0?Math.pow(V,1/3):-Math.pow(-V,1/3),V=-C-u,V>=0?L+=Math.pow(V,1/3):L-=Math.pow(-V,1/3),$.push(L-W)}else if(0>j){var i=Math.sqrt(-k/3),R=Math.atan2(Math.sqrt(-j),-C)/3,o=Math.cos(R),D=Math.sin(R),F=Math.sqrt(3);$.push(2*i*o-W),$.push(-i*(o+F*D)-W),$.push(-i*(o-F*D)-W)}else{var V;V=C>=0?-Math.pow(C,1/3):Math.pow(-C,1/3),$.push(2*V-W),$.push(-V-W)}return $},_h.prototype._70I=function(){var j=this;return j._p1.distanceToSquared(j._p2)<1e-10&&j._p3.distanceToSquared(j._p4)<1e-10},_h.prototype.insertKnot=function(T){var h=this,G=h._p1,n=h._p2,p=h._p3,v=h._p4,R=G.clone().lerp(n,T),b=n.clone().lerp(p,T),I=p.clone().lerp(v,T),i=R.clone().lerp(b,T),K=b.clone().lerp(I,T),s=i.clone().lerp(K,T);return h._70I()?(G.clone().lerp(v,T),[new tn.Math.CubicBezier(G,G.clone(),s.clone(),s),new tn.Math.CubicBezier(s,s.clone(),v.clone(),v)]):[new tn.Math.CubicBezier(G,R,i,s),new tn.Math.CubicBezier(s,K,I,v)]},S.defineProperties(_h.prototype,{length:{get:function(){var i=this._cacheLength;if(!i){i=this._cacheLength=[];for(var k=this._p1,s=0,x=0;1>=s;){var S=this.getPointAt(s+=.001);x+=S.clone().sub(k).length(),k=S,i.push({len:x,t:s,point:S.clone()})}}return i[i.length-1].len}},p1:{get:function(){return this._p1},set:function(l){this._p1=l,this._cacheLength=B}},p2:{get:function(){return this._p2},set:function(P){this._p2=P,this._cacheLength=B}},p3:{get:function(){return this._p3},set:function(f){this._p3=f,this._cacheLength=B}},p4:{get:function(){return this._p4},set:function(J){this._p4=J,this._cacheLength=B}}});var Im=_.Default.getInternal().ui().EdgeUI,bi={_47O:function(O){var q=this,F=bi.getBackups()._47O;tn.inEdit(q.gv)||F.call(q,O)}};tn.Inject.registAsModule(bi,Im);var Fb=_.Default.getInternal().ui().NodeUI,Kb={_47O:function(L){var i=this,$=Kb.getBackups()._47O;tn.inEdit(i.gv)||$.call(i,L)},getSelectWidth:function(){var R=this,e=R.gv,N=R._data;if(e.isEditable(N)&&tn.inEdit(e))return 0;var F=Kb.getBackup("getSelectWidth");return F.call(R)}};tn.Inject.registAsModule(Kb,Fb);var xf=_.graph.GraphView,cn={_editPointSize:function(){var $=_.Default.isTouchable,c=tn.getStyle("pointSize");return c[$?0:1]}(),isPointEditable:function(g){var r=this;if(tn.inEdit(r))return r._pointEditableFunc?r._pointEditableFunc(g):!0;var h=cn.getBackup("isPointEditable");h.call(r,g)},isEditable:function(C){var y,l=this,s=cn.getBackup("isEditable");if(y=C instanceof tn.Group?!0:s.call(l,C),!tn.inEdit(l))return y;if(!(C instanceof _.Edge))return y;if(!C.s("2d.editable"))return!1;var x=l.getEditableFunc();return x?x(C):!0},_42:function(J,u){var E=this,S=cn.getBackups()._42;if(S.call(E,J,u),tn.inEdit(E)){var g=E.getEditInteractor();g.drawImpl()}}};tn.Inject.registAsModule(cn,xf);var Tg=_.Default.getInternal().ui().ShapeUI,ip={_47O:function(s){var I=this,X=ip.getBackups()._47O;tn.inEdit(I.gv)||X.call(I,s)}};tn.Inject.registAsModule(ip,Tg);var cc=_.graph.DefaultInteractor,Ng={handle_mousewheel:function(u){var h=this,P=Ng.getBackup("handle_mousewheel");tn.inEdit(h.gv)||P.call(h,u)}};tn.Inject.registAsModule(Ng,cc);var zo=_.graph.MoveInteractor,ei={_calcShift:function(C,Z){var $=this,L=ei.getBackup("_calcShift"),z=$.gv;if(!tn.inEdit(z))return L.call($,C,Z);var P=z.getEditInteractor(),D=P.getSubModule("Move").calcShift(C,Z,$);return D||L.call($,C,Z)},clear:function($){var w=this,A=ei.getBackup("clear");A.call(w,$);var u=w.gv;if(tn.inEdit(u)){var d=u.getEditInteractor();d.getSubModule("Move").clear($)}}};tn.Inject.registAsModule(ei,zo);var Rg=tn.Rect=function(J){this.catalog="Rect",this._interactor=J};Rg.prototype={},Rg.prototype.constructor=Rg,Rg.prototype.gatherInfo=function(y,W){var L=this;if(1===W.length){var C=W[0];return C instanceof _.Shape&&C._70I()?L.gatherLine(y,C):Pc(C,y)?!1:L.gatherSingleTarget(y,C)}return W.length>1?L.gatherMultiTargets(y,W):!1},Rg.prototype.gatherSingleTarget=function(J,m){if(m.getCorners){var d,Y=this,T=Y.info;Y.target=m,d=Y.screenInfo={};var j=m.getCorners();T.LT=new tn.Math.Vector2(j[0]),T.LB=new tn.Math.Vector2(j[1]),T.RB=new tn.Math.Vector2(j[2]),T.RT=new tn.Math.Vector2(j[3]),T.T=T.LT.clone().add(T.RT).divideScalar(2),T.B=T.LB.clone().add(T.RB).divideScalar(2),T.L=T.LT.clone().add(T.LB).divideScalar(2),T.R=T.RT.clone().add(T.RB).divideScalar(2);for(var Z in T)d[Z]=tn.toScreenPosition(J,T[Z]);var U=Y._interactor,B=U.getStyle("checkSize"),k=function(y,q,K){var p=q.clone().sub(y).setLength(-B),O=K.clone().sub(y).setLength(-B),U=p.add(O).add(y);return U};return d.rotLT=k(d.LT,d.RT,d.LB),d.rotLB=k(d.LB,d.LT,d.RB),d.rotRB=k(d.RB,d.LB,d.RT),d.rotRT=k(d.RT,d.LT,d.RB),d.rotT=d.rotLT.clone().add(d.rotRT).divideScalar(2),d.rotB=d.rotLB.clone().add(d.rotRB).divideScalar(2),d.rotL=d.rotLT.clone().add(d.rotLB).divideScalar(2),d.rotR=d.rotRT.clone().add(d.rotRB).divideScalar(2),d.rotation=m.getRotation(),Y.gatherConnectInfo(),!0}},Rg.prototype.gatherConnectInfo=function(){var M=this,J=M.target,U=M._interactor,O=M.screenInfo,d=U.gv;if(d.isConnectActionVisible(J)&&U.getStyle("connectGuideVisible")){var V;J.s&&(V=J.s("connectGuideShift")),V||(V=U.getStyle("connectGuideShift"));var Z=J.getAnchor(),R=J.getSize(),t=J.toGlobal({x:R.width*(V[0]-Z.x),y:R.height*(V[1]-Z.y)});t=tn.toScreenPosition(d,t),O.P1?t.add(O.P2.clone().sub(O.P1).setLength(V[2])):(t.add(O.RT.clone().sub(O.LT).setLength(V[2])),t.add(O.LB.clone().sub(O.LT).setLength(V[3]))),O.connect=t}},Rg.prototype.gatherMultiTargets=function(P,H){var $=tn.Group.findOrCreateGroup(H,this._interactor._uuid);if(!$)return!1;var M=this;return M.editing&&"rotate"!==M.editing.mode||$.calcInfo(),M.gatherSingleTarget(P,$)},Rg.prototype.gatherLine=function(K,e){this.target=e;var M=this.screenInfo={},F=e.getPoints(),x=tn.getDataMatrix(e);return M.P1=tn.toScreenPosition(K,x.apply(F.get(0))),M.P2=tn.toScreenPosition(K,x.apply(F.get(1))),this.gatherConnectInfo(),!0},Rg.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Rg.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Rg.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Rg.prototype.check=function(s,J,C){if(_.Default.isLeftButton(J)){var K=this;if(K.editing=null,K.tipInfo=null,K.screenInfo){var n=K.target,O=s.isEditable(n),c=K.screenInfo;if(O&&c.connect){var v=K._checkConnect(C);if(v)return v}if(c.P1)return K._checkLine(C);var P,N,r,I=null,d=K._interactor,p=d.getStyle("checkSize");if(O&&s.isRectEditable(n))for(N=0;N<tn.Rect.ResizeKeys.length;N++)if(r=tn.Rect.ResizeKeys[N],tn.checkHit(C,c[r],p)){I=r,P="resize";break}if(!I&&O&&s.isRotationEditable(n)&&!d.getStyle("rotateAsClock")){var o=d.getStyle("rotateCheckSize");for(N=0;N<tn.Rect.RotateKeys.length;N++)if(r=tn.Rect.RotateKeys[N],tn.checkHit(C,c[r],o)){I=r,P="rotate";break}}if(!I)return d.setCursor("default"),void 0;if("rotate"===P){var U,k=s.lp(J);if(n instanceof tn.Group){var h=d.getStyle("groupRotateModeKey");"string"==typeof h&&(h=[h]);for(var G=!1,L=0,u=h.length;u>L;L++)if(J[h[L]]){G=!0;break}var m=d.getStyle("groupRotateModeDefault");U=G?"batch"===m?"block":"batch":m}var j="batch"===U?n.getAnchor2():n.getPosition(),y=Math.atan2(k.y-j.y,k.x-j.x);d._setRotateCursor(y),K.editing={mode:P,key:I,pos:j,flipY:n.getScale().y<0,rotation:n.getRotation(),hitRot:y},U&&(K.editing.groupRotateMode=U)}else{var a=tn.Rect.ResizeKeys.indexOf(I),f=tn.Rect.ResizeDirection[a],l=Math.cos(n.getRotation()),b=Math.sin(n.getRotation()),g=f.x*Math.sign(n.getScale().x),H=f.y*Math.sign(n.getScale().y),x=Math.atan2(-b*g-l*H,l*g-b*H),F=(Math.round(x/(Math.PI/4))+8)%8,i=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][F];this._interactor.setCursor(i);var z=n.getWidth(),Z=n.getHeight(),Y=n.getAnchor();K.editing={mode:P,key:I,rect:{x:-z*Y.x,y:-Z*Y.y,width:z,height:Z},anchor:Y,matrix:n.getMatrix()}}return I}}},Rg.prototype._checkLine=function(C){var q=this;q.screenInfo;var g,S=q._interactor.getStyle("checkSize");if(tn.checkHit(C,q.screenInfo.P1,S))g="P1";else{if(!tn.checkHit(C,q.screenInfo.P2,S))return this._interactor.setCursor("default"),void 0;g="P2"}return q.editing={mode:"line",key:g},g},Rg.prototype._checkConnect=function(i){var r=this,u=r.screenInfo,E=r._interactor,V=E.getStyle("connectGuideIntersectSize"),N=u.connect,K=i.x,f=N.x;if(f>K&&V>f-K&&Math.abs(N.y-i.y)<V||K>=f&&tn.checkHit(i,N,V)){var h="connect",o=m.getConnectAction(E.gv);if(r.editing={mode:h},o&&o.delete)if(r.target instanceof tn.Group){var Q=!0;E.gv.sm().getSelection().each(function(J){o.delete.visible.call(null,E.gv,J)||(Q=!1)}),r.editing.hasDeleteAction=Q}else o.delete.visible.call(null,E.gv,r.target)&&(r.editing.hasDeleteAction=!0);return E.setCursor("default"),h}},Rg.prototype._fireEditEvent=function(c,T){var t=this._interactor,J=this.editing;if(J){var D=J.mode;D="rotate"===D?"Rotation":"connect"===D?"Connection":"resize"===D?"Rect":D[0].toUpperCase()+D.slice(1),t.fi({kind:c+"Edit"+D,event:T})}},Rg.prototype.startEdit=function(X,d){X.startDragging(d);var W=this;W._interactor.fi({kind:"prepareEdit",event:d});var p=W.editing,n=W.target;if(p){if(W._fireEditEvent("begin",d),p.started=!0,"rotate"===p.mode)return p.groupRotateMode&&n.beginRotate(p),X._42(),void 0;if("connect"!==p.mode)("line"===p.mode||n&&0===n.getRotation())&&(W._inSmartGuide=!0,W._interactor.rectGuide.gatherRects());else if(p.hasDeleteAction){var c=X.gv,H=W._interactor.getStyle("connectGuideGarbageShift");p.garbageInfo={x:c.getWidth()*H[0]+H[2],y:c.getHeight()*H[1]+H[3],size:W._interactor.getStyle("connectGuideGarbageIntersectsize")},X._42()}}},Rg.prototype._46O=function(R){var M,F,d=this,g=d.editing,Y=d.target;if(g){if("connect"===g.mode&&!g.canceled&&!g.deleted)try{g.garbageInfo&&g.garbageInfo.hover?m.doDeleteConnectionAction(d._interactor.gv,Y):m.doConnectAction(d._interactor.gv,Y,g.target)}catch(a){console.error(a)}F=g.freezeFlag,M=d.editing.groupRotateMode,d._fireEditEvent("end",R),d.editing=null}d.tipInfo=null,d._inSmartGuide&&(d._interactor.rectGuide.clear(),d._inSmartGuide=!1),M&&Y&&Y.endRotate(),Y instanceof _.Block&&(F===B?delete Y._freezeSyncFromChildren:Y._freezeSyncFromChildren=F,Y.updateFromChildren())},Rg.prototype.handleNormalStateDelete=function(){var R=this,k=R.editing;if(k&&"connect"===k.mode&&!k.canceled&&!k.deleted){if(k.garbageInfo){try{m.doDeleteConnectionAction(R._interactor.gv,R.target)}catch(F){console.error(F)}k.garbageInfo=null}return k.cursorPos=null,k.targetCorners=null,k.deleted=!0,R._interactor._42(),!0}},Rg.prototype.handleNormalStateKeyDown=function(f){var O=this,r=O.editing;return!r||"connect"!==r.mode||r.canceled||r.deleted?void 0:_.Default.isEsc(f)?(r.cursorPos=null,r.targetCorners=null,r.canceled=!0,O._interactor._42(),!0):void 0},Rg.prototype.handleEdit=function(r,H){var W=this,j=W.editing;if(j){var m,T,D,n,Z,Q=W.target,O=j.key,z=j.mode,A=r.lp(H),b=W._interactor;if("connect"===z){if(j.canceled)return;if(j.deleted)return;j.cursorPos=b._getLogicalPoint(H);var R=j.garbageInfo;return R&&tn.checkHit(j.cursorPos,R,R.size)?(R.hover=!0,j.target=null,j.targetCorners=null):(R&&(R.hover=!1),j.target=r.getDataAt(A,function(g){return r.isSelectable(g)?Dk(g)?!0:!1:!1})||null,j.targetCorners=tn.getTargetCornersOnScreen(r,j.target)),b._42(),void 0}if("rotate"===z){var U,a,L=j.pos,e=Math.atan2(A.y-L.y,A.x-L.x);if(j.groupRotateMode?a=e-j.hitRot:(U=e-j.hitRot,a=j.rotation+U),a%=2*Math.PI,0>a&&(a+=2*Math.PI),!_.Default.isCtrlDown(H)){var J,s;Vn(H)?(J=b.getStyle("shiftRotateRound"),s=J/2):(J=b.getStyle("rotateRound"),s=b.getStyle("rotateSensitivity")),a=tn.roundTo(a,J,s)}j.groupRotateMode?(U=a-(j.lastRotation||0),0!==U&&(Q.addRotation(U,j.groupRotateMode,function(X){return r.isRotationEditable(X)}),j.lastRotation=a)):Q.setRotation(a),b._setRotateCursor(e),a>Math.PI&&(a-=2*Math.PI);var $=180*(a/Math.PI);$=$.toFixed(2),m=""+$+""}else if("resize"===z){var K=j.rect;D=K.x,n=K.y;var d,u=K.width,P=K.height,i=j.anchor,v=j.matrix,E=Q.s&&Q.s("keepAspectRatio")||b.getStyle("keepAspectRatio");Vn(H)&&(E=!E);var x=W._unionPointMode1,q=W._unionPointMode2;if(W._inSmartGuide&&!_.Default.isCtrlDown(H)&&!E){var y;"L"===O||"R"===O?y="x":("T"===O||"B"===O)&&(y="y"),W._adsorbedToClosest(A,y),Z=!0}d=v.tfi(A);var I;"LT"===O?(K=x(d,{x:D+u,y:n+P},u,P,E),I=9):"T"===O?(K=q({x:D,y:d.y},{x:D+u,y:n+P},u,P,E,"v"),I=1):"RT"===O?(K=x(d,{x:D,y:n+P},u,P,E),I=33):"L"===O?(K=q({x:d.x,y:n},{x:D+u,y:n+P},u,P,E,"h"),I=8):"R"===O?(K=q({x:D,y:n},{x:d.x,y:n+P},u,P,E,"h"),I=32):"LB"===O?(K=x(d,{x:D+u,y:n},u,P,E),I=12):"B"===O?(K=q({x:D,y:n},{x:D+u,y:d.y},u,P,E,"v"),I=4):"RB"===O&&(K=x(d,{x:D,y:n},u,P,E),I=36);var X=v.tf(K.x+K.width*i.x,K.y+K.height*i.y);Q instanceof _.Block&&(j.hasOwnProperty("freezeFlag")||(j.freezeFlag=Q._freezeSyncFromChildren,Q._freezeSyncFromChildren=!0)),Q.setPosition(X),Q.setSize(K.width,K.height),Z&&(T=Q.getRect(),b.rectGuide.gatherLines({node:Q,x:T.x,y:T.y,w:T.width,h:T.height},y,I)),m=""+Math.round(K.width)+" * "+Math.round(K.height)}else if("line"===z){if(Vn(H)){var l=Q.getPoints(),k="P1"===O?l.get(1):l.get(0),B={x:A.x-k.x,y:A.y-k.y},C=b.getStyle("shiftLineRotateRound"),t=W._shiftDirList;if(!t||W._shiftRotateRound!==C){W._shiftRotateRound=C,W._shiftDirList=t=[];for(var S=0;S<Math.PI;S+=C)t.push({x:N(S),y:c(S)})}for(var M,w=0,V=0,G=t.length;G>V;V++){var Y=t[V],g=Y.x*B.x+Y.y*B.y;Math.abs(g)>Math.abs(w)&&(w=g,M=Y)}A={x:k.x+M.x*w,y:k.y+M.y*w},b.rectGuide.clear()}else W._inSmartGuide&&!_.Default.isCtrlDown(H)&&(W._adsorbedToClosest(A),Z=!0);var f=tn.getDataMatrix(Q).applyInverse(A);Q.setPoint("P1"===O?0:1,f,!0);var o=Q.getPoints(),h=o.get(0),F=o.get(1);D=h.x-F.x,n=h.y-F.y,m=" "+Math.round(Math.sqrt(D*D+n*n))+" ",Z&&(T=Q.getRect(),b.rectGuide.gatherLines({node:Q,x:T.x,y:T.y,w:T.width,h:T.height}))}if(m){var p=_.Default.getLogicalPoint(H,b._canvas);p.x+=tn.Icons.TipShiftX,p.y+=tn.Icons.TipShiftY,W.tipInfo={helperPos:p,text:m,size:m.length}}W._fireEditEvent("between",H)}},Rg.prototype._unionPointMode1=function(o,u,j,c,U){if(U&&j&&c){var T=o.x-u.x,$=o.y-u.y;Math.abs(T*c)<Math.abs($*j)?($=Math.sign($)*Math.abs(T*c/j),o.y=u.y+$):(T=Math.sign(T)*Math.abs($*j/c),o.x=u.x+T)}return _.Default.unionPoint(o,u)},Rg.prototype._unionPointMode2=function(J,i,b,O,q,m){var I=_.Default.unionPoint(J,i);if(q&&b&&O){var f;"v"===m?(f=I.x+I.width/2,I.width=b*I.height/O,I.x=f-I.width/2):(f=I.y+I.height/2,I.height=O*I.width/b,I.y=f-I.height/2)}return I},Rg.prototype._adsorbedToClosest=function(n,f){var d=this,C=d._interactor,R=C.rectGuide.findClosest(n,f),Y=C.gridGuide.findClosest(n,f),q=1/0,c=1/0;R&&(isFinite(R.x)&&(q=R.x),isFinite(R.y)&&(c=R.y)),Y&&(isFinite(Y.x)&&Math.abs(Y.x)<Math.abs(q)&&(q=Y.x),isFinite(Y.y)&&Math.abs(Y.y)<Math.abs(c)&&(c=Y.y)),isFinite(q)&&(n.x+=q),isFinite(c)&&(n.y+=c)},Rg.prototype._42=function(N,D,G){var Z=this;Z.info={},Z.screenInfo=null;var r=Z._interactor;if(!r.editDetail&&Z.gatherInfo(D,G)){var i=Z.editing,E=i?i.groupRotateMode:null,B=Z.screenInfo;if("block"!==E||!i||!i.started){if(B.P1?tn.Icons.DrawIcon(r,N,tn.Icons.Line,B):tn.Icons.DrawIcon(r,N,tn.Icons.Rect,B),B.connect&&(tn.Icons.DrawIcon(r,N,tn.Icons.ConnectGuide,{rotation:B.rotation,connect:B.connect,cursorPos:i?i.cursorPos:null}),i)){if(i.targetCorners){for(var l={x:1/0,y:1/0},m={x:-1/0,y:-1/0},K=0,C=i.targetCorners.length;C>K;K+=2)l.x=Math.min(l.x,i.targetCorners[K]),m.x=Math.max(m.x,i.targetCorners[K]),l.y=Math.min(l.y,i.targetCorners[K+1]),m.y=Math.max(m.y,i.targetCorners[K+1]);tn.Icons.DrawIcon(r,N,tn.Icons.HoverDataRect,{min:l,max:m,color:r.getStyle("hoverGuideColor")||r.getStyle("baseColor")})}i.garbageInfo&&tn.Icons.DrawIcon(r,N,tn.Icons.ConnectGuideGarbage,i.garbageInfo)}r.getStyle("rotateTipVisible")&&Z.tipInfo&&tn.Icons.DrawIcon(r,N,tn.Icons.TipHelper,Z.tipInfo)}Z.target instanceof tn.Group&&Z.target._42(r,N,D)}};var ci=tn.Anchor=function(U){this.catalog="Anchor",this._interactor=U};ci.prototype={},ci.prototype.constructor=ci,ci.prototype.gatherInfo=function(a,N){var U=this;if(1===N.length){var W=N[0];if(!W.getAnchor)return;if(W instanceof _.Shape&&W._70I())return;if(Pc(W,a))return;return U.gatherSingleTarget(a,N[0])}return N.length>1?U.gatherMultiTargets(a,N):!1},ci.prototype.gatherSingleTarget=function(g,Y){var o=this;return o.info.POS=Y.getPosition(),o.screenInfo.POS=tn.toScreenPosition(g,o.info.POS),o.target=Y,!0},ci.prototype.gatherMultiTargets=function(O,N){var R=this,k=tn.Group.findOrCreateGroup(N,this._interactor._uuid);return k?(R.screenInfo.POS=tn.toScreenPosition(O,k.getAnchor2()),R.target=k,!0):!1},ci.prototype.isVisible=function(){var W=this,m=W._interactor;if(m.getStyle("anchorVisible")===!1)return!1;var Z=W.target;if(Z){if(this.editing)return!0;var S=Z.getAnchor(),q=m.getStyle("anchorOutsideVisibleThreshold");if(S.x<-q||S.x>1+q||S.y<-q||S.y>1+q)return!0;var j=Z.getSize(),s=Z.getScale(),y=Math.min(Math.abs(j.width*s.x),Math.abs(j.height*s.y));if(y*m.gv._zoom<m.getStyle("anchorHideThreshold"))return!1}return!0},ci.prototype.check=function(Y,D,m){if(_.Default.isLeftButton(D)){var v=this,Z=v._interactor;if(v.isVisible()&&Z.getStyle("anchorMovable")!==!1){v.editing=null,v.tipInfo=null;var c=v.target;if(c&&Y.isAnchorEditable(c)&&Y.isEditable(c)){var r;if(v.screenInfo&&(r=v.screenInfo.POS)&&tn.checkHit(m,new tn.Math.Vector2(r),Z.getStyle("checkSize"))){if(c instanceof tn.Group)return v.editing={},!0;var I=c.getWidth(),A=c.getHeight(),O=c.getAnchor();return v.editing={rect:{x:-I*O.x,y:-A*O.y,width:I,height:A},anchor:O,matrix:c.getMatrix()},!0}}}}},ci.prototype.startEdit=function(_,r){_.startDragging(r),_.fi({kind:"beginEditAnchor",event:r})},ci.prototype._46O=function(A){var p=this;p.editing&&(p.editing=null,p._interactor.fi({kind:"endEditAnchor",event:A})),p.tipInfo=null},ci.prototype.handleEdit=function(z,c){var R=this,U=R.target;if(U){var Q=R.editing;if(Q){var e=z.lp(c),n=R._interactor;if(U instanceof tn.Group)return U.setAnchor2(e),n._42(),void 0;var o=Q.matrix,B=o.tfi(e),Y=Q.rect,S=(B.x-Y.x)/Y.width,N=(B.y-Y.y)/Y.height;if(!_.Default.isCtrlDown(c)){var F=n.getStyle("anchorRound"),E=n.getStyle("anchorSensitivity");S=tn.roundTo(S,F,E),N=tn.roundTo(N,F,E)}U.setAnchor(S,N,!0);var j=_.Default.getLogicalPoint(c,n._canvas);j.x+=tn.Icons.TipShiftX,j.y+=tn.Icons.TipShiftY;var v=""+S.toFixed(2)+", "+N.toFixed(2);R.tipInfo={helperPos:j,text:v,size:v.length},n.fi({kind:"betweenEditAnchor",event:c})}}},ci.prototype._42=function(q,y,W){var z=this;z.info={},z.screenInfo={};var s=z._interactor;s.editDetail||z.gatherInfo(y,W)&&z.isVisible()&&(tn.Icons.DrawIcon(s,q,tn.Icons.Anchor,z.screenInfo),z.tipInfo&&tn.Icons.DrawIcon(s,q,tn.Icons.TipHelper,z.tipInfo))};var Wg=tn.MoveDummy=function(x){this.catalog="MoveDummy",this._interactor=x};Wg.prototype={},Wg.prototype.constructor=Wg,Wg.prototype.gatherInfo=function(){var M=this,W=this._interactor.getSubModule("Rect");if(W){var Z=W.screenInfo;if(Z){var P=M._interactor,u=M.getMovableTarget(W.target);if(u){var X=P.getStyle("moveDummyThreshold");if(X!==!1){var $=Z.LT||Z.P1,l=Z.RT||Z.P2,q=Z.LB||$;if($){var D=Z.P1,z=Math.min($.distanceTo(q),$.distanceTo(l));if(!(X!==!0&&z>X)){var I=P.getStyle("moveDummyPosition"),v=l.clone().sub($),f=q.clone().sub($),n=I[2],p=I[3];if(D){var C=P.getStyle("moveDummyLineExtraShift");C&&(n+=C[0],p+=C[1])}var g=$.clone().add(v.clone().multiplyScalar(I[0])).add(v.setLength(n)).add(f.clone().multiplyScalar(I[1])).add(f.setLength(p));return M.screenInfo.pos=g,M.screenInfo.size=P.getStyle("moveDummySensitivity"),!0}}}}}}},Wg.prototype.getMovableTarget=function(r){var d=this._interactor.gv;if(Dk(r)){if(d.isMovable(r))return r}else if(r instanceof tn.Group)for(var j=r._entities,K=j.length-1;K>=0;K--){var q=j[K];if(Dk(q)&&d.isMovable(q))return q}return null},Wg.prototype.getMoveInteractor=function(){for(var B,U,J,M=this._interactor.gv,j=M.getInteractors(),B=0,U=j.length;U>B;B++)if(J=j.get(B),J instanceof zo)return J},Wg.prototype.startEdit=function(K,i){K.startDragging(i);var O=this.getMoveInteractor();if(O){var W=this.selectedTarget,X=K.gv;X._moving=1,O._data=W,X.handleMouseDown&&X.handleMouseDown(i,W)}},Wg.prototype._46O=function(y){var b=this,$=b.getMoveInteractor();$&&($.handleWindowMouseUp(y),b.selectedTarget=null)},Wg.prototype.handleEdit=function(H,A){var j=this.getMoveInteractor();j&&j.handleWindowMouseMove(A)},Wg.prototype.check=function(B,Q,E){if(this.selectedTarget=null,_.Default.isLeftButton(Q)&&!B._scrolling&&!sc()){var z=this;if(z.screenInfo){var N=z.screenInfo.pos;if(N&&!(E.distanceTo(N)>z.screenInfo.size)){var i=z._interactor;return z.selectedTarget=z.getMovableTarget(i.getSubModule("Rect").target),i.setCursor("default"),!0}}}},Wg.prototype._42=function(I,v,o){var K=this;K.screenInfo={};var L=K._interactor;L.editDetail||K.gatherInfo(v,o)&&(!L.editing||K.selectedTarget)&&tn.Icons.DrawIcon(L,I,tn.Icons.MoveDummy,K.screenInfo)};var dr=tn.RotateX=function(g){this.catalog="RotateX",this._interactor=g};dr.prototype={},dr.prototype.constructor=dr,dr.prototype.gatherInfo=function(W,e){var U=this;if(1===e.length){var T=e[0];return T instanceof _.Shape&&T._70I()||Pc(T,W)?!1:U.gatherSingleTarget(W,T)
}return e.length>1?U.gatherMultiTargets(W,e):!1},dr.prototype.gatherSingleTarget=function(){var g=new _.Math.Vector2,t=new _.Math.Vector2,z=new _.Math.Vector2,A=new _.Math.Vector2,d=function(q,_){var c=q.x-_.x,w=q.y-_.y;return c*c+w*w};return function(o,j){if(j.getCorners){var u=this,D=j.getCorners(),M=15,W=j.getPosition();g.copy(D[0]),z.copy(D[1]),A.copy(D[3]),t.copy(g).add(A).divideScalar(2).add(g.sub(z).setLength(M/o.getZoom()));var B=Math.max(d(W,D[0]),d(W,D[1]),d(W,D[2]),d(W,D[3]));return u.info.POS=t.clone(),u.screenInfo.POS=tn.toScreenPosition(o,u.info.POS),u.screenInfo.LEN=Math.sqrt(B)*o.getZoom()+M,u.screenInfo.CENTER=tn.toScreenPosition(o,W),u.target=j,!0}}}(),dr.prototype.gatherMultiTargets=function(G,q){var Z=this,f=tn.Group.findOrCreateGroup(q,this._interactor._uuid);if(!f)return!1;var Z=this;return Z.gatherSingleTarget(G,f)},dr.prototype.isVisible=function(){var s=this._interactor;if(!s.getStyle("rotateAsClock"))return!1;var S=this.target;if(!S)return!0;var I=s.gv;return I.isEditable(S)&&I.isRotationEditable(S)?!0:!1},dr.prototype.check=function(C,Z,A){var g=this,c=g._checkImpl(C,Z,A);return(c||g._clockPainted)&&g._interactor._42(),c},dr.prototype._checkImpl=function(c,C,Q){if(_.Default.isLeftButton(C)){var f=this;f.editing=null,f.tipInfo=null;var v;if(f.screenInfo&&(v=f.screenInfo.POS)&&f.isVisible()){var i=f._interactor;if(tn.checkHit(Q,v,i.getStyle("checkSize"))){var y=f.target,d=c.lp(C),n=y.getPosition(),s=Math.atan2(d.y-n.y,d.x-n.x);return i._setRotateCursor(s),f.editing={pos:n,rotation:y.getRotation(),hitRot:s,groupRotateMode:"block",screenInfo:{CENTER:f.screenInfo.CENTER,LEN:f.screenInfo.LEN}},!0}}}},dr.prototype.startEdit=function(c,u){c.startDragging(u),c.fi({kind:"beginEditRotation",event:u}),this.target instanceof tn.Group&&this.target.beginRotate(this.editing)},dr.prototype._46O=function(w){var m=this;m.editing&&(m.editing=null,m._interactor.fi({kind:"endEditRotation",event:w})),m.target instanceof tn.Group&&m.target.endRotate(),m.tipInfo=null},dr.prototype.handleEdit=function(e,E){var g=this,I=g.editing;if(I){var Q,K,v=g.target,D=e.lp(E),w=g._interactor,n=I.pos,y=Math.atan2(D.y-n.y,D.x-n.x),s=v instanceof tn.Group;if(s?K=y-I.hitRot:(Q=y-I.hitRot,K=I.rotation+Q),K%=2*Math.PI,0>K&&(K+=2*Math.PI),!_.Default.isCtrlDown(E)){var R,O;Vn(E)?(R=w.getStyle("shiftRotateRound"),O=R/2):(R=w.getStyle("rotateRound"),O=w.getStyle("rotateSensitivity")),K=tn.roundTo(K,R,O)}s?(Q=K-(I.lastRotation||0),0!==Q&&(v.addRotation(Q,I.groupRotateMode,function(E){return e.isRotationEditable(E)}),I.lastRotation=K)):v.setRotation(K),w._setRotateCursor(y),K>Math.PI&&(K-=2*Math.PI);var F=180*(K/Math.PI),Y=""+F.toFixed(2)+"",c=_.Default.getLogicalPoint(E,w._canvas);c.x+=tn.Icons.TipShiftX,c.y+=tn.Icons.TipShiftY,g.tipInfo={helperPos:c,text:Y,size:Y.length},w.fi({kind:"betweenEditRotation",event:E})}},dr.prototype._42=function(U,_,H){var t=this;t._clockPainted=!1,t.info={},t.screenInfo={};var R=t._interactor;R.editDetail||t.gatherInfo(_,H)&&t.isVisible()&&(tn.Icons.DrawIcon(R,U,tn.Icons.RoundPoint,t.screenInfo.POS),R.getStyle("rotateTipVisible")&&t.tipInfo&&tn.Icons.DrawIcon(R,U,tn.Icons.TipHelper,t.tipInfo),t.editing&&t.drawClock(U))},dr.prototype.drawClock=function(k){k.save();var m=this;m._clockPainted=!0;var l=m.editing||{},z=l.screenInfo||m.screenInfo,H=z.LEN,J=H+8,K=H+18;k.save(),k.translate(z.CENTER.x,z.CENTER.y),k.beginPath(),k.strokeStyle="rgb(150, 150, 150)";for(var w,e,y,B,R,d=0;360>d;d++)w=d*Math.PI/180,0===d%5&&(e=c(w)*H,y=N(w)*H,B=c(w)*J,R=N(w)*J,k.moveTo(e,y),k.lineTo(B,R)),0===d%45&&(e=c(w)*H,y=N(w)*H,B=c(w)*K,R=N(w)*K,k.moveTo(e,y),k.lineTo(B,R));k.stroke(),k.rotate(-Yp);var q=l.lastRotation||m.target.getRotation();k.beginPath(),k.fillStyle="rgba(255, 0, 0, 0.1)",k.strokeStyle="rgb(157, 157, 157)",k.moveTo(0,0),k.arc(0,0,K,0,q,!1),k.fill(),k.beginPath(),k.moveTo(0+K,0),k.arc(0,0,K,0,q,!1),k.stroke(),k.restore()};var Yo=tn.Curve=function(u){this.catalog="Curve",this._interactor=u};Yo.prototype={},Yo.prototype.constructor=Yo,S.defineProperties(Yo.prototype,{activing:{get:function(){return this._activing},set:function(b){var k=this;if(b)k._activing=new tn.CurveActiving(this,b),k.gatherSingleTarget(k._interactor.gv,k.target);else{var R=k._activing;R&&R.dispose(),k._activing=null}}}}),Yo.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Yo.prototype.setUp=function(){var n=this,w=n._interactor;w&&w.gv.mp(n._onGraphviewPropertyChanged,n)},Yo.prototype._onGraphviewPropertyChanged=function(O){("zoom"===O.property||"translateX"===O.property||"translateY"===O.property)&&this._handleDataChanged()},Yo.prototype.tearDown=function(){var j=this,F=j._interactor;F&&F.gv.ump(j._onGraphviewPropertyChanged,j)},Yo.prototype.canEnterEditDetailMode=function(){var q=qi(this._interactor);return q?this.target=q:void 0},Yo.prototype.canQuitEditDetailMode=function(T){var M=this,z=M._interactor._getLogicalPoint(T);return M._checkEditRealPoint(z)?void 0:M._interactor.gv.getDataAt(T)!==M.target?!0:void 0},Yo.prototype.preHandleScroll=function(){var Y=this.editing;return Y&&Y.inEdit?!0:void 0},Yo.prototype.getCurrentSelectintStatus=function(){var s=this;if(s.activing&&!s.activing.selections){if(s.activing.status!=B)return s.activing.status;var G=function(R){var M=s.activing.status;s.activing.status=R,s._interactor.fp("shapePointStatus",M,R)},R=tn.Curve.PointType,Y=s.activing.point,$=s.activing.pairs;if(!$||1!==$.length)return G(R.Mirrored);var X=$[0],m=X.c1&&X.c1.isNearEnough(Y),g=X.c2&&X.c2.isNearEnough(Y);if(!X.c1||!X.c2)return m||g?G(R.Straight):G(R.Disconnected);if(m&&g)return G(R.Straight);if(m||g)return G(R.Asymmetric);var C=X.c1.clone().sub(Y),P=X.c2.clone().sub(Y);return Math.abs(C.x*P.y-C.y*P.x)>1e-5||C.x*P.x>0?G(R.Disconnected):Math.abs(C.length()-P.length())>1e-5?G(R.Asymmetric):G(R.Mirrored)}},Yo.prototype.handle_keydown=function(j){var z=this;if(z._interactor.editDetail){var K=tn.Curve.PointType;"1"===j.key?z._setCurrentSelectionStatus(K.Straight):"2"===j.key?z._setCurrentSelectionStatus(K.Mirrored):"3"===j.key?z._setCurrentSelectionStatus(K.Disconnected):"4"===j.key&&z._setCurrentSelectionStatus(K.Asymmetric)}},Yo.prototype.setCurrentSelectionStatus=function(j){var P=this,o=P._interactor;if(o){var R=o.gv;R.dm().beginTransaction(),this._setCurrentSelectionStatus(j),R.dm().endTransaction()}},Yo.prototype._setCurrentSelectionStatus=function(N){var b=this,T=b.activing;if(T){var j=b.getCurrentSelectintStatus();if(null!==j&&j!==N){T.status=N;var a=b.activing.point,H=b.activing.pairs;if(H&&1===H.length){var X=H[0],y=b.screenInfo.curve,h=tn.Curve.PointType,t=b._interactor,U=function(){b._writeToHt(),t.fp("shapePointStatus",j,N),b.check(t.gv,null,new tn.Math.Vector2(t._lastLogicalPoint))};if(N===h.Straight)return y.moveCtrlPoint(X,a,"c1"),y.moveCtrlPoint(X,a,"c2"),U(),void 0;if(j===h.Straight){var W=y.findPairs(a,!0),A=W[0],V=A.r1||a,J=A.r2||a,M=J.clone().sub(V).multiplyScalar(.25);return y.moveCtrlPoint(X,a.clone().sub(M),"c1"),y.moveCtrlPoint(X,a.clone().add(M),"c2"),U(),void 0}var u=X.c1,S=X.c2;if(u&&S){if(N===h.Mirrored)return y.moveCtrlPoint(X,a.clone().multiplyScalar(2).sub(S),"c1"),U(),void 0;if(N===h.Asymmetric&&j===h.Disconnected){var m=u.clone().sub(a).length(),M=a.clone().sub(S).setLength(m).add(a);return y.moveCtrlPoint(X,M,"c1"),U(),void 0}}T._firePointChange(),t.fp("shapePointStatus",j,N),b.check(t.gv,null,new tn.Math.Vector2(t._lastLogicalPoint))}}}},Yo.prototype._handleDataChanged=function(){var N="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(j){var q=this;if(q.screenInfo&&q.target){if(j&&N.indexOf(j.property)<0)return;var z=q._interactor;q.gatherSingleTarget(z.gv,q.target,!0),q.check(z.gv,null,new tn.Math.Vector2(z._lastLogicalPoint)),z._42()}}}(),Yo.prototype.gatherSingleTarget=function(u,b,T){var c,R,e=this;e.screenInfo&&e.screenInfo.curve&&(R=e.screenInfo.curve._curves);var A=e.editing;c=A?e.screenInfo:e.screenInfo={};var O,I,Q=b instanceof _.Edge;Q?(O=b.s("edge.segments"),I=b.s("edge.points")||new _.List):(O=b._58O,I=b._59O),c.S=O;var C,i=c.P=[],j=tn.getDataMatrix(b);if(b instanceof _.Polyline||b instanceof _.Edge&&e._interactor.getStyle("edgeElevationEditable"))C=b.getElevation&&b.getElevation()||0,c.E=[];else{var X=!1;I.each(function(E){E.e!==B&&(X=!0)}),X&&(c.E=[])}if(I.each(function(S){c.E&&c.E.push(S.e!=B?S.e:C),S=j.apply(S);var _=tn.toScreenPosition(u,S);i.push(_.x,_.y)}),Q){var P=i.length,V=tn.toScreenPosition(u,b._lastSourcePoint||(P?{x:i[0],y:i[1]}:{x:0,y:0})),v=tn.toScreenPosition(u,b._lastTargetPoint||(P?{x:i[P-2],y:i[P-1]}:{x:0,y:0}));if(i.splice(0,0,V.x,V.y),i.push(v.x,v.y),c.E){var F=b.getSourceAgent();F instanceof _.Edge?c.E.splice(0,0,b.s("edge.source.offset.elevation")):c.E.splice(0,0,((b.s("edge.source.anchor.elevation")||.5)-.5)*F.getTall()*F.getScaleTall()+F.getElevation()+b.s("edge.source.offset.elevation"));var W=b.getTargetAgent();W instanceof _.Edge?c.E.push(b.s("edge.target.offset.elevation")):c.E.push(((b.s("edge.target.anchor.elevation")||.5)-.5)*W.getTall()*W.getScaleTall()+W.getElevation()+b.s("edge.target.offset.elevation"))}}if(!c.S||!c.S.size()){c.S=new _.List,c.S.add(1);for(var D=0;D<i.length/2-1;D++)c.S.add(2)}if((!A||T)&&e.convertToCubicBezier(R),e.activing&&(T||!e.editing||"realPoint"===e.editing.type)){var Z=c.curve.findPairs(e.activing.point);e.activing.pairs=Z}},Yo.prototype._convertToNewPoint=function(h,c,T,H){var q,Q,e;for(q=0,Q=c.length;Q>q;q++){if(e=c[q],e._p1.isNearEnough(h)&&(!H||H.indexOf(e._p1)<0))return e._p1;if(e._p4.isNearEnough(h)&&(!H||H.indexOf(e._p4)<0))return e._p4}if(T)for(q=0,Q=Math.min(T.length,Q);Q>q;q++){if(e=T[q],e._p1===h&&(!H||H.indexOf(c[q]._p1)<0))return c[q]._p1;if(e._p4===h&&(!H||H.indexOf(c[q]._p4)<0))return c[q]._p4}},Yo.prototype.convertToCubicBezier=function(R){var V,e,m=this,L=new tn.Math.Curve,X=m.screenInfo;if(L.createFromHtShape(X.P,X.S,X.E),X.curve=L,m.activing){var U=L._curves;V=m.activing.point,e=m._convertToNewPoint(V,U,R);var o=[];if(e&&(m.activing.point=e,o.push(e)),m.activing.selections){var S=-1,v=m.activing.selections;v.forEach(function(p){S++,e=m._convertToNewPoint(p,U,R,o),e&&(v[S]=e,o.push(e))})}}},Yo.prototype.check=function(s,V,p){if(!V||ti(V)||Mi(V)){var Z=this;if(Z._interactor.setCursor("default"),Z.editing=null,Z.highlight=null,Z.tipInfo=null,Z.edgeEditResult=null,Z.screenInfo){if(sc()||V&&Mi(V))return Z._interactor._42(),!0;if(Z._checkEditCtrlPoint(p))return Z._interactor._42(),!0;if(Z._checkEditRealPoint(p))return Z._interactor._42(),!0;if(Z._checkEditElevation(p))return Z._interactor._42(),!0;var i=Z.screenInfo.curve,m=i.checkPoint(p,Z._interactor.getStyle("curveIntersectSize"));if(m){var H=Z.highlight={};H.type="insertKnot",H.bezier=m.bezier,H.point=m.intersection}return Z._interactor._42(),!0}}},Yo.prototype.getAdjacentBeziers=function(g){var a=this.screenInfo;if(a){var f,D,Z,W=a.curve._curves,s=[],X=B;for(f=0,D=W.length;D>f;f++)if(Z=W[f],X===B){if(Z._p4.isNearEnough(g)){s.push(Z),X=f;continue}}else{if(Z._p1.isNearEnough(g))return s.push(Z),s;if(Z._p4.isNearEnough(g)){s[0]=Z,X=f;continue}}}},Yo.prototype.roundCorner=function(t){if(this.activing&&this.screenInfo){var T=this.screenInfo.curve,K=T._curves,l=this.getAdjacentBeziers(this.activing.point),I=l[1],m=I._index;I=I.insertKnot(I.getTByPercentage(t/I.length))[1],K[m]=I;var x=I.p1,f=l[0],J=f._index;f=f.insertKnot(f.getTByPercentage(1-t/f.length))[0],K[J]=f;var v=f.p4,$=this.activing.point,g=new tn.Math.CubicBezier(v,$.clone().sub(v).multiplyScalar(2/3).add(v),$.clone().sub(x).multiplyScalar(2/3).add(x),x);K.splice(m,0,g),this._writeToHt(),this.activing=null,this._interactor._42()}},Yo.prototype._checkEditRealPoint=function(D){var o,U,N,w,v,P,F=this,G=F.screenInfo.curve._curves,d=F._interactor.getStyle("curvePointIntersectSize"),y=1/0;for(d*=d,N=0,w=G.length;w>N;N++)o=G[N],v=o._p1,P=D.distanceToSquared(v),y>P&&(y=P,U=v),v=o._p4,P=D.distanceToSquared(v),y>P&&(y=P,U=v);if(y>d)return!1;var e=F.highlight={};return e.type="changeRealPoint",e.point=U,F.editing={type:"realPoint",point:U,shiftGuide:{point:U.clone(),dir:"x",limit:0}},F._interactor.setCursor("crosshair"),!0},Yo.prototype._checkEditElevation=function(l){var d=this;if(!d._interactor.getStyle("curveElevationVisible"))return!1;var H=d.target;if(H instanceof _.Edge&&!d._interactor.getStyle("edgeElevationEditable"))return!1;var M=d.activing;if(!M)return!1;var o=M.getCurrentEditingPoint();if(!o)return!1;var O=d._interactor,F=O.getStyle("curveElevationGuideShift"),S=O.getStyle("curveElevationIntersectSize"),h=l.distanceToSquared({x:o.x+F[0],y:o.y+F[1]});if(!(h>S*S)){var A=d.highlight={};A.type="elevation";var R=new tn.Math.Vector2(l.x,l.y,o.e);return d.editing={type:"elevation",startPoint:R},d._interactor.setCursor("crosshair"),!0}},Yo.prototype._checkEditCtrlPoint=function(J){var f=this;if(f.activing&&!f.activing.selections){var s=f.getCurrentSelectintStatus();if(s!==tn.Curve.PointType.Straight){var h=f.activing.pairs;if(h){var S=f._interactor.getStyle("curvePointIntersectSize");S*=S;var R,H,V,n,i,w,t,d,p,T=1/0;for(t=0,p=h.length;p>t;t++)for(n=h[t],d=0;2>d;d++)i=0===d?"c1":"c2",n[i]&&(w=J.distanceToSquared(n[i]),T>w&&(T=w,R=n,H=t,V=i));if(T>S)return!1;f.activing.hlpair=R,f.activing.hltype=V;var O=f.highlight={};return O.type="changeCtrlPoint",O.point=R[V],f.editing={type:"ctrlPoint",pair:R,pairId:H,ctrlType:V,direction:R[V].clone().sub(f.activing.point).normalize()},f._interactor.setCursor("crosshair"),!0}}}},Yo.prototype.startEdit=function(o,i){o.startDragging(i);var W=this;W.highlight&&"insertKnot"===W.highlight.type&&(W.insertKnot(),W.gatherSingleTarget(W._interactor.gv,W.target),W.activing=null,W._checkEditRealPoint(W._interactor._getLogicalPoint(i)));var t=W._activing;if(t){var R=W.editing?W.editing.type:null;"ctrlPoint"===R?t.editingCtrl={pairId:W.editing.pairId,type:t.hltype}:"realPoint"===R&&(t.editingCtrl=!1)}var J=W.highlight,$=_.Default.isCtrlDown(i);if(!J||sc()||Mi(i)){var M=W._interactor.gv;if(!M.setFocus(i)||M._scrolling)return;return $?W._multiSelect={startPoint:M.lp(i)}:M.isPannable()&&(ti(i)||Mi(i))&&(W._pan={tx:M.tx(),ty:M.ty()},o.fi({kind:"beginPan",event:i})),void 0}if("changeRealPoint"===J.type){var A,X=W.activing?W.activing.point:null,E=W.activing?W.activing.selections:null;if($&&W.activing)X===J.point?(E?(W.activing={point:E[0]},E.length>1&&(E.splice(0,1),W.activing.selections=E)):W.activing=null,W.editing=null):E&&(A=E.indexOf(J.point))>=0?(E.length>1?E.splice(A,1):delete W.activing.selections,W.editing=null):E?(E.push(X),W.activing={point:J.point,selections:E}):W.activing={point:J.point,selections:[X]};else if(E)X===J.point||((A=E.indexOf(J.point))>=0?(E.splice(A,1,X),W.activing={point:J.point,selections:E}):W.activing={point:J.point});else{var O;X===J.point&&(O=W.activing.status),W.activing={point:J.point},O&&(W.activing.status=O)}o.fi({kind:"beginEditPoint",event:i})}},Yo.prototype.insertKnot=function(){var z=this,k=z.highlight,w=z.screenInfo.curve;w.insertKnot(k.bezier,k.point.t),z._writeToHt()},Yo.prototype._writeToHt=function(){var u,b,l=this,U=l.screenInfo.curve,q=U.toHtShape(),z=q.points,H=[],M=q.segments,c=l._interactor.gv;c.dm().beginTransaction();var B,s,F=l.target,T=F instanceof _.Edge,K=tn.getDataMatrix(F).invert();s=F instanceof _.Polyline||T&&l._interactor.getStyle("edgeElevationEditable"),s&&(B=F.getElevation&&F.getElevation()||0);for(var e=0,n=z.length;n>e;e++)u=z[e],b=tn.toWorldPosition(c,u),b=K.apply(b),isFinite(u.e)&&u.e!==B&&(b.e=u.e),H.push(b);if(F._writing=!0,T){F.s("edge.type","points"),F.setStyle("edge.segments",M),F.setStyle("edge.points",H.slice(1,H.length-1)),F.setStyle("edge.source.offset.x",0),F.setStyle("edge.source.offset.y",0),F.setStyle("edge.target.offset.x",0),F.setStyle("edge.target.offset.y",0);var I=l._nextChangeEdgeHost;delete l._nextChangeEdgeHost,I&&("source"===I.type?F.setSource(I.host):F.setTarget(I.host)),l._writeEdgeHostAnchor("source",H[0]),l._writeEdgeHostAnchor("target",H[H.length-1])}else H.length?(F.setSegments(M),F.setPoints(H,!0)):F.removeFromDataModel();c.dm().endTransaction(),delete F._writing},Yo.prototype._writeEdgeHostAnchor=function(U,G){var r=this,k=r.target,C=r._calcHostAnchor(k,U,G);C.index!==B?(k.setStyle("edge."+U+".index",C.index),k.setStyle("edge."+U+".percent",B),k.setStyle("edge."+U+".anchor.x",B),k.setStyle("edge."+U+".anchor.y",B),k.setStyle("edge."+U+".anchor.elevation",B),k.setStyle("edge."+U+".offset.elevation",G.e)):C.percent!==B?(k.setStyle("edge."+U+".percent",C.percent),k.setStyle("edge."+U+".index",B),k.setStyle("edge."+U+".anchor.x",B),k.setStyle("edge."+U+".anchor.y",B),k.setStyle("edge."+U+".anchor.elevation",B),k.setStyle("edge."+U+".offset.elevation",G.e)):(k.s("edge."+U+".anchor.x",C.x),k.s("edge."+U+".anchor.y",C.y),k.s("edge."+U+".anchor.elevation",C.e),C.offsetX||C.offsetY||C.offsetElevation?(k.s("edge."+U+".offset.x",C.offsetX),k.s("edge."+U+".offset.y",C.offsetY),k.s("edge."+U+".offset.elevation",C.offsetElevation)):(k.s("edge."+U+".offset.x",0),k.s("edge."+U+".offset.y",0),k.s("edge."+U+".offset.elevation",0)))},Yo.prototype._calcHostAnchor=function(U,g,b,t){t||(t="source"===g?U.getSource():U.getTarget());var M=this._interactor.gv,O=M.calculateAttachPoint(t,b);if(O)return O.info;if(Xr(t)){var w=M.calculateEdgePosition(t,b);return w}var Y=t.getRotation(),X=t.getAnchor();Pc(t,M)&&(Y=0);var h=t.getElevation(),I=t.getTall()*t.getScaleTall();h=((b.e||0)-U.s("edge."+g+".offset.elevation")-h)/I+.5;var n=t.getScale();if(Y||n.x<0||n.y<0){var Z=t.getMatrix(),V=Z.tfi(b),B=t.getSize();return{x:V.x/B.width+X.x,y:V.y/B.height+X.y,e:h}}var y=Tb(M,t),G={x:(b.x-y.x)/y.width,y:(b.y-y.y)/y.height,e:h};return G},Yo.prototype._handlePanning=function(w){var E=this,U=E._pan;if(U){U.started=!0;var b=E._interactor,Y=b.gv,H=b._lastClientPoint,u=el(w),e=Oo(Y,u,H);Y.setTranslate(U.tx+e.x,U.ty+e.y),E.gatherSingleTarget(b.gv,E.target),b._42(),b.fi({kind:"betweenPan",event:w})}},Yo.prototype.handleEdit=function(O,Y){var h=this,V=h.editing;if(h._pan)return h._handlePanning(Y),void 0;if(h._multiSelect)return h._multiSelect.endPoint=O.lp(Y),h._interactor.redraw(),void 0;if(V){V.inEdit=!0;var s,f,v,W=h._interactor._getLogicalPoint(Y),S=_.Default.isCtrlDown(Y),d=_.Default.isShiftDown(Y),D=V.type,z=h.activing;if(h._guideInfo=null,"ctrlPoint"===D&&d){var m=h.editing.direction.clone();s=z.point;var i=m.dot(W.clone().sub(s));W=m.setLength(i).add(s)}else if("ctrlPoint"===D||"realPoint"===D){var m;if("realPoint"===D&&d){var a=h.editing.shiftGuide;f=a.point;var Q=Math.abs(W.x-f.x),Z=Math.abs(W.y-f.y);Q>Z&&Q>a.limit&&"y"===a.dir&&(a.dir="x"),Z>Q&&Z>a.limit&&"x"===a.dir&&(a.dir="y"),m=a.dir,"x"===m?(W.y=f.y,a.limit=Math.max(a.limit,Q)):"y"===m&&(W.x=f.x,a.limit=Math.max(a.limit,Z))}if(!S){var w,t=h._isEditEdgeSourceTarget();t&&(w=W.clone());var r=h._guidingToEdit(W,m),I="realPoint"===D?h._interactor.gridGuide.findClosest(W,m,!0):null,c=1/0,q=1/0;I&&(I.x&&(c=I.x),I.y&&(q=I.y));var U=!1;if(r&&(r.xList&&(Math.abs(r.x)<=Math.abs(c)?(U=!0,c=r.x):delete r.xList),r.yList&&(Math.abs(r.y)<=Math.abs(q)?(U=!0,q=r.y):delete r.yList),U&&(h._guideInfo=r)),isFinite(c)&&(W.x+=c),isFinite(q)&&(W.y+=q),U&&(r.v=W),t){var $=U?W.clone():null;W.copy(w);var G=h._editEdgeSourceTarget(t,W,S,$);G&&(h.edgeEditResult=G,v=G.tipText,G.isFixed&&(h._guideInfo=null))}}}var T=h.screenInfo.curve;if("realPoint"===V.type){s=V.point,s.e!==B&&(W.e=s.e),T.moveRealPoint(s,W),V.point=W,h.highlight.point=W;var n=z.status,u=z.selections;if(h.activing={point:W,status:n},u){var M=W.clone().sub(s),F=0;u.forEach(function(o){var s=o.clone().add(M);T.moveRealPoint(o,s),u[F++]=s}),h.activing.selections=u}}else if("ctrlPoint"===V.type){var g=z.pairs,K=g[V.pairId];T.moveCtrlPoint(K,W,V.ctrlType);var o=z.status,l=tn.Curve.PointType;if((o===l.Mirrored||o===l.Asymmetric)&&K.c1&&K.c2){var s=new tn.Math.Vector2(z.point),J="c1"===V.ctrlType?"c2":"c1";if(o===tn.Curve.PointType.Mirrored)T.moveCtrlPoint(K,s.clone().multiplyScalar(2).sub(W),J);else if(o===l.Asymmetric){var i=K[J].clone().sub(s).length(),L=s.clone().sub(K[V.ctrlType]).setLength(i).add(s);isNaN(L.x)||T.moveCtrlPoint(K,L,J)}}z._firePointChange()}else if("elevation"===V.type){f=V.startPoint;var R=f.e+(f.y-W.y)/O._zoom;h._setCurrentPointImpl("e",R),z._firePointChange(),v="E: "+tn.toFixed(R)}var N=_.Default.getLogicalPoint(Y,h._interactor._canvas);if(N.x+=tn.Icons.TipShiftX,N.y+=tn.Icons.TipShiftY,!v){var E=tn.toWorldPosition(O,W);v=""+tn.toFixed(E.x)+", "+tn.toFixed(E.y)}h.tipInfo={helperPos:N,text:v,size:v.length},h._writeToHt(),h._interactor.fi({kind:"betweenEditPoint",event:Y})}},Yo.prototype._setCurrentPointImpl=function(i,Z){var H=this,S=H._activing;if(!S)return!1;var K=H.target;if(!K)return!1;var G=S.getCurrentEditingPoint();if(!G)return!1;var O=S.editingCtrl;if(!O)var J=G.clone();if("e"===i)G.e=Z;else{var Y;if("x"===i||"y"===i){var E=S._lastFirePoint;Y="x"===i?{x:Z,y:E?E.y:0}:{x:E?E.x:0,y:Z}}else"object"==typeof i?(Y=i,i.e!==B&&(G.e=i.e)):(Y={x:arguments[0],y:arguments[1]},arguments[2]!==B&&(G.e=arguments[2]));var u=tn.getDataMatrix(K);Y=tn.toScreenPosition(H._interactor.gv,u.apply(Y)),G.x=Y.x,G.y=Y.y}if(!O){var y=J.multiplyScalar(-1).add(G);Aj(G.e)&&Aj(J.e)&&(y.e=G.e-J.e);var L=H.screenInfo.curve;L.moveCtrlDueToRealPointMovement(G,y);var D=S.selections;if(D){var w=0;D.forEach(function(Z){var b=Z.clone().add(y);isFinite(y.e)&&(b.e=(isFinite(Z.e)?Z.e:K.getElevation()||0)+y.e),L.moveRealPoint(Z,b),D[w++]=b}),S.selections=D}}return!0},Yo.prototype.setCurrentPoint=function(X,C){return this._setCurrentPointImpl(X,C)?(this._writeToHt(),!0):!1},Yo.prototype._isEditEdgeSourceTarget=function(){var p=this,c=p.target;if(!(c instanceof _.Edge))return!1;var y=p.editing.point,X=p.screenInfo.curve._curves;return y===X[0]._p1?"source":y===X[X.length-1]._p4?"target":!1},Yo.prototype._editEdgeSourceTarget=function(h,m,z,H){var p,i=this,Q=i.target;if(p="source"===h?Q.getSource():Q.getTarget()){var d,L=i._interactor.gv,f=tn.toWorldPosition(L,m),Z=i._calcHostAnchor(Q,h,f,p);if(d=Z.index!==B||Z.percent!==B?Z.distance*L.getZoom()>i._interactor.getStyle("edgeHostEdgeMaxDistance"):i._interactor.getStyle("edgeHostDetectPerFrame")?!0:Z.x<0||Z.x>1||Z.y<0||Z.y>1?!0:!1){var G=L.getDataAt(f,function(S){return L.isSelectable(S)?L.isSourceTargetEditable(Q,S,h)?Q.canSetSourceTarget(S,h)?!0:!1:!1:!1});if(G){var j=i._calcHostAnchor(Q,h,f,G);p=G,i._nextChangeEdgeHost={type:h,host:G},Z=j}}var W,T,Y,t=!1;if(z||Z.x===B)(Z.percent!==B||Z.index!==B)&&(t=!0,T=Z.point);else{var R=i._interactor.getStyle("anchorRound"),n=i._interactor.getStyle("anchorSensitivity");W=L.calculateAttachPoint(p,f),W?(Z=W.info,t=!0):(H&&(Z=i._calcHostAnchor(Q,h,tn.toWorldPosition(L,H),p)),Z.x=tn.roundTo(Z.x,R,n),Z.y=tn.roundTo(Z.y,R,n)),T=tm(L,p,0,Z.offsetX||0,Z.offsetY||0,Z.x,Z.y)}T&&(Y=tn.toScreenPosition(L,T),m.x=Y.x,m.y=Y.y),i._edgeHostGuideInfo={corners:tn.getTargetCornersOnScreen(L,p),attach:W?W.index:-1,host:p};var P;return Z.percent!==B?P="percent: "+Z.percent.toFixed(2):Z.index!==B?P="index: "+Z.index:(P=""+Z.x.toFixed(2)+", "+Z.y.toFixed(2),(Z.offsetX||Z.offsetY)&&(P+=" offset: "+Z.offsetX.toFixed(2)+", "+Z.offsetY.toFixed(2))),{host:p,anchor:Z,tipText:P,isFixed:t}}},Yo.prototype._guidingToEdit=function(T,L){var X,G,c=this;if(X=c.screenInfo.curve){G=X._curves;var M,x,H,k,Y,Z,D,U,A=1/0,j=1/0,q=[];for(c.editing&&"realPoint"===c.editing.type&&(U=c.editing.point),Y=0,Z=2*G.length;Z>Y;Y++)D=G[Math.floor(Y/2)][Y%2?"_p4":"_p1"],q.indexOf(D)>=0||(q.push(D),U&&U===D||(H=D.x-T.x,k=D.y-T.y,Math.abs(H)<Math.abs(A)?(A=H,M=[D]):H===A&&M.push(D),Math.abs(k)<Math.abs(j)?(j=k,x=[D]):k===j&&x.push(D)));var W=c._interactor.getStyle("smartGuideThreshold");if((Math.abs(A)>W||"y"===L)&&(M=null),(Math.abs(j)>W||"x"===L)&&(x=null),M||x){var B=!1,S={};if(M&&(B=!0,S.xList=M,S.x=A),x&&(B=!0,S.yList=x,S.y=j),B)return S}}},Yo.prototype._46O=function(B){var s=this;s.editing&&(s.editing=null,s._interactor.fi({kind:"endEditPoint",event:B})),s._guideInfo=null,s._edgeHostGuideInfo=null,s._pan&&(s._pan=null,s._interactor.fi({kind:"endPan",event:B})),s._multiSelect&&(s._handleMultiSelect(s._multiSelect,B),s._multiSelect=null),s.tipInfo=null,s.edgeEditResult=null},Yo.prototype._handleMultiSelect=function(x,I){if(x.startPoint&&x.endPoint){var C,j,s,X,U,Y,q=this,e=q._interactor,G=e.gv,z=tn.toScreenPosition(G,x.startPoint),w=tn.toScreenPosition(G,x.endPoint),S=_.Default.unionPoint(z,w),t=q.screenInfo.curve._curves,h=[],u=function(N){N.x>=S.x&&N.y>=S.y&&N.x<=S.x+S.width&&N.y<=S.y+S.height&&h.indexOf(N)<0&&h.push(N)};for(C=0,j=t.length;j>C;C++)U=t[C],u(U._p1),u(U._p4);if(h.length){var y=q.activing||{},p=y.selections||[];y.point&&p.push(y.point);var f=_.Default.isShiftDown(I),N=I.altKey;if(N&&!f)for(Y=h,h=[],C=0,j=Y.length;j>C;C++)s=Y[C],X=p.indexOf(s),X>=0&&h.push(s);for(C=0,j=p.length;j>C;C++)s=p[C],X=h.indexOf(s),X>=0?(!f||f&&N)&&(h[X]=B):h.push(s);for(Y=h,h=[],C=0,j=Y.length;j>C;C++)Y[C]&&h.push(Y[C]);j=h.length,0===j?q.activing=null:1===j?q.activing={point:h[0]}:(s=h[j-1],q.activing={point:s,selections:h.splice(0,j-1)}),e.redraw()}}},Yo.prototype._canDeletePoint=function(x,o){var U=this.target;if(!(U instanceof _.Edge))return!0;var e=x._curves[0],q=x._curves[x._curves.length-1];return e._p1===o||q._p4===o?!1:!0},Yo.prototype.handleDelete=function(){var k=this;if(k.activing&&k.screenInfo){var T=_.Default.isShiftDown(),z=k.screenInfo.curve;k._canDeletePoint(z,k.activing.point)&&z.deleteRealPoint(k.activing.point,T),k.activing.selections&&k.activing.selections.forEach(function(U){k._canDeletePoint(z,U)&&z.deleteRealPoint(U,T)}),k.activing=null,delete k.editing,delete k.tipInfo,delete k.edgeEditResult,delete k._pan,delete k._multiSelect,k._writeToHt(),k._interactor.fp("deleteShapePoint",!1,!0)}},Yo.prototype.handleDoubleClick=function(s){var R=this,Y=R._interactor._getLogicalPoint(s);if(R.screenInfo&&R._checkEditRealPoint(Y)){var S=R.getCurrentSelectintStatus(),r=tn.Curve.PointType;return S=S===r.Mirrored?r.Straight:r.Mirrored,R._setCurrentSelectionStatus(S),R._interactor._42(),!0}},Yo.prototype._drawHighlight=function(s){var R=this,o=R.highlight;if(o){var f=o.bezier,y=R._interactor;f&&tn.Icons.DrawIcon(y,s,tn.Icons.ShapeHighlightCurve,[f._p1.x,f._p1.y,f._p2.x,f._p2.y,f._p3.x,f._p3.y,f._p4.x,f._p4.y]);var i=o.point;i&&"insertKnot"===o.type&&tn.Icons.DrawIcon(y,s,tn.Icons.ShapeHighlighPoint,i)}},Yo.prototype._drawGuide=function(o){var T=this,J=T._guideInfo;if(J){var M,K,Z,v,i=J.v;for(M=0;2>M;M++)if(v=0===M?J.xList:J.yList)for(K=0,Z=v.length;Z>K;K++)tn.Icons.DrawIcon(T._interactor,o,tn.Icons.ShapeGuideLine,[i.x,i.y,v[K].x,v[K].y])}},Yo.prototype._drawCurrentPoint=function(y){var N=this;if(N.activing){var I=N.activing,e=N.getCurrentSelectintStatus(),G=N._interactor;if(e!==tn.Curve.PointType.Straight){var i=I.pairs;I.hlpair,I.hltype;var X=I.selections,u=I.editingCtrl;if(i&&!X){var p,J,A;for(J=0,A=i.length;A>J;J++)p=i[J],u&&J===u.pairId&&p[u.type]?tn.Icons.DrawIcon(G,y,tn.Icons.ShapeActivingCtrl,{point:p.point,c1:p.c1,c2:p.c2,hl:u.type}):tn.Icons.DrawIcon(G,y,tn.Icons.ShapeActivingCtrl,p)}}tn.Icons.DrawIcon(G,y,tn.Icons.ShapeHighlighRealPoint,N.activing.point),X&&X.forEach(function(I){tn.Icons.DrawIcon(G,y,tn.Icons.ShapeHighlighRealPoint,I)})}},Yo.prototype.clear=function(){var A=this;A.editing=null,A._guideInfo=null,A.activing=null,A.highlight=null},Yo.prototype._42=function(w){var z=this;z.info={},z.editing||(z.screenInfo=null);var s=z._interactor;if(!s.editDetail)return z.clear(),void 0;var Q=s.gv;if(!z.target||!Q.isSelected(z.target)||!Q.isVisible(z.target))return s.editDetail=!1,z.clear(),void 0;if(z.gatherSingleTarget(Q,z.target),tn.Icons.DrawIcon(s,w,tn.Icons.ShapeBgCurve,z.screenInfo),z._interactor.getStyle("curveElevationVisible")&&(z.target instanceof _.Polyline||z.target instanceof _.Edge&&z._interactor.getStyle("edgeElevationEditable"))&&z.activing){var q=z.activing.getCurrentEditingPoint();q&&"string"!=typeof q.e&&tn.Icons.DrawIcon(s,w,tn.Icons.EdgeElevationGuide,q)}if(z._drawHighlight(w),z._drawCurrentPoint(w),z._getRealPoint().forEach(function(S){tn.Icons.DrawIcon(s,w,tn.Icons.ShapePoint,S)}),z._drawGuide(w),z.tipInfo&&z._interactor.getStyle("curveTipVisible")&&tn.Icons.DrawIcon(s,w,tn.Icons.TipHelper,z.tipInfo),z._edgeHostGuideInfo&&s._drawHostGuide(z._edgeHostGuideInfo),z.edgeEditResult&&z._drawEdgeHostHighlight(w,z.edgeEditResult.host,z.edgeEditResult.anchor),z._multiSelect&&z._multiSelect.endPoint){var c=_.Default.unionPoint(tn.toScreenPosition(Q,z._multiSelect.startPoint),tn.toScreenPosition(Q,z._multiSelect.endPoint));c.color=Q.getRectSelectBorderColor(),w.save(),w.setTransform(1,0,0,1,0,0);var V=m.devicePixelRatio,$=c.borderWidth=Math.round(V);$/=2,c.x=Math.round(c.x*V)+$,c.y=Math.round(c.y*V)+$,c.width=Math.round(c.width*V),c.height=Math.round(c.height*V),tn.Icons.DrawIcon(s,w,tn.Icons.SimpleRect,c),w.restore()}},Yo.prototype._drawEdgeHostHighlight=function(b,l,Y){this.drawEdgeHostHighlight(b,l,Y),this._interactor.redraw()},Yo.prototype.drawEdgeHostHighlight=function(y,k,L){if(Xr(k)){var m,r,G,F,H=this,c=H._interactor,N=c.gv,O=N.getDataUI(k),Q=Cq(O),P=[];for(G=0,F=Q.points.length;F>G;G++)r=tn.toScreenPosition(N,Q.points.get(G)),P.push(r.x,r.y);Q.segments&&(m=Q.segments.toArray());var e=c.getStyle("edgeHostHighlighPeriod"),u=c.getStyle("edgeHostEdgeHighlighColor");tn.Icons.DrawIcon(c,y,tn.Icons.ShapeBgCurve,{P:P,S:m,color:u,dynamicVisible:L.index===B,dynamicPeriod:e}),u=c.getStyle("edgeHostPointHighlighColor");var S=ik(O);for(G=0,F=S.length;F>G;G++){var T=S[G],Y=tn.toScreenPosition(N,T);tn.Icons.DrawIcon(c,y,tn.Icons.ShapePoint,{point:{x:Y.x,y:Y.y},color:u,size:12,dynamicVisible:G===L.index,dynamicPeriod:e})}}},Yo.prototype._getRealPoint=function(){var j,z=this.screenInfo,D=z.P,P=z.S,V=-1,J=[],W=-1,u=P.length;return P.each(function(_){W++;var I=1;if(3===_)I=2;else if(4===_)I=3;else if(5===_)return;V+=I,j=W+1>=u?!0:1===P.get(W+1)?!0:!1,J.push({point:{x:D[2*V],y:D[2*V+1]},segmentIndex:W,pointIndex:V,isEnd:j})}),J},Yo.prototype.getEditingPointsInfo=function(v){var P=this,w=P.activing;if(!w)return!1;var i=w.point;if(!i)return!1;var B=this._getRealPoint(),Y=[{screen:i}];w.selections&&w.selections.forEach(function(f){Y.push({screen:f})});var d,k,W=B.length;return Y.forEach(function(y){for(d=0;W>d;d++)if(k=B[d],y.screen.isNearEnough(k.point)){y.segmentIndex=k.segmentIndex,y.pointIndex=k.pointIndex,y.point=P.target.getPoints().get(k.pointIndex);break}}),v&&Y.sort(function(U,h){return U.segmentIndex-h.segmentIndex}),Y};var Tf=tn.MoveHelper=function(v){var k=this;k.catalog="Move",k._interactor=v};Tf.prototype={},Tf.prototype.constructor=Tf,Tf.prototype.calcShift=function(K,b,Y){var E,e,D=this,Z=D._interactor.gv,X=Z.lp(b);if("beginMove"===K&&D._gatherGridInfo(Y._lastLogicalPoint||X),E=D._target){var M=E.downPosition;if(M){var f=D._interactor.getStyle("moveSensitivity")/Z._zoom;if(M.distanceTo(X)<f)return{x:0,y:0};delete E.downPosition}var n;e=_.Default.isShiftDown(b),e&&(X=D._dealShiftDown(X),n=E.shiftGuide.dir);var G,t=E.rawPos={x:E.pos.x+X.x-E.lp.x,y:E.pos.y+X.y-E.lp.y};if(_.Default.isCtrlDown(b)){if(G=D._calcShiftByAddon(),D._target.node instanceof tn.Group){var i=D._target.node;i._position.x+=G.x,i._position.y+=G.y}return G}var B=D._interactor.rectGuide;if(E.node instanceof _.Data&&E.node.s("2d.attachable")){var N=D._calcAttachNodeShift(E.node,t);if(B.clear(),N)return N}for(var V,c=E.x+t.x,d=E.y+t.y,m={x:c,y:d},R={x:c+E.w/2,y:d+E.h/2},Q={x:c+E.w,y:d+E.h},y=D._interactor.gridGuide,W=[B.findClosest(m,n),B.findClosest(R,n),B.findClosest(Q,n),y.findClosest(m,n),y.findClosest(R,n),y.findClosest(Q,n)],O=1/0,w=1/0,I=0,F=W.length;F>I;I++)V=W[I],V&&(c=V.x,d=V.y,isFinite(c)&&Math.abs(c)<Math.abs(O)&&(O=c),isFinite(d)&&Math.abs(d)<Math.abs(w)&&(w=d));if(isFinite(O)||(O=0),isFinite(w)||(w=0),G=D._calcShiftByAddon(O,w),D._target.node instanceof tn.Group){var i=D._target.node;i._position.x+=G.x,i._position.y+=G.y}var g=E.node;if(!Pc(g,Z)){var l=t.x+O,z=t.y+w;D._interactor.rectGuide.gatherLines({node:g,x:E.x+l,y:E.y+z,w:E.w,h:E.h},n)}return G}},Tf.prototype._calcShiftByAddon=function(K,i){var V=this._target,h=V.rawPos,f=V.node.getPosition();
return K=K||0,i=i||0,{x:h.x-f.x+K,y:h.y-f.y+i}},Tf.prototype._dealShiftDown=function(X){var q=this,F=q._target.shiftGuide,P=q._target.lp,j=Math.abs(X.x-P.x),g=Math.abs(X.y-P.y);j>g&&j>F.limit&&"y"===F.dir&&(F.dir="x"),g>j&&g>F.limit&&"x"===F.dir&&(F.dir="y");var x=F.dir;return"x"===x?(X.y=P.y,F.limit=Math.max(F.limit,j)):"y"===x&&(X.x=P.x,F.limit=Math.max(F.limit,g)),X},Tf.prototype._isAttachableLineShape=function(a){if(!a.getSegments)return!1;var w=a.getSegments();if(!w)return!0;w instanceof _.List&&(w=w.getArray());for(var g=1,K=w.length;K>g;g++)if(2!==w[g])return!1;return!0},Tf.prototype._calcAttachNodeShift=function(){var v=new sm,T=new sm,t=new sm,N=new sm;return function(U,X){var $=this._interactor.gv,f=U.getHost(),s=$.getDataAt(X,function(K){return K.s("2d.hostable")?!0:!1});if(s&&f!==s&&U.setHost(s),!s)return this._edgeHostGuideInfo=null,U.setHost(null);var M=this._edgeHostGuideInfo={corners:tn.getTargetCornersOnScreen($,s),host:s,attach:-1};if(this._isAttachableLineShape(s)){for(var o,D,B,w,E,m,H=s.getPoints(),K=H.size(),e=s.getPointsMatrix2d(),F=1/0,R=0;K>R&&(R!==K-1||s.isClosePath());R++)0!==R?T.copy(t):e.apply(H.get(R),T),e.apply(R===K-1?H.get(0):H.get(R+1),t),v.copy(X).sub(T),N.copy(t).sub(T),o=N.length(),N.divideScalar(o),D=v.dot(N),0>D?D=0:D>o&&(D=o),N.multiplyScalar(D).add(T),B=v.copy(X).sub(N).lengthSq(),F>B&&(F=B,m=R,w=D,E=o);return Math.sqrt(F)*$.getZoom()>this._interactor.getStyle("attachThreshold")?(U.s({"attach.index":-1}),U.setHost(null),void 0):(U.s("attach.offset.opposite")&&(w=E-w),U.s({"attach.index":m,"attach.offset":U.s("attach.offset.relative")?w/E:w}),{x:0,y:0})}var n=$.calculateAttachPoint(s,X);if(n){var Q=n.point;return M.attach=n.index,this._calcShiftByAddon(Q.x-X.x,Q.y-X.y)}}}(),Tf.prototype._gatherGridInfo=function(P){var i,$=this,p=$._interactor,C=p._getValidSelection();if(C.length){if(1===C.length){if(i=C[0],!i.getRect)return $._target=null,void 0}else if(i=tn.Group.findOrCreateGroup(C,p._uuid),!i)return $._target=null,void 0}else{var C=p.gv.sm().getSelection();if(C.length&&(i=C.get(0),!i.getRect))return $._target=null,void 0}if(i){var Q=i.getPosition(),K=i.getRect();$._target={node:i,x:K.x-Q.x,y:K.y-Q.y,w:K.width,h:K.height,lp:{x:P.x,y:P.y},pos:{x:Q.x,y:Q.y},shiftGuide:{dir:"x",limit:0},downPosition:new tn.Math.Vector2(P)},p.rectGuide.gatherRects()}},Tf.prototype.clear=function(){var k=this;k._edgeHostGuideInfo=null,k._interactor.rectGuide.clear(),k._interactor._42()},Tf.prototype._42=function(){var W=this._edgeHostGuideInfo;W&&this._interactor._drawHostGuide(W)};var Uk=S.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),de=function(){function z(_,e){var w=B;return function(){return w||(w=_.getExtension(e)),w}}function K(E,f){f==B&&(f={}),f.version=L&&(E instanceof WebGL2RenderingContext||S.prototype.toString.call(E)===M)?2:1,f.extensions=function(){for(var e={},S=E.getSupportedExtensions(),L=S.length;L--;)e[S[L]]=z(E,S[L]);return e}();for(var e=S.keys(F),x=0,d=e.length;d>x;++x){var D=e[x];f[D]=E.getParameter(F[D])}if(f.version>1){e=S.keys(C);for(var x=0,d=e.length;d>x;++x){var D=e[x];f[D]=E.getParameter(C[D])}}return f}var L="undefined"!=typeof WebGL2RenderingContext,M="[object WebGL2RenderingContext]",F={aliasedLineWidthRange:Uk.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Uk.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Uk.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Uk.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Uk.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Uk.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Uk.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Uk.MAX_TEXTURE_SIZE,maxVaryingVectors:Uk.MAX_VARYING_VECTORS,maxVertexAttribs:Uk.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Uk.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Uk.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Uk.MAX_VIEWPORT_DIMS},C={max3DTextureSize:Uk.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Uk.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Uk.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Uk.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Uk.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Uk.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Uk.MAX_DRAW_BUFFERS,maxElementIndex:Uk.MAX_ELEMENT_INDEX,maxElementsIndices:Uk.MAX_ELEMENTS_INDICES,maxElementsVertices:Uk.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Uk.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Uk.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Uk.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Uk.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Uk.MAX_SAMPLES,maxTextureLODBias:Uk.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Uk.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Uk.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Uk.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Uk.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Uk.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Uk.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Uk.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Uk.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Uk.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Uk.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(D){var L=D._info;return L||(D._info=L=K(D,L)),L}}}(),$n=function(){function p(P,u,$){return{def:P,getter:$?function(Q){var v=de.for(Q);return v.version>1?Q.getParameter(u):P}:function(Y){return Y.getParameter(u)},setter:$?function(O,r){var P=de.for(O);P.version>1&&O.pixelStorei(u,r)}:function(X,c){X.pixelStorei(u,c)}}}function W(e){return"string"==typeof e?Qk(e):e.r!==B?(q[0]=e.r,q[1]=e.g,q[2]=e.b,q[3]=e.a,q):e.red!==B?(q[0]=e.red,q[1]=e.green,q[2]=e.blue,q[3]=e.alpha,q):e}function s(Z){return P(Z)?Array.prototype.slice.call(Z,0):Z}function O(v,k,F){this.gl=k,this._record=F||{},this._branches={},this._leafSync={},this._struct=v;for(var m=v.children,l=m.length;l--;){var e=m[l],A=e.name;e.isLeaf?(this._leafSync[A]=!1,this._record[A]=s(e.desc.def)):this._record[A]={}}}function Q(s){function k(F,t){O.call(this,s,F,t);for(var I=V.length;I--;){var q=V[I];this._branches[q._name]=new q._type(F,this._record[q._name])}}function W(G,N){function y(S,i){for(var d=M,r=!1;d--;)S[d]!==i[d]&&(S[d]=i[d],r=!0);return r}var o=G.name,E=P(G.desc.def),M=E&&G.desc.def.length;if(G.isLeaf){var D=G.desc.setter,b=G.desc.parse;S.defineProperty(N,o,{configurable:!1,enumerable:!0,get:function(){return this._record[o]},set:E?function(E){b&&(E=b(E)),(y(this._record[o],E)||!this._leafSync[o])&&(D(this.gl,this._record[o]),this._leafSync[o]=!0)}:function(G){this._record[o]===G&&this._leafSync[o]||(D(this.gl,G),this._record[o]=G,this._leafSync[o]=!0)}})}else V.push({_name:o,_type:Q(G)}),S.defineProperty(N,o,{configurable:!1,enumerable:!0,get:function(){return this._branches[o]},set:function(_){this._branches[o].apply(_)}})}var V=[];return D(k,O),s.forEach(W,k.prototype),k}var q="undefined"!=typeof Float32Array&&new Float32Array(4),K={viewport:{def:[0,0,0/0,0/0],getter:function(b){return b.getParameter(b.VIEWPORT)},setter:function(d,Y){var H=Y[2]!==Y[2]?d.drawingBufferWidth-Y[0]:Y[2],S=Y[3]!==Y[3]?d.drawingBufferHeight-Y[1]:Y[3];d.viewport(Y[0],Y[1],H,S)}},dither:{def:!1,getter:function(f){return f.isEnabled(f.DITHER)},setter:function(L,o){o?L.enable(L.DITHER):L.disable(L.DITHER)}},rasterizerDiscard:{def:!1,getter:function(d){var P=de.for(d);return P.version>1&&d.isEnabled(d.RASTERIZER_DISCARD)},setter:function(m,r){var T=de.for(m);1!==T.version&&(r?m.enable(m.RASTERIZER_DISCARD):m.disable(m.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(E){return E.lineWidth?E.getParameter(E.LINE_WIDTH):1},setter:function(u,j){u.lineWidth&&u.lineWidth(j)}},color:{clear:{def:[0,0,0,0],getter:function(L){return L.getParameter(L.COLOR_CLEAR_VALUE)},setter:function(k,W){k.clearColor(W[0],W[1],W[2],W[3])},parse:W},mask:{def:[!0,!0,!0,!0],getter:function(A){return A.getParameter(A.COLOR_WRITEMASK)},setter:function(d,V){d.colorMask(V[0],V[1],V[2],V[3])}}},blend:{enabled:{def:!1,getter:function(S){return S.isEnabled(S.BLEND)},setter:function(j,s){s?j.enable(j.BLEND):j.disable(j.BLEND)}},color:{def:[0,0,0,0],getter:function(l){return l.getParameter(l.BLEND_COLOR)},setter:function(_,S){_.blendColor(S[0],S[1],S[2],S[3])},parse:W},equation:{def:[Uk.FUNC_ADD,Uk.FUNC_ADD],getter:function(Z){return[Z.getParameter(Z.BLEND_EQUATION_RGB),Z.getParameter(Z.BLEND_EQUATION_ALPHA)]},setter:function(_,f){_.blendEquationSeparate(f[0],f[1])},parse:function(t){var T=t.length;return T>1?t:1===T?(q[1]=q[0]=t[0],q):(q[1]=q[0]=t,q)}},func:{def:[Uk.ONE,Uk.ZERO,Uk.ONE,Uk.ZERO],getter:function(j){return[j.getParameter(j.BLEND_SRC_RGB),j.getParameter(j.BLEND_DST_RGB),j.getParameter(j.BLEND_SRC_ALPHA),j.getParameter(j.BLEND_DST_ALPHA)]},setter:function(F,c){F.blendFuncSeparate(c[0],c[1],c[2],c[3])},parse:function(A){var H=A.length;return H>3?A:(q[2]=q[0]=A[0],q[3]=q[1]=A[1],q)}}},cullFace:{enabled:{def:!1,getter:function(f){return f.isEnabled(f.CULL_FACE)},setter:function(n,h){h?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE)}},mode:{def:Uk.BACK,getter:function(u){return u.getParameter(u.CULL_FACE_MODE)},setter:function(I,L){I.cullFace(L)}},frontFace:{def:Uk.CCW,getter:function(S){return S.getParameter(S.FRONT_FACE)},setter:function(v,B){v.frontFace(B)}}},scissor:{enabled:{def:!1,getter:function(l){return l.isEnabled(l.SCISSOR_TEST)},setter:function(K,W){W?K.enable(K.SCISSOR_TEST):K.disable(K.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(m){return m.getParameter(m.SCISSOR_BOX)},setter:function(U,K){var d=K[2]!==K[2]?U.drawingBufferWidth-K[0]:K[2],e=K[3]!==K[3]?U.drawingBufferHeight-K[1]:K[3];U.scissor(K[0],K[1],d,e)}}},depth:{enabled:{def:!1,getter:function(Y){return Y.isEnabled(Y.DEPTH_TEST)},setter:function(T,y){y?T.enable(T.DEPTH_TEST):T.disable(T.DEPTH_TEST)}},clear:{def:1,getter:function(d){return d.getParameter(d.DEPTH_CLEAR_VALUE)},setter:function(r,z){r.clearDepth(z)}},mask:{def:!0,getter:function(S){return S.getParameter(S.DEPTH_WRITEMASK)},setter:function(g,z){g.depthMask(z)}},range:{def:[-1,1],getter:function(L){return L.getParameter(L.DEPTH_RANGE)},setter:function(p,l){p.depthRange(l[0],l[1])}},func:{def:Uk.LESS,getter:function(g){return g.getParameter(g.DEPTH_FUNC)},setter:function(r,P){r.depthFunc(P)}}},stencil:{enabled:{def:!1,getter:function(O){return O.isEnabled(O.STENCIL_TEST)},setter:function(g,X){X?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST)}},clear:{def:0,getter:function(B){return B.getParameter(B.STENCIL_CLEAR_VALUE)},setter:function(F,J){F.clearStencil(J)}},frontMask:{def:255,getter:function(E){return E.getParameter(E.STENCIL_WRITEMASK)},setter:function(B,J){B.stencilMaskSeparate(B.FRONT,J)}},frontOp:{def:[Uk.KEEP,Uk.KEEP,Uk.KEEP],getter:function(J){return[J.getParameter(J.STENCIL_FAIL),J.getParameter(J.STENCIL_PASS_DEPTH_FAIL),J.getParameter(J.STENCIL_PASS_DEPTH_PASS)]},setter:function(M,F){M.stencilOpSeparate(M.FRONT,F[0],F[1],F[2])}},frontFunc:{def:[Uk.ALWAYS,0,255],getter:function(J){return[J.getParameter(J.STENCIL_FUNC),J.getParameter(J.STENCIL_REF),J.getParameter(J.STENCIL_VALUE_MASK)]},setter:function(w,V){w.stencilFuncSeparate(w.FRONT,V[0],V[1],V[2])}},backMask:{def:255,getter:function(h){return h.getParameter(h.STENCIL_BACK_WRITEMASK)},setter:function(J,s){J.stencilMaskSeparate(J.BACK,s)}},backOp:{def:[Uk.KEEP,Uk.KEEP,Uk.KEEP],getter:function(M){return[M.getParameter(M.STENCIL_BACK_FAIL),M.getParameter(M.STENCIL_BACK_PASS_DEPTH_FAIL),M.getParameter(M.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(h,w){h.stencilOpSeparate(h.BACK,w[0],w[1],w[2])}},backFunc:{def:[Uk.ALWAYS,0,255],getter:function(e){return[e.getParameter(e.STENCIL_BACK_FUNC),e.getParameter(e.STENCIL_BACK_REF),e.getParameter(e.STENCIL_BACK_VALUE_MASK)]},setter:function(R,u){R.stencilFuncSeparate(R.BACK,u[0],u[1],u[2])}}},hint:{generateMipmap:{def:Uk.DONT_CARE,getter:function(x){return x.getParameter(x.GENERATE_MIPMAP_HINT)},setter:function(m,C){m.hint(m.GENERATE_MIPMAP_HINT,C)}},fragmentShaderDerivative:{def:Uk.DONT_CARE,getter:function(T){var t=de.for(T);return 1!==t.version||t.extensions.OES_standard_derivatives?T.getParameter(Uk.FRAGMENT_SHADER_DERIVATIVE_HINT):Uk.DONT_CARE},setter:function(H,J){var Q=de.for(H);return Q.version>1||Q.extensions.OES_standard_derivatives?(H.hint(Uk.FRAGMENT_SHADER_DERIVATIVE_HINT,J),void 0):void 0}}},pixelStore:{packAlignment:p(4,Uk.PACK_ALIGNMENT,!1),unpackAlignment:p(4,Uk.UNPACK_ALIGNMENT,!1),unpackFlipY:p(!1,Uk.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:p(!1,Uk.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:p(Uk.BROWSER_DEFAULT_WEBGL,Uk.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:p(0,Uk.PACK_ROW_LENGTH,!0),packSkipPixels:p(0,Uk.PACK_SKIP_PIXELS,!0),packSkipRows:p(0,Uk.PACK_SKIP_ROWS,!0),unpackRowLength:p(0,Uk.UNPACK_ROW_LENGTH,!0),unpackImageHeight:p(0,Uk.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:p(0,Uk.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:p(0,Uk.UNPACK_SKIP_ROWS,!0),unpackSkipImages:p(0,Uk.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(w){return w.isEnabled(w.POLYGON_OFFSET_FILL)},setter:function(e,m){m?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(p){return[p.getParameter(p.POLYGON_OFFSET_FACTOR),p.getParameter(p.POLYGON_OFFSET_UNITS)]},setter:function(y,G){y.polygonOffset(G[0],G[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(P){return P.isEnabled(P.SAMPLE_COVERAGE)},setter:function(o,j){j?o.enable(o.SAMPLE_COVERAGE):o.disable(o.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(k){return k.isEnabled(k.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(H,r){r?H.enable(H.SAMPLE_ALPHA_TO_COVERAGE):H.disable(H.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(t){return[t.getParameter(t.SAMPLE_COVERAGE_VALUE),t.getParameter(t.SAMPLE_COVERAGE_INVERT)]},setter:function(q,R){q.sampleCoverage(R[0],R[1])}}}},V=Ti.create(K,function(W){return"def"in W});O.prototype.reset=function(){for(var $=this._struct.children,q=$.length;q--;){var m=$[q],z=m.name;m.isLeaf?this[z]=m.desc.def:this._branches[z].reset()}},O.prototype.save=function(f){f==B&&(f={});for(var t=this._struct.children,T=t.length;T--;){var J=t[T],h=J.name;if(J.isLeaf)f[h]=s(this._record[h]);else{var d=f[h];d==B&&(f[h]=d={}),this._branches[h].save(d)}}return f},O.prototype.sync=function(n,l){for(var E=this._struct.children,I=E.length;I--;){var u=E[I],W=u.name;u.isLeaf?(l||!this._leafSync[W])&&(n?(this._record[W]=u.desc.getter(this.gl),this._leafSync[W]=!0):(u.desc.setter(this.gl,this._record[W]),this._leafSync[W]=!0)):this._branches[W].sync(n,l)}},O.prototype.syncLoss=function(){for(var j=this._struct.children,E=j.length;E--;){var w=j[E];w.isLeaf?this._leafSync[w.name]=!1:this._branches[w.name].syncLoss()}},O.prototype.apply=function(l){for(var c=this._struct.children,v=c.length;v--;){var X=c[v],C=X.name;C in l&&(X.isLeaf?this[C]=l[C]:this._branches[C].apply(l[C]))}},O.prototype.append=function(A){var c=this._struct.childMap;for(var z in A){var o=c[z];o&&(o.isLeaf?this[z]=A[z]:this._branches[z].append(A[z]))}};var L=Q(V);return function(D){var G=D._state;return G||(D._state=G=new L(D)),G}}(),Do=function(){function r(z,I,F,E){if(z){var n=z.length;if(n!=B)for(var o=0;E>o;++o)I[F+o]=z[o];else z.toArray&&z.toArray(I,F)}else for(var o=0;E>o;++o)I[F+o]=0}function p(Y,O,q){var A=Y[0];if(0>=A||A>0)return Y;var G=O*q,z=y[G];if(z==B&&(y[G]=z=new Float32Array(G)),0!==O){r(A,z,0,q);for(var C=1,P=0;C!==O;++C)P+=q,r(Y[C],z,P,q)}return z}function l(q,n){q.uniform1f(this.addr,n)}function x(c,k){c.uniform1fv(this.addr,k)}function V(v,W){if(W.x!=B)v.uniform2f(this.addr,W.x,W.y);else{var D=y[2];D.set(W,0),v.uniform2fv(this.addr,D)}}function o(A,h){A.uniform2fv(this.addr,p(h,this.size,2))}function E(p,x){if(x.x!=B)p.uniform3f(this.addr,x.x,x.y,x.z);else if(x.r!=B)p.uniform3f(this.addr,x.r,x.g,x.b);else if(x.red!=B)p.uniform3f(this.addr,x.red,x.green,x.blue);else{var q=y[3];q.set(x,0),p.uniform3fv(this.addr,q)}}function $(s,y){s.uniform3fv(this.addr,p(y,this.size,3))}function G(q,D){if("string"==typeof D&&(D=Qk(D)),D.x!=B)q.uniform4f(this.addr,D.x,D.y,D.z,D.w);else if(D.r!=B)q.uniform4f(this.addr,D.r,D.g,D.b,D.a);else if(D.red!=B)q.uniform4f(this.addr,D.red,D.green,D.blue,D.alpha);else{var Q=y[4];Q.set(D,0),q.uniform4fv(this.addr,Q)}}function P(t,E){t.uniform4fv(this.addr,p(E,this.size,4))}function N(U,O){U.uniform1i(this.addr,O)}function K(H,Q){H.uniform1iv(this.addr,Q)}function m(Y,T){Y.uniform2iv(this.addr,T)}function Q(e,F){e.uniform3iv(this.addr,F)}function H(Z,w){Z.uniform4iv(this.addr,w)}function e(w,G){w.uniform1i(this.addr,M[G?1:0])}function R(p,o){var D=y[4];D.set(o,0),p.uniformMatrix2fv(this.addr,!1,D)}function T(g,X){g.uniformMatrix2fv(this.addr,!1,p(X,this.size,4))}function n(o,w){var z=y[9];z.set(w,0),o.uniformMatrix3fv(this.addr,!1,z)}function L(A,S){A.uniformMatrix3fv(this.addr,!1,p(S,this.size,9))}function b(E,Q){var R=y[16];R.set(Q,0),E.uniformMatrix4fv(this.addr,!1,R)}function f(U,P){U.uniformMatrix4fv(this.addr,!1,p(P,this.size,16))}function v(r,U){r.uniform1i(this.addr,this.slots[0]),r.activeTexture(r.TEXTURE0+this.slots[0]),r.bindTexture(r.TEXTURE_2D,U||r._emptyTexture)}function C(g,B){g.uniform1iv(this.addr,this.slots);for(var _=this.slots.length;_--;)g.activeTexture(g.TEXTURE0+this.slots[_]),g.bindTexture(g.TEXTURE_2D,B[_]||g._emptyTexture)}function J(b,d){b.uniform1i(this.addr,this.slots[0]),b.activeTexture(b.TEXTURE0+this.slots[0]),b.bindTexture(b.TEXTURE_CUBE_MAP,d||b._emptyCubeTexture)}function j(s,N){s.uniform1iv(this.addr,this.slots);for(var H=this.slots.length;H--;)s.activeTexture(s.TEXTURE0+this.slots[H]),s.bindTexture(s.TEXTURE_CUBE_MAP,N[H]||s._emptyCubeTexture)}function u(g,O,A){W[g]=[O,A]}function I(x,i,A){switch(x.type){case 35678:case 35680:if("uSampler"===A)return[0];if("uBlendSampler"===A)return[1];for(var W=x.size,M=new Int32Array(W),P=0;W>P;++P)M[P]=i.usedTextureSlot++;return M}return B}function t(L,d,v,N,R){this.name=L,this.addr=d,this.size=N?v.size:0,this.activeInfo=v,this.setter=W[v.type][N?1:0],this.slots=I(v,R,L),Lj(this)}function U(X,T,P,m){var O=X.name,s=O.length;for(k.lastIndex=0;;){var Y=k.exec(O),r=k.lastIndex,U=Y[1],A="]"===Y[2],J=Y[3];if(A&&(U=0|U),J===B||"["===J&&r+2===s){P[U]=new t(U,T,X,J!==B,m);break}var C=P[U];C==B&&(P[U]=C={}),P=C}}function z(g,S,p){this.gl=S,this._program=p,this._leaves={},this._branches={},this._struct=g}function O(u){function B(l,b){z.call(this,u,l,b);for(var r=k.length;r--;){var B=k[r];this._branches[B._name]=new B._type(l,b)}this.uuid=_k.generateUUID()}function K(y,w){var q=y.name;if(y.isLeaf){var F=A("d.setter(this.gl, v);",["v"],["d"],[y.desc]);S.defineProperty(w,q,{configurable:!1,enumerable:!0,get:function(){return F
},set:F})}else k.push({_name:q,_type:O(y)}),S.defineProperty(w,q,{configurable:!1,enumerable:!0,get:function(){return this._branches[q]},set:function(v){this._branches[q].apply(v)}})}var k=[];return D(B,z),u.forEach(K,B.prototype),B}function s(r,X){for(var F=r.getProgramParameter(X,r.ACTIVE_UNIFORMS),i={},t={usedTextureSlot:2};F--;){var e=r.getActiveUniform(X,F),I=e.name,q=r.getUniformLocation(X,I);U(e,q,i,t)}var H=Ti.create(i,function(M){return"addr"in M}),l=O(H);return S.defineProperty(l.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:t.usedTextureSlot}),new l(r,X)}var y=[];if("function"==typeof Float32Array)for(var g=1;17>g;++g)y[g]=new Float32Array(g);var M=[0,1],W=[];u(Uk.FLOAT,l,x),u(Uk.FLOAT_VEC2,V,o),u(Uk.FLOAT_VEC3,E,$),u(Uk.FLOAT_VEC4,G,P),u(Uk.INT,N,K),u(Uk.INT_VEC2,m,m),u(Uk.INT_VEC3,Q,Q),u(Uk.INT_VEC4,H,H),u(Uk.BOOL,e,K),u(Uk.BOOL_VEC2,m,m),u(Uk.BOOL_VEC3,Q,Q),u(Uk.BOOL_VEC4,H,H),u(Uk.FLOAT_MAT2,R,T),u(Uk.FLOAT_MAT3,n,L),u(Uk.FLOAT_MAT4,b,f),u(Uk.SAMPLER_2D,v,C),u(Uk.SAMPLER_CUBE,J,j);var k=/([\w\d_]+)(\])?(\[|\.)?/g;return z.prototype.apply=function(D){for(var d=this._struct.children,a=d.length;a--;){var T=d[a],t=T.name;t in D&&(T.isLeaf?this[t]=D[t]:this._branches[t].apply(D[t]))}},z.prototype.append=function(B){var Q=this._struct.childMap;for(var $ in B){var A=Q[$];A&&(A.isLeaf?this[$]=B[$]:this._branches[$].append(B[$]))}},function(A,I){var X=I._uniforms;return X||(I._uniforms=X=s(A,I)),X}}(),Fq=function(){function z(R,r,Q){r.vertexAttrib1f(R.addr,Q)}function y(a,Z,X){if(X.x!=B)Z.vertexAttrib2f(a.addr,X.x,X.y);else{var C=i[2];C.set(X,0),Z.vertexAttrib2fv(a.addr,C)}}function V(L,e,l){if(l.x!=B)e.vertexAttrib3f(L.addr,l.x,l.y,l.z);else if(l.r!=B)e.vertexAttrib3f(L.addr,l.r,l.g,l.b);else if(l.red!=B)e.vertexAttrib3f(L.addr,l.red,l.green,l.blue);else{var k=i[3];k.set(l,0),e.vertexAttrib3fv(L.addr,k)}}function c(u,R,H){if("string"==typeof H&&(H=Qk(H)),H.x!=B)R.vertexAttrib4f(u.addr,H.x,H.y,H.z,H.w);else if(H.r!=B)R.vertexAttrib4f(u.addr,H.r,H.g,H.b,H.a);else if(H.red!=B)R.vertexAttrib4f(u.addr,H.red,H.green,H.blue,H.alpha);else{var m=i[4];m.set(H,0),R.vertexAttrib4fv(u.addr,m)}}function u(k,u,c){c=c.el||c;for(var C=0,P=0;2>C;++C)u.vertexAttrib2f(k.addr,c[P++],c[P++])}function E(g,q,f){f=f.el||f;for(var L=0,o=0;3>L;++L)q.vertexAttrib3f(g.addr,f[o++],f[o++],f[o++])}function f(e,B,u){u=u.el||u;for(var V=0,b=0;4>V;++V)B.vertexAttrib4f(e.addr,u[b++],u[b++],u[b++],u[b++])}function $(u,O,t,m){for(var H,n=t?1:0,q=O.addr,U=u._divisorState,e=0;m>e;e++)H=U[q+e]||0,H!==n&&(U[q+e]=n,u.vertexAttribDivisor(q+e,n))}function F(V,Y,k,R,n,w,B){Y.bindBuffer(Y.ARRAY_BUFFER,k);var E=V.addr;Y.enableVertexAttribArray(E),$(Y,V,k.instanced,1),Y.vertexAttribPointer(E,1,R||Y.FLOAT,!!n,w||0,B||0),Y.bindBuffer(Y.ARRAY_BUFFER,null)}function R(s,y,O,d,B,S,p){y.bindBuffer(y.ARRAY_BUFFER,O);var j=s.addr;y.enableVertexAttribArray(j),$(y,s,O.instanced,1),y.vertexAttribPointer(j,2,d||y.FLOAT,!!B,S||0,p||0),y.bindBuffer(y.ARRAY_BUFFER,null)}function j(f,T,N,Y,j,p,e){T.bindBuffer(T.ARRAY_BUFFER,N);var s=f.addr;T.enableVertexAttribArray(s),$(T,f,N.instanced,1),T.vertexAttribPointer(s,3,Y||T.FLOAT,!!j,p||0,e||0),T.bindBuffer(T.ARRAY_BUFFER,null)}function M(b,T,A,U,Y,i,R){T.bindBuffer(T.ARRAY_BUFFER,A);var o=b.addr;T.enableVertexAttribArray(o),$(T,b,A.instanced,1),T.vertexAttribPointer(o,4,U||T.FLOAT,!!Y,i||0,R||0),T.bindBuffer(T.ARRAY_BUFFER,null)}function g(w,t,i,J,T,x,Y){var x=x||16,Y=Y||0,n=w.addr;t.bindBuffer(t.ARRAY_BUFFER,i),t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,J||t.FLOAT,!!T,x,Y),t.enableVertexAttribArray(n+1),t.vertexAttribPointer(n+1,2,J||t.FLOAT,!!T,x,Y+8),$(t,w,i.instanced,2),t.bindBuffer(t.ARRAY_BUFFER,null)}function O(r,F,J,o,y,w,R){var w=w||36,R=R||0,H=r.addr;F.bindBuffer(F.ARRAY_BUFFER,J);for(var G=0;3>G;G++)F.enableVertexAttribArray(H+G),F.vertexAttribPointer(H+G,3,o||F.FLOAT,!!y,w,R+12*G);$(F,r,J.instanced,3),F.bindBuffer(F.ARRAY_BUFFER,null)}function U(r,G,B,C,o,m,i){var m=m||64,i=i||0,h=r.addr;G.bindBuffer(G.ARRAY_BUFFER,B);for(var p=0;4>p;p++)G.enableVertexAttribArray(h+p),G.vertexAttribPointer(h+p,4,C||G.FLOAT,!!o,m,i+16*p);$(G,r,B.instanced,4),G.bindBuffer(G.ARRAY_BUFFER,null)}function w(f,U,L,C){o[f]=function(R,i,r,Y,N,G){this.addr==B||this.addr<0||(i==B||i===!1?C(R,this.addr):Xk(i)===t?L(this,R,i,r,Y,N,G):(C(R,this.addr),U(this,R,i)))}}function s(W,s){W.disableVertexAttribArray(s)}function l(b,x){b.disableVertexAttribArray(x),b.disableVertexAttribArray(x+1)}function q(r,V){r.disableVertexAttribArray(V),r.disableVertexAttribArray(V+1),r.disableVertexAttribArray(V+2)}function W(E,W){E.disableVertexAttribArray(W),E.disableVertexAttribArray(W+1),E.disableVertexAttribArray(W+2),E.disableVertexAttribArray(W+3)}function N(r,X,S){this.name=r,this.addr=X,this.activeInfo=S,this.setter=o[S.type],Lj(this)}function x(W,g,P){this.gl=g,this.program=P,this._branches={},this._struct=W}function k(u){function d(T,$){x.call(this,u,T,$);for(var M=e.length;M--;){var i=e[M];this._branches[i._name]=new i._type(T,$)}}function P(m,x){var t=m.name;if(m.isLeaf){var H=A("d.setter(this.gl, v);",["v"],["d"],[m.desc]);S.defineProperty(x,t,{configurable:!1,enumerable:!0,get:function(){return H},set:H})}else e.push({_name:t,_type:k(m)}),S.defineProperty(x,t,{configurable:!1,enumerable:!0,get:function(){return this._branches[t]},set:function(S){this._branches[t].apply(S)}})}var e=[];return D(d,x),u.forEach(P,d.prototype),d}function X(E,i){for(var P=E.getProgramParameter(i,E.ACTIVE_ATTRIBUTES),y={};P--;){var G=E.getActiveAttrib(i,P),T=G.name,x=E.getAttribLocation(i,T);y[T]=new N(T,x,G)}var b=Ti.create(y,function(e){return"addr"in e}),u=k(b);return new u(E,i)}for(var i=[],e=1;17>e;++e)i[e]=new al(e);var o=[],t="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return w(Uk.FLOAT,z,F,s),w(Uk.FLOAT_VEC2,y,R,s),w(Uk.FLOAT_VEC3,V,j,s),w(Uk.FLOAT_VEC4,c,M,s),w(Uk.FLOAT_MAT2,u,g,l),w(Uk.FLOAT_MAT3,E,O,q),w(Uk.FLOAT_MAT4,f,U,W),x.prototype.disable=function(){for(var b=this._struct.children,z=b.length;z--;){var D=b[z],L=D.name;D.isLeaf?this[L]=B:this._branches[L].disable()}},x.prototype.apply=function(c){for(var f=this._struct.children,J=f.length;J--;){var v=f[J],I=v.name;I in c&&(v.isLeaf?this[I]=c[I]:this._branches[I].apply(c[I]))}},x.prototype.append=function(g){var V=this._struct.childMap;for(var h in g){var b=V[h];b&&(b.isLeaf?this[h]=g[h]:this._branches[h].append(g[h]))}},function(T,z){var W=z._attribs;return W||(z._attribs=W=X(T,z)),W}}(),Gh=function(K){var G=this;S.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:K,writable:!1},glState:{configurable:!1,enumerable:!1,value:$n(K),writable:!1}}),G._currProgram=B,G._currUniforms=B,G._currAttribs=B,G._sync=!0};S.defineProperties(Gh.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(g){var h=this;h._sync&&g===h._currProgram||(h.gl.useProgram(g),h._currProgram=g,h._currUniforms=Do(h.gl,g),h._currAttribs=Fq(h.gl,g),h._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var n=this;return n._currProgram&&!n._sync&&(n.gl.useProgram(n._currProgram),n._sync=!0),n._currUniforms},set:function(P){var K=this;K._currUniforms&&(K._currProgram&&!K._sync&&(K.gl.useProgram(K._currProgram),this._sync=!0),K._currUniforms.apply(P))}},attribs:{configurable:!1,enumerable:!1,get:function(){var l=this;return l._currProgram&&!l._sync&&(l.gl.useProgram(l._currProgram),l._sync=!0),l._currAttribs},set:function(q){var k=this;k._currUniforms&&(k._currProgram&&!k._sync&&(k.gl.useProgram(k._currProgram),this._sync=!0),k._currAttribs.apply(q))}}}),Gh.prototype.useProgram=function(p){var R=this;R._sync&&p===R._currProgram||(R.gl.useProgram(p),R._currProgram=p,R._currUniforms=Do(R.gl,p),R._currAttribs=Fq(R.gl,p),R._sync=!0)},Gh.prototype.directState=function(){return this.glState},Gh.prototype.directUniforms=function(){return this._currUniforms},Gh.prototype.directAttribs=function(){return this._currAttribs},Gh.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},Gh.for=function(X){var h=X._renderState;return h||(X._renderState=h=new Gh(X)),h};var $r="directional",Ej="point",Bb="spot",wc="light.color",co=4294967295,Wn=0,_e={},Kk=[],Je=0,Pq=function(y,S){hq(S)&&Qj.test(S)?Pe(y,S):Th(S)&&S.modelType?Og(y,S):S===B?delete zn[y]:zn[y]=S},Vk=function(K){return K},Tq=function(i){i=m.convertShape3dModelName(i);var L;if(Th(i)){if(i.modelType){if(i.uuid){if(L=zn[i.uuid])return L}else i.uuid=_.Math.generateUUID();return L===B&&(dp&&dp[i.uuid]||Og(i.uuid,i)),B}return i}return L=zn[i],i&&L===B&&Qj.test(i)&&(dp&&dp[i]||Pe(i,i)),L},Kp=function(W,q){W.frameStack?W.frameStack.push(q):W.frameStack=[q],W.bindFramebuffer(W.FRAMEBUFFER,q)},kg=function(K){var $=K.frameStack;if($){if($.pop(),$.length)return K.bindFramebuffer(K.FRAMEBUFFER,$[$.length-1]),void 0;K.frameStack=null}K.bindFramebuffer(K.FRAMEBUFFER,null)};Lp(m,{graph3dViewAttributes:z,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:s/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:ep,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:s,graph3dViewRotateMinPhi:0,graph3dViewShadowDisabled:!0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:s/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightDirection:"camera",graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewUvClipEnabled:!1,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewBatchInstancedDisabled:!0,graph3dViewFlowBlendMode:"addRGB",graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:Pq,getShape3dModel:Tq,convertShape3dModelName:Vk,getShape3dModelMap:function(){return zn},getCachedShape3dModelMap:function(){return tr},createMatrix:function(f,S){Jm(f)||(f=[f]);for(var m=f.length-1;m>=0;m--){var X=f[m];S=ji(X.mat,X.s3,X.r3,X.rotationMode,X.t3,S)}return S},transformVec:function(H,t){return jd(H,t)},glBindFrame:Kp,glUnbindFrame:kg,createBoxModel:function(){return{vs:On,ns:Jr,uv:gn,is:lg}},createRoundRectModel:function($,q){return is.roundRect($,q)},createStarModel:function(p,a){return is.star(p,a)},createRectModel:function(G,Q){return is.rect(G,Q)},createTriangleModel:function(Z,p){return is.triangle(Z,p)},createRightTriangleModel:function(w,k){return is.rightTriangle(w,k)},createParallelogramModel:function(v,w){return is.parallelogram(v,w)},createTrapezoidModel:function(Q,g){return is.trapezoid(Q,g)},createSmoothSphereModel:function(H,y,v,j,I,c,$){return nj(new id(H,y,v,j,I,c,$))},createSphereModel:function(h,J,x,s,y,z,r){return h?Bd(h,J,x,s,y,z,r):m.createSmoothSphereModel()},createSmoothConeModel:function(r,h,U,V,m){return Vh(r,h,U,V,m)},createConeModel:function(G,t,x,l,_,b,z,r){return G?Pg(G,t,x,l,_,b,z,r):Vh(b)},createSmoothCylinderModel:function(s,f,F,w,b,W,u,c){return nj(new Xo(s,f,F,w,b,W,u,c))},createCylinderModel:function(W,M,p,c,y,z,j,q){return W?Fl(W,M,p,c,y,z,j,q):Lo(z,j)},createSmoothTorusModel:function(z,n,s,h,w,V){return nj(new wl(z,n,s,h,w,V))},createTorusModel:function(L,I,r,$,m,W,f,o){return L?ab(L,I,r,$,m,W,f,o):Yi(W,f)},createExtrusionModel:function(A,S,U,P,o,b,Z,R){return Am(A,S,U,P,o,b,Z,R)},createSmoothRingModel:function(j,m,Z,w,t,D){for(var q=[],i=0;i<j.length-1;i+=2)q.push({x:j[i],y:j[i+1]});for(j=Qf(q,m,Z)[0],q=[],i=0;i<j.length;i++){var V=j[i];q.push(new Yb(V.x,0,V.y))}return nj(new Wp(q,D,w,t))},createTextGeometry:function(v,l){var t=nj(new qo(v,l));if(l.cube)for(var E=qm(t),c=E.min,L=E.max,s=c.x,m=c.y,M=c.z,Y=L.x-s||1,P=L.y-m||1,K=L.z-M||1,F=["vs","top_vs","bottom_vs"],N=0,S=F.length;S>N;N++){var e=t[F[N]];if(e)for(var x=0,g=e.length;g>x;x+=3)e[x]=(e[x]-s)/Y-.5,e[x+1]=(e[x+1]-m)/P-.5,e[x+2]=(e[x+2]-M)/K-.5}return t},loadFontFace:function(G,z){m.xhrLoad(G,function(u){if(!u)return z();var M;try{M=JSON.parse(u)}catch(m){M=JSON.parse(u.substring(65,u.length-2))}ed.loadFace(M),z&&z(M.familyName.toLowerCase())},z?null:{sync:!0})},getShaderErrorLog:function(){return Kk.join("\n")},createRingModel:function(Y,_,J,I,U,i,r,Q,y,$){for(var D=[],x=0;x<Y.length-1;x+=2)D.push({x:Y[x],y:Y[x+1]});i=i||m.shapeSide,r=r||0,Q=Q||i;var K,n,a,j,v,s,k,H,o,L,x,b,p,M,C,V,u,T,g=[],B=[],f=y?[]:z,S=y?[]:z,X=$?[]:z,q=$?[]:z,e=I?[]:z,A=I?[]:z,h=U?[]:z,P=U?[]:z,Y=Qf(D,_,J),w=ko(Y),R=0,O=2*Math.PI/i;return Y.forEach(function(G){if(a=G.length,a>1){if(j=G[0],I)for(s=j.x,H=j.y,x=r;Q>x;x++)b=x+1,p=x*O,M=b*O,C=c(p),V=N(p),u=c(M),T=N(M),e.push(C*s,H,-V*s,u*s,H,-T*s,0,H,0),A.push(.5-.5*C,.5-.5*V,.5-.5*u,.5-.5*T,.5,.5);for(L=0;a>L;L++){for(v=G[L],s=j.x,k=v.x,H=j.y,o=v.y,K=R/w,R+=bh(j,v),n=R/w,x=r;Q>x;x++)b=x+1,p=x*O,M=b*O,C=c(p),V=N(p),u=c(M),T=N(M),g.push(C*k,o,-V*k,u*k,o,-T*k,C*s,H,-V*s,u*k,o,-T*k,u*s,H,-T*s,C*s,H,-V*s),B.push(x/i,n,b/i,n,x/i,K,b/i,n,b/i,K,x/i,K),y&&x===r&&(f.push(0,H,0,0,o,0,C*k,o,-V*k,C*k,o,-V*k,C*s,H,-V*s,0,H,0),S.push(0,.5-H,0,.5-o,2*k,.5-o,2*k,.5-o,2*s,.5-H,0,.5-H)),$&&b===Q&&(X.push(0,H,0,u*k,o,-T*k,0,o,0,u*k,o,-T*k,0,H,0,u*s,H,-T*s),q.push(1,.5-H,1-2*k,.5-o,1,.5-o,1-2*k,.5-o,1,.5-H,1-2*s,.5-H));j=v}if(U)for(s=j.x,H=j.y,x=r;Q>x;x++)b=x+1,p=x*O,M=b*O,C=c(p),V=N(p),u=c(M),T=N(M),h.push(u*s,H,-T*s,C*s,H,-V*s,0,H,0),P.push(.5-.5*u,.5+.5*T,.5-.5*C,.5+.5*V,.5,.5)}}),{vs:g,uv:B,bottom_vs:h,bottom_uv:P,top_vs:e,top_uv:A,from_vs:f,from_uv:S,to_vs:X,to_uv:q}}},!0),Lp(b,{"3d.move.mode":B,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":B,"edge.gradient.color":B,"edge.source.t3":B,"edge.target.t3":B,"light.type":Ej,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":s/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":co,"headlight.ambientIntensity":B,"wf.visible":!1,"wf.width":1,"wf.fog":!0,"wf.color":Up,"wf.short":!1,"wf.mat":B,"wf.boundingBox":!1,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:B,"transparent.mask":!1,brightness:B,"select.brightness":.7,"repeat.uv.length":B,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":B,"3d.clipbox.mask":co,"3d.clipbox.group":0,"3d.clipbox.shape":"cube","effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":B,"effect.flow.mask":co,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":B,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Dn,"label.t3":B,"label.r3":B,"label.texture.scale":2,"label.rotationMode":Ei,"label.light":!1,"label.blend":B,"label.reverse.flip":!1,"label.reverse.color":Ml,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Dn,"label2.t3":B,"label2.r3":B,"label2.texture.scale":2,"label2.rotationMode":Ei,"label2.light":!1,"label2.blend":B,"label2.reverse.flip":!1,"label2.reverse.color":Ml,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Dn,"note.t3":B,"note.r3":B,"note.texture.scale":2,"note.rotationMode":Ei,"note.light":!1,"note.blend":B,"note.reverse.flip":!1,"note.reverse.color":Ml,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Dn,"note2.t3":B,"note2.r3":B,"note2.texture.scale":2,"note2.rotationMode":Ei,"note2.light":!1,"note2.blend":B,"note2.reverse.flip":!1,"note2.reverse.color":Ml,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,"part.boundingBox":!1,shape3d:B,"shape3d.color":rg,"shape3d.top.color":B,"shape3d.bottom.color":B,"shape3d.from.color":B,"shape3d.to.color":B,"shape3d.image":B,"shape3d.image.projection":B,"shape3d.top.image":B,"shape3d.bottom.image":B,"shape3d.from.image":B,"shape3d.to.image":B,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":B,"shape3d.side.to":B,"shape3d.smooth":B,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":B,"shape3d.opacity":B,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Ml,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":B,"shape3d.uv.scale":B,"shape3d.uv.rotation":B,"shape3d.uv.anchor":B,"shape3d.uv.union":B,"shape3d.top.uv.offset":B,"shape3d.top.uv.scale":B,"shape3d.top.uv.rotation":B,"shape3d.top.uv.anchor":B,"shape3d.bottom.uv.offset":B,"shape3d.bottom.uv.scale":B,"shape3d.bottom.uv.rotation":B,"shape3d.bottom.uv.anchor":B,"shape3d.from.uv.offset":B,"shape3d.from.uv.scale":B,"shape3d.from.uv.rotation":B,"shape3d.from.uv.anchor":B,"shape3d.to.uv.offset":B,"shape3d.to.uv.scale":B,"shape3d.to.uv.rotation":B,"shape3d.to.uv.anchor":B,"shape3d.top.cap":B,"shape3d.bottom.cap":B,"shape3d.start.angle":0,"shape3d.sweep.angle":Q,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":B,"camera.ortho.width":B,"camera.near":B,"camera.far":B,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":B,"texture.filter":B,"texture.filter.min":B,"texture.filter.mag":B,"texture.wrap":B,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":rg,"all.image":B,"all.blend":B,"all.opacity":B,"all.reverse.flip":!1,"all.reverse.color":Ml,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":B,"all.uv.offset":B,"all.uv.scale":B,"all.uv.rotation":B,"all.uv.anchor":B,"all.uv.union":B,"all.discard.selectable":!0,mat:B,"left.mat":B,"right.mat":B,"top.mat":B,"bottom.mat":B,"front.mat":B,"back.mat":B,"edge.source.anchor.elevation":B,"edge.target.anchor.elevation":B,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);var Ui,Op=!1,Hg=[0,0,0,0],Od=function(N){return N instanceof Ds},Jb=function(g){return[g.x,g.e||0,g.y]},Wf=function(x,p,C){for(var p=Qk(p||0),Z=p[0],V=p[1],f=p[2];C--;)x.push(Z,V,f)},Vm=function(c,U,T){for(var U=Qk(U||0),J=U[0],R=U[1],e=U[2],w=U[3];T--;)c.push(J,R,e,w)},vc=function(X,H,a){if(H)for(var h,u,k,K=H[0],J=H[1],$=H[2],w=H[4],I=H[5],B=H[6],M=H[8],i=H[9],g=H[10],S=H[12],_=H[13],m=H[14],D=a.length,P=0,P=0;D>P;P+=3)h=a[P],u=a[P+1],k=a[P+2],X.push(K*h+w*u+M*k+S,J*h+I*u+i*k+_,$*h+B*u+g*k+m);else re(X,a);return X},mp=function(N,C,g){var t=C.s("light.intensity"),q=Qk(C.s(wc)),d=q[0],A=q[1],b=q[2];1!==t&&(d*=t,A*=t,b*=t);var y=C.s("light.disabled");N.push(d,A,b,y?1:0),g.c.push(d,A,b),g.g.push(y?-1:C.s("light.group")),g.e.push(y?1:0)},bc=function(_,L){var z,G=Gh.for(L),x=G.directUniforms(),a=_._lastLightUploadInfo={c:[],g:[],e:[]},n=_._headlightDirection;n&&3===n.length?z=n:"shadow"===n&&(z=_.shadowMap.getDirection()),z=z?Or.normalizeArray(_._transformDirectionToViewSpace(null,z)):[0,0,0],x.uHeadlightDirection=z,x.uHeadlightRange=_._headlightRange;var U=x.uHeadlightAmbientIntensity=_._headlightAmbientIntensity,v=_._headlightIntensity,t=Qk(_._headlightColor);1!==v&&(t=[t[0]*v,t[1]*v,t[2]*v]);var H;x.uHeadlightColor=[t[0],t[1],t[2],(H=_._headlightDisabled)?1:0],a.c.push(t[0],t[1],t[2]),a.g.push(H?-1:_._headlightGroup),a.e.push(H?1:0);var j=_._59O,r=_._spots,J=_._dirs;if(j.length){var p=[],X=[],y=[];j.forEach(function(V){mp(p,V,a),re(X,_._transformPointToViewSpace(V.p3())),y.push(V.s("light.range"))}),x.uPointColor=p,x.uPointRange=y,x.uPointPosition=X}if(r.length){var q=[],e=[],W=[],o=[],P=[],u=[];r.forEach(function(H){mp(q,H,a),re(e,_._transformPointToViewSpace(H.p3())),re(P,_._transformDirectionToViewSpace(H.p3(),H.s("light.center"))),W.push(H.s("light.range")),o.push(c(H.s("light.angle")/2)),u.push(H.s("light.exponent"))}),x.uSpotColor=q,x.uSpotRange=W,x.uSpotAngle=o,x.uSpotExponent=u,x.uSpotPosition=e,x.uSpotDirection=P}if(J.length){var h=[],S=[];J.forEach(function(z){mp(h,z,a),re(S,_._transformDirectionToViewSpace(z.p3()))}),x.uDirColor=h,x.uDirDirection=S}_._lastLightMask=co,_._lastHeadlightAmbientIntensity=U},op=function(q,Z,K,O){if(O===B&&(O=q._headlightAmbientIntensity),O!==q._lastHeadlightAmbientIntensity&&(Z.uHeadlightAmbientIntensity=q._lastHeadlightAmbientIntensity=O),K!==q._lastLightMask){q._lastLightMask=K;var I=q._lastLightUploadInfo;if(I){var x,G,z,n=I.g,r=I.e,W=n.length,y=new Array(W),m=!1;for(G=0;W>G;G++)x=n[G],z=0>x||x>=32?1:K&1<<x?0:1,y[G]=z,z!==r[G]&&(m=!0);if(m){I.e=r=y;var s=I.c;Z.uHeadlightColor=[s[0],s[1],s[2],r[0]];var p,M=q._59O,k=q._spots,u=q._dirs,v=3,P=1;if(W=M.length){for(G=0,p=[];W>G;G++)p.push(s[v++],s[v++],s[v++],r[P++]);Z.uPointColor=p}if(W=k.length){for(G=0,p=[];W>G;G++)p.push(s[v++],s[v++],s[v++],r[P++]);Z.uSpotColor=p}if(W=u.length){for(G=0,p=[];W>G;G++)p.push(s[v++],s[v++],s[v++],r[P++]);Z.uDirColor=p}}}}},Mr=function(W,D){return Math.max(W.getRotateMinPhi()+ic,Math.min(W.getRotateMaxPhi()-ic,D))},zh=function(){return.05+Um()/2},Ye=function(k,i,z,r){var Z,M=k.getEye();return k.isOrtho()?(Z=of(k.getCenter(),M),Z[0]+=r[0],Z[1]+=r[1],Z[2]+=r[2]):Z=M,Mp(i,z,r,Z)},Mp=function(c,N,t,F){var Y=In(c,N),l=of(F,t,!0),s=In(l,N);if(n(s)<ic)return z;var I=(Y-In(t,N))/s;return[t[0]+l[0]*I,t[1]+l[1]*I,t[2]+l[2]*I]},ok=function(g,J){return{x:2*g.x-J.x,y:2*g.y-J.y}},uq=function(J,b,U,g){var A,V;if(!J)return A=Wc(b.y-U.y,U.x-b.x),{x:b.x+g*N(A),y:b.y+g*c(A)};if(!U)return A=Wc(J.y-b.y,b.x-J.x),{x:b.x+g*N(A),y:b.y+g*c(A)};var D=of([J.x,J.y,0],[b.x,b.y,0],!0),u=of([U.x,U.y,0],[b.x,b.y,0],!0),f=-(D[0]+u[0])/2,z=-(D[1]+u[1])/2,i=l(f*f+z*z);if(ic>i)return A=Wc(J.y-b.y,b.x-J.x),{x:b.x+g*N(A),y:b.y+g*c(A)};var h=J.x-b.x,d=J.y-b.y,Y=U.x-b.x,O=U.y-b.y,e=l(h*h+d*d),m=l(Y*Y+O*O);A=L(In(D,u))/2,V=D[1]*u[0]-D[0]*u[1]>0?-1:1,f/=i,z/=i;var W=g/N(A),P=$(e,m)/c(A);i=Math.min(W,P);var o={x:b.x+V*i*f,y:b.y+V*i*z};return U.b&&W>m/c(A)&&(o.adjust=!0),o},Io=function(c){var y=c[1],F=c[2],l=c[3],q=c[6],e=c[7],E=c[11];c[1]=c[4],c[2]=c[8],c[3]=c[12],c[4]=y,c[6]=c[9],c[7]=c[13],c[8]=F,c[9]=q,c[11]=c[14],c[12]=l,c[13]=e,c[14]=E},Zc=function(b){var H=b[0],g=b[1],P=b[2],V=b[3],X=b[4],Y=b[5],W=b[6],q=b[7],I=b[8],O=b[9],v=b[10],o=b[11],h=b[12],k=b[13],F=b[14],y=b[15],a=H*Y-g*X,N=H*W-P*X,u=H*q-V*X,l=g*W-P*Y,r=g*q-V*Y,G=P*q-V*W,E=I*k-O*h,p=I*F-v*h,Q=I*y-o*h,C=O*F-v*k,d=O*y-o*k,A=v*y-o*F,m=a*A-N*d+u*C+l*Q-r*p+G*E;return m?(m=1/m,b[0]=(Y*A-W*d+q*C)*m,b[1]=(P*d-g*A-V*C)*m,b[2]=(k*G-F*r+y*l)*m,b[3]=(v*r-O*G-o*l)*m,b[4]=(W*Q-X*A-q*p)*m,b[5]=(H*A-P*Q+V*p)*m,b[6]=(F*u-h*G-y*N)*m,b[7]=(I*G-v*u+o*N)*m,b[8]=(X*d-Y*Q+q*E)*m,b[9]=(g*Q-H*d-V*E)*m,b[10]=(h*r-k*u+y*a)*m,b[11]=(O*u-I*r-o*a)*m,b[12]=(Y*p-X*C-W*E)*m,b[13]=(H*C-g*p+P*E)*m,b[14]=(k*N-h*l-F*a)*m,b[15]=(I*l-O*N+v*a)*m,void 0):z},hk=function(f,P){if(P){var b=P[0],Y=P[1],O=P[2];f[12]=f[0]*b+f[4]*Y+f[8]*O+f[12],f[13]=f[1]*b+f[5]*Y+f[9]*O+f[13],f[14]=f[2]*b+f[6]*Y+f[10]*O+f[14],f[15]=f[3]*b+f[7]*Y+f[11]*O+f[15]}},Tl=function(F,B){if(B){var j=B[0],f=B[1],G=B[2];F[0]=F[0]*j,F[1]=F[1]*j,F[2]=F[2]*j,F[3]=F[3]*j,F[4]=F[4]*f,F[5]=F[5]*f,F[6]=F[6]*f,F[7]=F[7]*f,F[8]=F[8]*G,F[9]=F[9]*G,F[10]=F[10]*G,F[11]=F[11]*G}},zg=function(k,b,V){var d=b[0],Q=b[1],i=b[2],f=b[3],e=b[4],D=b[5],W=b[6],l=b[7],p=b[8],w=b[9],X=b[10],Z=b[11],J=b[12],r=b[13],N=b[14],v=b[15],$=V[0],s=V[1],E=V[2],n=V[3];return k[0]=$*d+s*e+E*p+n*J,k[1]=$*Q+s*D+E*w+n*r,k[2]=$*i+s*W+E*X+n*N,k[3]=$*f+s*l+E*Z+n*v,$=V[4],s=V[5],E=V[6],n=V[7],k[4]=$*d+s*e+E*p+n*J,k[5]=$*Q+s*D+E*w+n*r,k[6]=$*i+s*W+E*X+n*N,k[7]=$*f+s*l+E*Z+n*v,$=V[8],s=V[9],E=V[10],n=V[11],k[8]=$*d+s*e+E*p+n*J,k[9]=$*Q+s*D+E*w+n*r,k[10]=$*i+s*W+E*X+n*N,k[11]=$*f+s*l+E*Z+n*v,$=V[12],s=V[13],E=V[14],n=V[15],k[12]=$*d+s*e+E*p+n*J,k[13]=$*Q+s*D+E*w+n*r,k[14]=$*i+s*W+E*X+n*N,k[15]=$*f+s*l+E*Z+n*v,k},$d=function(H,r,Y,A){var y,d,s,X,O,k,C,u,m,o,c=r[0],i=r[1],w=r[2],z=A[0],S=A[1],L=A[2],h=Y[0],a=Y[1],G=Y[2];return n(c-h)<ic&&n(i-a)<ic&&n(w-G)<ic?ss(H):(C=c-h,u=i-a,m=w-G,o=1/l(C*C+u*u+m*m),C*=o,u*=o,m*=o,y=S*m-L*u,d=L*C-z*m,s=z*u-S*C,o=l(y*y+d*d+s*s),o?(o=1/o,y*=o,d*=o,s*=o):(y=0,d=0,s=0),X=u*s-m*d,O=m*y-C*s,k=C*d-u*y,o=l(X*X+O*O+k*k),o?(o=1/o,X*=o,O*=o,k*=o):(X=0,O=0,k=0),H[0]=y,H[1]=X,H[2]=C,H[3]=0,H[4]=d,H[5]=O,H[6]=u,H[7]=0,H[8]=s,H[9]=k,H[10]=m,H[11]=0,H[12]=-(y*c+d*i+s*w),H[13]=-(X*c+O*i+k*w),H[14]=-(C*c+u*i+m*w),H[15]=1,H)},Ek=function(p,j,F,C,m){var N=1/Qn(j/2),r=1/(C-m);return p[0]=N/F,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=N,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=(m+C)*r,p[11]=-1,p[12]=0,p[13]=0,p[14]=2*m*C*r,p[15]=0,p},ms=function(G,C,J,S,a,s,j){var T=1/(C-J),Y=1/(S-a),A=1/(s-j);return G[0]=-2*T,G[1]=0,G[2]=0,G[3]=0,G[4]=0,G[5]=-2*Y,G[6]=0,G[7]=0,G[8]=0,G[9]=0,G[10]=2*A,G[11]=0,G[12]=(C+J)*T,G[13]=(a+S)*Y,G[14]=(j+s)*A,G[15]=1,G},mi=function(s,F){var l=F[0],e=F[1],I=F[2],X=F[3],$=l*l+e*e+I*I+X*X,m=$?1/$:0;return s[0]=-l*m,s[1]=-e*m,s[2]=-I*m,s[3]=X*m,s},Ym=function(q,E){var Z=E[0]+E[5]+E[10],r=0;return Z>0?(r=2*Math.sqrt(Z+1),q[3]=.25*r,q[0]=(E[6]-E[9])/r,q[1]=(E[8]-E[2])/r,q[2]=(E[1]-E[4])/r):E[0]>E[5]&E[0]>E[10]?(r=2*Math.sqrt(1+E[0]-E[5]-E[10]),q[3]=(E[6]-E[9])/r,q[0]=.25*r,q[1]=(E[1]+E[4])/r,q[2]=(E[8]+E[2])/r):E[5]>E[10]?(r=2*Math.sqrt(1+E[5]-E[0]-E[10]),q[3]=(E[8]-E[2])/r,q[0]=(E[1]+E[4])/r,q[1]=.25*r,q[2]=(E[6]+E[9])/r):(r=2*Math.sqrt(1+E[10]-E[0]-E[5]),q[3]=(E[1]-E[4])/r,q[0]=(E[8]+E[2])/r,q[1]=(E[6]+E[9])/r,q[2]=.25*r),q},up=function(h,v,W){var Z=v[0],S=v[1],A=v[2],s=v[3],N=Z+Z,U=S+S,P=A+A,g=Z*N,H=Z*U,O=Z*P,o=S*U,T=S*P,K=A*P,r=s*N,$=s*U,B=s*P;return h[0]=1-(o+K),h[1]=H+B,h[2]=O-$,h[3]=0,h[4]=H-B,h[5]=1-(g+K),h[6]=T+r,h[7]=0,h[8]=O+$,h[9]=T-r,h[10]=1-(g+o),h[11]=0,h[12]=W[0],h[13]=W[1],h[14]=W[2],h[15]=1,h},Cj=function(e,h){if(e.isVREnabled()){var u=e.vr.getViewMatrix(h);if(u)return u}return e._camera?e._camera.getViewMatrix(h):$d(h?h:Cd(),e._eye,e._center,e._up)},gr=function(A,H){if(A.isVREnabled()){var W=A.vr.getProjectMatrix();if(W)return W}if(A._camera)return A._camera.getProjectMatrix();if(!H&&A._computedProjectMatrix)return Cp(A._computedProjectMatrix);var P=A.getAspect(),F=A._near,q=A._far,r=Cd();if(A._ortho){var g=A._orthoWidth/2,j=g/P;ms(r,-g,g,-j,j,F,q)}else Ek(r,A._fovy,P,F,q);return r},gq=function(q,b){if(!q)return z;var e=0,c=1,v=2,G=[],j=0,J=q.length,X=J/3;if(b){for(;J>j;j++)G[j]=0;for(j=0;j<b.length;j+=3){var Z=[],p=[],K=[];Z[e]=q[3*b[j+1]+e]-q[3*b[j]+e],Z[c]=q[3*b[j+1]+c]-q[3*b[j]+c],Z[v]=q[3*b[j+1]+v]-q[3*b[j]+v],p[e]=q[3*b[j+2]+e]-q[3*b[j+1]+e],p[c]=q[3*b[j+2]+c]-q[3*b[j+1]+c],p[v]=q[3*b[j+2]+v]-q[3*b[j+1]+v],K[e]=Z[c]*p[v]-Z[v]*p[c],K[c]=Z[v]*p[e]-Z[e]*p[v],K[v]=Z[e]*p[c]-Z[c]*p[e];for(var r=0;3>r;r++)G[3*b[j+r]+e]+=K[e],G[3*b[j+r]+c]+=K[c],G[3*b[j+r]+v]+=K[v]}}else for(j=0;X>j;j+=3){var Z=[],p=[],K=[];Z[e]=q[3*(j+1)+e]-q[3*j+e],Z[c]=q[3*(j+1)+c]-q[3*j+c],Z[v]=q[3*(j+1)+v]-q[3*j+v],p[e]=q[3*(j+2)+e]-q[3*(j+1)+e],p[c]=q[3*(j+2)+c]-q[3*(j+1)+c],p[v]=q[3*(j+2)+v]-q[3*(j+1)+v],K[e]=Z[c]*p[v]-Z[v]*p[c],K[c]=Z[v]*p[e]-Z[e]*p[v],K[v]=Z[e]*p[c]-Z[c]*p[e];for(var r=0;3>r;r++)G[3*(j+r)+e]=K[e],G[3*(j+r)+c]=K[c],G[3*(j+r)+v]=K[v]}for(j=0;J>j;j+=3){var I=[];I[e]=G[j+e],I[c]=G[j+c],I[v]=G[j+v];var B=l(I[e]*I[e]+I[c]*I[c]+I[v]*I[v]);0===B&&(B=ic),I[e]=I[e]/B,I[c]=I[c]/B,I[v]=I[v]/B,G[j+e]=I[e],G[j+c]=I[c],G[j+v]=I[v]}return new al(G)},cm=function(P,U,F,K){if(F||(F=P.createTexture()),U){var V=P.TEXTURE_2D,D=P.REPEAT,a=P.CLAMP_TO_EDGE,T=P.TEXTURE_MIN_FILTER;K=K||df;var R=K.minFilter||K.filter||P.LINEAR,u=K.magFilter||K.filter||P.LINEAR;P.activeTexture(P.TEXTURE0),cj(P,F),P.texImage2D(V,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,U),bo(P,P.TEXTURE_MAG_FILTER,u);var k=U.naturalWidth||U.width,G=U.naturalHeight||U.height;_k.isPOT(k)&&_k.isPOT(G)&&!K.clampToEdge&&!U.clampToEdge?(bo(P,P.TEXTURE_WRAP_S,D),bo(P,P.TEXTURE_WRAP_T,D),bo(P,T,R===P.NEAREST?P.NEAREST_MIPMAP_NEAREST:P.LINEAR_MIPMAP_LINEAR),K.mipmapMaxLevel!==B&&bo(P,P.TEXTURE_MAX_LEVEL,K.mipmapMaxLevel),P.generateMipmap(V)):(bo(P,P.TEXTURE_WRAP_S,a),bo(P,P.TEXTURE_WRAP_T,a),bo(P,T,R)),cj(P,z)}return F},ng=function($,L,o){var D=new Uint8Array(o||4);return L=L||$.createTexture(),$.activeTexture($.TEXTURE0),cj($,L),bo($,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texImage2D($.TEXTURE_2D,0,$.RGBA,1,1,0,$.RGBA,$.UNSIGNED_BYTE,D),L},nl=function(u,n,f){var z=new Uint8Array(f||4);return n=n||u.createTexture(),u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_CUBE_MAP,n),u.texParameteri(u.TEXTURE_CUBE_MAP,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_CUBE_MAP,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,z),u.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,z),u.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,z),u.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,z),u.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,z),u.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,z),n},Rq=function($){$._26I&&$._prg&&($._26I.deleteProgram($._prg),$._prg=z)},bq=function(){function p(U){if(U.match(W))return Mm(U);var h=t[U];if(h)return h;var B=new RegExp("#define\\s+"+U+"\\s+(\\d+)"),J=Y.match(B);return t[U]=J?Mm(J[1]):0}function b(a){t={},Y=a;var z=a.replace(D,L).replace(N,F);return Y=null,t=null,z}function L(y,b,T){T=p(T);for(var j="",L=0;T>L;L++)j+=b+L+";";return j}function F(t,b,r,k){for(var D="",x=p(b);x<p(r);x++)D+=k.replace(/\[\s*i\s*\]/g,"["+x+"]").replace(/\[\s*I\s*\]/g,x);return D}var t,Y,D=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,N=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,W=/^\d+$/;return function(J){return b(J)}}(),xb=function(f,F,G,A){var u=f.createShader(G);return f.shaderSource(u,bq(A)),f.compileShader(u),f.attachShader(F,u),u},Co=function(I){return I.createBuffer()},cj=function(s,p){s.bindTexture(s.TEXTURE_2D,p||s._emptyTexture)},bo=function(v,N,W){v.texParameteri(v.TEXTURE_2D,N,W)},Pr=function(D,y){var M=Gh.for(D).directState();M.polygonOffset.enabled=!0,M.polygonOffset.value=y},pi=function(b){var D=Gh.for(b).directState();D.polygonOffset.enabled=!1},br=function(F,m){if(m){var O=Gh.for(F).directState();O.color.clear=Qk(m)
}},Cn=function(N,G,L){if(L!==G._lastClipboxEnabled){var z=N._boxClipperGroups,e=N._boxClipperShape,x=z?z.length:0,Z=new Array(x);if(L)for(var Y=0;x>Y;Y++)Z[Y]=L&1<<z[Y]?e[Y]:0;G._lastClipboxEnabled=L,G.uClipperShape=Z}},Vj=Cn,ff=function(x){var o=Gh.for(x),$=o.directUniforms(),b=o.directAttribs();$.uFix=!0,b.aNormal=!1},Rn=function(e){var M=Gh.for(e),c=M.directUniforms();c.uFix=!1},wn=function(M,h,N,F,R,x,T,w){var A=Gh.for(M),c=A.directState(),S=A.directUniforms();M._picking||(N?(S.uBlend=!0,S.uBlendColor=N):S.uBlend=!1,S.uLight=S.uFog=F==z?!0:F,Aj(R)&&1!==R&&(S.uPartOpacity=R),S.uReverseFlip=x==z?!1:x,S.uFixPickReverseColor=T||Ml),c.cullFace.enabled=w?!0:!1},xj=function(W){if(!W._picking){var O=Gh.for(W),C=O.directUniforms();C.uPartOpacity=1}},vf=function(){var c=new _.Math.Matrix2d,A=[1,0,0,0,1,0,0,0,0];return function(M,P,$,y,t,g,S,_,p,T,x){var w=Gh.for(M),W=w.directUniforms(),b=w.directAttribs();return $?(W.uTexture=!0,W.uDiscardSelectable=Zn(y)?y:!0,b.aUv=Cs(M,t,g,z,2),x?(W.uBlendTexture=!0,W.uBlendSampler=x):(W.uBlendTexture=!1,W.uBlendSampler=M._emptyBlendTexture),W.uSampler=$,W.uUvMatrix=S||_||p||T?jb(p,S,_,T,c).toArray9():A,void 0):(W.uSampler=M._emptyTexture,W.uBlendSampler=M._emptyBlendTexture,void 0)}}(),uf=function(Z,K,$){var o=Gh.for(Z),u=o.directUniforms(),l=o.directAttribs();Z.activeTexture(Z.TEXTURE0),cj(Z,z),Z.activeTexture(Z.TEXTURE1),cj(Z,z),$&&(l.aUv=!1,u.uTexture=!1,u.uSampler=Z._emptyTexture,u.uBlendTexture=!1,u.uBlendSampler=Z._emptyBlendTexture)},zm=function(l,Z,w,F,e,I){var R=Gh.for(l),p=R.directUniforms(),m=R.directAttribs();!w||Md||hd||l.lineWidth(w),F&&!l._picking&&(p.uFixPickReverseColor=F),e&&(m.aPosition=Cs(l,e,I,z))},am=function(m,E,I,J,W){Ui&&(J=m[Ui]),W?m.drawArraysInstanced(J==z?m.TRIANGLES:J,E,I,W):m.drawArrays(J==z?m.TRIANGLES:J,E,I);var k=m._renderInfo;k&&(k.calls++,W&&(I*=W),k.vertices+=I,(J==z||J===m.TRIANGLES)&&(k.faces+=I/3),J===m.LINES&&(k.lines+=I/2),J===m.POINTS&&(k.points+=I))},Ck=function(r,Y,d,v,y,a){Ui&&(v=r[Ui]),a?r.drawElementsInstanced(v==z?r.TRIANGLES:v,d,y==z?r.UNSIGNED_SHORT:y,Y==z?0:2*Y,a):r.drawElements(v==z?r.TRIANGLES:v,d,y==z?r.UNSIGNED_SHORT:y,Y==z?0:2*Y);var W=r._renderInfo;W&&(W.calls++,a&&(d*=a),W.vertices+=d,(v==z||v===r.TRIANGLES)&&(W.faces+=d/3),v===r.LINES&&(W.lines+=d/2),v===r.POINTS&&(W.points+=d))},wr=function(K,a,q){var S=K.ARRAY_BUFFER;return K.bindBuffer(S,a),q&&K.bufferData(S,q,K.STATIC_DRAW),a},di=function(A,U,f,m,H){var U=Cs(A,U,f,m,H);return U.instanced=!0,U},Cs=function(r,p,t,y,d){return t?Db(r,r.ARRAY_BUFFER,p,t):wr(r,p,t,y,d)},Vg=function(q,h,Y){var s=q.ELEMENT_ARRAY_BUFFER;q.bindBuffer(s,h),Y&&q.bufferData(s,Y,q.STATIC_DRAW)},Wj=function(W,X,m){Db(W,W.ELEMENT_ARRAY_BUFFER,X,m)},Db=function(m,z,x,s){var p=s._bufId;p||(p=s._bufId=_.Math.generateIncreasingID());var x,g=m._bufPool;return(x=g[p])&&x._buf?m.bindBuffer(z,x._buf):(x=g[p]={_buf:Co(m)},m.bindBuffer(z,x._buf),m.bufferData(z,s,m.STATIC_DRAW)),x._fid=m._renderInfo.frame,x._buf},hn=function(g,k){k!=z&&k>=0&&g.enableVertexAttribArray(k)},Hd=function(J,w){w!=z&&w>=0&&J.disableVertexAttribArray(w)},nc=function(O,i){var l=O.getGL(),k=Gh.for(l),p=k.directUniforms();O._7O=O._8O.pop(),i&&(p.uMVMatrix=O._7O,O._6O=i,p.uNMatrix=i)},pq=function(v,q){return q||(q=Cd()),_b(q,v),Zc(q),Io(q),q},Zm=function(m,j){var V=m.getGL(),y=m._7O,k=Gh.for(V),K=k.directUniforms();j?(m._8O.push(Cp(y)),K.uMMatrix=j,zg(y,y,j),m._7O=y):K.uMMatrix=Sb,K.uMVMatrix=y,K.uNMatrix=pq(y,m._6O)},vg={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Mh=10,zq=function(Q,d,_,Z,q,H){var e;if(_){var D=Z._pickId;D||(D=Z._pickId=d._pickIdUsed,d._pickIdUsed+=Mh);var k,u=vg[q];if(null!=u)k=D+u;else{var g=Z._pickExtraPartMap;g||(g=Z._pickExtraPartMap={}),(k=g[q])||(k=g[q]=d._pickIdUsed++)}d[k]||(d[k]={data:Z.data,part:q}),e=Vs(k)}else e=Hg;if(!H){var $=Gh.for(Q),b=$.directUniforms();b.uFixPickReverseColor=e}return e},Xd=zq,be=function(K,J,L){"target"!==L&&(L="source");var M="target"===L?J.getTargetAgent():J.getSourceAgent(),y="edge."+L+".";if(Dk(M)){var H=J.s(y+"anchor.x"),g=J.s(y+"anchor.elevation"),$=J.s(y+"anchor.y"),t=vs(M,K.getMat(M)),O=M.getAnchor3d(),Z=jd([(H===B?.5:H)-O.x,(g===B?.5:g)-O.y,($===B?.5:$)-O.z],t);return Z[1]+=J.s(y+"offset.elevation"),Z}var v=J.s(y+"index"),q=K.getData3dUI(M);if(!q.info||!q.info.list)return!1;if(v>=0){var f,s,E,r,e,D=q.info._lastPointsSegments,U=D.points,i=D.segments,S=-1,w=-1;for(E=0,r=i?i.length:U.length;r>E;E++){if(s=i?i.get(E):1,3===s)e=2;else if(4===s)e=3;else{if(5===s)continue;e=1}if(S+=e,w++,w===v){f=U.get(S);break}}return f||(f=U.get(U.length-1)),[f.x,(f.e||0)+J.s(y+"offset.elevation"),f.y]}var k=J.s(y+"percent")||.5;if(k=Math.max(0,Math.min(k,1)),!q||!q.getCache)return!1;var o=q.getCache(),r=o[o.length-1].length,D=K.getLineOffset(M,k*r),Z=D.point;return[Z.x,Z.y+J.s(y+"offset.elevation"),Z.z]},wd=function(){var Y={center:function(f,e,n,B,N){var p=-e[1]/2,d={x:-e[0]/2,y:p,width:e[0],height:e[1]},G=Gb(f,d,n);return[G.x+B,-G.y-N,m.getPosition3dGap()]},front:function(n,o,H,N,L){var Q=-o[1]/2,g={x:-o[0]/2,y:Q,width:o[0],height:o[1]},d=Gb(n,g,H);return[d.x+N,-d.y-L,o[2]/2+m.getPosition3dGap()]},back:function(J,F,U,W,C){var w=-F[0]/2,h=-F[1]/2,Y={x:w,y:h,width:F[0],height:F[1]},k=Gb(J,Y,U);return[-k.x-W,-k.y-C,-F[2]/2-m.getPosition3dGap()]},left:function(Z,A,k,D,C){var z=-A[1]/2,r={x:-A[2]/2,y:z,width:A[2],height:A[1]},W=Gb(Z,r,k);return[-A[0]/2-m.getPosition3dGap(),-W.y-C,W.x+D]},right:function(Y,D,s,V,a){var x=-D[2]/2,A=-D[1]/2,$={x:x,y:A,width:D[2],height:D[1]},H=Gb(Y,$,s);return[D[0]/2+m.getPosition3dGap(),-H.y-a,-H.x-V]},top:function(Q,t,z,s,_){var f={x:-t[0]/2,y:-t[2]/2,width:t[0],height:t[2]},w=Gb(Q,f,z);return[w.x+s,t[1]/2+m.getPosition3dGap(),w.y+_]},bottom:function(X,N,P,T,U){var C=-N[2]/2,S={x:-N[0]/2,y:C,width:N[0],height:N[2]},V=Gb(X,S,P);return[V.x+T,-N[1]/2-m.getPosition3dGap(),-V.y-U]}};return function(v,g,c,e,s,i){return Y[e](v,g,c,s||0,i||0)}}(),Ue=function(k,o,Q,Z,n,m,H,K,y,U){if(n&&(o[0]+=n[0],o[1]+=n[1],o[2]+=n[2]),hk(k,Q),K){var g=Cd();if(wj(g,y,U),jd(o,g),hk(k,o),k.auto=K,k.pos=jd([0,0,0],k),m){var c=k.mat2=Cd();wj(c,m,H)}}else wj(k,y,U),hk(k,o),Z===Mq?Uj(k,-Yp):Z===ze?Uj(k,Yp):Z===Ih?zl(k,-Yp):Z===Vd?zl(k,Yp):Z===Zl&&Uj(k,s),wj(k,m,H);return k},ce=function(W,N){var m=N.auto,z=N.mat2,M=W.gv;if(m){var Y,H=Cd(),f=[0,0,0,0];Y="string"==typeof m?[m.indexOf("x")<0?M._eye[0]:M._center[0],m.indexOf("y")<0?M._eye[1]:M._center[1],m.indexOf("z")<0?M._eye[2]:M._center[2]]:M._eye,Ym(f,$d(Cd(),Y,M._center,M._up)),up(H,mi(f,f),N.pos),z&&zg(H,H,z),Zm(M,H)}else Zm(M,N)},xd=function(c,O,A,F,L){var m=c.s,d=c.gv,j=d.getGL(),n=d._prg,V=d._buffer,r=d._1O,Z=Gh.for(j),i=Z.directAttribs();cm(j,Pj,r),ce(c,A),wn(j,n,m(O+".blend"),m(O+".light"),m(O+".opacity"),m(O+".reverse.flip"),m(O+".reverse.color"),m(O+".reverse.cull")),vf(j,n,r,L,V.uv,zi),i.aPosition=Cs(j,V.vs,F,z),i.aNormal=Cs(j,V.ns,Fo,z),Wj(j,V.is,me),Ck(j,0,me.length),uf(j,n,r),xj(j,n),nc(d)},uh=function(l,x,o){var T=l.gv,p=l.data,c=l[x]={blend:T.getBodyColor(p)||T.getFaceBlend(p,x),light:T.getFaceLight(p,x),color:T.getFaceColor(p,x),opacity:T.getFaceOpacity(p,x),transparent:T.getFaceTransparent(p,x),reverseFlip:T.getFaceReverseFlip(p,x),reverseColor:T.getFaceReverseColor(p,x),reverseCull:T.getFaceReverseCull(p,x),texture:T.getFaceImage(p,x),blendTexture:T.getFaceBlendImage(p,x),discardSelectable:T.getFaceDiscardSelectable(p,x)};if("csg"!==x){c.uv=T.getFaceUv(p,x)||o&&o[x+"Uv"],c.uvScale=T.getFaceUvScale(p,x)||o&&o[x+"UvScale"],c.uvOffset=T.getFaceUvOffset(p,x)||o&&o[x+"UvOffset"],c.uvRotation=T.getFaceUvRotation(p,x)||o&&o[x+"uvRotation"],c.uvAnchor=T.getFaceUvAnchor(p,x)||o&&o[x+"uvAnchor"];var X=T.getFaceMat(p,x);if(X){var r=vs(p,X);p.appendAnchorMatrix3d(r),c.mat=r}}return c},_f=function(W,O,a,v,r){var y=W[v];if(y){if(!r(y.transparent))return;var $=W.data,C=W.gv,i=C._buffer,F=C.getTexture(y.texture,$,v),K=C.getTexture(y.blendTexture,$),e=Gh.for(O),M=e.directUniforms(),l=e.directAttribs();vf(O,a,F,y.discardSelectable,i.uv,y.tuv,y.uvOffset,y.uvScale,y.uvRotation,y.uvAnchor,K),wn(O,a,y.blend,y.light,y.opacity,y.reverseFlip,y.reverseColor,y.reverseCull),y.cs&&!C._batchColorDisabled?(M.uBatchColor=!0,l.aBatchColor=Cs(O,i.batchColor,y.cs,a.aBatchColor,4)):M.uDiffuse=y.color||b["color.empty"],l.aPosition=Cs(O,i.vs,y.vs,z),l.aNormal=Cs(O,i.ns,y.ns,z),am(O,0,y.vs.length/3),y.cs&&!C._batchColorDisabled&&(M.uBatchColor=!1,Hd(O,a.aBatchColor)),xj(O,a),uf(O,a,F)}},Gd=function(G,H,g){Jm(G)?G.forEach(function(S){Gd(S,H,g)}):hq(G)?Gd(qb(H,G),H,g):Th(G)?G.shape3d?Gd(G.shape3d,H,g):g.push(G):g.push(G)},Qd=function(){for(var N=50,E=arguments.length,x=[],C=0;E>C;C++)x[C]=arguments[C];Kk[Je]="Time : "+(new Date).toLocaleString()+", Info :"+x.join(", "),Je=(Je+1)%N,console.error("Failed to create shader.")},jb=function(){var J=new _k.Matrix2d;return function(h,p,b,r,j){return j||(j=J),j.identity(),r&&j.translate(-r[0],-r[1]),b&&j.scale(b[0],b[1]),h&&j.rotate(h),r&&j.translate(r[0],r[1]),p&&j.translate(p[0],p[1]),j}}(),Lb=function(I,Y,W,c,$,x){var V,q,r,w,u,h,j,y,T,M,i,p=[c-Y,$-W],N=I?I.length:0;for(r=0;N>r;r++){for(w=2,V=I[r],u=V[0],h=V[1];w+1<V.length;){if(j=V[w],y=V[w+1],q=Zk(Y,W,c,$,u,h,j,y,!0)){T=[j-u,y-h],M=bh(T),T[0]/=M,T[1]/=M,M=In(p,T),M=M>0?x:-x,i=[T[0]*M,T[1]*M];break}u=j,h=y,w+=2}if(i)break}if(i)for(c=Y+i[0],$=W+i[1],r=0;N>r;r++)for(w=2,V=I[r],u=V[0],h=V[1];w+1<V.length;){if(j=V[w],y=V[w+1],q=Zk(Y,W,c,$,u,h,j,y,!0))return[0,0];u=j,h=y,w+=2}return i?i:[c-Y,$-W]},Ed=function(h){return"nearest"===h?Uk.NEAREST:"linear"===h?Uk.LINEAR:h},ae=_.graph3d={WebGLConstants:Uk},yc=function(M,X,w){Fm(j+".graph3d."+M,X,w)},mn="!~!<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~!<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg!<{zy/*enspgtobsu!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMwVxpmg!4dfw!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<enspgtobsu!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!gjeof$!~!<fdobutjEfojMb!>!fdobutjEfojMw!|!*itbEv)!gj!ITBE!gfegj$!gjeof$!~!<ttfouihjsCidubCb!>!ttfouihjsCidubCw!|!*ttfouihjsCidubCv)!gj!TTFOUIHJSCIDUBC!gfegj$!gjeof$!~!<eofmCidubCb!>!eofmCidubCw!|!*eofmCidubCv)!gj!EOFMCIDUBC!gfegj$!gjeof$!~!<spmpDidubCb!>!spmpDidubCw!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!gjeof$!~!<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw!|!*fsvuyfUv)!gj!ftmf$!<*y/wVb!-**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw)4dfw!>!wVw!QJMD`WV!gfegj$!<*enspgtobsu)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<*enspgtobsu!+!yjsubNNv)4dfw!>!emspXw!<*yfusfw)4dfw!>!yfusfWw!gjeof$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf!~!<**1/2!-mbnspOw!+!n)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!<**^3]n!-^3]n)upe!-*^2]n!-^2]n)upe!-*^1]n!-^1]n)upe)4dfw!0!mbnspOb!>!mbnspOw!<*!efdobutoJyjsubNb!)4ubn!>!n!4ubn!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!gjeof$!|!*ldjQva)!gj!1!>>!SFQQJMD`YPC`YBN!gj$!<enspgtobsu!+!yjsubNWNv!>!yfusfw!5dfw!gjeof$!~!<enspgtobsu!+!efdobutoJyjsubNb!>!enspgtobsu!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!<*1/2!-opjujtpQb)5dfw!>!enspgtobsu!5dfw!|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<esppDxpebit!5dfw!hojzsbw!<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEfojMb!ubpmg!fuvcjsuub!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCb!4dfw!fuvcjsuub!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCb!ubpmg!fuvcjsuub!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCb!5dfw!fuvcjsuub!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw!<emspXw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<yjGv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!<yjsubNOv!5ubn!nspgjov!<yjsubNQv!5ubn!nspgjov!<yjsubNNv!5ubn!nspgjov!<yjsubNWNv!5ubn!nspgjov!<opjujtpQb!4dfw!fuvcjsuub!gjeof$!~!<*{zy/**1/1!-sje)5dfw!+!yjsubn))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsu!4dfw!<efdobutoJyjsubNb!5ubn!fuvcjsuub!<fdobutoJftVv!mppc!nspgjov!FDOBUTOJIDUBC!gfegj$!<mbnspOb!4dfw!fuvcjsuub!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<wVb!3dfw!fuvcjsuub!<yjsubNwVv!4ubn!nspgjov!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!YJGFSQ$!^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Mc="!~!~!<eJ!>!spmpDhbsG`mh!~!<spmpDsfmqnbTwv!>+!eJ!<*zy/wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw!|!*fsvuyfUeofmCv)!gj!gjeof$!~!<ttfouihjsCidubCw!>+!chs/eJ!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~!<ttfouihjsCv!>+!chs/eJ!|*1/2!>a!ttfouihjsCv)gj!gjeof$!~!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!|!*hpGv)!gj!HPG!gfegj$!~!~!<zujdbqPusbQv!>+!b/eJ!|*1/2!>a!zujdbqPusbQv)gj!~!gjeof$!~!<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof!<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw!ftmf$!<***mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!-ubvRqbnwoFv)spudfWfubups)f{jmbnspo!>!dfWudfmgfs!4dfw!FUBUPS`QBNWOF!gfegj$!<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw!<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw!|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!gjeof$!~!~!~!~!<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ!<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt!|*^j]fmhoBupqTv!?!udfggFupqt)gj!<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg!<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSupqTv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDupqTv)gj!|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!gjeof$!~!~!~!<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSuojpQv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDuojpQv)gj!|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!gjeof$!~!~!<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!>>!x/^j]spmpDsjEv)gj!|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~!<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~!<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!<osvufs!<esbdtje!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj!<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg!|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~!<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!>+!nsfUusfcnbm!|*1/1!?!fhobSuihjmebfIv)gj!<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!nsfUusfcnbm)ybn!>!nsfUusfcnbm!<*opjudfsjEuihjmebfIv.!-O)upe!>!nsfUusfcnbm!ftmf!<*M.!-O)upe!>!nsfUusfcnbm!*1/1!>>!{/opjudfsjEuihjmebfIv!%%!1/1!>>!z/opjudfsjEuihjmebfIv!%%!1/1!>>!y/opjudfsjEuihjmebfIv)!gj!<nsfUusfcnbm!ubpmg!|*1/1!>>!x/spmpDuihjmebfIv)gj!gjeof$!EOF`QPPM`MMPSOV$!~!gjeof$!<chs/mfyfUxpmg!>,!chs/eJ!ftmf$!<bchs/mfyfUxpmg!>,!bchs/eJ!*!BCHS`EEB`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>!bchs/eJ!*!BCHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<b/mfyfUxpmg!>!b/eJ!*!B`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>!chs/eJ!*!CHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>+!bchs/eJ!*!BCHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>+!chs/eJ!*!CHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gj$!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj!<*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!>!mfyfUxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!<mfyfUxpmg!5dfw!1!?!UDFKCP`XPMG`YBN!gj$!|!*uihjMv)!gj!~!gjeof$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf!~!<eofmCidubCw!>+!chs/eJ!|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~!~!<esbdtje!|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~!<ftvggjEv!>!eJ!|ftmf~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!ftmf!~!<spmpDwv!>!eJ!|*fsvuyfUv)gj!|!ftmf!~!<spmpDftsfwfSldjQyjGv!>!eJ!|*qjmGftsfwfSva!%%!ldbCtj)gj!~!<fvsu!>!ldbCtj!<O.!>!O!|*1/1!=!*O!-F)upe)gj!<ftmbg!>!ldbCtj!mppc!<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw!|!ftmf!~!gjeof$!~!~!<ftvggjEv!>!eJ!|ftmf!~!<esbdtje!|*1/1!>>!x/ftvggjEv)gj!|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!eJ!|!ftmf!~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!*yjGv)!gj!<eJ!5dfw!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!|!ftmf!~!<spmpDidubCw!>!spmpDhbsG`mh!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!|!*ldjQv)!gj!~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~!~!<osvufs!<esbdtje!|!**6/1!=!*mbdpMw)iuhofm)!>a!^j]sfooJqjmDsfqqjmDv!%%!3!>>!^j]fqbiTsfqqjmDv!}}!***ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!2!>>!^j]fqbiTsfqqjmDv)!gj!<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw!|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~!gjeof$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj!ftmf$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQqjmd!-sje)upe)!gj!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2.!>!y/sje!|!*:!=!opjudfsjEqjmDv)!gj!ftmf!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2!>!y/sje!|!*9!=!opjudfsjEqjmDv)!gj!ftmf!QJMD`WV!gfegj$!~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj!gjeof$!<opjujtpQw!>!opjujtpQqjmd!4dfw!QJMD`WV!gfegj$!<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw!|!*1!?!opjudfsjEqjmDv)!gj!~!~!~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!|!*uofsbqtobsUv)!gj!gjeof$!<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!ftmf$!<*zy/wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!QJMD`WV!gfegj$!|!**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)!gj!<spmpDwv!5dfw!|!*ejpw)ojbn!ejpw!<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov!<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!gjeof$!~!~!<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs!<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw!|!ftmf!~!<*1/2!-1spmpd)5dfw!osvufs!|!*1/1!>>!Gqjn)!gj!<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw!<*qjn)sppmg!>!uoJqjn!ubpmg!<*qjn)udbsg!>!Gqjn!ubpmg!<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg!|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~!<qjn!osvufs!~!<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn!|!ftmf!~!<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn!|!*7s!>?!ttfoihvps)!gj!ftmf!~!<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn!|!*6s!>?!ttfoihvps)!gj!ftmf!~!<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn!|!*5s!>?!ttfoihvps)!gj!ftmf!~!<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn!|!*2s!>?!ttfoihvps)!gj!<1/1!>!qjn!ubpmg!|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~!<*z/g!-nc!-nu)yjn!osvufs!<*y/g!-sc!-mc)yjn!>!nc!4dfw!<*y/g!-su!-mu)yjn!>!nu!4dfw!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw!<f{jTmfyfu!>.!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw!<f{jTmfyfu!>,!z/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw!<f{jTmfyfu!>,!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw!<f{jTmfyfu!>+!wv!<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv!<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv!~!<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv!|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj!<f{jTfdbg!+!fdbg!>,!y/wv!~!<1/4!>.!fdbg!<f{jTfdbg!>,!z/wv!|!*1/3!?!fdbg)!gj!<g!.!6/1!>,!wv!<*wv)udbsg!>!g!3dfw!<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw!<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg!<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg!<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn!<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg!<*opjudfsje)fdbGufh!>!fdbg!ubpmg!|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~!<*1/2!,!wv)!+!6/1!osvufs!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv!|!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/5!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv!|!*1/4!>>!fdbg)!gj!ftmf!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/3!>>!fdbg)!gj!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv!|!*1/2!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv!|!*1/1!>>!fdbg)!gj!<wv!3dfw!|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~!<fdbg!osvufs!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj!|!ftmf!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!<1/2!.!>!fdbg!ubpmg!<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw!|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~!<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw!~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!~!<{zy/*!*x/ubvr!-{/ubvr.!-z/ubvr.!-y/ubvr.)5dfw!-wr!)ubvRumvn!osvufs!<*!*1/1!-dfw)5dfw!-ubvr!)ubvRumvn!>!wr!5dfw!|!*!dfw!4dfw!-ubvr!5dfw!)spudfWfubups!4dfw!~!<*!{/3r!+!{/2r!.!z/3r!+!z/2r!.!y/3r!+!y/2r!.!x/3r!+!x/2r!-z/3r!+!y/2r!.!y/3r!+!z/2r!,!x/3r!+!{/2r!,!{/3r!+!x/2r!-y/3r!+!{/2r!.!{/3r!+!y/2r!,!x/3r!+!z/2r!,!z/3r!+!x/2r!-{/3r!+!z/2r!.!z/3r!+!{/2r!,!x/3r!+!y/2r!,!y/3r!+!x/2r)5dfw!osvufs!|!*3r!5dfw!-2r!5dfw)ubvRumvn!5dfw!<ubvRqbnwoFv!5dfw!nspgjov!FUBUPS`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!gjeof$!~!gjeof$!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!ftmf$!<*1/:!0!1/2)!+!*!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!)!osvufs!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!<tbjCxpebit!>,!qe!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!~!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!~!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!<*z/w)ohjt!>!Zohjt!ubpmg!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!<*y/w)ohjt!>!Yohjt!ubpmg!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!<y/w!.!1/5!>!y/sbobmq!*1/1!?!{/w)!gj!|!*foPutpnmb!>?!{/Wtcb)!gj!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!<zy/w!>!sbobmq!3dfw!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!<fcvDpUfmbdt!>+!Wtcb!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!<*w)tcb!>!Wtcb!4dfw!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!~!<xpebit!osvufs!~!gjeof$!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!ftmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!|!*utfUnvutvsg)!gj!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!<tbjCxpebit!>,!{/esppDxpebit!<x/esppDxpebit!>0!{zy/esppDxpebit!<1/2!>!xpebit!ubpmg!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!~!<d!osvufs!<*y/g!-c!-b)yjn!>!d!ubpmg!<*z/g!-us!-cs)yjn!>!c!ubpmg!<*z/g!-um!-cm)yjn!>!b!ubpmg!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!~!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!~!<*tspudbGldbqoV!-w)upe!osvufs!|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!<*/763!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!<esppDxpebit!5dfw!hojzsbw!<fwjfdfSxpebit!mppc!nspgjov!<tvjebSxpebit!ubpmg!nspgjov!<tbjCxpebit!ubpmg!nspgjov!<zujtofuoJxpebit!ubpmg!nspgjov!<f{jTxpebit!3dfw!nspgjov!<qbNxpebit!E3sfmqnbt!nspgjov!<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEqbHitbEv!ubpmg!nspgjov!<fdobutjEitbEv!ubpmg!nspgjov!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!gjeof$!<sbGhpGv!ubpmg!nspgjov!<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<hpGv!mppc!nspgjov!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd!<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd!<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov!<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov!<^SFQQJMD`YPC`YBN]fqbiTsfqqjmDv!uoj!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov!<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov!<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjudfsjEuihjmebfIv!4dfw!nspgjov!<spmpDuihjmebfIv!5dfw!nspgjov!<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov!<fhobSuihjmebfIv!ubpmg!nspgjov!<emspXw!4dfw!hojzsbw!<opjujtpQbsfnbDv!4dfw!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!gjeof$!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov!<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov!<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<ftvggjEv!5dfw!nspgjov!<zujdbqPusbQv!ubpmg!nspgjov!<ttfouihjsCv!ubpmg!nspgjov!<uihjMv!mppc!nspgjov!<spmpDeofmCv!5dfw!nspgjov!<eofmCv!mppc!nspgjov!<uofdsfQqjmDv!ubpmg!nspgjov!<opjudfsjEqjmDv!uoj!nspgjov!<sfmqnbTeofmCv!E3sfmqnbt!nspgjov!<sfmqnbTv!E3sfmqnbt!nspgjov!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!<uofsbqtobsUv!mppc!nspgjov!<utfUbiqmBv!ubpmg!nspgjov!<spmpDftsfwfSldjQyjGv!5dfw!nspgjov!<qjmGftsfwfSv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjGv!mppc!nspgjov!<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ$!gjeof$!gjeof$!<ubpmg!qnvjefn!opjtjdfsq!ftmf$!<ubpmg!qihji!opjtjdfsq!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!TF`MH!gfegj$!";
Lp(m,{setBatchInfo:function(u,n){mf[u]=n},getBatchInfo:function(m){return mf[m]},getBatchInfoMap:function(){return mf},setBatchInfoMap:function(H){mf=H}},!0);var ad=[1,1,1],fm=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],se=[1,0,0,0,0,1,0,1,1,1,1,0],qd=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Rk=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Xc=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],xr=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],sn=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Ik=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],De=function(g,C){var I=g._40Q;I.each(function(p){p.ivBatch(C)})},ih=function(D,I,R){var M=R._id,e=I[M];if(e){var k=e.batch,q=D[k],u=q.ds,H=e.index;if(q.invalidate=!0,delete I[M],u.splice(H,1),Tc(u))return delete D[k],void 0;for(var v=H,a=e.begin,x=e.size;H<u.length;H++)e=I[u[H]._id],e.index--,e.begin-=x;if(q.ms&&q.ms.length)return q.ms.splice(16*v,16),q.ics&&q.ics.splice(4*v,4),q.ps&&q.ps.splice(4*v,4),void 0;var G=3*a,d=3*x,b=4*a,t=4*x,V=q.vs,J=q.ps,g=q.uv,o=q.cs,N=q.bs,s=q.rs,y=q.ns,Z=q.ls;V.splice(G,d),J.splice(b,t),g&&g.splice(2*a,2*x),o&&o.splice(b,t),N&&N.splice(G,d),s&&s.splice(a,x),y&&y.splice(G,d),Z&&Z.splice(a,x)}},cb=function(b,P,W,f,E){if(!f)return z;var Z=P[f];if(!Z){var i=E.getBatchInfo(f)||df,F=i.image?[]:z;Z=P[f]={vs:[],ns:[],uv:F,cs:F?z:i.color?z:[],bs:i.blend?[]:z,ps:[],rs:i.brightness?[]:z,ds:[],ms:i.instanced?[]:z,ics:F?z:i.color||!i.instanced?z:[]}}return Z.invalidate=!0,b[W._id]={index:Z.ds.length,begin:Z.vs.length/3,batch:f},Z.ds.push(W),Z},aq=function(B,p){return p!=z&&1!==p?[B[0]*p,B[1]*p,B[2]*p,B[3]]:B},Lf=function(c){var Q=c.shapeModel;Q||(Q=qb(c)),Q&&(Q._ctlineModel=[],Q._lineModel=B)},Hk=function(){var e;return function(N,s,U){var J=N.getData3dUI(s),S=J.shapeModel;if(S||(S=qb(J)),S||!J.shapeName){var r,Q=s.s("wf.combineTriangle");if(U.geometry){if(!S&&(s instanceof _.Node&&!(s instanceof _.Shape)?(e||(e={vs:On,is:lg,uv:gn}),S=e):S=[J.left,J.front,J.right,J.back,J.top,J.bottom],!S))return B;if(Q){var Z=s.s("wf.normEpsilon");isNaN(Z)&&(Z=2),Q=0|Math.min(3,Math.max(1,isNaN(Q)?1:Q)),r=ml[Q-1](S,J,180/(Math.PI*Z))}else r=zd(S,J);if(!r||0===r.length)return}else if(r=U.short?Fr:Rc,s.s("wf.boundingBox")){var X=J.getBoundingBox(!0);if(X){var C=(new vr).scale(X.max.clone().sub(X.min)).setPosition(X.max.clone().add(X.min).divideScalar(2)).toArray();r=vc([],C,r)}}var Y,$,V,T=N.getBrightness(s),h=s.s("bloom"),D=s.s("3d.reflectable"),v=Qk(U.color||"white"),H=v[3]<1,z=Math.ceil(U.width)||1,M=s.s("3d.clipbox")?Wn:s.s("3d.clipbox.mask"),j=s.s("wf.fog"),L=s.getRenderLayer(),K=N._40Q.get(L),x=K.wireframeIndexMap,c=K.wireframeModelMap,W=s.s("batch"),w=s.s("3d.clip.direction");if(w){if($=s.s("3d.clip.percentage"),0===$)return;Y="_"+s._id,V=J._formatClipUniforms(w,$,s)}else Y=W?(H?"T":"O")+W:(H?"T":"O")+(h?"_1":"_0")+(D?"1_":"0_")+M+"_"+z+(j?"1_":"0_");var p=c[Y];p||(p=c[Y]={vs:[],cs:[],ps:[],ds:[],T:H,B:h,clipboxMask:M,reflectable:!!D,W:z,batch:W,fog:j}),p.invalidate=!0;var I=p.vs,b=p.cs,P=p.ds,n=x[s._id]={index:P.length,begin:I.length/3,batch:Y};P.push(s);var G,R=J.mat;U.geometry&&s instanceof _.Shape&&(m.extractShapeTranslation||m.extractPolylineTranslation||m.extractVerticesTranslation)&&(G=J._vsTranslation)&&R&&(R=(new _k.Matrix4).fromArray(R).multiply(G).toArray()),s instanceof _.Edge||!(!R||!U.geometry&&s instanceof _.Shape)||(R=vs(s,U.mat),s.appendAnchorMatrix3d(R)),V?(p.mat=Cp(R),p.clipDirection=V[0],p.clipPercent=V[1],vc(I,null,r)):vc(I,R,r);var O=n.size=I.length/3-n.begin;Vm(b,aq(v,T),O)}}}(),rd=function(P,M,w,p,k,Q,u,A,h){var O=P.getBrightness(M);O==z&&(O=1);var U=aq(Qk(p),O),V=U[3]<1;Q=Math.ceil(Q)||1;var Z=(V?"T":"O")+Q;if(u){var t=u[0],C=(u[1]||t)+t;Z+="-"+t+"-"+C,h&&(Z+="-"+ws(h)+"-"+O,h=aq(Qk(h),O))}var K=M.getRenderLayer(),W=P._40Q.get(K),g=W.polylineIndexMap,n=W.polylineModelMap,H=n[Z];H||(H=n[Z]={vs:[],cs:[],ps:[],ds:[],ls:u?[]:z,T:V,W:Q},u&&(H.D=t,H.G=C,H.A=h)),H.invalidate=!0;var L,E=H.vs,v=H.cs,j=H.ds,b=H.ls,J=g[M._id]={index:j.length,begin:E.length/3,batch:Z};j.push(M);var X;!(X=P.getData3dUI(M).mat)&&M instanceof _.Polyline&&(X=vs(M),M.appendAnchorMatrix3d(X)),vc(E,X,w);var S,B=J.size=E.length/3-J.begin,r=w.length,$=0,l=[];if(u||k)for(L=0;r>L;L+=6)S=bh([w[L],w[L+1],w[L+2]],[w[L+3],w[L+4],w[L+5]]),l.push(S),$+=S;if($&&k){var D,c=aq(Qk(k),O),s=[c[0]-U[0],c[1]-U[1],c[2]-U[2],c[3]-U[3]],I=0;for(L=0;r>L;L+=6)D=I/$,Vm(v,[U[0]+s[0]*D,U[1]+s[1]*D,U[2]+s[2]*D,U[3]+s[3]*D],1),I+=l[L/6],D=I/$,Vm(v,[U[0]+s[0]*D,U[1]+s[1]*D,U[2]+s[2]*D,U[3]+s[3]*D],1)}else Vm(v,U,B);if(u)for(I=A||0,L=0;r>L;L+=6)b.push(I),I+=l[L/6],b.push(I)},Fg=function(L,h,V){if(h){var f=V[h.batch],k=f.ps,T=f.ms&&f.ms.length,Q=T?4*h.index:4*h.begin,v=T?1:h.size;if(k[Q]!==L[0]||k[Q+1]!==L[1]||k[Q+2]!==L[2]||k[Q+3]!==L[3]){for(var C=0;v>C;C++)k[Q++]=L[0],k[Q++]=L[1],k[Q++]=L[2],k[Q++]=L[3];k._invalidateThisFrame=!0}}},Lc=function(){var b=new _.Math.Vector3,J=new _.Math.Vector3;return function(q,O){var Q=O+["32"],C=q[O],Z=q[Q];if(C){if((m.extractBatchTranslation||m.extractVerticesTranslation)&&"vs"===O){J.set(0,0,0);for(var o=C.length,s=0;o>s;s+=3)J.add(b.fromArray(C,s));J.divideScalar(o/3);for(var N=J.x,$=J.y,K=J.z,v=new Array(o),s=0;o>s;s+=3)v[s]=C[s]-N,v[s+1]=C[s+1]-$,v[s+2]=C[s+2]-K;C=v,q.translate=[N,$,K]}Z&&Z.length===C.length?(Z.set(C),Z._bufId=null):q[Q]=new al(C)}else delete q[Q]}}(),Lm=function(b,r,V,N,M,F,m,y){var G=r instanceof _.Shape,J=F[0],u=F.length;if(u>1){J=Cp(J);for(var L=1;u>L;L++)zg(J,J,F[L])}if(G){var A=r.p3();hk(J,A)}re(m.ms,J);var k;if(m.ics&&(k=r.s("shape3d.color"))&&Vm(m.ics,k,1),!m.vs.length){var C=Cp(fm);G&&hk(C,Qm(A)),oo(b,r,V,N,M,[C],m,y)}},oo=function(Z,Y,G,F,A,W,i,J){if(Jm(G))G.forEach(function(D){oo(Z,Y,D,F,A,W,i,J)});else if(hq(G))oo(Z,Y,qb(F,G),F,A,W,i,J);else if(Th(G)){var O,d=Gq(G.mat,Y,Z),t=Gq(G.s3,Y,Z),k=Gq(G.t3,Y,Z),g=Gq(G.r3,Y,Z);if((t||g||k||d)&&(O=ji(d,t,g,Gq(G.rotationMode,Y,Z),k),W.push(O)),G.shape3d)oo(Z,Y,G.shape3d,F,A,W,i,G);else{var U=F.s;J=J||df;var V=W[0],n=W.length,m=U("shape3d.color",G.color,J.color);if(A||(A=U("shape3d.blend",G.blend,J.blend)),n>1){V=Cp(V);for(var a=1;n>a;a++)zg(V,V,W[a])}var P=V?pq(V):z;G.vs&&U(Nc,G.visible,J.visible)&&oj(V,i,G.vs,G.uv,G.is,G.ns,P,A,m),G.top_vs&&U(gg,G.topVisible,J.topVisible)&&oj(V,i,G.top_vs,G.top_uv,G.top_is,G.top_ns,P,A,U("shape3d.top.color",G.topColor,J.topColor)||m),G.bottom_vs&&U(kc,G.bottomVisible,J.bottomVisible)&&oj(V,i,G.bottom_vs,G.bottom_uv,G.bottom_is,G.bottom_ns,P,A,U("shape3d.bottom.color",G.bottomColor,J.bottomColor)||m),G.from_vs&&U(jj,G.fromVisible,J.fromVisible)&&oj(V,i,G.from_vs,G.from_uv,G.from_is,G.from_ns,P,A,U("shape3d.from.color",G.fromColor,J.fromColor)||m),G.to_vs&&U(bl,G.toVisible,J.toVisible)&&oj(V,i,G.to_vs,G.to_uv,G.to_is,G.to_ns,P,A,U("shape3d.to.color",G.toColor,J.toColor)||m)}O&&W.pop()}},oj=function(c,z,k,i,O,m,F,d,t){var g,f=z.cs,K=z.uv,Z=z.bs,G=z.ns,T=z.vs;if(m&&0!==m.length||(m=gq(k,O)),O){g=O.length;for(var W=0;g>W;W++){var A=O[W],_=3*A;vc(T,c,[k[_],k[_+1],k[_+2]]),vc(G,F,[m[_],m[_+1],m[_+2]]),K&&re(K,[i[2*A],i[2*A+1]])}}else g=k.length/3,vc(T,c,k),vc(G,F,m),K&&re(K,i);f&&Vm(f,t,g),Z&&(d?Wf(Z,d,g):re(Z,ad,g))},_p=function(f,k,g){var N=f.data.p3();if(k=Cp(k),hk(k,N),re(g.ms,k),!g.vs.length){var Z=Cp(fm);hk(Z,Qm(N)),Te(f,Z,g)}},Te=function(E,Q,w){og(E,Mq,Q,w),og(E,ze,Q,w),og(E,Dn,Q,w),og(E,Zl,Q,w),og(E,Ih,Q,w),og(E,Vd,Q,w),og(E,"csg",Q,w)},un=function(p,O,_,I,C,d){re(_.ms,C);var k;_.ics&&(k=O.s("all.color"))&&Vm(_.ics,k,1),_.vs.length||Zj(p,O,_,I,Cp(fm),d)},Zj=function(D,V,L,u,J,d){fi(D,V,L,u,J,d,Mq,qd),fi(D,V,L,u,J,d,ze,Rk),fi(D,V,L,u,J,d,Ih,Xc),fi(D,V,L,u,J,d,Vd,xr),fi(D,V,L,u,J,d,Dn,sn),fi(D,V,L,u,J,d,Zl,Ik)},xn=function(m,w,t,N,Z){N?Z.instanced?m.gv.batchInstancedModel(m.data,N,m,m.getBodyColor(),[w],t):oo(m.gv,m.data,N,m,m.getBodyColor(),[w],t):Z.instanced?m.gv.batchInstancedShapeFace(m,w,t):Te(m,w,t)},og=function(J,D,j,m){var g=J[D];if(g){var B=g.tuv;if(B){var C=g.uvScale,e=g.uvOffset,$=g.uvRotation,r=g.uvAnchor;if(C||e||$){var E,b,H,a=jb($,e,C,r),u=a.a,h=a.b,P=a.c,o=a.d,F=a.tx,X=a.ty,n=B.length;for(H=0;n>H;H+=2)E=B[H],b=B[H+1],B[H]=u*E+P*b+F,B[H+1]=h*E+o*b+X}}oj(j,m,g.vs,B,z,z,j?pq(j):z,g.blend,g.color)}},fi=function(G,X,O,y,V,Y,$,A){var D,K=O.cs,o=O.uv,z=O.bs,E=O.vs,k=O.ns,W=gq(A);if(G.getFaceVisible(X,$)){var w=G.getFaceMat(X,$);if(w&&(V=vs(X,w),Y=pq(V)),vc(E,V,A),vc(k,Y,W),K&&Vm(K,G.getFaceColor(X,$),6),o){var Z=G.getFaceUv(X,$)||y[$+"Uv"],J=G.getFaceUvScale(X,$)||y[$+"UvScale"],U=G.getFaceUvOffset(X,$)||y[$+"UvOffset"],c=G.getFaceUvRotation(X,$)||y[$+"UvRotation"],H=G.getFaceUvAnchor(X,$)||y[$+"UvAnchor"];Z=Z?[Z[6],Z[7],Z[0],Z[1],Z[2],Z[3],Z[2],Z[3],Z[4],Z[5],Z[6],Z[7]]:se;var M=Z[0],C=Z[1],P=Z[2],e=Z[3],t=Z[4],q=Z[5],N=Z[6],g=Z[7],f=Z[8],l=Z[9],h=Z[10],v=Z[11];if(J||U||c||H){var m=jb(c,U,J,H),B=m.a,R=m.b,F=m.c,u=m.d,S=m.tx,s=m.ty;M=B*M+F*C+S,C=R*M+u*C+s,P=B*P+F*e+S,e=R*P+u*e+s,t=B*t+F*q+S,q=R*t+u*q+s,N=B*N+F*g+S,g=R*N+u*g+s,f=B*f+F*l+S,l=R*f+u*l+s,h=B*h+F*v+S,v=R*h+u*v+s}o.push(M,C,P,e,t,q,N,g,f,l,h,v)}z&&(D=G.getBodyColor(X)||G.getFaceBlend(X,$),D?Wf(z,D,6):re(z,ad,6))}},Ep=function(Y,D,j,r){var j=Y._picking?Y.pickColorMap:null,N=Y.getGL(),g=Y._prg,J=Y._buffer;if(!od(D)){Zm(Y,fm),ff(N);var k,S,H,U;for(var n in D){var F,R,o,f,i=D[n];if(i.batch){var C=Y.getBatchInfo(i.batch)||df;F=C.wfBloom===B?C.bloom:C.wfBloom,R=C.wfReflectable===B?C.reflectable:C.wfReflectable,o=C.wfClipboxMask===B?C.clipboxMask:C.wfClipboxMask,f=C.width}else F=i.B,R=i.reflectable,o=i.clipboxMask,f=i.W;if(!(r&&!i.T||!r&&i.T||Y.isReflecting(N)&&R===!1)){i.invalidate?(i.invalidate=!1,Lc(i,"vs"),Lc(i,"cs"),Lc(i,"ls"),Lc(i,"ps")):j&&i.ps&&i.ps._invalidateThisFrame&&(i.ps._invalidateThisFrame=!1,Lc(i,"ps")),k=i.translate,S=i.clipDirection,k||S?(H=S?Cp(i.mat):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k&&hk(H,k),U=Cp(Y._6O),Zm(Y,H)):H=null;var d=i.vs32,V=j?i.ps32:i.cs32;zm(N,g,f,z,J.vs,d);var T=Gh.for(N),X=T.directUniforms(),y=T.directAttribs(),s=i.D,u=!Y._dashDisabled&&s;X.uAlphaTest=b.alphaTest,N._blooming&&!F&&(X.blackout=!0),S&&(X.uClipPercent=i.clipPercent,X.uClipDirection=S),Vj(Y,X,o===B?co:o),u&&(X.uDash=!0,X.uDashDistance=s,X.uDashGapDistance=i.G,X.uDiffuse=i.A||b["color.empty"],y.aLineDistance=Cs(N,J.lineDistance,i.ls32,z,1));var m=!Y._batchColorDisabled;m&&V.length?(X.uBatchColor=!0,y.aBatchColor=Cs(N,J.batchColor,V,z,4)):(X.uBatchColor=!1,y.aBatchColor=!1);var a=i.fog!==!1;a||(X.uFog=!1),vf(N),am(N,0,d.length/3,N.LINES),uf(N),a||(X.uFog=!0),m&&(X.uBatchColor=!1,y.aBatchColor=!1),u&&(X.uDash=!1,y.aLineDistance=!1),N._blooming&&!F&&(X.blackout=!1),H&&(S&&(X.uClipDirection=0),nc(Y,U),X.uMMatrix=Sb)}}Rn(N),nc(Y)}},wh=function(K){K.invalidate=!1,Lc(K,"vs"),Lc(K,"ns"),Lc(K,"cs"),Lc(K,"rs"),Lc(K,"ps"),Lc(K,"bs"),Lc(K,"uv"),Lc(K,"ms"),Lc(K,"ics")},qp=function(y,V,i,M,s){var P,d,U,v,j,x,w,Y,K,S,p,l,a,i=y._picking?y.pickColorMap:null,L=y.getGL(),W=y._prg,A=Gh.for(L),T=A.directUniforms(),F=A.directAttribs(),n=y._buffer;if(!od(V)){var c,r,H=y._flowObjects.length?y.flowMap:null,e=y.drawFilter;Zm(y,fm);for(d in V)if(U=y.getBatchInfo(d)||df,U.visible!==!1&&!(M&&!U.transparent||!M&&U.transparent||y.isReflecting(L)&&U.reflectable===!1)){var $=U.renderLayerMask;if($==z&&($=wq),s==z&&(s=wq),bk(s,$)&&(v=V[d],i||!U.transparentMask)){if(e){if(U.highlight!==!0)continue;if(c=v.ds){r=!1;for(var O=0,Q=c.length;Q>O;O++)if(!e(c[O])){r=!0;break}if(!r)continue}}var C=M&&U.autoSort===!0&&(y._33Q||v.invalidate);v.invalidate?wh(v):i&&v.ps&&v.ps._invalidateThisFrame&&(v.ps._invalidateThisFrame=!1,Lc(v,"ps"));var o=v.ms32,N=o&&o.length;if(x=v.vs32,w=i?v.ps32:N?v.ics32:v.cs32,S=v.uv32,Y=v.bs32,K=v.rs32,l=x.length/3,C){var R=Wd(x,y.getEye(),y);R?(v.is=R.is,v.elementTypeUint=R.useUint32):(v.is=null,v.elementTypeUint=null)}if(l){a=v.translate,a&&Zm(y,[1,0,0,0,0,1,0,0,0,0,1,0,a[0],a[1],a[2],1]),j=U.light,p=y.getTexture(U.image),wn(L,W,z,U.light,U.opacity,U.reverseFlip,U.reverseColor,U.reverseCull),P=U.polygonOffset,P&&Pr(L,P),w?y._batchColorDisabled?(T.uBatchColor=!1,F.aBatchColor=!1):(T.uBatchColor=!0,F.aBatchColor=N?di(L,n.instancedBatchColor,w,z,4):Cs(L,n.batchColor,w,z,4)):(T.uBatchColor=!1,T.uDiffuse=U.color||b["color.empty"]);var m=U.alphaTest;T.uAlphaTest=m===B?b.alphaTest:m,T.shadowReceive=!i&&U.shadowReceive!==!1,Vj(y,T,U.clipboxMask===B?co:U.clipboxMask),op(y,T,U.lightMask===B?co:U.lightMask,U.headlightAmbientIntensity),H&&H.resetFlowUniform(U.effectFlowMask===B?co:U.effectFlowMask,T),L._blooming&&!U.bloom&&(T.blackout=!0),U.envmap!==B?(T.uUseEnvMap=!0,T.uReflectivity=U.envmap,T.roughness=U.roughness||0,y._setEnvmapByProbeId(T,U.envmapProbe||0)):(T.uUseEnvMap=!1,T.uReflectivity=0);var D=Y&&!y._batchBlendDisabled;D&&(T.uBatchBlend=!0,F.aBatchBlend=Cs(L,n.batchBlend,Y,z));var X=K&&!y._batchBrightnessDisabled;X&&(T.uBatchBrightness=!0,F.aBatchBrightness=Cs(L,n.batchBrightness,K,z,1)),S?vf(L,W,p,U.discardSelectable,n.uv,S,U.uvOffset,U.uvScale,U.uvRotation,U.uvAnchor):vf(L),F.aPosition=Cs(L,n.vs,x,z),F.aNormal=Cs(L,n.ns,v.ns32,z),N&&(T.uUseInstance=!0,F.aMatrixInstanced=di(L,n.ms,o,z)),v.is?(Vg(L,n.is,v.is),Ck(L,0,l,null,v.elementTypeUint?L.UNSIGNED_INT:null,null,N?v.ms32.length/16:0)):am(L,0,l,null,N?v.ms32.length/16:0),S?uf(L,W,p):uf(L),w&&!y._batchColorDisabled&&(T.uBatchColor=!1,F.aBatchColor=!1),D&&(T.uBatchBlend=!1,F.aBatchBlend=!1),X&&(T.uBatchBrightness=!1,F.aBatchBrightness=!1),L._blooming&&!U.bloom&&(T.blackout=!1),N&&(T.uUseInstance=!1,F.aMatrixInstanced=B),P&&pi(L),xj(L,W),a&&(nc(y),T.uMMatrix=Sb)}}}nc(y)}},Wd=function(Q,j,r){var Y=Q.length/3,c=Y>65535,y=r._glCapabilities.elementTypeUint&&c;if(!y&&c)return null;for(var t=new Array(Y),v=Y/3,H=new Array(v),l=0;v>l;l++)H[l]=l;H.sort(function(S,a){var L=9*S,V=[(Q[L]+Q[L+3]+2*Q[L+6])/4,(Q[L+1]+Q[L+4]+2*Q[L+7])/4,(Q[L+2]+Q[L+5]+2*Q[L+8])/4];L=9*a;var k=[(Q[L]+Q[L+3]+2*Q[L+6])/4,(Q[L+1]+Q[L+4]+2*Q[L+7])/4,(Q[L+2]+Q[L+5]+2*Q[L+8])/4],t=bh(j,V)-bh(j,k);return t>0?-1:0>t?1:0});for(var l=0;v>l;l++){var I=3*l,J=3*H[l];t[I]=J,t[I+1]=J+1,t[I+2]=J+2}return{useUint32:y,is:y?new Uint32Array(t):new im(t)}},dh={obj:function(I,D){var f={mat:I.mat,s3:I.s3,r3:I.r3,rotationMode:I.rotationMode,t3:I.t3,cube:I.cube==z?!0:I.cube,center:I.center==z?!0:I.center,ignoreMtls:I.ignoreMtls,ignoreTransparent:I.ignoreTransparent,ignoreColor:I.ignoreColor,ignoreImage:I.ignoreImage,ignoreNormal:I.ignoreNormal,prefix:I.prefix,flipY:I.flipY,flipFace:I.flipFace,reverseFlipMtls:I.reverseFlipMtls,finishFunc:function(O,F){if(O){var F=[];for(var a in O){var $=O[a];F.rawS3=$.rawS3,$.center&&(F.center=$.center),F.push($),I.eachModel&&I.eachModel(a,$)}F.json=I,D(F)}else D()}};m.loadObj(I.obj,I.mtl,f)},bin:function(J,j){var $={finishFunc:function(s){s?j(s):j()}};m.loadBin(J.url,$)}};m.getModelTypeHandlers=function(){return dh},m.setModelTypeHandler=function(J,b){dh[J]=b},m.getModelTypeHandler=function(t){return dh[t]},m.handleModelLoaded=function(){},m.handleUnfoundModel=function(){};var dp=z,Gc=z,pb=function(K){dp&&!K._loadingModelView_&&(Gc||(Gc={}),Gc[K._loadingModelView_=Ie()]=K)},Pe=function(k,i){dp||(dp={});var f=dp[k];if(f){if(f.url===i)return;f.request.onload=uo,f.request.onerror=uo}if(i.indexOf(".bin")===i.length-4)return Og(k,{modelType:"bin",url:i},i);if(i=m.beforeLoadURL(i),i.data){var K=m.parse(i.data);Og(k,K,i)}else{var G=new Bp;dp[k]={request:G,url:i},G.onload=function(){if(200===this.status||0===this.status){delete dp[k];var A=m.parse(G.getResponseText());Og(k,A,i)}else ye(k,m.handleUnfoundModel(k,i)||z)},G.onerror=function(){ye(k,m.handleUnfoundModel(k,i)||z)};var p={};p.url=encodeURI(i),p.sync=!1,G.send(p)}},Og=function(c,x,T){var R=x.modelType;if(!R)return ye(c,x),m.handleModelLoaded(c,x),void 0;var Q=m.getModelTypeHandler(R);if(Q){if(dp||(dp={}),dp[c])return;dp[c]=!0;var e=function(O){O?(ye(c,O),m.handleModelLoaded(c,O)):ye(c,m.handleUnfoundModel(c,T,x)||z)};Q(x,e)}else ye(c,m.handleUnfoundModel(c,T,x)||z)},ye=function(A,W){if(delete dp[A],hq(W)&&Qj.test(W))return Pe(A,W),void 0;if(zn[A]=W,od(dp)&&(dp=z,Gc)){for(var t in Gc){var S=Gc[t];S.invalidateAll&&S.invalidateAll(B,"modelLoaded",A),S.redraw&&S.redraw(),S.iv(),delete S._loadingModelView_}Gc=z}if(W&&Gc)for(var t in Gc){var S=Gc[t];S.invalidateAll&&S.invalidateAll(B,"modelLoading",A),S.redraw&&S.redraw(),S.iv()}},zi=new al([0,0,0,1,1,1,1,0]),Fo=new al([0,0,1,0,0,1,0,0,1,0,0,1]),me=new im([0,1,2,2,3,0]),On=new al([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),lg=new im([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),gn=new al([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Jr=gq(On,lg),mc=(new al([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new im([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Mq,Dn,ze,Zl,Ih,Vd]),Rc=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Fr=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Bd=function(Z,a,H,t,S,D,l){D=D||16,Z=Z||16,a=a||0,H=H||Z;var $,j,U,e,g,M,R,P,O,W=.5,Y=[],m=[],f=Q/Z,z=s/D;for($=0;D>$;$++)for(M=$+1,e=$*z,O=M*z,j=a;H>j;j++)R=j+1,U=j*f,P=R*f,Y.push(W*N(e)*c(U),W*c(e),-W*N(e)*N(U),W*N(O)*c(P),W*c(O),-W*N(O)*N(P),W*N(e)*c(P),W*c(e),-W*N(e)*N(P),W*N(e)*c(U),W*c(e),-W*N(e)*N(U),W*N(O)*c(U),W*c(O),-W*N(O)*N(U),W*N(O)*c(P),W*c(O),-W*N(O)*N(P)),m.push(j/Z,$/D,R/Z,M/D,R/Z,$/D,j/Z,$/D,j/Z,M/D,R/Z,M/D);if(l){var x=[];for($=0,g=Y.length;g>$;$+=3)x.push(2*Y[$],2*Y[$+1],2*Y[$+2])}if(t){var r=[],p=[];for(U=a*f,$=0;D>$;$++)M=$+1,e=$*z,O=M*z,r.push(0,0,0,W*N(O)*c(U),W*c(O),-W*N(O)*N(U),W*N(e)*c(U),W*c(e),-W*N(e)*N(U)),p.push(0,.5,a/Z,M/D,a/Z,$/D)}if(S){var A=[],o=[];for(U=H*f,$=0;D>$;$++)M=$+1,e=$*z,O=M*z,A.push(0,0,0,W*N(e)*c(U),W*c(e),-W*N(e)*N(U),W*N(O)*c(U),W*c(O),-W*N(O)*N(U)),o.push(1,.5,H/Z,$/D,H/Z,M/D)}var y={vs:Y,uv:m,from_vs:r,from_uv:p,to_vs:A,to_uv:o};return l&&(y.ns=x),y},Yi=function(C,i,I){C=C||.17,i=i||12,I=I||18,0>C?C=0:C>.25&&(C=.25);var j,r,b,T,M,U,S,p=.5,F=[],v=[],O=[],l=Q/I,L=Q/i,u=p-C;for(r=0;i>=r;r++)for(T=-s+r*L,U=c(T),M=N(T),j=0;I>=j;j++)b=j*l,S=u+C*U,F.push(c(b)*S,M*C,-N(b)*S),v.push(j/I,1-r/i);for(r=0;i>r;r++){var B=r*(I+1),x=(r+1)*(I+1);for(j=0;I>j;j++)O.push(B+j,x+j+1,x+j,B+j,B+j+1,x+j+1)}return{vs:F,uv:v,is:O}},ab=function(D,K,Z,r,e,j,p,m){p=p||12,D=D||18,K=K||0,Z=Z||D,j=j||.17,0>j?j=0:j>.25&&(j=.25);var E,h,k,y,_,X,M,a,n,f,F=.5,A=[],l=[],L=Q/D,g=Q/p,W=F-j,U=m?[]:B;for(k=0;p>k;k++)for(y=k+1,M=-s+k*g,a=-s+y*g,E=K;Z>E;E++)h=E+1,_=E*L,X=h*L,n=W+j*c(M),f=W+j*c(a),A.push(c(_)*n,N(M)*j,-N(_)*n,c(X)*n,N(M)*j,-N(X)*n,c(X)*f,N(a)*j,-N(X)*f,c(_)*n,N(M)*j,-N(_)*n,c(X)*f,N(a)*j,-N(X)*f,c(_)*f,N(a)*j,-N(_)*f),l.push(E/D,1-k/p,h/D,1-k/p,h/D,1-y/p,E/D,1-k/p,h/D,1-y/p,E/D,1-y/p),m&&U.push(c(_)*c(M),N(M),-N(_)*c(M),c(X)*c(M),N(M),-N(X)*c(M),c(X)*c(a),N(a),-N(X)*c(a),c(_)*c(M),N(M),-N(_)*c(M),c(X)*c(a),N(a),-N(X)*c(a),c(_)*c(a),N(a),-N(_)*c(a));if(r){var R=[],u=[];for(k=0;p>k;k++)y=k+1,M=-s+k*g,a=-s+y*g,_=K*L,n=W+j*c(M),f=W+j*c(a),R.push(c(_)*n,N(M)*j,-N(_)*n,c(_)*f,N(a)*j,-N(_)*f,c(_)*W,0,-N(_)*W),u.push(.5+.5*c(M),.5-.5*N(M),.5+.5*c(a),.5-.5*N(a),.5,.5)}if(e){var q=[],S=[];for(k=0;p>k;k++)y=k+1,M=-s+k*g,a=-s+y*g,_=Z*L,n=W+j*c(M),f=W+j*c(a),q.push(c(_)*n,N(M)*j,-N(_)*n,c(_)*W,0,-N(_)*W,c(_)*f,N(a)*j,-N(_)*f),S.push(.5-.5*c(M),.5-.5*N(M),.5,.5,.5-.5*c(a),.5-.5*N(a))}var w={vs:A,uv:l,from_vs:R,from_uv:u,to_vs:q,to_uv:S};return m&&(w.ns=U),w},Lo=function(y,q){for(var H,a,_,S,F,w=.5,A=16,V=[],Z=[],z=[],j=[],x=Q/A,l=0;A>=l;l++)H=l*x,a=c(H),S=a*w,_=N(H),F=_*w,V.push(S,-w,F,S,w,F),z.push(a,0,_,a,0,_),Z.push(1-l/A,1,1-l/A,0);for(l=0;A>l;l++)j.push(2*l,2*l+1,2*l+3,2*l,2*l+3,2*l+2);if(q){var J=[],s=[],K=[];for(J.push(0,-w,0),s.push(.5,.5),l=0;A>=l;l++)H=l*x,a=c(H),_=N(H),J.push(a*w,-w,-_*w),s.push(.5+.5*a,.5+.5*_);for(l=0;A>l;l++)K.push(0,l+2,l+1)}if(y){var o=[],e=[],L=[];for(o.push(0,w,0),e.push(.5,.5),l=0;A>=l;l++)H=l*x,a=c(H),_=N(H),o.push(a*w,w,-_*w),e.push(.5+.5*a,.5-.5*_);for(l=0;A>l;l++)L.push(0,l+1,l+2)}return{vs:V,uv:Z,is:j,ns:z,bottom_vs:J,bottom_uv:s,bottom_is:K,top_vs:o,top_uv:e,top_is:L}},Fl=function(g,I,B,L,G,j,w,k){g=g||12,I=I||0,B=B||g;for(var Y,T,F,K,R,O,i,W,n,M=.5,t=[],V=[],b=Q/g,A=I;B>A;A++)Y=A+1,T=A*b,F=Y*b,K=c(T)*M,R=N(T)*M,O=c(F)*M,i=N(F)*M,t.push(K,-M,-R,O,-M,-i,K,M,-R,O,-M,-i,O,M,-i,K,M,-R),V.push(A/g,1,Y/g,1,A/g,0,Y/g,1,Y/g,0,A/g,0);if(k){var l=[];for(A=0,n=t.length;n>A;A+=3)l.push(2*t[A],0,2*t[A+2])}if(w){var o=[],D=[];for(A=I;B>A;A++)T=b*A,F=b*(A+1),K=c(T),R=N(T),O=c(F),i=N(F),o.push(K*M,-M,-R*M,0,-M,0,O*M,-M,-i*M),D.push(.5+.5*K,.5+.5*R,.5,.5,.5+.5*O,.5+.5*i)}if(j){var U=[],p=[];for(A=I;B>A;A++)T=b*A,F=b*(A+1),K=c(T),R=N(T),O=c(F),i=N(F),U.push(K*M,M,-R*M,O*M,M,-i*M,0,M,0),p.push(.5+.5*K,.5-.5*R,.5+.5*O,.5-.5*i,.5,.5)}if(L){var m=[],E=[];T=b*I,K=c(T)*M,R=N(T)*M,W=I/g,m.push(0,M,0,0,-M,0,K,-M,-R,K,-M,-R,K,M,-R,0,M,0),E.push(0,0,0,1,W,1,W,1,W,0,0,0)}if(G){var s=[],r=[];T=b*B,K=c(T)*M,R=N(T)*M,W=B/g,s.push(0,-M,0,0,M,0,K,M,-R,K,M,-R,K,-M,-R,0,-M,0),r.push(1,1,1,0,W,0,W,0,W,1,1,1)}var X={vs:t,uv:V,bottom_vs:o,bottom_uv:D,top_vs:U,top_uv:p,from_vs:m,from_uv:E,to_vs:s,to_uv:r};return k&&(X.ns=l),X},Vh=function(p,s,U,O,w){s=s||18,U=U||0,O=O==z?Q:O,w=w==z?.5:w;for(var M,T,W,I,y,m,L=[0,.5,.75,.875,.9375],H=[],g=[],V=[],F=O/s,q=0;q<L.length;q++){var a=0===q%2?0:.5;for(M=0;s>=M;M++)T=(M+a)*F+U,W=1-L[q],H.push(c(T)*w*W,-w+2*L[q]*w,-N(T)*w*W),g.push((M+a)/s,W)}for(q=0;q<L.length-1;q++){var Z=q*(s+1),e=(q+1)*(s+1);for(M=0;s>M;M++)V.push(Z+M,e+M+1,e+M,Z+M,Z+M+1,e+M+1)}for(m=H.length/3-(s+1),M=0;s>M;M++)H.push(0,w,0),g.push((M+.5)/s,0);for(M=0;s>M;M++)V.push(m+M,m+M+1,m+(s+1)+M);if(p){var C=[],K=[],D=[];for(C.push(0,-w,0),K.push(.5,.5),M=0;s>=M;M++)T=M*F+U,I=c(T),y=N(T),C.push(I*w,-w,-y*w),K.push(.5+.5*I,.5+.5*y);for(M=0;s>M;M++)D.push(0,M+2,M+1)}return{vs:H,uv:g,is:V,bottom_vs:C,bottom_uv:K,bottom_is:D}},Pg=function(O,g,w,Y,t,j,F,k){O=O||16,g=g||0,w=w||O,F=F||1;var E,s,D,Z,m,R,W,v=.5,$=[],J=[],e=Q/O,i=g,T=1/F,s=new Or,D=new Or,H=new Or,I=new Or,B=new Or,u=new Or,C=new Or;for(k&&(E=[],m=new Or,R=new Or,W=new Or);w>i;i++){var z=i+1,a=e*i,G=e*z;for(s.set(c(a)*v,-v,-N(a)*v),D.set(c(G)*v,-v,-N(G)*v),H.set(0,v,0),k&&(m.set(c(a),.5,-N(a)).normalize(),R.set(c(G),.5,-N(G)).normalize(),W.copy(m).add(R).normalize()),I.lerpVectors(H,s,T),B.lerpVectors(H,D,T),$.push(I.x,I.y,I.z,B.x,B.y,B.z,H.x,H.y,H.z),J.push(i/O,T,z/O,T,(i+z)/2/O,0),k&&E.push(m.x,m.y,m.z,R.x,R.y,R.z,W.x,W.y,W.z),Z=1;F>Z;Z++)I.lerpVectors(H,s,T*(Z+1)),B.lerpVectors(H,D,T*(Z+1)),u.lerpVectors(H,s,T*Z),C.lerpVectors(H,D,T*Z),$.push(I.x,I.y,I.z,B.x,B.y,B.z,u.x,u.y,u.z,u.x,u.y,u.z,B.x,B.y,B.z,C.x,C.y,C.z),J.push(i/O,T*(Z+1),z/O,T*(Z+1),i/O,T*Z,i/O,T*Z,z/O,T*(Z+1),z/O,T*Z),k&&E.push(m.x,m.y,m.z,R.x,R.y,R.z,m.x,m.y,m.z,m.x,m.y,m.z,R.x,R.y,R.z,R.x,R.y,R.z)}if(j){var l=[],d=[];for(i=g;w>i;i++){a=e*i,G=e*(i+1);var K=c(a),r=N(a),h=c(G),y=N(G);l.push(K*v,-v,-r*v,0,-v,0,h*v,-v,-y*v),d.push(.5+.5*K,.5+.5*r,.5,.5,.5+.5*h,.5+.5*y)}}if(Y){var V=[],x=[];a=e*g,V.push(0,v,0,0,-v,0,c(a)*v,-v,-N(a)*v),x.push(0,0,0,1,g/O,1)}if(t){var f=[],n=[];a=e*w,f.push(0,-v,0,0,v,0,c(a)*v,-v,-N(a)*v),n.push(1,1,1,0,w/O,1)}var L={vs:$,uv:J,bottom_vs:l,bottom_uv:d,from_vs:V,from_uv:x,to_vs:f,to_uv:n};return k&&(L.ns=E),L},Am=function(u,C,O,T,b,I,U,V){for(var n=[],x=0;x<u.length-1;x+=2)n.push({x:u[x],y:u[x+1]});return jo(n,C,O,T,b,I,U,V,!1)},is={roundRect:function(z,K){return Am([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],z,K,3)},star:function(A,m){return Am([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],A,m)},rect:function(y,S){return Am([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],y,S)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(Q,B){return Am([0,-.5,.5,.5,-.5,.5],[1,2,2,5],Q,B)},rightTriangle:function(z,A){return Am([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],z,A)},parallelogram:function($,i){return Am([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],$,i)},trapezoid:function(L,F){return Am([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],L,F)}},Pi={sphere:1,cylinder:1,cone:1,torus:1},lq={torus:1,sphere:1,cone:1},bd=Lp(zs(is),{cylinder:1}),Cm=Lp(zs(is),{cylinder:1,cone:1}),Ln=function(Y,j,i){var Q,H=Gq(Y.anchor3d,i,j),q=Gq(Y.mat,i,j),N=Gq(Y.s3,i,j),F=Gq(Y.t3,i,j),U=Gq(Y.r3,i,j),G=N||U||F||q;if(H||G){Q=Cp(j._6O);var E=G?ji(q,N,U,Gq(Y.rotationMode,i,j),F):Cd();H&&hk(E,[.5-H[0],.5-H[1],.5-H[2]]),Zm(j,E)}return Q},Pf=function(i,$,p,V,I,w,x){if(Jm(p))p.forEach(function(l){Pf(i,$,l,V,I,w,x)});else if(hq(p))Pf(i,$,qb(V,p),V,I,w,x);else if(Th(p))if(p.shape3d){var z=Ln(p,i,$);Pf(i,$,p.shape3d,V,I,w,p),z&&nc(i,z)}else En(i,$,p,V.s,I,w,x)},En=function(L,s,F,M,t,N,D){if(D=D||df,!N||N(M("shape3d.transparent",F.transparent,D.transparent))){var h=Ln(F,L,s);if(bj(F)){var Z=L.getData3dUI(s);Z.dispatchBoundingBoxChanged()}var q=L._26I,B=L._prg,J=L._buffer,r=M("shape3d.color",F.color,D.color);t||(t=M("shape3d.blend",F.blend,D.blend));var $,T=F.opacity==z?D.opacity:F.opacity,m=M("shape3d.opacity");$=m!=z&&T!=z?T*m:T!=z?T:m,wn(q,B,t,M("shape3d.light",F.light,D.light),$,M("shape3d.reverse.flip",F.reverseFlip,D.reverseFlip),M("shape3d.reverse.color",F.reverseColor,D.reverseColor),M("shape3d.reverse.cull",F.reverseCull,D.reverseCull));var A=M("polygonOffset",F.polygonOffset,D.polygonOffset);F.vs&&M(Nc,F.visible,D.visible)&&Ug(q,B,J,r,L.getTexture(M("shape3d.image",F.image,D.image),s),M("shape3d.discard.selectable",F.discardSelectable,D.discardSelectable),F.vs,F.uv,F.ns,F.is,M("shape3d.uv.offset",F.uvOffset,D.uvOffset),M("shape3d.uv.scale",F.uvScale,D.uvScale),M("shape3d.uv.rotation",F.uvRotation,D.uvRotation),M("shape3d.uv.anchor",F.uvAnchor,D.uvAnchor),A),F.top_vs&&M(gg,F.topVisible,D.topVisible)&&Ug(q,B,J,M("shape3d.top.color",F.topColor,D.topColor)||r,L.getTexture(M("shape3d.top.image",F.topImage,D.topImage),s,"top"),M("shape3d.top.discard.selectable",F.topDiscardSelectable,D.topDiscardSelectable),F.top_vs,F.top_uv,F.top_ns,F.top_is,M("shape3d.top.uv.offset",F.topUvOffset,D.topUvOffset),M("shape3d.top.uv.scale",F.topUvScale,D.topUvScale),M("shape3d.top.uv.rotation",F.topUvRotation,D.topUvRotation),M("shape3d.top.uv.anchor",F.topUvAnchor,D.topUvAnchor),A),F.bottom_vs&&M(kc,F.bottomVisible,D.bottomVisible)&&Ug(q,B,J,M("shape3d.bottom.color",F.bottomColor,D.bottomColor)||r,L.getTexture(M("shape3d.bottom.image",F.bottomImage,D.bottomImage),s,"bottom"),M("shape3d.bottom.discard.selectable",F.bottomDiscardSelectable,D.bottomDiscardSelectable),F.bottom_vs,F.bottom_uv,F.bottom_ns,F.bottom_is,M("shape3d.bottom.uv.offset",F.bottomUvOffset,D.bottomUvOffset),M("shape3d.bottom.uv.scale",F.bottomUvScale,D.bottomUvScale),M("shape3d.bottom.uv.rotation",F.bottomUvRotation,D.bottomUvRotation),M("shape3d.bottom.uv.anchor",F.bottomUvAnchor,D.bottomUvAnchor),A),F.from_vs&&M(jj,F.fromVisible,D.fromVisible)&&Ug(q,B,J,M("shape3d.from.color",F.fromColor,D.fromColor)||r,L.getTexture(M("shape3d.from.image",F.fromImage,D.fromImage),s,"from"),M("shape3d.from.discard.selectable",F.fromDiscardSelectable,D.fromDiscardSelectable),F.from_vs,F.from_uv,F.from_ns,F.from_is,M("shape3d.from.uv.offset",F.fromUvOffset,D.fromUvOffset),M("shape3d.from.uv.scale",F.fromUvScale,D.fromUvScale),M("shape3d.from.uv.rotation",F.fromUvRotation,D.fromUvRotation),M("shape3d.from.uv.anchor",F.fromUvAnchor,D.fromUvAnchor),A),F.to_vs&&M(bl,F.toVisible,D.toVisible)&&Ug(q,B,J,M("shape3d.to.color",F.toColor,D.toColor)||r,L.getTexture(M("shape3d.to.image",F.toImage,D.toImage),s,"to"),M("shape3d.to.discard.selectable",F.toDiscardSelectable,D.toDiscardSelectable),F.to_vs,F.to_uv,F.to_ns,F.to_is,M("shape3d.to.uv.offset",F.toUvOffset,D.toUvOffset),M("shape3d.to.uv.scale",F.toUvScale,D.toUvScale),M("shape3d.to.uv.rotation",F.toUvRotation,D.toUvRotation),M("shape3d.to.uv.anchor",F.toUvAnchor,D.toUvAnchor),A),xj(q,B),h&&nc(L,h)}},Ug=function(q,F,d,S,e,K,$,h,A,J,Z,u,Q,j,t){if($){t&&Pr(q,t);var m=Gh.for(q),U=m.directUniforms(),Y=m.directAttribs();U.uDiffuse=S||b["color.empty"],h?vf(q,F,e,K,d.uv,h,Z,u,Q,j):vf(q),Y.aPosition=Cs(q,d.vs,$,z),Y.aNormal=Cs(q,d.ns,A,z),J?(Wj(q,d.is,J),Ck(q,0,J.length,null,J instanceof Uint32Array?q.UNSIGNED_INT:null)):am(q,0,$.length/3),h?uf(q,F,e):uf(q),t&&pi(q)}},qb=function($,a){var P=$.s;if(a||(a=P(um)),!a)return z;var M=Tq(a);if(M)return M;if("text"===a){var T={amount:P("shape3d.text.amount"),size:P("shape3d.text.size"),font:P("shape3d.text.font"),style:P("shape3d.text.style"),weight:P("shape3d.text.weight"),fill:P("shape3d.text.fill"),curveSegments:P("shape3d.text.curveSegments"),spacing:P("shape3d.text.spacing"),cube:P("shape3d.text.cube")},v=$.gv.getShape3dText($.data),g=v;for(var s in T)g+="_"+(T[s]===B?"U":T[s]);return $._cachedTextKey===g?$._cachedTextGeometry:($._cachedTextKey=g,$._cachedTextGeometry=m.createTextGeometry(v,T))}var s=a;if(Pi[a]){var u=P("shape3d.side"),Y=P("shape3d.side.from"),Z=P("shape3d.side.to"),r=P(jj),X=P(bl);3>u?(u=0,Y=0,Z=0,r=!1,X=!1):((Y==z||0>Y)&&(Y=0),(Z==z||Z>u)&&(Z=u),0===Y&&Z===u&&(r=!1,X=!1));var D=P("shape3d.smooth");s+="-"+u+"-"+Y+"-"+Z+"-"+r+"-"+X+(D?1:0)}if(bd[a]){var U=P(gg);s+="-"+U}if(Cm[a]){var V=P(kc);s+="-"+V}if("torus"===a){var w=P("shape3d.torus.radius");0>w?w=0:w>.25&&(w=.25),s+="-"+w}if(lq[a]){var E=P(ao);s+="-"+E}return M=tr[s],M||("box"===a?M=m.createBoxModel():is[a]?M=is[a](U,V):"sphere"===a?M=m.createSphereModel(u,Y,Z,r,X,E,D):a===Vb?M=m.createCylinderModel(u,Y,Z,r,X,U,V,D):"cone"===a?M=m.createConeModel(u,Y,Z,r,X,V,E,D):"torus"===a&&(M=m.createTorusModel(u,Y,Z,r,X,w,E,D)),tr[s]=M),M},bj=function(){var p=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],C=["is","top_is","bottom_is","from_is","to_is"];return V=Zq(mn.substr(mn.indexOf("^#")+2)),Nh(m[dc(Tr+p[15]+"n"+p[16])]())&&Id()?function(f){return f&&!f._complete_?(f._complete_=!0,f.vs&&Tc(f.ns)&&(f.ns=gq(f.vs,f.is),f.boundingBox=B),f.top_vs&&Tc(f.top_ns)&&(f.top_ns=gq(f.top_vs,f.top_is),f.top_boundingBox=B),f.bottom_vs&&Tc(f.bottom_ns)&&(f.bottom_ns=gq(f.bottom_vs,f.bottom_is),f.bottom_boundingBox=B),f.from_vs&&Tc(f.from_ns)&&(f.from_ns=gq(f.from_vs,f.from_is),f.from_boundingBox=B),f.to_vs&&Tc(f.to_ns)&&(f.to_ns=gq(f.to_vs,f.to_is),f.to_boundingBox=B),p.forEach(function(s){var d=f[s];Jm(d)&&(f[s]=new al(d))}),C.forEach(function(r){var h=f[r];Jm(h)&&(f[r]=h.length>65535?new Er(h):new im(h))}),!0):!1}:void 0}(),yj=function(t,o){var U=t[o];Jm(U)&&(t[o]=new al(U))};Lp(Yh,{_25Q:function(M){var _=new Or;M._16O=function(Y,m,r,q,h,o,H,X,s){var W=this.info;if(W){var b,k,$,G,A,R,L=Cd();Jp[m]?(b=W.p3,k=W.c1,$=W.c2):dg[m]?(k=W.s1||W.c1,$=W.s2||W.c2):(k=W.t1||W.c1,$=W.t2||W.c2);var B=this.data;if(B instanceof Hl&&this.shapeModel){var U=B.getPointsMatrix3d();b&&(b=_.copy(b).applyMatrix4(U).toArray()),k&&(k=_.copy(k).applyMatrix4(U).toArray()),$&&($=_.copy($).applyMatrix4(U).toArray())}var T=0;if(k&&$){var Z=of($,k);T=bh(k,$),G=[0,-Wc(Z[2],Z[0]),J(Z[1]/T)],A="zyx",b||(b=[(k[0]+$[0])/2,(k[1]+$[1])/2,(k[2]+$[2])/2])
}return R=wd(m,[T,0,0],r,q,X,s),Ue(L,R,b,q,h,o,H,Y,G,A)}return Sb},M._80o=function(y,Q,U){var S=this,C=S.shapeModel;if(C){var P=S.gv;Zm(P),Pf(P,S.data,C,S,S.getBodyColor(),U)}},M.createLineModel=function(g,D,k,B,f){var $=this,x=$.s,w=Kj(g,D,x(ao)),b=x(B+".color");if(b){for(var u=[],p=0;p<w.length;p++){var s=w[p],h=s.length;if(h>1){var C=s[0];u.push(C.x,C.y,C.z);for(var r=1;h-1>r;r++)C=s[r],u.push(C.x,C.y,C.z),u.push(C.x,C.y,C.z);C=s[h-1],u.push(C.x,C.y,C.z)}}var E,K,i,Q=x(f),y=0;Q&&(K=x(f+".color"),E=x(f+".pattern"),y=x(f+".offset"),i=b),rd($.gv,$.data,u,K||b,i?z:x(B+".gradient.color"),k,E||x(B+".pattern"),y,i)}return w},M.createTubeModel=function(P,A,m,B){for(var N=this,c=N.s,T=c("shape3d.side")||Zo,L=c("shape3d.start.angle"),J=c("shape3d.sweep.angle"),F=c(gg)?c("shape3d.top.cap"):z,C=c(kc)?c("shape3d.bottom.cap"):z,n=c("3d.clip.direction"),i="flat"===F,b="flat"===C,K=i&&(B?B.uv:c("shape3d.top.image")),W=b&&(B?B.uv:c("shape3d.bottom.image")),D=B?B.uv:c("shape3d.image")||"uv.left"===n||"uv.right"===n,S=c("shape3d.smooth"),Q={vs:[],uv:D?[]:z,ns:S?[]:z,top_vs:i?[]:z,top_uv:K?[]:z,bottom_vs:b?[]:z,bottom_uv:W?[]:z},I=Kj(P,A,c(ao),m),d=0,R=I.length,v=0,E=c("shape3d.uv.union");R>d;d++)E!==!0&&(v=0),v=Ve(Q,I[d],c(gh),m,T,L,J,F,C,v);if(B){var k=N._matWithExtraction||N.mat;oo(N.gv,N.data,Q,N,N.getBodyColor(),k?[k]:[],B)}else N.shapeModel=Q;N.lineShapeModel=Q;var V=N._vsTranslation;if(V)for(var d=0,X=I.length;X>d;d++)for(var q=0,p=I[d].length;p>q;q++)I[d][q]=I[d][q].clone().applyMatrix4(V);return I},M.getCache=function(){var R=this.info;if(R){var r=R.list;if(r){var w=R.cache;return w||(w=R.cache=eb(r)),w}}return z}}});var So=function(a,h){for(var d,J=0,V=a.length,p=0,z=V-1;z>=p;)if(J=e(p+(z-p)/2),d=a[J].length-h,0>d)p=J+1;else{if(!(d>0)){z=J;break}z=J-1}J=z;var r=a[J],n=r.point;return J===V-1||r.length===h||(n=(new Yb).subVectors(a[J+1].point,n).normalize().multiplyScalar(h-r.length).add(n)),{point:n,tangent:r.tangent}},eb=function(G){for(var d,y,w=[],o=0,p=0;p<G.length;p++){for(var _=G[p],B=0;B<_.length;B++){d=_[B],y&&(o+=y.distanceTo(d));var e=new Yb,A=_[B+1];A?e.subVectors(A,d):y?e.subVectors(d,y):e.x=1,e.normalize(),w.push({point:d,length:o,tangent:e}),y=d}y=null}return w},Kj=function(L,C,R,p){R=R||rp;for(var Y=[],W=0,n=L.size();n>W;W++){var Q=L.get(W);Y.push(new Yb(Q.x,Q.e||0,Q.y))}C&&(pj(C)&&(C=C._as),C.length||(C=null));for(var F,I,G,v,i,m=[],g=[],T=0,h=0,N=C?C.length:n;N>h;h++){if(i=C?C[h]:0===h?1:2,1===i)m.push(G=[]),G.push(Y[T++]);else if(2===i||5===i)if(v=2===i?Y[T++]:G[0],p){var P=C?C[h+1]:N>h+1?2:z;if(2===P||5===P){var l=G[G.length-1],r=2===P?Y[T]:G[0],$=(new Yb).subVectors(l,v),w=(new Yb).subVectors(r,v),o=$.length(),Z=w.length();if(o&&Z)if(p>o/2&&p>Z/2)G.push(v);else for($.multiplyScalar(H(p,o/2)/o).add(v),w.multiplyScalar(H(p,Z/2)/Z).add(v),F=new db($,v,w).getPoints(R),I=0;R>=I;I++)G.push(F[I])}else G.push(v)}else G.push(v);else if(3===i)for(F=new db(G[G.length-1],Y[T++],Y[T++]).getPoints(R),I=1;R>=I;I++)G.push(F[I]);else if(4===i)for(F=new Ap(G[G.length-1],Y[T++],Y[T++],Y[T++]).getPoints(R),I=1;R>=I;I++)G.push(F[I]);g.push(m.length,G.length)}return m.indexMark=g,m},Si=function(R){for(var d,p,b=new Yb,v=[],l=[],h=[],P=0,r=R.length;r>P;P++)d=R[P],p=R[P+1],p?b.subVectors(p,d):b.subVectors(d,R[P-1]),v.push(b.normalize().clone());var T,Q=new Yb,E=new Yb,H=new vr,M=1e-4,J=v[0],i=l[0]=new Yb,O=h[0]=new Yb;for(Math.abs(Math.abs(J.y)-1)<M?Q.set(1,0,0):Q.set(0,1,0),E.crossVectors(J,Q).normalize(),i.crossVectors(J,E),O.crossVectors(J,i),P=1;r>P;P++)l[P]=l[P-1].clone(),h[P]=h[P-1].clone(),E.crossVectors(v[P-1],v[P]),E.length()>M&&(E.normalize(),T=L(jp(v[P-1].dot(v[P]),-1,1)),l[P].applyMatrix4(H.makeRotationAxis(E,T))),h[P].crossVectors(v[P],l[P]);return{B:h,T:v,N:l}},Ve=function(){var I=function(B){for(var V=1;V<arguments.length;V++){var r=arguments[V];B.push(r.x,r.y,r.z)}},K=function(D){for(var X=1;X<arguments.length;X++){var $=arguments[X].uv;D.push($[0],$[1])}},q=function(f){for(var T=1;T<arguments.length;T++){var t=arguments[T].ns;f.push(t[0],t[1],t[2])}},P=function(Z,M,o,C,$){var d=-C*c($),j=C*N($);return new Yb(Z.x+d*o.x+j*M.x,Z.y+d*o.y+j*M.y,Z.z+d*o.z+j*M.z)},V=function(M,n,W,l,m,T,G,J,h){G=G||Q;for(var R,w=[],I=G/m,R=h?new Or:z,D=0;m>=D;D++){var b=P(M,n,W,l,D*I+T);w.push(b),J!=z&&(b.uv=[J,1-D/m]),h&&(b.ns=R.subVectors(b,M).normalize().toArray())}return w},g=function(F,f,V,b,k,s,p,z,R){R=R||Q;var B=f?F.top_vs:F.bottom_vs;if(B)for(var X=f?F.top_uv:F.bottom_uv,G=R/p,t=0;p>t;t++){var q,Z;f?(q=t*G+z,Z=(t+1)*G+z):(Z=t*G+z,q=(t+1)*G+z),I(B,P(V,b,k,s,q),P(V,b,k,s,Z),V),X&&X.push(.5-.5*c(q),.5-.5*N(q),.5-.5*c(Z),.5-.5*N(Z),.5,.5)}};return function(y,Y,f,H,j,W,Q,i,O,t){var e=Y.length;if(e>1){var T,v,$,L,a,M,d,X=Si(Y),R=X.T,s=X.N,E=X.B;"flat"===i&&g(y,!0,Y[0],E[0],s[0],H,j,W,Q),"flat"===O&&g(y,!1,Y[e-1],E[e-1],s[e-1],H,j,W,Q);var o,N,k=[],w=u(j/2),A="round"===i,r="round"===O,G=Y[0],D=R[0],J=E[0],U=s[0],b=Y[e-1],S=R[e-1],c=E[e-1],m=s[e-1];if(A){for($=1;w>=$;$++)s.splice(0,0,U),E.splice(0,0,J),R.splice(0,0,D),N=-$/w*H,Y.splice(0,0,D.clone().multiplyScalar(N).add(G)),k[w-$]=l(H*H-N*N);e+=w}if(r){for($=1;w>=$;$++)s.push(m),E.push(c),R.push(S),N=$/w*H,Y.push(S.clone().multiplyScalar(N).add(b)),k[Y.length-1]=l(H*H-N*N);e+=w}if(y.uv){var C=0,p=t,x=[];for(f&&(C=f),a=Y[0],x[0]=0,$=1;e>$;$++)L=Y[$],x[$]=a.distanceTo(L),a=L,f||(C+=x[$]);for(o=[],$=0;e>$;$++)p+=x[$],o[$]=C?p/C:0;t=p,y.internalUvScale=C?t/C:1}var _=y.ns?!0:!1;for($=0;e>$;$++){if(L=Y[$],M=E[$],d=s[$],T=V(L,M,d,k[$]===B?H:k[$],j,W,Q,o?o[$]:z,_),v)for(var P=0;j>P;P++){var F=v[P],n=v[P+1]||v[0],Z=T[P],h=T[P+1]||T[0];I(y.vs,n,F,Z,Z,h,n),y.uv&&K(y.uv,n,F,Z,Z,h,n),_&&q(y.ns,n,F,Z,Z,h,n)}v=T}}return t}}();Lp(m,{getLineLength:function(h){return h[h.length-1].length},getLineOffset:function(U,Y){return So(U,Y)},getLineCacheInfo:function(i,X,U,V){return eb(Kj(i,X,U,V))}});var vb=_.graph3d.RenderLite={},xs=new Array(0),ys=vb.Buffer=function(x,u,U,I){this.gl=x,this.buffer=x.createBuffer(),this.type=u||x.ARRAY_BUFFER,this.drawType=I||x.STATIC_DRAW,this.data=xs,U&&this.upload(U)};ys.prototype.upload=function(m,b,r){r||this.bind();var c=this.gl;m=m||this.data,b=b||0,this.data.byteLength>=m.byteLength?c.bufferSubData(this.type,b,m):c.bufferData(this.type,m,this.drawType),this.data=m},ys.prototype.bind=function(){var L=this.gl;L.bindBuffer(this.type,this.buffer)},ys.createVertexBuffer=function(b,g,J){return new ys(b,b.ARRAY_BUFFER,g,J)},ys.createIndexBuffer=function($,q,J){return new ys($,$.ELEMENT_ARRAY_BUFFER,q,J)},ys.create=function(I,k,f,x){return new ys(I,k,x)},ys.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var kh=vb.Shader=function(m,j,h){this.gl=m,this.program=Gm(m,j,h),this.attributes=vk(m,this.program);var R=ch(m,this.program);this.uniforms=vn(m,R)};kh.prototype.bind=function(){this.gl.useProgram(this.program)},kh.prototype.destroy=function(){this.gl};var Gm=function(s,T,i){var L=Hr(s,s.VERTEX_SHADER,T),Y=Hr(s,s.FRAGMENT_SHADER,i),P=s.createProgram();return s.attachShader(P,L),s.attachShader(P,Y),s.linkProgram(P),s.getProgramParameter(P,s.LINK_STATUS)||(Qd("LINK","LITE",s.getProgramParameter(P,s.VALIDATE_STATUS),s.getError(),s.getProgramInfoLog(P)),s.deleteProgram(P),P=null),s.deleteShader(L),s.deleteShader(Y),P},Hr=function(O,_,b){var f=O.createShader(_);return O.shaderSource(f,b),O.compileShader(f),O.getShaderParameter(f,O.COMPILE_STATUS)?f:(Qd("COMPILE","LITE",_,O.getError(),O.getShaderInfoLog(f)),null)},ch=function(O,g){for(var k={},B=O.getProgramParameter(g,O.ACTIVE_UNIFORMS),E=0;B>E;E++){var z=O.getActiveUniform(g,E),F=z.name.replace(/\[.*?\]/,""),I=Bl(O,z.type);k[F]={type:I,size:z.size,location:O.getUniformLocation(g,F),value:Ke(I,z.size)}}return k},vk=function(h,o){for(var f={},F=h.getProgramParameter(o,h.ACTIVE_ATTRIBUTES),v=0;F>v;v++){var c=h.getActiveAttrib(o,v),L=Bl(h,c.type);f[c.name]={type:L,size:$f(L),gl:h,location:h.getAttribLocation(o,c.name),pointer:Sh}}return f},Sh=function(l,p,$,i,M){var z=this.gl;z.enableVertexAttribArray(this.location),l instanceof vb.Buffer||(l=vb.Buffer.createVertexBuffer(z,l)),z.bindBuffer(l.type,l.buffer),z.vertexAttribPointer(this.location,this.size,p||z.FLOAT,$||!1,i||0,M||0)},$f=function(y){return $e[y]},$e={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Bl=function(c,H){if(!Mg){var q=S.keys(Mj);Mg={};for(var W=0;W<q.length;++W){var k=q[W];Mg[c[k]]=Mj[k]}}return Mg[H]},Mg=null,Mj={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Ke=function(w,Z){switch(w){case"float":return 0;case"vec2":return new Float32Array(2*Z);case"vec3":return new Float32Array(3*Z);case"vec4":return new Float32Array(4*Z);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*Z);case"ivec3":return new Int32Array(3*Z);case"ivec4":return new Int32Array(4*Z);case"bool":return!1;case"bvec2":return Jn(2*Z);case"bvec3":return Jn(3*Z);case"bvec4":return Jn(4*Z);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Jn=function(q){for(var g=new Array(q),O=0;O<g.length;O++)g[O]=!1;return g},vn=function(J,G){var T={data:{}};T.gl=J;for(var N=S.keys(G),o=0;o<N.length;o++){var X=N[o],i=X.split("."),P=i[i.length-1],K=Sj(i,T),r=G[X];K.data[P]=r,K.gl=J,S.defineProperty(K,P,{get:gl(P),set:ii(P,r)})}return T},gl=function(_){var D=Fe.replace("%%",_);return new Function(D)},ii=function(y,I){var S,o=Qi.replace(/%%/g,y);return S=1===I.size?yo[I.type]:ol[I.type],S&&(o+="\nthis.gl."+S+";"),new Function("value",o)},Sj=function(m,X){for(var I=X,J=0;J<m.length-1;J++){var z=I[m[J]]||{data:{}};I[m[J]]=z,I=z}return I},Fe=["return this.data.%%.value;"].join("\n"),Qi=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),yo={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},ol={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Bk=function(C){function D(n){if("string"!=typeof n)return 0|n;switch(n){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}function R(){g.enable=!m.graph3dViewShadowDisabled,G=m.graph3dViewShadowType,$=m.graph3dViewShadowIntensity,v=m.graph3dViewShadowBias,x=m.graph3dViewShadowQuality,n=m.graph3dViewShadowRadius,q=m.graph3dViewShadowDegreeX,w=m.graph3dViewShadowDegreeZ}var g=this;g.enable=!1;var G,$,v,x,n,q,w;R();var j,X,A,H,c=1,r=D(x),L=!1,i=new _.Math.Matrix4,u=new _.Math.Matrix4,F=g.pvMatrix=new _.Math.Matrix4,E=0;g.contextLost=function(){g.mapForReflector=null,g.map=null;var z=C.getGL();z&&(z._shadowShader=null)},g.render=function(){if(!C._picking&&g.enable){var X=C.getGL();if(X){if(L&&g.setupShadowCamera(),C._glCapabilities&&(r=Math.min(r,C._glCapabilities.maxTextureSize)),H=C.isReflecting(X)){if(E===X._renderInfo.frame)return;E=X._renderInfo.frame}var B=H?"mapForReflector":"map";if((j=g[B])?j.setSize(r,r):j=g[B]=new Ns(C,C.getGL(),0,0,{samples:1,minFilter:Uk.NEAREST,magFilter:Uk.NEAREST,width:r,height:r}),!X._shadowShader){var q="#define MAX_BOX_CLIPPER "+C._boxClippers.length;C._batchInstancedDisabled||(q+="\n#define BATCHINSTANCE"),X._shadowShader=new vb.Shader(X,Bk.shaderSrc.vs.replace("$DEFINE",q),Bk.shaderSrc.fs.replace("$DEFINE",q))}var W=C._frameState,F=W.renderState.glState;F.blend.enabled=!1,F.depth.enabled=!0,F.depth.mask=!0;var G=F.color.clear.slice(0);br(X,[1,1,1,1]),W.renderState.useProgram(X._shadowShader.program),V(),br(X,G)}}},g.deleteShadowProgram=function(){var w=C.getGL();w&&w._shadowShader&&(w.deleteProgram(w._shadowShader.program),w._shadowShader=null)},g.getShadow=function(){var E={degreeX:q,degreeZ:w,intensity:$,quality:x,type:G,radius:n,bias:v};return 1!==c&&(E.boundExtend=c),E},g.setShadow=function(p,j){p=!!p;var W=g.enable!==p;g.enable=p,"object"==typeof j&&(j.intensity!==B&&($=j.intensity),j.bias!==B&&(v=j.bias),j.radius!==B&&(n=j.radius),j.degreeX!==B&&(q=j.degreeX),j.degreeZ!==B&&(w=j.degreeZ),j.quality!==B&&(x=j.quality),j.type!==B&&G!==j.type&&(G=j.type,W=!0),r=D(x),j.boundExtend!==B&&(c=j.boundExtend)),p&&g.setupShadowCamera(),W&&Rq(C),C.iv()};var y=null;g.tryInvalidateLater=function(m,c){"modelLoaded"===c&&(y&&Ig(y,!0),y=sg(function(){y=null,g.refresh()},g,B,200))},g.refresh=function(){this.enable&&(this.setupShadowCamera(),C.iv())},g.tryUpdateBounding=function(N){var k=this.boundingSphere;if(k){var x=(new vr).fromArray(vs(N,C.getMat(N))),b=N.getAnchor3d(),I=new Or;k.containsPoint(I.set(0-b.x,0-b.y,0-b.z).applyMatrix4(x))&&k.containsPoint(I.set(0-b.x,0-b.y,1-b.z).applyMatrix4(x))&&k.containsPoint(I.set(0-b.x,1-b.y,0-b.z).applyMatrix4(x))&&k.containsPoint(I.set(0-b.x,1-b.y,1-b.z).applyMatrix4(x))&&k.containsPoint(I.set(1-b.x,0-b.y,0-b.z).applyMatrix4(x))&&k.containsPoint(I.set(1-b.x,0-b.y,1-b.z).applyMatrix4(x))&&k.containsPoint(I.set(1-b.x,1-b.y,0-b.z).applyMatrix4(x))&&k.containsPoint(I.set(1-b.x,1-b.y,1-b.z).applyMatrix4(x))||g.setupShadowCamera()}},g.createShadow=function(z){if(z||(z=C._frameState.renderState.directUniforms()),z.shadowMatrix=F.toArray(),C._getFrameRenderOptions("renderShadow")===!1){var _,x=C.getGL();(_=x._emptyShadowTexture)||(_=x._emptyShadowTexture=ng(x,null,[255,255,255,255])),z.shadowMap=_}else{var r=C._getFrameRenderOptions("useReflectorSelfShadowMap")&&g.mapForReflector;z.shadowMap=r?g.mapForReflector.texture:g.map.texture}z.shadowSize=[j.width,j.height],z.shadowIntensity=$,z.shadowBias=v,z.shadowRadius=n},g.genShaderDefine=function(){var p="#define USE_SHADOWMAP\n";return"hard"===G?p+="#define SHADOWMAP_TYPE_PCF\n":"soft"===G&&(p+=C.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),p};var M;g.setupShadowCamera=function(){X||(X=g.boundingSphere=new _.Math.Sphere),L=!1;var D,N,G=C.getBoundingBox(C.dm().toDatas(function(E){return E.s("shadow.cast")&&C.isVisible(E)}));G?(D=new Or(G.min),N=new Or(G.max)):(D=new Or(-256,-256,-256),N=new Or(256,256,256),L=!0),X.set(D.clone().add(N).multiplyScalar(.5),.5*D.distanceTo(N)*c);var h,J=X.radius,W=C.getBoundingBox(C.dm().toDatas(function(U){return(U.s("shadow.cast")||U.s("shadow.receive"))&&C.isVisible(U)}));if(W){D.copy(W.min),N.copy(W.max);var B=.5*D.distanceTo(N);h=B+Math.min(B,J+X.center.distanceTo(D.add(N).multiplyScalar(.5)))}else h=2*J;M=ms(Cd(),-J,J,-J,J,h/1e3,h),F.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),F.multiply(i.fromArray(M));var Q=Math.tan(-q*Math.PI/180),j=Math.tan(-w*Math.PI/180),O=J/Math.sqrt(Q*Q+j*j+1),y=new Or(O*Q,O,O*j);g.direction=Or.normalizeArray(y.clone().multiplyScalar(-1)),i.lookAt(y,new Or(0,0,0),new Or(0,1,0)).setPosition(y.add(X.center)),i.getInverse(i),F.multiply(i)},g.getDirection=function(){return g.enable?g.direction:void 0};var V=function(){var Y=C.getGL(),X=r,H=r;j.setSize(Y,X,H),j.bind(Y),Y.clear(Uk.COLOR_BUFFER_BIT|Uk.DEPTH_BUFFER_BIT);var i=C._frameState,O=i.renderState,K=O.directUniforms(),$=O.directAttribs(),V=O.directState();K.uUseInstance=!1,$.aMatrixInstanced=B,K.projectionMatrix=M,(A=C._boxClippers.length>0)&&(Vj(C,K,Wn),K.uClipperMatrix=C._boxClipperMatrixes,K.uClipperClipInner=C._boxClipperClipInner);var Z=C._viewport;C.setViewport(Y,0,0,X,H);var c,P,n,s;for(c=0,P=Ql.length;P>c;c++)if(n=Ql[c],!fq[n].ignore&&(s=C._40Q.get(n))){var Q=s.batchIndexMap;g.renderItems(Y,K,$,V,s.opaque,Q),g.renderItems(Y,K,$,V,s.transparent,Q),g.renderBatch(Y,K,$,V,s.batchModelMap,Q)}j.unbind(Y),C.setViewport(Y,Z[0],Z[1],Z[2],Z[3])};g._renderDirect=function(S,I,X,H,l){if(X&&X.length){var t=l&&l.length?l.length/16:0;I.position=Cs(S,C._buffer.vs,X,z),H?(Wj(S,C._buffer.is,H),Ck(S,0,H.length,null,H instanceof Uint32Array?S.UNSIGNED_INT:null,null,t)):am(S,0,X.length/3,null,t)}},g.renderShapeModel=function(q,x,t,R){var U,P,s;if(Jm(t))for(P=0,s=t.length;s>P;P++)U=t[P],U&&g.renderShapeModel(q,x,U,R);else hq(t)?g.renderShapeModel(q,x,qb(R,t),R):Th(t)&&(t.shape3d?g.renderShapeModel(q,x,t.shape3d,R):g.renderShapeModelImpl(q,x,t))},g.renderShapeModelImpl=function(A,h,Q){bj(Q),g._renderDirect(A,h,Q.vs,Q.is),g._renderDirect(A,h,Q.top_vs,Q.top_is),g._renderDirect(A,h,Q.bottom_vs,Q.bottom_is),g._renderDirect(A,h,Q.from_vs,Q.from_is),g._renderDirect(A,h,Q.to_vs,Q.to_is)},g.renderBatch=function(y,a,w,R,D){if(!od(D)&&!C.drawFilter){a.modelViewMatrix=u.identity().premultiply(i).toArray();var q,j,G;for(q in D)if(G=C.getBatchInfo(q)||df,G.visible!==!1&&G.shadowCast!==!1&&(!H||G.reflectable!==!1)){j=D[q],j.invalidate&&wh(j),A&&(a.modelMatrix=fm,Vj(C,a,G.clipboxMask===B?co:G.clipboxMask));var W=j.ms32,U=W&&W.length;U&&(a.uUseInstance=!0,w.aMatrixInstanced=di(y,C._buffer.ms,W,z)),g._renderDirect(y,w,j.vs32,j.is,W),U&&(a.uUseInstance=!1,w.aMatrixInstanced=B)}}},g.renderItems=function(Z,w,F,v,h,B){var D,z,M,o,Y,x,L=h.length;for(D=0;L>D;D++)if(z=h[D],o=z.ui,M=z.data,!(Od(M)||!M.s("shadow.cast")||M instanceof Jk||M.s("effect.flow")||!C.isVisible(M)||B[M._id]||H&&M.s("3d.reflectable")===!1)){var R=o.s("3d.clip.direction");if(R){var q=o.s("3d.clip.percentage");if(0===q)continue;var J=o._formatClipUniforms(R,q,M);w.uClipPercent=J[1],w.uClipDirection=J[0]}else w.uClipDirection=0;Y=o.shapeModel||qb(o),Y||(Y=M instanceof _.Node&&!(M instanceof _.Shape)?{vs:On,is:lg}:[o.left,o.front,o.right,o.back,o.top,o.bottom]),x=o.mat?u.fromArray(o.mat):u.identity();var G=o._vsTranslation;G&&(m.extractShapeTranslation||m.extractPolylineTranslation||m.extractVerticesTranslation)&&x.multiply(G),A&&(w.modelMatrix=x.toArray(),Vj(C,w,M.s("3d.clipbox")?Wn:M.s("3d.clipbox.mask"))),w.modelViewMatrix=x.premultiply(i).toArray(),v.cullFace.enabled=!!M.s("shape3d.reverse.cull"),g.renderShapeModel(Z,F,Y,o)}},g.resetProperties=R};Bk.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #ifdef BATCHINSTANCE \n","uniform bool uUseInstance;","attribute mat4 aMatrixInstanced;","\n #endif \n","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec4 transformed = vec4( position, 1.0 );","\n #ifdef BATCHINSTANCE \n","if (uUseInstance) { transformed = aMatrixInstanced * transformed; }","\n #endif \n","vPosition = vec3(transformed);","vec4 mvPosition = modelViewMatrix * transformed;","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * transformed);","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform int uClipperShape[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperShape[i] == 1 && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin))) ||","uClipperShape[i] == 2 && uClipperClipInner[i] != (length(vLocal) < 0.5)) { ","discard; return;","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Bk.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"],Yh.ms_shadow=function(e){Bk.PARAMS.forEach(function(p){var k=p.replace(/(^|\.)[a-z]/g,function(K){return K[K.length-1].toUpperCase()}),l=k.charAt(0).toLowerCase()+k.substr(1);e["getShadow"+k]=function(){return this._getShadowParam(l)},e["setShadow"+k]=function(c){this._setShadowParam(l,c)}}),e.enableShadow=function(T){this.shadowMap.setShadow(!0,T)},e.disableShadow=function(){this.shadowMap.setShadow(!1)},e._getShadowParam=function(l){return this.shadowMap.getShadow()[l]},e._setShadowParam=function(U,k){var z=this._getShadowParam(U),x={};x[U]=k;var $=this.shadowMap;$.setShadow($.enable,x),this.firePropertyChange("shadow"+U.charAt(0).toUpperCase()+U.substr(1),z,k)}};var Xb=function(k){function L(f,m,c,h,E){var p=k.getData3dUI(c),W=p.s("shape3d");if("billboard"===W||"plane"===W){var R;(R=O[m])||(R=O[m]=new Ns(k));var n=c.s("effect.flow.size"),B=c.s("effect.flow.uvshape"),$=c.getFinalScale3d(),y=$[0],C="billboard"===W?$[1]:$[2];y>C?(C=C/y*n,y=n):(y=y/C*n,C=n),y=Math.max(128,Math.round(y)||0),C=Math.max(128,Math.round(C)||0),R.setSize(f,y,C),R.bind(f);var v=k.getViewport(f);k.setViewport(f,0,0,y,C),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT);var w,p=k.getData3dUI(c),L=qb(p,W);if(!L)return!1;!L.ns&&L.length&&(L=L[0]),bj(L),w=L.vs;var V,X=c.s("effect.flow.gradient");if(X){if(V="Flow3d.Cached."+X,!_.Default.getImageMap()[V]){var D=100;_.Default.setImage(V,_.Default.toCanvas({width:D,height:D,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:X,rect:[0,0,D,D]}]},D,D))}}else V=c.s("shape3d.image");h.useXZ="plane"===W,h.image=k.getTexture(V,c),h.blend=c.s("effect.flow.blend")||l,h.uvMatrix=jb(p.s("shape3d.uv.rotation"),p.s("shape3d.uv.offset"),p.s("shape3d.uv.scale"),p.s("shape3d.uv.anchor"),Q).toArray9(),h.intensity=c.s("effect.flow.intensity");var T=x.indexOf(B);-1===T&&0===B.indexOf("polygon")&&(T=qe(1*B.substring(7),3,1024)-1),h.shape=T,E.position=Cs(f,null,w,z,3),am(f,0,w.length/3),R.unbind(f),k.setViewport(f,v[0],v[1],v[2],v[3]);var j=c.getMatrix4();j.getInverse(j);var P=j.getElements();"plane"===W?P[1]=P[5]=P[9]=P[13]=0:P[2]=P[6]=P[10]=P[14]=0,i[m]={matrix:j,group:c.s("effect.flow.group")}}}var Q,d=this,O=this.renderTargetPool=[],i=[],x=["rect","circle","polygon"];d.render=function(){if(!k._picking){var P=k._flowObjects;if(P.length){var Q=k.getGL();if(Q){var V;(V=Q._flowShader)||(V=Q._flowShader=new vb.Shader(Q,Xb.shaderSrc.vs,Xb.shaderSrc.fs));var D=k._frameState.renderState,C=D.glState;C.blend.enabled=!1,C.depth.enabled=!1,C.cullFace.enabled=!1;var l=C.color.clear.slice(0);br(Q,[0,0,0,1]),D.useProgram(V.program);var R,H,p=D.directUniforms(),e=D.directAttribs();for(R=0,H=P.length;H>R;R++)L(Q,R,P[R],p,e);br(Q,l),O.length!==H&&O.splice(H,O.length-H)}}}},d.contextLost=function(){var P=k.getGL();P&&(P._flowShader=null,O=this.renderTargetPool=[])},d.createFlow=function(G){var H;if(H=O.length){G||(G=k._frameState.renderState.directUniforms());for(var r=[],n=[],D=[],j=0;H>j;j++)r[j]=i[j].matrix.toArray(),n[j]=O[j].texture,D[j]=!1;G.flowMatrix=r;for(var j=0;H>j;j++)G["flowTexture"+j]=n[j];G.flowEnabled=D}},d.disableFlow=function(S){var U;if(U=O.length){S||(S=k._frameState.renderState.directUniforms());for(var y=[],H=0;U>H;H++)y[H]=!1;S.flowEnabled=y}},d.resetDataFlowEnabld=function(H,D){return d.resetFlowUniform(H.s("effect.flow.mask"),D)},d.resetFlowUniform=function(M,U){var p=O.length,s=new Array(p);if(M)for(var J=0;p>J;J++)M&1<<i[J].group&&(s[J]=!0);U.flowEnabled=s};var l="white"};Xb.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var $o=function(H){this.gv=H,this.onMouseOver=this.onMouseOver.bind(this),this.resetProperties()};$o.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Yh.ms_highlight=function(R){R.setHighlightMode=function(u){var l;l="selection"===u||"selected"===u?$o.Mode.Selection:"mouseover"===u||"hover"===u?$o.Mode.MouseOver:"style"===u?$o.Mode.Style:$o.Mode.Disable;var k=this.getHighlightMode();this._highlightHelper.mode=l,this.firePropertyChange("highlightMode",k,u)},R.getHighlightMode=function(){var Q=this._highlightHelper.mode;return Q===$o.Mode.Selection?"selected":Q===$o.Mode.MouseOver?"hover":Q===$o.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(H){var d=H.replace(/(^|\.)[a-z]/g,function(R){return R[R.length-1].toUpperCase()});R["getHighlight"+d]=function(){return this._highlightHelper[H]},R["setHighlight"+d]=function(E){var J=this._highlightHelper,v=J[H];E!==v&&(J[H]=E,this.firePropertyChange("highlight"+d,v,E))}})},Fm($o,S,{onMouseOver:function(n){m.preventDefault(n);var N=this.gv;if(!N._48Q){var W=N.getDataAt(n);W!==this.mouseOverData&&(this.mouseOverData=W,N.iv())}},setFetchTargetFunc:function(H){this.fetchTargetFunc=H},_42:function(q,z){var u,B,p=this,y=p._mode,w=p.gv;if(!q._renderInfo.reflectDepth&&y!==$o.Mode.Disable){if(y===$o.Mode.Selection?u=w.sm().getSelection().toArray(function(U){return U.s("highlight.visible")}):y===$o.Mode.MouseOver&&p.mouseOverData&&p.mouseOverData.s("highlight.visible")&&(u=[p.mouseOverData]),p.fetchTargetFunc&&(u=p.fetchTargetFunc(u)),y===$o.Mode.Style)u=u||[],B=function(G){if(u.indexOf(G)>=0)return!1;var L=w.getDataHighlightMode(G);return L===!1?!0:L===!0?!1:"selected"===L?w.isSelected(G)?!1:!0:"hover"===L?G===p.mouseOverData?!1:!0:!0};else{if(!u||!u.length)return;B=function(w){return u.indexOf(w)<0?!0:void 0}}var d=w.isVRPresenting(),h=w.getWidth();if(d){var r=w.getWidth;h/=2,w.getWidth=function(){return h};var c=w.getViewport()}var Z,D=w.getDevicePixelRatio(),g=Math.floor(h*D),A=Math.floor(w.getHeight()*D);(Z=p._renderTarget)?Z.setSize(q,g,A):p._renderTarget=Z=new ae.RenderTarget(w,q,g,A);var R="soft"===p.type;if(Z.bind(q),R){var $=q.getParameter(q.COLOR_CLEAR_VALUE);br(q,[1,1,1,1]),q.clear(q.COLOR_BUFFER_BIT),br(q,$)}else q.clear(q.COLOR_BUFFER_BIT);w.setViewport(q,0,0,g,A),w.drawFilter=function(_){var G=B(_);if(G){var i=w.getData3dUI(_);i&&_.s("batch")&&i._46Q(q,[0,0,0,0])}return G},zq=function($,b,E,c,d,O){var M;return M=c&&c.data&&B(c.data)?[0,0,0,0]:[E?0:1,1,1,1],O||(Gh.for($).directUniforms().uFixPickReverseColor=M),M};var x=q._blooming;x&&(q._blooming=!1),w.renderPickScene(),x&&(q._blooming=!0),zq=Xd,w.drawFilter=null,Z.unbind(q),Md&&Hd(q,z.aPosition),Hd(q,z.aNormal),d&&(w.getWidth=r,w.setViewport(q,c[0],c[1],c[2],c[3]));var Q=w.getHighlightColor();if(p._lastHighlightColor!==Q){var j=ws(p._lastHighlightColor=Q);p._highlightColorData=[j[0]/255,j[1]/255,j[2]/255,j[3]/255]}return R?p.renderSoftOutline(q,g,A):p.renderHardOutline(q,g,A),q.useProgram(z=w._prg),Md&&hn(q,z.aPosition),!0}},_assureShader:function(P,i){var W=P._compiledShader[i];return W||(W=P._compiledShader[i]=new vb.Shader(P,$o.CommonShaderVs,$o[i].fs)),W},renderHardOutline:function(m,L,w){var E=this,c=E.gv,l=c._postProcessing,x=Gh.for(m),T=x.directState();T.blend.enabled=!0,T.depth.enabled=!1,l.blitScreen(null,E._renderTarget.texture,E._assureShader(m,"HighlightHard"),{textureSize:[L,w],edgeWidth:c.getHighlightWidth(),edgeColor:E._highlightColorData},{clear:!1}),T.blend.enabled=!1,T.depth.enabled=!0},renderSoftOutline:function(b,m,j){var t,d,p,U,I,i=this,O=i.gv,n=O._postProcessing,x=Math.floor(m/2),Q=Math.floor(j/2),o=Math.floor(m/4),Z=Math.floor(j/4),z=i._downSampleRenderTarget;z?(t=i._edgeDetectionRenderTarget,d=i._blurV2,p=i._blurH2,U=i._blurV4,I=i._blurH4,(z.width!==x||z.height!==Q)&&(z.setSize(x,Q),t.setSize(x,Q),d.setSize(x,Q),p.setSize(x,Q),U.setSize(o,Z),I.setSize(o,Z))):(z=i._downSampleRenderTarget=new ae.RenderTarget(O,b,x,Q),t=i._edgeDetectionRenderTarget=new ae.RenderTarget(O,b,x,Q),d=i._blurV2=new ae.RenderTarget(O,b,x,Q),p=i._blurH2=new ae.RenderTarget(O,b,x,Q),U=i._blurV4=new ae.RenderTarget(O,b,o,Z),I=i._blurH4=new ae.RenderTarget(O,b,o,Z));var h=b.getParameter(b.COLOR_CLEAR_VALUE),s=O.getViewport(),Y=i.width,r=i.strength,X=i.glow,G=Gh.for(b).glState,S=G.depth,B=G.blend,w=S.enabled;br(b,[1,1,1,1]),S.enabled=!1,B.apply({func:[b.SRC_ALPHA,b.ONE]}),n.blitScreen(z,i._renderTarget.texture),n.blitScreen(t,z.texture,i._assureShader(b,"EdgeDetection"),{texSize:[x,Q],color:i._highlightColorData}),n.blitScreen(p,t.texture,i._assureShader(b,"Blur"),{direction:[1,0],texSize:[x,Q],radius:Y}),n.blitScreen(d,p.texture,i._assureShader(b,"Blur"),{direction:[0,1],texSize:[x,Q],radius:Y}),n.blitScreen(I,d.texture,i._assureShader(b,"Blur"),{direction:[1,0],texSize:[o,Z],radius:Y}),n.blitScreen(U,I.texture,i._assureShader(b,"Blur"),{direction:[0,1],texSize:[o,Z],radius:Y}),B.apply({enabled:!0}),O.setViewport(b,s[0],s[1],s[2],s[3]),n.blitScreen(null,i._renderTarget.texture,i._assureShader(b,"BlendTogether"),{edgeTexture1:d.texture,edgeTexture2:U.texture,edgeStrength:r*Y,edgeGlow:X},{clear:!1}),B.apply({func:[b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA]}),S.enabled=w,br(b,h)},resetProperties:function(){this.mode=$o.Mode.Style,this.type=b["highlight.type"],this.color=b["highlight.color"],this.width=b["highlight.width"],this.glow=b["highlight.glow"],this.strength=b["highlight.strength"]},contextLost:function(){this._renderTarget=null}}),S.defineProperties($o.prototype,{mode:{get:function(){return this._mode},set:function(y){var d=this._mode;if(y!==d){this._mode=y;var w=d===$o.Mode.MouseOver||d===$o.Mode.Style,i=y===$o.Mode.MouseOver||y===$o.Mode.Style;i&&w||(w&&v(this.gv.getView(),"mousemove",this.onMouseOver),i&&C(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),$o.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),$o.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},$o.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},$o.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},$o.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};
var Ds=_.Light=function(){mg(Ds,this),this.s(wc,b[wc]),this.s(um,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Fh("Light",Oe,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(A,n,C){Ds.superClass.onStyleChanged.apply(this,arguments),A===wc&&this.s("shape3d.color",C)}});var Es=ae.FrameState=function(A,L){this.renderState=Gh.for(L),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=B,this.projectMatrix=B,this.viewMatrix=B,this.view=A,this.defaultProgram=B,this.pickColorMap=B,this._pvStack=[],this._renderStateStack=[]};Es.prototype.savePV=function(){var F=this.view;this._pvStack.push([Cp(this.projectMatrix),Cp(this.viewMatrix),F._18Q,Cp(F._7O)])},Es.prototype.restorePV=function(){var W=this._pvStack.pop();if(W){var f=this.view;this.projectMatrix=f._projectMatrix=W[0],this.viewMatrix=f._viewMatrix=W[1],f._18Q=W[2],f._7O=W[3]}},Es.prototype.setPV=function(l,B){var I=this.view,Z=!1;if(l&&(this.projectMatrix=I._projectMatrix=l,Z=!0),B&&(this.viewMatrix=I._viewMatrix=B,I._7O=Cp(B),Z=!0),Z){var A=I.getWidth(),k=I.getHeight(),c=Cp(this.projectMatrix);I._18Q=zg(c,c,B),I._18Q._wh=A/k}},Es.prototype.syncEnv=function(h){var Y=this,B=Y.view;Y.envmapReflectivity=B._envmapReflectivity||.5,Y.cameraPosition=B.getEye(),Y.projectMatrix=B._projectMatrix,Y.viewMatrix=B._viewMatrix,Y.pickColorMap=h,Y.picking=B.getGL()._picking},Es.prototype.setGLState=function(){var Y=[0,0,0,0],z=[!0,!0,!0,!0],D=[-1,1],i=[Uk.FUNC_ADD,Uk.FUNC_ADD],X=[Uk.SRC_ALPHA,Uk.ONE_MINUS_SRC_ALPHA,Uk.ONE,Uk.ONE_MINUS_SRC_ALPHA];return function(f,v){var V=this,L=V.renderState.gl,a=V.renderState.glState;a.dither=!1,v?a.color.mask=z:a.color.reset(),a.pixelStore.reset(),a.blend.color=Y,a.blend.equation=i,a.blend.func=X,a.cullFace.enabled=!1,a.scissor.enabled=!1,a.depth.enabled=!0,a.depth.clear=1,a.depth.func=L.LEQUAL,a.depth.range=D,a.stencil.enabled=!1,a.polygonOffset.enabled=!1,f?(a.depth.mask=!1,a.blend.enabled=!0):(a.depth.mask=!0,a.blend.enabled=!1)}}(),Es.prototype.setUniforms=function(I){var Z=this,A=Z.view,c=Z.renderState,V=c.gl,K=c.uniforms;K.uBrightness=1,K.uOpacity=1,K.uPartOpacity=1,K.uPick=Z.picking,K.uUseInstance=!1,K.uTexture=!1,K.uBlendTexture=!1,K.uAlphaTest=b.alphaTest,K.uTransparent=!!I,K.uFix=!1,K.uBatchColor=!1,K.uBatchBlend=!1,K.uBatchBrightness=!1,K.uReflectivity=Z.envmapReflectivity||.5,K.uCameraPosition=Z.cameraPosition,K.uPMatrix=Z.projectMatrix,K.uViewMatrix=Z.viewMatrix,K.uEnvMap=null,Vj(A,K,Wn),K.uClipperMatrix=A._boxClipperMatrixes,K.uClipperClipInner=A._boxClipperClipInner,K.uEnvmapQuat=A._envmapExtraQuaternion,A._envmapRenderer.resetUniformCache(),Z.picking||(bc(A,V,B),A._fogDisabled||(K.uFogColor=A._fogColor,K.uFogDensity=A._fogDensity,K.uFogNear=A._fogNear,K.uFogFar=A._fogFar))},Es.prototype.drawLayer=function(k){return this.view.renderLayers(k,!0)},Es.prototype.drawData=function($,S,g){var z=this.view;if(z.isVisible($)){var w=this.renderState,y=w.uniforms,i=z.getData3dUI($);if(i){var e=w.gl,H=e._picking,q=z._picking,f=i._pickId;g&&(i._pickId=g),y.uPick=e._picking=z._picking=!!g,y.uTransparent=!!S,i._42(w.gl,w.program,S?r:p),y.uPick=e._picking=H,z._picking=q,i._pickId=f}}};var Fs=ae.Graph3dView=function(L,x){var e=this;e.resetHeadlightProperties(),e.resetFogProperties(),e._webGLVersion=1,e._attributes=x||m.graph3dViewAttributes,e._25I={},e._view=Oc(1,e);var t;e._attributes&&(t=e._attributes.canvas)||(t=km(e._view)),e._canvas=t,C(t,"webglcontextlost",function(Y){Y.preventDefault(),Rq(e),e._26I&&(e._doBufferGC(e._26I,!0),Eg(e._canvas,0,0),["_highlightHelper","shadowMap","flowMap","_envmapRenderer","_postProcessing"].forEach(function(W){e[W].contextLost()}),e.dm().each(function(O){var c=e.getData3dUI(O);c.contextLost()})),e._26I=z,e._1o.onContextLost(),e._35O=!0}),C(t,"webglcontextrestored",function(){e._35O=!1,e.iv()}),e._40Q=new Ms(e),e._43Q={},e._44Q=-1,e._batchIndexMap={},e._batchModelMap={},e._wireframeIndexMap={},e._wireframeModelMap={},e._wireframeIndexMapSwap={},e._wireframeModelMapSwap={},e._polylineIndexMap={},e._polylineIndexMap={},e._polylineIndexMapSwap={},e._polylineIndexMapSwap={},e._8O=[],e._7O=Cd(),e._6O=Cd(),e._1o=new Ws(e),e._30O=new Zs(e),e._31O=new Xs(e),e._32O=new Ys(e),e._raycaster=new it(e),e._highlightHelper=new $o(e),e._postProcessing=new st(e),e._41Q=[],e._42Q=0,e._frameRenderOptionStack=[],ae.VR?(e.vr=new ae.VR(e),e.isVREnabled=function(){return this.vr.enable},e.isVRPresenting=function(){return this.vr.isPresenting()}):(e.vr={enable:!1,isPresenting:I},e.isVREnabled=I,e.isVRPresenting=I),e.shadowMap=new Bk(e),e.flowMap=new Xb(e),e._33Q=!0,e._eye=zs(m.graph3dViewEye),e._center=zs(m.graph3dViewCenter),e._up=zs(m.graph3dViewUp),e._lightChanged=!1,e._59O=[],e._spots=[],e._dirs=[],e._boxClippers=[],e._flowObjects=[],e._frameId=0,e._picking=!1,e._batchInfoMap={},e.overlappingBox=new Tk(e),e.dm(L?L:new wp),e._coreInteractor=new bm(this),e._envmapRenderer=new ae.EnvmapRenderer(this),e.setInteractors([new Ps(e)]),e._initView(),e._genBatchInstancedArrayFunc()},Gs={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchInstancedDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,flowBlendMode:1,uvClipEnabled:1,ortho:1},Hs={box:1,sphere:2},Is={addRGB:"FLOW_BLEND_MODE_ADD_RGB",addRGBA:"FLOW_BLEND_MODE_ADD_RGBA",overrideRGBA:"FLOW_BLEND_MODE_OVERRIDE_RGBA",overrideRGB:"FLOW_BLEND_MODE_OVERRIDE_RGB",overrideA:"FLOW_BLEND_MODE_OVERRIDE_A",multiplyRGB:"FLOW_BLEND_MODE_MULTIPLY_RGB",multiplyRGBA:"FLOW_BLEND_MODE_MULTIPLY_RGBA"},Js=0;yc("Graph3dView",S,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",ql,Fd,"firstPersonMode",yp,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightDirection","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",xe,Gp,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","uvClipEnabled","batchColorDisabled","batchInstancedDisabled","batchBlendDisabled","batchBrightnessDisabled","flowBlendMode","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:m.graph3dViewSortable,_editHelperDisabled:m.graph3dViewEditHelperDisabled,_blockSelectable:m.graph3dViewBlockSelectable,_devicePixelRatio:B,_boundaries:B,_moveStep:m.graph3dViewMoveStep,_rotateStep:m.graph3dViewRotateStep,_rotateMinPhi:m.graph3dViewMinPhi===B?m.graph3dViewRotateMinPhi:m.graph3dViewMinPhi,_rotateMaxPhi:m.graph3dViewMaxPhi===B?m.graph3dViewRotateMaxPhi:m.graph3dViewMaxPhi,_pannable:m.graph3dViewPannable,_rotatable:m.graph3dViewRotatable,_walkable:m.graph3dViewWalkable,_resettable:m.graph3dViewResettable,_zoomable:m.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:m.graph3dViewFirstPersonMode,_mouseRoamable:m.graph3dViewMouseRoamable,_gridVisible:m.graph3dViewGridVisible,_gridSize:m.graph3dViewGridSize,_gridGap:m.graph3dViewGridGap,_gridColor:m.graph3dViewGridColor,_originAxisVisible:m.graph3dViewOriginAxisVisible,_centerAxisVisible:m.graph3dViewCenterAxisVisible,_axisXColor:m.graph3dViewAxisXColor,_axisYColor:m.graph3dViewAxisYColor,_axisZColor:m.graph3dViewAxisZColor,_ortho:m.graph3dViewOrtho,_orthoWidth:m.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:m.graph3dViewSyncEyeWithOrthoWidth,_fovy:m.graph3dViewFovy,_near:m.graph3dViewNear,_far:m.graph3dViewFar,_rectSelectable:m.graph3dViewRectSelectable,_rectSelectBackground:m.graph3dViewRectSelectBackground,_editSizeColor:m.graph3dViewEditSizeColor,_autoMakeVisible:yl,_pickerResolution:m.graph3dViewPickerResolution,_dashDisabled:m.graph3dViewDashDisabled,_uvClipEnabled:m.graph3dViewUvClipEnabled,_batchColorDisabled:m.graph3dViewBatchColorDisabled,_batchInstancedDisabled:m.graph3dViewBatchInstancedDisabled,_batchBlendDisabled:m.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:m.graph3dViewBatchBrightnessDisabled,_flowBlendMode:m.graph3dViewFlowBlendMode,addCamera:function(N){var r=this,V=S.freeze({id:r._42Q++,priority:N.priority||0,ignoreInPick:!!N.ignoreInPick,render:N.render});N.switch3DStatus&&(r._43Q[V.id]=!0),r._41Q.push(V),r._41Q.sort(function(B,s){return B.priority!==s.priority?B.priority-s.priority:B.id-s.id})},setEye:function(w,g,Y){1===arguments.length&&(g=w[1],Y=w[2],w=w[0]);var Z=this._eye;Z[0]=w,Z[1]=g,Z[2]=Y,this.fp(xe,z,Z)},setCenter:function(v,K,n){1===arguments.length&&(K=v[1],n=v[2],v=v[0]);var a=this._center;a[0]=v,a[1]=K,a[2]=n,this.fp(Gp,z,a)},setUp:function(o,r,h){1===arguments.length&&(r=o[1],h=o[2],o=o[0]);var v=this._up;v[0]=o,v[1]=r,v[2]=h,this.fp("up",z,v)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||sq},isTransparentMask:function(F){return F.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var C=this,P=C._aspect;return P?P:(P=C.getWidth()/C.getHeight(),P||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(t){var d=this,y=d._dataModel,V=d._selectionModel;y!==t&&(y&&(y.ump(d.handleDataModelPropertyChange,d),y.umm(d.handleDataModelChange,d),y.umd(d.handleDataPropertyChange,d),V||y.sm().ums(d.handleSelectionChange,d)),d._dataModel=t,t.mp(d.handleDataModelPropertyChange,d),t.mm(d.handleDataModelChange,d),t.md(d.handleDataPropertyChange,d),V?V._21I(t):t.sm().ms(d.handleSelectionChange,d),d._postProcessing.handleDataModleChange(y,t),d._tryInvalidateEnvmap(),d.invalidateAll(!0),d.invalidateLight(),d.invalidateboxClipper(),d.invalidateFlowObjects(),d._49Q(),d.fp(Kd,y,t),d._canvas.style.background=t.getBackground()||"")},handleDataModelPropertyChange:function(M){var Q=M.property;if("background"===Q){var I=this._canvas.style.background,c=M.newValue||"";this._canvas.style.background=c,this.fp("canvasBackground",I,c)}else if("envmapType"===Q)this._tryInvalidateEnvmap();else if("envmap"===Q){var I=this._shaderUseEnvmapFlag,c=!(!M.newValue||!M.newValue.length);I!==c&&Rq(this),this.iv()}},handleDataPropertyChange:function(O){var _=O.data;this.invalidateData(_);var m=O.property;Od(_)&&"s:light.type"===m?this.invalidateLight():"s:3d.clipbox"===m?this.invalidateboxClipper(_,!0):"s:effect.flow"===m?this.invalidateFlowObjects(_,!0):"s:shadow.cast"===m?this.shadowMap.tryUpdateBounding(_):"s:3d.visible"===m&&this.invalidateQuickVisible(_)},invalidateboxClipper:function(d,q){var D=this._boxClippers,P=D.length;if(d){var z=!!d.s("3d.clipbox");if(q=!!q,z===q)D.indexOf(d)<0&&D.push(d);else{var k=D.indexOf(d);k>=0&&D.splice(k,1)}}else D=this._boxClippers=[],this.dm().each(function(E){E.s("3d.clipbox")&&D.push(E)});var U=D.length;P!==U&&(Rq(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),Vj=U?Cn:uo),this.iv()},_updateBoxClipperMatrix:function(){for(var D,g,p=this._boxClippers,$=this._boxClipperMatrixes=[],i=this._boxClipperClipInner=[],H=this._boxClipperGroups=[],G=this._boxClipperShape=[],Q=new vr,K=0,f=p.length;f>K;K++)D=p[K],D.appendAnchorMatrix3d(g=vs(D,this.getMat(D))),$.push(Q.getInverse(Q.fromArray(g)).toArray()),i.push("inner"===D.s("3d.clipbox")),H.push(D.s("3d.clipbox.group")),G.push(Hs[D.s("3d.clipbox.shape")]||1)},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<m.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(O,V){var D=this._flowObjects,$=D.length;if(O){var W=!!O.s("effect.flow");if(V=!!V,W===V)D.indexOf(O)<0&&D.push(O);else{var u=D.indexOf(O);u>=0&&D.splice(u,1)}}else D=this._flowObjects=[],this.dm().each(function(_){_.s("effect.flow")&&D.push(_)});$!==D.length&&Rq(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(o){var b=this,t=o.property;if(b.iv(),b._18Q=z,"eye"===t)b._33Q=!0;else if("devicePixelRatio"===t)b._42(b.getDevicePixelRatio());else if(Gs[t]&&(Rq(b),"batchInstancedDisabled"===t)){b._genBatchInstancedArrayFunc(),this.shadowMap.deleteShadowProgram();var a,E=m.getBatchInfoMap();for(a in E)E[a]&&E[a].instanced&&b.invalidateBatch(a);E=b._batchInfoMap;for(a in E)E[a]&&E[a].instanced&&b.invalidateBatch(a)}},_5O:function(h){var m=h._22Q();return m?new m(this,h):z},getData3dUI:function(e){var Q=this._25I[e._id];return Q===B&&(Q=this._5O(e),this._25I[e._id]=Q),Q},invalidateAll:function(E,s){var g=this;if(E){for(var T in g._25I){var $=g._25I[T];$&&$.dispose()}g._25I={},g.iv(),De(g)}else De(g),g.dm().each(function(t){g.invalidateData(t)});g.shadowMap.tryInvalidateLater(E,s)},invalidateSelection:function(){var B=this;B.sm().each(function(u){B.invalidateData(u)})},invalidateData:function(l){var K=this,u=K.getData3dUI(l);u&&(u.iv(),K.iv()),De(K,l)},getShape3dText:function(t){return t.getStyle("shape3d.text")||this.getLabel(t)},invalidateBatch:function(v){var S=this,o=S._40Q;o.each(function(T){S._invalidateBatch(v,T.batchModelMap,T.batchIndexMap),S._invalidateBatch("T"+v,T.wireframeModelMap,T.wireframeIndexMap),S._invalidateBatch("O"+v,T.wireframeModelMap,T.wireframeIndexMap),T.markBatchInvalid()}),S.iv()},_invalidateBatch:function(s,r,z){var A=this,f=r[s];f&&(f.ds.forEach(function(P){var w=A.getData3dUI(P);w&&w.iv(),delete z[P._id]}),delete r[s])},handleDataModelChange:function(e){var f=this,V=e.kind,g=e.data;if("add"===V)f.invalidateData(g),Xr(g)&&g.getEdgeGroup()&&g.getEdgeGroup().eachSiblingEdge(f.invalidateData,f),Od(g)&&f.invalidateLight(),g.s("3d.clipbox")&&f.invalidateboxClipper(g,!0),g.s("effect.flow")&&f.invalidateFlowObjects(g,!0),f._49Q();else if(V===Zf){var S=g._id,k=f._25I[S];k&&(k.dispose(),delete f._25I[S],f.iv()),g===f._currentSubGraph&&f.setCurrentSubGraph(z),De(f,g),Od(g)&&f.invalidateLight(),g.s("3d.clipbox")&&f.invalidateboxClipper(g,!1),g.s("effect.flow")&&f.invalidateFlowObjects(g,!1)}else V===hm&&(f.invalidateAll(!0),f.setCurrentSubGraph(z),De(f),f.invalidateLight(),f.invalidateboxClipper(),f.invalidateFlowObjects())},toCanvas:function(J,O,g){var w=this,C=w.getGL();if(w.validate(),J){var t=C.getParameter(C.COLOR_CLEAR_VALUE);br(C,J)}w._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var y=w.getWidth()||1,b=w.getHeight()||1,D=new Uint8Array(4*y*b),k=km(),U=k.getContext("2d");C.readPixels(0,0,y,b,C.RGBA,C.UNSIGNED_BYTE,D),Eg(k,y,b,1);for(var d=U.getImageData(0,0,y,b),A=d.data,B=0;B<A.length;B+=4){var T=B/4,M=e(T/y),j=T-M*y;T=4*((b-1-M)*y+j),A[T]=D[B],A[T+1]=D[B+1],A[T+2]=D[B+2],A[T+3]=D[B+3]}if(U.putImageData(d,0,0),J&&br(C,t),w._42(w.getDevicePixelRatio()),O&&g){var X=km(),h=X.getContext("2d");return Eg(X,O,g,1),m.drawImage(h,k,0,0,O,g),X}return k},toDataURL:function(H,M){var E=this,T=E.getGL();if(E.validate(),H){var p=T.getParameter(T.COLOR_CLEAR_VALUE);br(T,H)}E._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var b=E._canvas.toDataURL(M||"image/png",1);return H&&br(T,p),E._42(E.getDevicePixelRatio()),b},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var c=this._26I;if(c)return this.acquireProgram(),c;if(!this._35O){var U=this,y=U._canvas,Z=U._attributes;if(!Z||Z.requestWebGL2!==!1)try{c=y.getContext("webgl2",Z)||y.getContext("experimental-webgl2",Z),c&&(U._webGLVersion=2,U._26I=c)}catch(g){}if(!c)try{c=y.getContext("webgl",Z)||y.getContext("experimental-webgl",Z)}catch(g){throw new Error("WebGL not supported")}if(!c)throw new Error("WebGL not supported");U._26I=c;var C=U._frameState=new Es(this,c);U._glExtensions=new W(c),U._glCapabilities=new f(c,U._glExtensions),U._2O={},c._emptyCubeTexture=nl(c),c._compiledShader={},c._emptyTexture=ng(c),c._emptyBlendTexture=ng(c),c._bufPool={},c._id=++Js,c._divisorState=[],C.setGLState(),U._buffer={vs:Co(c),ns:Co(c),is:Co(c),uv:Co(c),batchColor:Co(c),batchBlend:Co(c),batchBrightness:Co(c),lineDistance:Co(c)},U._1O=cm(c);var z=U._cube={vs:Co(c),ns:Co(c),is:Co(c),uv:Co(c)};return wr(c,z.vs,On),wr(c,z.ns,Jr),wr(c,z.uv,gn),Vg(c,z.is,lg),U.acquireProgram(),U._genBatchInstancedArrayFunc(),c._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,textureCache:{time:0,count:0,pixels:0},frame:0,cacheTimeCost:0,reflectDepth:0},c}},getGLCapabilities:function(){var D=this.getGL();return D?this._glCapabilities:void 0},getGLExtensions:function(){var $=this.getGL();return $?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<m.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var c,t=this.dm();return t&&(c=t.getEnvmapType()),c||"legacy"},setEnvmapExtraQuaternion:function(V){var T=this._envmapExtraQuaternion;this._envmapExtraQuaternion=V instanceof _k.Quaternion?V.clone().inverse().toArray():null,null==T!=(null==V)&&Rq(this)},invalidateEnvmap:function(l){return this._envmapRenderer.invalidateEnvmap(l)},_setEnvmapByProbeId:function(h,l){return this._envmapRenderer.setEnvmapByProbeId(h,l)},_tryInvalidateEnvmap:function(){var Z=this.getEnvmapType();Z!==this._lastProgramEnvmapType&&(Rq(this),this.iv())},acquireProgram:function(){var Z=this,n=Z._26I;if(n&&!Z._prg){var X=Z._prg=n.createProgram();if(!X)return z;var Q=Z._dirs.length,R=Z._spots.length,q=Z._59O.length,l=Z._boxClippers.length,v=Z._flowObjects.length,_=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];Q&&_.push("uDirColor","uDirDirection"),R&&_.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),q&&_.push("uPointColor","uPointRange","uPointPosition"),Op||(mn=Zq(mn.substring(0,mn.indexOf("^#"))),Mc=Zq(Mc),Op=!0);var D=Z.getEnvmap(),t=D&&D.length,h=Z.getEnvmapType(),O=["#define MAX_DIR "+Q,"#define MAX_SPOT "+R,"#define MAX_POINT "+q,"#define MAX_BOX_CLIPPER "+l,"#define MAX_FLOW_OBJECT "+v,Z._fogDisabled?"":"#define FOG","exp2"===Z.getFogMode()?"#define FOG_EXP2":"",Z._dashDisabled?"":"#define DASH",Z._uvClipEnabled?"#define UV_CLIP":"",null==Z._envmapExtraQuaternion?"":"#define ENVMAP_ROTATE",t?"#define USE_ENVMAP":"","legacy"!==h?"#define ENVMAP_TYPE_CUBE_UV":"",Z.isOrtho()?"#define ORTHOGRAPHIC":"",Z._batchColorDisabled?"":"#define BATCHCOLOR",Z._batchInstancedDisabled?"":"#define BATCHINSTANCE",Z._batchBlendDisabled?"":"#define BATCHBLEND",Z._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS","#define "+(Is[Z.getFlowBlendMode()]||Is[m.graph3dViewFlowBlendMode]),Z.shadowMap.enable?Z.shadowMap.genShaderDefine():"",""].join("\n"),A=xb(n,X,n.VERTEX_SHADER,mn.replace("#PREFIX",O));n.getShaderParameter(A,n.COMPILE_STATUS)||Qd("COMPILE",n.VERTEX_SHADER,n.getError(),n.getShaderInfoLog(A));var C=xb(n,X,n.FRAGMENT_SHADER,Mc.replace("#PREFIX",O));if(n.getShaderParameter(C,n.COMPILE_STATUS)||Qd("COMPILE",n.FRAGMENT_SHADER,n.getError(),n.getShaderInfoLog(C)),Md?_.push("aPosition"):(X.aPosition=0,n.bindAttribLocation(X,0,"aPosition")),n.linkProgram(X),!n.getProgramParameter(X,n.LINK_STATUS)){var x=n.getProgramInfoLog(X);return Z._prg=z,x.indexOf("maximum temp register")>=0&&!Z._glTempRegisterLimited?(Z._glTempRegisterLimited=!0,n.deleteProgram(X),Z.acquireProgram()):(Qd("LINK",n.getProgramParameter(X,n.VALIDATE_STATUS),n.getError(),x),n.deleteProgram(X),z)}_.forEach(function(u){X[u]=/^u/.test(u)?n.getUniformLocation(X,u):n.getAttribLocation(X,u)});var H=Z._frameState;H.renderState.program=H.defaultProgram=X,Z._envmapRenderer.changeEnvmapType(Z._lastProgramEnvmapType=h),Z._shaderUseEnvmapFlag=t,n.deleteShader(A),n.deleteShader(C)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(I){var X=I.s("brightness"),f=this.isSelected(I)?I.s("select.brightness"):z;return X==z?f:f==z?X:X*f},getDataHighlightMode:function(f){return f.s("highlight.mode")},getWireframe:function(l){var O=l.s("wf.visible"),y=l.s("wf.width");return O===!0||y>0&&"selected"===O&&this.isSelected(l)?{color:l.s("wf.color"),width:y,"short":l.s("wf.short"),mat:l.s("wf.mat")}:void 0},getPartPosition:function(V,o,l,c){c=c||df;var M=this.getData3dUI(V),d=M._16O(c.autoRotate,o,z,l||Dn,c.t3,c.r3,c.rotationMode);return[d[12],d[13],d[14]]},_transformPointToViewSpace:function(B){var b=[B[0],B[1],B[2]];return jd(b,this._viewMatrix),b},_transformDirectionToViewSpace:function(l,U){var Z=l?[l[0],l[1],l[2]]:[0,0,0];jd(Z,this._viewMatrix);var G=U?[U[0],U[1],U[2]]:[0,0,0];jd(G,this._viewMatrix);var S=G[0]-Z[0],O=G[1]-Z[1],J=G[2]-Z[2],M=Math.sqrt(S*S+O*O+J*J);return M?[S/M,O/M,J/M]:[S,O,J]},getWireframeGeometry:function(s){return s.s("wf.geometry")?{color:s.s("wf.color"),width:s.s("wf.width"),mat:s.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(W){return W.s("body.color")},getMat:function(T){return T.getMat?T.getMat():T.s("mat")},getFaceMat:function(U,n){return U.getFaceMat?U.getFaceMat(n):U.s(n+".mat")},getFaceBlend:function(L,u){return L.s(u+".blend")||L.s("all.blend")},getFaceColor:function(q,h){return q.s(h+".color")||q.s("all.color")},getFaceImage:function(N,B){return N.s(B+".image")||N.s("all.image")},getFaceBlendImage:function(s,z){return s.s(z+".blend.image")||s.s("all.blend.image")},getFaceDiscardSelectable:function(d,L){var l=d.s(L+".discard.selectable");return l==z?d.s("all.discard.selectable"):l},getFaceUv:function(J,a){return J.s(a+".uv")||J.s("all.uv")},getFaceUvOffset:function(k,c){return k.s(c+".uv.offset")||k.s("all.uv.offset")},getFaceUvScale:function(n,B){return n.s(B+".uv.scale")||n.s("all.uv.scale")},getFaceUvRotation:function(t,G){return t.s(G+".uv.rotation")||t.s("all.uv.rotation")},getFaceUvAnchor:function(v,h){return v.s(h+".uv.anchor")||v.s("all.uv.anchor")},getFaceLight:function(I,R){var d=I.s(R+".light");return d==z?I.s("all.light"):d},getFaceVisible:function(K,y){var M=K.s(y+".visible");return M==z?K.s("all.visible"):M},getFaceOpacity:function(s,P){var $=s.s(P+".opacity");return $==z?s.s("all.opacity"):$},getFaceTransparent:function(M,V){var I=M.s(V+".transparent");return I==z?M.s("all.transparent"):I},getFaceReverseColor:function(R,h){return R.s(h+".reverse.color")||R.s("all.reverse.color")},getFaceReverseFlip:function(U,c){var Z=U.s(c+".reverse.flip");return Z==z?U.s("all.reverse.flip"):Z},getFaceReverseCull:function(A,R){var N=A.s(R+".reverse.cull");return N==z?A.s("all.reverse.cull"):N},getTextureMap:function(){return this._2O},_2Oi:function(W,T,w){w=w||"";var j;(j=this._2O[W])||(j=this._2O[W]={}),j[w]=T},deleteTexture:function(p){var K=this;if(K._2O){var g=K._2O[p];if(g){delete K._2O[p];var Y=K.getGL();for(var y in g)Y.deleteTexture(g[y])}}},renderPickScene:function(){var e=this.getGL();this.syncRenderState(),this._picking=e._picking=!0,this.renderScene(),this._picking=e._picking=!1},invalidateCachedTexture:function(E){var D=this.getData3dUI(E);D.invalidateCachedTexture(this.getGL()),this.invalidateData(E)},invalidateShape3dCachedImage:function(Y){this.invalidateCachedTexture(Y)},invalidateCachedGeometry:function(J){var P=this.getData3dUI(J);P.invalidateCachedGeometry(),this.invalidateData(J)},isInteractive:function(t){return t.s("interactive")},getTexture:function(P,a,e,F){if(!P)return z;var s,S,x=this,v=x.getGL(),D=x._2O[P];if(D&&(a&&(S=a.s("texture.mipmap.max")),s=D[S||""]||D.default),!s){var T=Om(P);if(F||(F={}),!T)return v._emptyTexture;if(a){F.mipmapMaxLevel=S=a.s("texture.mipmap.max");var $=a.s("texture.wrap");F.clampToEdge="clampToEdge"===$?!0:"repeat"===$?!1:B}if(T.uuid||(T.uuid=_.Math.generateUUID()),T.tagName){if(T.dynamic)return cm(v,T,x._1O,F);s=cm(v,T,B,F),x._2Oi(P,s,S)}else{var n,K=a&&(a.s("texture.cache")||a.s("shape3d.image.cache")||T.textureCache),h=x.isVRPresenting();if(h&&(a._textureUpdateFrame===v._renderInfo.frame?K=!0:a._textureUpdateFrame=v._renderInfo.frame),K&&(n=x.getData3dUI(a),s=n.getCachedTexture(e),s&&n.interactiveInfo&&s.interactiveInfo&&(n.interactiveInfo[s.interactiveInfo.key]=s.interactiveInfo.info)),!s){var g=v._renderInfo.textureCache;if(K){if(g.time>m.graph3dMaxVectorCacheTime)return x.redraw(),v._emptyTexture;if(!Gj(T,a))return v._emptyTexture}var d;a&&(1!==a.s("texture.scale")?d=a.s("texture.scale"):1!==a.s("shape3d.texture.scale")&&(d=a.s("shape3d.texture.scale"))),d||(d=1);var J=a&&(a.s("fixSizeOnScreen")||a.s("shape3d.fixSizeOnScreen")),u=J?v.NEAREST:v.LINEAR;J?"number"==typeof J&&(d*=0>J?1:J):a&&(a.s("vector.dynamic")||a.s("shape3d.vector.dynamic"))&&(n||(n=x.getData3dUI(a)),J=n.getVectorDynamicSize());var k,C,M,W=a&&a.s("shape3d");"billboard"===W?M=a.getTall()/a.getWidth():"plane"===W&&(M=a.getHeight()/a.getWidth());var q=To(T,a);if(J){var H;H=K?x._devicePixelRatio||sq:x.getDevicePixelRatio(),k=J[0]>0?J[0]*H:d*q*H,C=J[1]>0?J[1]*H:d*(M?Of(T,a,x,Math.min(4096,q*M)):Of(T,a))*H}else k=d*q,C=d*(M?Of(T,a,x,Math.min(4096,q*M)):Of(T,a));if(k>=1&&C>=1){var Y=0;(K||h)&&(Y=Date.now());var c=x._glCapabilities.maxTextureSize;k=Math.min(k,c),C=Math.min(C,c);var V=ee(k,C);if(!n&&a&&(n=x.getData3dUI(a)),n&&n.interactiveInfo){var Q=P;"object"==typeof Q&&(Q=Q.uuid||(Q.uuid=_.Math.generateUUID()));var j=n.interactiveInfo[Q]={};V.interactiveInfo=j.bodyInfo={compInfos:[],matrix:new hf,rect:{x:0,y:0,width:k,height:C}}}sl(V,T,0,0,k,C,a,x),V.interactiveInfo&&(V.interactiveInfo=null),V.restore(),g.count++,g.pixels+=k*C,a?(F.minFilter=Ed(a.s("texture.filter.min")||a.s("texture.filter"))||u,F.magFilter=Ed(a.s("texture.filter.mag")||a.s("texture.filter"))||u):F.minFilter=F.magFilter=u,K||h?(s=cm(v,Pj,null,F),n.setCachedTexture(s,e),g.time+=Date.now()-Y,j&&(s.interactiveInfo={key:Q,info:j}),Pj=null):s=cm(v,Pj,x._1O,F)}}}}return s},redraw:function(){this.iv()},validateImpl:function(){var Q=this;if(Q._lightChanged){Q._lightChanged=!1;var K=[],v=[],p=[];Q.dm().each(function(b){if(Od(b)){var J=b.s("light.type");J===Ej?K.push(b):J===Bb?v.push(b):J===$r&&p.push(b)}}),(K.length!==Q._59O.length||v.length!==Q._spots.length||p.length!==Q._dirs.length)&&Rq(Q),Q._59O=K,Q._spots=v,Q._dirs=p}var c=Q.getAspect();c!==Q.__cachedAspect__&&(Q._updateSkybox({property:"asceptChanged"}),Q.__cachedAspect__=c),Q._42(),Q._1o.iv()},getRenderInfo:function(){var K=this.getGL();return K?K._renderInfo:void 0},getDebugTip:function(){var O=this,I=O.getRenderInfo();if(I){var j=O.getGL()._validBufCount||0,Z="Draw Calls: "+I.calls+"<br/>"+"Vertices: "+I.vertices+"<br/>"+"Faces: "+I.faces+"<br/>"+"Lines: "+I.lines+"<br/>"+(I.points?"Points: "+I.points+"<br/>":"")+"Buffers: "+j+"<br/>"+"Cache Models: "+S.keys(tr).length+"<br/>"+"Shape3d Models: "+S.keys(zn).length;if(O.isVRPresenting()&&(Z+="<br/>VR fps: "+O.vr.getFps()),I.textureCache){var m=I.textureCache.count;if(Z+="<br/>2D Dynamic Textures: "+I.textureCache.count,m>0){var B,$=I.textureCache.pixels;B=$>1e6?Math.round($/1e6)+"M":$>1e3?Math.round($/1e3)+"K":Math.round($),Z+="<br/>2D Dynamic pixels: "+B}}return Z}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var w=new _.Math.Box3,Q=new _.Math.Matrix4;return function(o){var Y=o;if(Y instanceof _.Data&&(Y=this.getData3dUI(Y)),!Y.mat)return!0;var t=Y.getBoundingBox(!0);w.copy(t).applyMatrix4(Q.fromArray(Y.mat));var h=this.getFrustum();return h.intersectsBox(w)}}(),updateScene:function(){var V=this;V._81O=z,V.overlappingBox.clear();var I=V._40Q;I.init();var P=V.getGL(),T=V.dm();if(T.isHierarchicalRendering())T.eachByHierarchical(function(E){var N=V.getData3dUI(E);N&&N.update(V,P,I)});else{var d,B,K,J=T.getDatas().getArray(),r=J.length;for(d=0;r>d;d++)B=J[d],K=V.getData3dUI(B),K&&K.update(V,P,I)}this._updateBoxClipperMatrix(),I.onUpdated()},_pushFrameRenderOptions:function(C){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=C},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(R){var $=this._currentFrameRenderOptions;return $&&$[R]},getRenderLists:function(){return this._40Q},renderScene:function(J){function T(k,O){c.setGLState(k,O),c.setUniforms(k),c.renderState.attribs.disable(),j=w.directUniforms(),Y=w.directAttribs(),Y.disable()}function C(_){for(var I=!1;n>l;l++){var y=H[l];if(!G||!y.ignoreInPick){if(y.priority>=_)break;(!a._43Q[a._44Q=y.id]||Wl[cs.length])&&(y.render(o,a,c),T(),I=!0)}}return I}var a=this;a._pushFrameRenderOptions(J),a._getFrameRenderOptions("createShadowMap")!==!1&&a.shadowMap.render(),a.flowMap.render();var o=a.getGL();a._envmapRenderer.onBeforeRender(o),a._44Q=-1;var j,Y,c=a._frameState,w=c.renderState,V=w.glState,h=a._prg;a._projectMatrix=gr(a),Cj(a,a._7O),a._viewMatrix=Cp(a._7O),a.isReflecting(o)||zg(a._projScreenMatrix=Cd(),a._projectMatrix,a._viewMatrix),c.syncEnv(this._picking?this.pickColorMap:B),w.useProgram(h),T(!1,!0),o.clear(o.DEPTH_BUFFER_BIT);var G=a._picking,H=this._41Q,l=0,n=H.length;if(C(m.cameraPriority.skybox),G){var y=V.color.clear.slice(0);br(o,[0,0,0,0])}else br(o,[0,0,0,0]),V.blend.enabled=!1,V.depth.enabled=!1,V.depth.mask=!1,a._camera&&a._camera.s("camera.renderSky")===!1||a.drawSky(o,h),a._getFrameRenderOptions("renderReflector")!==!1&&a.drawReflectors(o)&&(a._projectMatrix=gr(a),Cj(a,a._7O),a._viewMatrix=Cp(a._7O),c.syncEnv(),T()),V.blend.enabled=!1,V.depth.enabled=!0,V.depth.mask=!0,j.uTransparent=!1,a._getFrameRenderOptions("renderGrid")!==!1&&a._31O._42(o,h);if(!o.textureBatch||Wl[(ONE_FRAME_TIME-6)/2]){G||(a.shadowMap.enable&&a.shadowMap.createShadow(j),a.flowMap.createFlow(j));for(var U=0,v=Ql.length;v>U;U++){var I=Ql[U],M=fq[I];if(!(!a._camera&&M.ignore||a._camera&&!a._camera.isLayerVisible(I))){var E=M.priority;C(E)&&(G||(a.shadowMap.enable&&a.shadowMap.createShadow(j),a.flowMap.createFlow(j))),this.renderLayer(I)}}C(m.cameraPriority.infinity),G||a.flowMap.disableFlow(j),op(a,j,0,m.graph3dViewHeadlightAmbientIntensity),j.uHeadlightColor=[1,1,1,0],j.uUseEnvMap=!1,j.uHeadlightDirection=[0,0,0],j.uHeadlightRange=0,V.depth.enabled=!1,j.uTransparent=!1,j.shadowReceive=!1,Vj(a,j,Wn),G?a.drawFilter||a._30O._42(o,h):(a._highlightHelper._42(o,h),this._renderAxisAndEditHelper(a._getFrameRenderOptions("renderAxis")!==!1,a._getFrameRenderOptions("renderEdit")!==!1),V.blend.enabled=!1,V.depth.mask=!0),V.depth.enabled=!0,G&&br(o,y),wr(o,z),Vg(o,z),a._44Q=-1,a._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(N,Y){if(N||Y){var e=this,O=e.getGL(),o=e._prg,M=e._frameState,t=M.renderState,n=t.glState,K=t.directUniforms();M.renderState.attribs.disable(),n.depth.enabled=!1,K.uTransparent=!1,K.shadowReceive=!1,n.blend.enabled=!1,n.depth.mask=!0,K.uPick=e._picking;var H=!e._fogDisabled;H&&(K.uFog=!1),N&&e._32O._42(O,o),Y&&e._30O._42(O,o),H&&(K.uFog=!0),wr(O,z),Vg(O,z)}},renderLayers:function(j,K){K&&(j=Ef(j));for(var s=0,f=j.length;f>s;s++)this.renderLayer(j[s])},renderSky:function(){var X=this,J=X._frameState,u=J.renderState,U=u.glState,R=X.getGL(),M=X._prg;X._projectMatrix=gr(X),Cj(X,X._7O),X._viewMatrix=Cp(X._7O),zg(X._projScreenMatrix=Cd(),X._projectMatrix,X._viewMatrix),J.syncEnv(),u.useProgram(M),J.setGLState(!1,!0),J.setUniforms(!1),J.renderState.attribs.disable(),R.clear(R.DEPTH_BUFFER_BIT),br(R,[0,0,0,0]),U.blend.enabled=!1,U.depth.enabled=!1,U.depth.mask=!1,X.drawSky(R,M),U.depth.mask=!0,U.depth.enabled=!0,wr(R,z),Vg(R,z)
},addRenderLayerListener:function(Y,G,I){var c=this;c._renderLayerNotifier||(c._renderLayerNotifier=new Ji),c._renderLayerNotifier.add(Y,G,I)},removeRenderLayerListener:function(f,w){this._renderLayerNotifier&&this._renderLayerNotifier.remove(f,w)},fireRenderLayerEvent:function(h,W){var $=this._renderLayerNotifier;$&&$.fire({layer:h,phase:W})},renderLayer:function(f){var O=this,K=O._picking,Z=O._40Q.get(f);if(Z){O.fireRenderLayerEvent(f,"prepare");var b=O.getGL(),T=fq[f],_=O._frameState,I=_.renderState,F=I.glState,R=I.directUniforms();!K&&O.isSortable()&&Z.sort(O._sortFunc,O._projScreenMatrix);var U,d,W,a=Z.opaque,P=Z.transparent,s=Z.batchModelMap,A=Z.polylineModelMap,D=Z.wireframeModelMap,b=O.getGL(),$=O._prg;K||(F.blend.enabled=!1,F.depth.enabled=!0,F.depth.mask=!0),R.uTransparent=!1,T.clearDepth!==!1&&b.clear(b.DEPTH_BUFFER_BIT);var H=this.drawFilter;if(H){for(W=a,U=0,d=W.length;d>U;U++)H(W[U].data)!==!0&&W[U].ui._42(b,$,p);if(K)for(W=P,U=0,d=W.length;d>U;U++)W[U].ui._46Q(b);qp(O,s)}else{for(W=a,U=0,d=W.length;d>U;U++)W[U].ui._42(b,$,p);if(K)for(W=P,U=0,d=W.length;d>U;U++)W[U].ui._46Q(b);qp(O,s),Ep(O,A),Ep(O,D)}if(K||(F.blend.enabled=!0,F.depth.mask=!1),O._45Q=R.uTransparent=!0,H){for(W=P,U=0,d=W.length;d>U;U++)H(W[U].data)!==!0&&W[U].ui._42(b,$,r);qp(O,s,null,!0)}else{for(W=P,U=0,d=W.length;d>U;U++)W[U].ui._42(b,$,r);qp(O,s,null,!0),Ep(O,A,null,!0),Ep(O,D,null,!0)}O._45Q=null,O.fireRenderLayerEvent(f,"post")}},_42:function(J,L){var W=this;if(!W._35O&&(!Ch||Wl(Ch))){var l=W.getWidth(),T=W.getHeight();if(l&&T){var j=W.getGL();if(j){var V,M=W._canvas;if(J?V=!0:J=W.getDevicePixelRatio(),!W._picking&&(V||l!==M.clientWidth||T!==M.clientHeight)){Eg(M,l,T,J);var y=J;l&&Math.abs(j.drawingBufferWidth-l*J)>1&&(y=Math.min(y,j.drawingBufferWidth/l)),T&&Math.abs(j.drawingBufferHeight-T*J)>1&&(y=Math.min(y,j.drawingBufferHeight/T)),y!==J&&(W.setDevicePixelRatio(J=y),Eg(M,l,T,J)),W._18Q=null}j.clear(j.COLOR_BUFFER_BIT);var K=j._renderInfo;K.calls=0,K.vertices=0,K.faces=0,K.lines=0,K.points=0,K.textureCache={time:0,count:0,pixels:0},K.frame=++W._frameId,K.cacheTimeCost=0,K.reflectDepth=0,l*=J,T*=J,this.syncRenderState();do{if(W.isVREnabled()&&W.vr.render(j,l,T,L))break;if(W.updateScene(),W._postProcessing.render(j,l,T,L))break;W.setViewport(j,0,0,l,T),W.renderScene(L)}while(!1);W._33Q=!1,W.countFrame(),W._doBufferGC(j)}}}},syncRenderState:function(){var f,P;(f=this._frameState)&&(P=f.renderState)&&P.syncLoss()},drawReflectors:function(w){w._renderInfo.reflectDepth++;var X,m,h,S=this,b=S._dataModel.getReflectors(),r=!1;for(X in b)m=b[X],S.isVisible(m)&&(h=S.getData3dUI(m),h&&h.drawReflector&&h.drawReflector(w)&&(r=!0));return w._renderInfo.reflectDepth--,r},isReflecting:function(f){return f._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(u,q){return this._postProcessing.enableModule(u,q)},getPostProcessingModule:function(u){return this._postProcessing.getModule(u)},getPostProcessingValue:function(g,V){var T=this._postProcessing.getModule(g);return T?T[V]:B},setPostProcessingValue:function(K,W,E){var g=this.getPostProcessingValue(K,W),n=this._postProcessing.getModule(K);n&&g!==E&&("enable"===W?this.enablePostProcessing(K,E):n[W]=E,this.firePropertyChange("postProcessing."+K+"."+W,g,E))},setDofImageFromGraphView:function(V,I,H){return this._postProcessing.getModule("Dof").setImageFromGraphView(V,I,H)},setViewport:function(m,x,J,L,I){this._viewport=[x,J,L,I],Gh.for(m).directState().viewport=this._viewport},getRenderState:function(){return Gh.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(p){this._bufferGCInterval=p},_doBufferGC:function(w,k){var s,j,N=w._bufPool,D=0,P=0,L=w._renderInfo.frame,U=this._bufferGCInterval||10;for(s in N)D++,j=N[s],j&&(k||L-j._fid>U?(w.deleteBuffer(j._buf),j._buf=null,N[s]=null):P++);if(D/2>P&&D>128){var h={};for(s in N)N[s]&&(h[s]=N[s]);w._bufPool=h}w._validBufCount=P},_swapLineMap:function(){var V=this;pl=V._polylineModelMap,V._polylineModelMap=V._polylineModelMapSwap,V._polylineModelMapSwap=pl,pl=V._wireframeModelMap,V._wireframeModelMap=V._wireframeModelMapSwap,V._wireframeModelMapSwap=pl,pl=V._polylineIndexMap,V._polylineIndexMap=V._polylineIndexMapSwap,V._polylineIndexMapSwap=pl,pl=V._wireframeIndexMap,V._wireframeIndexMap=V._wireframeIndexMapSwap,V._wireframeIndexMapSwap=pl},_updateSkybox:function(l){if(this._skybox&&l){var r=l.property,C=!1,d=this._skybox;if("eye"===r||"forceUpdate"===r){var m=this._eye;d.p3(m[0],m[1],m[2]),C=!0}if("near"===r||"far"===r||"forceUpdate"===r||"asceptChanged"===r){var x=d.__cachedS3__;x||(x=d.__cachedS3__=d.getFinalScale3d());var c=Math.sqrt(3),T=1/0,u=-1/0;x.forEach(function(w){w/=2,T=H(w,T),u=$(w,u)}),u*=c;var o=this._near,O=this._far,z=Math.tan(this.getFovy()/2)*o,J=this.getAspect()*z,M=1.1*Math.sqrt(J*J+z*z+o*o),P=1;if(M>T)P=M/T;else if(u>=O){var k=O*O/(o+O);P=k/u}if(1!==P){d.__updatingSkybox__=!0;var X=x.map(function(p){return P*p});d.s3(X),d.setScale3d(1,1,1),C=!0,delete d.__updatingSkybox__}}C&&this.invalidateData(d)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(d){return this.setSkybox(d)},getSkybox:function(){return this._skybox},setSkybox:function(j){var r=this._skybox;if(r===j)return j&&this._updateSkybox({property:"forceUpdate"}),void 0;if(r&&(this._skyboxStyleMap&&r.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&r.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&r.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Zf,data:r})),this._skybox=j,this.ump(this._updateSkybox,this),j){j.removeFromDataModel(),this._skyboxStyleMap=_.Default.clone(j.getStyleMap()),this._skyboxAnchor3d=j.getAnchor3d(),j.setAnchor3d(.5,.5,.5),this._skyboxP3=j.p3().slice(0),j.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var L=j.onPropertyChanged;j.onPropertyChanged=function(R){L.call(j,R),!j.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(R.property)>=0&&(j.__cachedS3__=B)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",r,j)},drawSky:function(j,$){var M=this,q=M._skybox;if(q){var E=Gh.for(j).directUniforms(),N=M._headlightIntensity,n=Qk(M._headlightColor),$=M._prg;1!==N&&(n=[n[0]*N,n[1]*N,n[2]*N]),E.uHeadlightColor=[n[0],n[1],n[2],1];var i=M.getData3dUI(q);if(i){var S=M.isOrtho(),A=S||this._computedProjectMatrix;if(A){var I=M._projectMatrix;S&&(M._ortho=!1),E.uPMatrix=M._projectMatrix=gr(M,!0)}var o=q.p3(),C=this.getEye();(o[0]!==C[0]||o[1]!==C[1]||o[2]!==C[2])&&(q._position.x=C[0],q._54O=C[1],q._position.y=C[2]),i.validate(),i._42(j,$,X),A&&(S&&(M._ortho=!0),E.uPMatrix=M._projectMatrix=I)}j.clear(j.DEPTH_BUFFER_BIT),E.uHeadlightColor=[n[0],n[1],n[2],M._headlightDisabled?1:0]}},getLogicalPoint:function(i){return Xi(i,this._canvas)},isRectOverlapping:function(U){var L=this.getData3dUI(U);return L._rectOverlapping},getHitFaceInfo:function(b){b.target&&(b=this.lp(b));var t=this.getDataInfoAt(b);if(t){var M=this.intersectObject(b,t.data);if(M)return{data:t.data,face:M.part}}return z},unproject:function(t,r){var d=this,a=d.getWidth(),m=d.getHeight(),w=t.target?d.lp(t):t,i=w.x-a/2,p=w.y-m/2,M=2*(i/a),V=2*(-1*p/m);r=r||0;var k=Cd(),I=gr(d),s=Cj(d);zg(k,I,s),Zc(k);var U=ho([M,V,r,1],k);return[U[0]/U[3],U[1]/U[3],U[2]/U[3]]},getDataAt:function(n){var $=this.getDataInfoAt(n);return $?$.data:z},getDataInfoAt:function(X,C,U){return X.target&&(X=this.lp(X)),this._1o.get(Sq(X.x,X.y,C),!0,U)},getDatasInRect:function(q,A){return this._1o.get(q,!1,A)},setEditable:function(G){var F=this,l=F._editable;F._editable=G,this.fp(so,l,G)},isEditable:function(M){var j=this;return M?j._editable?Dk(M)?M.s("3d.editable")?j._editableFunc?j._editableFunc(M):!0:!1:!1:!1:j._editable},isSelectable:function(J){return J.s("3d.selectable")&&this.sm().isSelectable(J)},isMovable:function(I){var x=this;return Xr(I)&&I.getStyle(Ur)!==Bj?!1:I.s("3d.movable")?x._movableFunc?x._movableFunc(I):!0:!1},isSizeEditable:function(A){return Dk(A)?this._sizeEditableFunc?this._sizeEditableFunc(A):!0:!1},isRotationEditable:function(q){return Dk(q)&&q.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(q):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(d){this.setZoom(rf,d)},zoomOut:function(s){this.setZoom(1/rf,s)},setZoom:function(){var b=new Or,B=new Or,x=new Or,G=new Or;return function(_,a){if(1!==_){var O=this;O._14o&&O._14o.stop(!0);var U,T=1/_;b.copy(O.getCenter()),B.copy(O.getEye());var z=O._ortho;if(z){if(U=O._orthoWidth,U<O._moveStep&&_>1)return}else if(b.distanceTo(B)<O._moveStep&&1>T)return;var Y=!1;return O._zoomToCenter===!1&&O._lastZoomLP&&(x.copy(B).sub(b).normalize(),O._81O=null,G.copy(O.getHitPosition(O._lastZoomLP,b.toArray(),x.toArray())),Y=!0,O._lastZoomHit=G),(a=vi(a))?(a.action=function(v){O.fi({kind:O._zooming?"betweenZoom":"beginZoom"}),O._zooming=1;var c=(T-1)*v+1;z&&O.setOrthoWidth(U*c),Y?(O.setEye(x.lerpVectors(G,B,c).toArray()),O.setCenter(x.lerpVectors(G,b,c).toArray())):z||O.setEye(x.lerpVectors(b,B,c).toArray())},a._37o=function(){delete O._14o,delete O._zooming,O.fi({kind:"endZoom"}),O.onZoomEnded()},O._14o=om(a)):(z&&O.setOrthoWidth(U*T),Y?(O.setEye(x.lerpVectors(G,B,T).toArray()),O.setCenter(x.lerpVectors(G,b,T).toArray())):z||O.setEye(x.lerpVectors(b,B,T).toArray()),void 0)}}}(),setOrthoZoom:function(G,o){return this.setZoom(G,o)},getPositionInfo:function(X){var l=this,o=l._eye,Z=l._center,e=l.getAspect(),r=X?In(of(Z,o,!0),of(X,o)):bh(o,Z);if(l._ortho){var k=l._orthoWidth;return{length:r,height:k/e,width:k}}var w=2*Qn(l._fovy/2)*r;return{length:r,height:w,width:w*e}},getCenterInfo:function(){var Y=this;return Y._81O||(Y._81O=Y.getPositionInfo()),zs(Y._81O)},rotate:function(v,o,S,M){var F=this;if(v||o){M==z&&(M=F._firstPersonMode),F._88O&&F._88O.stop(!0);var f=F._center,Z=F._eye,w=F.getCenterInfo().length,U=M?f:Z,E=M?Z:f,t=of(U,E),Y=Wc(t[0],t[2]),R=Wc(l(t[0]*t[0]+t[2]*t[2]),t[1]),G=M?Gp:xe;return M&&(o=-o),(S=vi(S))?(S.action=function(d){F.fi({kind:F._rotating?"betweenRotate":"beginRotate"}),F._rotating=1;var u=Y+v*d,L=R+o*d;L=M?s-Mr(F,s-L):Mr(F,L),t[0]=w*N(L)*N(u),t[1]=w*c(L),t[2]=w*N(L)*c(u),U[0]=E[0]+t[0],U[1]=E[1]+t[1],U[2]=E[2]+t[2],F.fp(G,z,U)},S._37o=function(){delete F._88O,delete F._rotating,F.fi({kind:"endRotate"}),F.onRotateEnded()},F._88O=om(S)):(Y+=v,R+=o,R=M?s-Mr(F,s-R):Mr(F,R),t[0]=w*N(R)*N(Y),t[1]=w*c(R),t[2]=w*N(R)*c(Y),U[0]=E[0]+t[0],U[1]=E[1]+t[1],U[2]=E[2]+t[2],F.fp(G,z,U),void 0)}},pan:function(Z,R,C,j){if(Z||R){var G=this;j==z&&(j=G._firstPersonMode),G._89O&&G._89O.stop(!0);var $=Cj(G),w=[$[0]*Z,$[4]*Z,$[8]*Z],v=[$[1]*R,$[5]*R,$[9]*R],h=w[0]+v[0],m=w[1]+v[1],B=w[2]+v[2],E=G._center,H=G._eye;if(j){var _=Lb(G.getBoundaries(),H[0],H[2],H[0]+h,H[2]+B,l(h*h+B*B));h=_[0],B=_[1]}if(C=vi(C)){var T=zs(H),W=zs(E);return C.action=function(e){G.fi({kind:G._panning?"betweenPan":"beginPan"}),G._panning=1,E[0]=W[0]+h*e,E[1]=W[1]+m*e,E[2]=W[2]+B*e,H[0]=T[0]+h*e,H[1]=T[1]+m*e,H[2]=T[2]+B*e,G.fp(xe,z,H),G.fp(Gp,z,E)},C._37o=function(){delete G._89O,delete G._panning,G.fi({kind:"endPan"}),G.onPanEnded()},G._89O=om(C)}E[0]+=h,E[1]+=m,E[2]+=B,H[0]+=h,H[1]+=m,H[2]+=B,G.fp(xe,z,H),G.fp(Gp,z,E)}},walk:function(l,e,c){if(l){var t=this;c==z&&(c=t._firstPersonMode),t._90O&&t._90O.stop(!0);var p=t._center,Z=t._eye,j=of(p,Z,!0);if(c){var C=Lb(t.getBoundaries(),Z[0],Z[2],Z[0]+j[0]*l,Z[2]+j[2]*l,n(l));if(l=bh(C),!l)return;j=[C[0]/l,0,C[1]/l]}if(e=vi(e)){var u=zs(Z),X=zs(p);return e.action=function(e){t.fi({kind:t._walking?"betweenWalk":"beginWalk"}),t._walking=1;var b=l*e;Z[0]=u[0]+j[0]*b,Z[1]=u[1]+j[1]*b,Z[2]=u[2]+j[2]*b,p[0]=X[0]+j[0]*b,p[1]=X[1]+j[1]*b,p[2]=X[2]+j[2]*b,t.fp(xe,z,Z),t.fp(Gp,z,p)},e._37o=function(){delete t._90O,delete t._walking,t.fi({kind:"endWalk"}),t.onWalkEnded()},t._90O=om(e)}Z[0]+=j[0]*l,Z[1]+=j[1]*l,Z[2]+=j[2]*l,p[0]+=j[0]*l,p[1]+=j[1]*l,p[2]+=j[2]*l,t.fp(xe,z,Z),t.fp(Gp,z,p)}},handleScroll:function(p,M){pd(p);var x=this,W=x._moveStep,R=x.getDataInfoAt(p);if(R){var l=R.data;if(l&&x.isInteractive(l)){var P=x.intersectObject(p,l);if(P){var Q=P.part,L=Om(l.s(Q+".image")||l.s("shape3d."+Q+".image")||l.s("all.image")||l.s("shape3d.image"));if(L&&Gq(L.scrollable,l,x))return}}}return x.isFirstPersonMode()?(x.isPannable()&&x.pan(0,M>0?W:-W),void 0):(x.isZoomable()&&(x._lastZoomLP=x.lp(p),x.setZoom(0>M?1/vh:vh),x._lastZoomLP=x._lastZoomHit=null),void 0)},handlePinch:function(g,j){if(this.isZoomable()){if(Math.abs(g-j)<m.pinchZoomThreshold)return;this.setZoom(j>g?1/Sf:Sf)}},reset:function(Q){this.setUp(m.graph3dViewUp),this.moveCamera(m.graph3dViewEye,m.graph3dViewCenter,Q)},moveSelection:function(A,u,q){var b=this;b.dm().beginTransaction(),Yj(this.sm().toSelection(this.isMovable,this),A,u,q),b.dm().endTransaction()},getMoveMode:function(L,o){var x=o.s("3d.move.mode");if(x)return x;var O="88",V="89",C="90";return Vn(L)||nq[O]&&nq[V]&&nq[C]?"xyz":nq[O]&&nq[V]?"xy":nq[O]&&nq[C]?"xz":nq[V]&&nq[C]?"yz":nq[O]?"x":nq[V]?"y":nq[C]?"z":"xz"},handleTick:function(){var T=this,a=!1,v=T._moveStep,V=v,i=!1,k=!0,h=T._rotateStep*(k?-1:1);if(T.isWalkable()||(V=0),T.isPannable()||(v=0),T.isRotatable()||(h=0),T._32Q){var d=(cr()-T._32Q)/50;V*=d,v*=d,h*=d}T._31Q&&(Ig(T._31Q),delete T._31Q,delete T._32Q),Xh()&&(a=!0,T.pan(-v,0,i,k)),ni()&&(a=!0,T.pan(v,0,i,k)),td()&&(a=!0,Vn()?T.pan(0,v,i,k):T.walk(V,i,k)),he()&&(a=!0,Vn()?T.pan(0,-v,i,k):T.walk(-V,i,k)),kr()&&(a=!0,T.rotate(-h,0,i,k)),Zg()&&(a=!0,T.rotate(h,0,i,k)),jc()&&(a=!0,T.rotate(0,-h/2,i,k)),Cg()&&(a=!0,T.rotate(0,h/2,i,k)),a&&(T._32Q=cr(),T._31Q=sg(T.handleTick,T))},handleKeyDown:function(C){var i=this;!Wo(C)&&ar[C.keyCode]?i.handleTick():jq(C)?i.selectAll():xi(C)?i.handleDelete(C):sc(C)&&this.isResettable()&&i.reset()},checkDoubleClickOnNote:function(Y,i,e){var h=this;if(e===kb){if(i.s("note.toggleable"))return i.s(Ag,!i.s(Ag)),h.fi({kind:"toggleNote",event:Y,data:i,part:e}),!0}else if(e===Wb&&i.s("note2.toggleable"))return i.s(dn,!i.s(dn)),h.fi({kind:"toggleNote2",event:Y,data:i,part:e}),!0;return!1},checkDoubleClickOnRotation:function(e,V,c){return c===bt?(V.setRotationX(0),!0):c===ct?(V.setRotationY(0),!0):c===dt?(V.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(p){var c=this;if(c.isOrtho())return c.getWidth()/c.getOrthoWidth();var I=c.getCenter(),T=c.getHeight(),R=c.getEye(),Q=[I[0]-R[0],I[1]-R[1],I[2]-R[2]],z=[p[0]-R[0],p[1]-R[1],p[2]-R[2]],E=Math.sqrt(Q[0]*Q[0]+Q[1]*Q[1]+Q[2]*Q[2]),S=1/Math.tan(c.getFovy()/2);return T*E*S/(z[0]*Q[0]+z[1]*Q[1]+z[2]*Q[2])},inViewSpace:function(C){var c,F=this,x=F._transformPointToViewSpace(C),y=F.getAspect(),t=F.getNear(),f=F.getFar();return-x[2]<t||-x[2]>f?!1:F.isOrtho()?(c=F.getOrthoWidth()/2,Math.abs(x[0])<=c&&Math.abs(x[1]*y)<=c):(c=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2])*Math.tan(F.getFovy()/2),Math.abs(x[1]<=c)&&Math.abs(x[0])<=c*y)},getPVMatrix:function(){var T,e=this;return(T=e._18Q)||(T=gr(e),e._18Q=zg(T,T,Cj(e)),e._18Q._wh=e.getWidth()/2/e.getHeight()),T},getFrustum:function(){var K=new vr,z=new hj,I=new Array(16);return function(){for(var s=this.getPVMatrix(),T=!1,Y=0;16>Y;Y++)s[Y]!==I[Y]&&(T=!0,I[Y]=s[Y]);return T&&z.setFromMatrix(K.fromArray(s)),z}}(),toViewPosition:function(b){var r=this,f=r.getWidth()/2,n=r.getHeight()/2,s=r.getPVMatrix();return b=ho([b[0],b[1],b[2],1],s),{x:f+f*b[0]/b[3],y:n-n*b[1]/b[3],z:b[2]/b[3]}},getHitPosition:function(f,o,G){var e=this,y=e.getWidth(),v=e.getHeight(),X=f.target?e.lp(f):f,M=X.x-y/2,C=X.y-v/2,j=e.getCenterInfo(),P=Cj(e);o=o?o:[0,0,0],G=G?G:[0,1,0],M=M/y*j.width,C=-1*C/v*j.height;var t=[P[0]*M,P[4]*M,P[8]*M],U=[P[1]*C,P[5]*C,P[9]*C],H=[t[0]+U[0],t[1]+U[1],t[2]+U[2]],N=e.getCenter(),T=Ye(e,o,G,[H[0]+N[0],H[1]+N[1],H[2]+N[2]]);return T?T:[0,0,0]},intersectObject:function(Y,T){return this._raycaster.intersectObject(Y,T)},intersectObjects:function(y,c,q){return this._raycaster.intersectObjects(y,c,q)},getLineLength:function(l){this.validate();var v=this.getData3dUI(l);if(v&&v.getCache){var T=v.getCache();if(T)return T[T.length-1].length}return 0},getLineOffset:function(n,y){var f=this.getData3dUI(n);if(f&&f.getCache){var k=f.getCache();if(k){var t=So(k,y);if(n.s("shape3d")!==Vb)return t;var M,m;if(n.getScale3d&&(M=n.getScale3d(),1===M[0]&&1===M[1]&&1===M[2]&&(M=null)),n.r3&&(m=n.r3(),0===m[0]&&0===m[1]&&0===m[2]&&(m=null)),!m&&!M)return t;var q=new Or(n.p3()),d=new Or(t.point).sub(q),P=new Or(t.tangent).add(d);if(M&&(M=new Or(M),d.multiply(M),P.multiply(M)),m){var e=(new eo).setFromEuler(new hs(m,n.getRotationMode(),!0));d.applyQuaternion(e),P.applyQuaternion(e)}return{point:d.clone().add(q),tangent:P.sub(d).normalize()}}}return z},_genBatchInstancedArrayFunc:function(){var i=this._glCapabilities&&this._glCapabilities.instancedArray&&!this._batchInstancedDisabled,B=i?Lm:oo;this.batchInstancedModel=function(I,w,b,h,u,g,T){B(this,I,w,b,h,u,g,T)};var f=i?_p:Te;this.batchInstancedShapeFace=function(O,y,o){f(O,y,o)};var F=i?un:Zj;this.batchInstancedFace=function(v,Z,m,A,Q){F(this,v,Z,m,A,Q)}},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(m,p,n){var K=this,I=K.getEye();I=[I[0],I[1],I[2]];var G=K.getCenter();if(G=[G[0],G[1],G[2]],m||(m=I),p||(p=G),K._flyAnim&&K._flyAnim.stop(!0),n=vi(n),!n)return K.setEye(m[0],m[1],m[2]),K.setCenter(p[0],p[1],p[2]),delete K._flyAnim,!0;var w=[m[0]-I[0],m[1]-I[1],m[2]-I[2]],x=[p[0]-G[0],p[1]-G[1],p[2]-G[2]];return n.action=function(Q){K.setCenter(G[0]+x[0]*Q,G[1]+x[1]*Q,G[2]+x[2]*Q),K.setEye(I[0]+w[0]*Q,I[1]+w[1]*Q,I[2]+w[2]*Q)},n._37o=function(){delete K._flyAnim},K._flyAnim=om(n)},flyTo:function(){function e(g,K,x){if(x instanceof _.Node){k.fromArray(vs(x,K.getMat(x)));var v=x.getAnchor3d();g.push((new Or).set(0-v.x,0-v.y,0-v.z).applyMatrix4(k)),g.push((new Or).set(0-v.x,0-v.y,1-v.z).applyMatrix4(k)),g.push((new Or).set(0-v.x,1-v.y,0-v.z).applyMatrix4(k)),g.push((new Or).set(0-v.x,1-v.y,1-v.z).applyMatrix4(k)),g.push((new Or).set(1-v.x,0-v.y,0-v.z).applyMatrix4(k)),g.push((new Or).set(1-v.x,0-v.y,1-v.z).applyMatrix4(k)),g.push((new Or).set(1-v.x,1-v.y,0-v.z).applyMatrix4(k)),g.push((new Or).set(1-v.x,1-v.y,1-v.z).applyMatrix4(k))}}var D=new Or,Y=new Or,M=new Or,P=new Or,A=new Or,k=new vr,o=new _.Math.Quaternion,r=new hs,C=new $k;return function(Q,q,g){var U=this;"boolean"==typeof q&&(q={animation:q}),q=q||{};var Z=q.center,X=q.distance,G=q.direction,a=q.worldDirection,p=g||q.ratio||.8,E=q.xRatio||p,V=q.yRatio||p;(g!==B||q.duration||q.frames)&&(q={animation:q});var S,I,W=[],$=X===B;if(Z&&M.fromArray(Z),!Z||$)if(Q||(Q=U.dm().getDatas()),1===Q.length&&(Q=pj(Q)?Q.get(0):Q[0]),Q instanceof _.Node)Z||M.fromArray(Q.p3()),$&&(e(W,U,Q),S=W.length);else{if(!Q.length)return;if(($||!Z)&&(W=[],Q.forEach(function(R){e(W,U,R)}),S=W.length,!S))return;Z||(C.setFromPoints(W),M.copy(C.min).add(C.max).multiplyScalar(.5))}if(U._flyAnim&&U._flyAnim.stop(!0),D.fromArray(U.getEye()),Y.fromArray(U.getCenter()),U.setCenter(M.x,M.y,M.z),P.subVectors(D,Y),G||a){!a&&Q instanceof _.Node?o.setFromEuler(r.set(Q.r3(),Q.getRotationMode(),!0)):o.set(0,0,0,1);var i=P.length();P.fromArray(a||G).applyQuaternion(o).setLength(i)}var J=new Or(U.getUp()),x=_k.fequal(J.x,0,1e-5)&&_k.fequal(J.z,0,1e-5);if(x&&0===P.x&&0===P.z){var t=.001,N=P.y;P.y=N*(1-t),P.z=Math.sign(N)*t}var l=0;if($){var H,f,z,s=E,c=V;if(A.copy(P),U.isOrtho()){var L=-1/0;for(U._eye[0]=P.x+M.x,U._eye[1]=P.y+M.y,U._eye[2]=P.z+M.z,H=gr(U),zg(H,H,Cj(U)),I=0;S>I;I++)z=W[I],f=ho([z.x,z.y,z.z,1],H),L=Math.max(L,Math.max(Math.abs(f[0])/s,Math.abs(f[1])/c));l=U.getOrthoWidth()*L}else{for(var u,R,k=U.getNear(),j=10;j--;){for(U._eye[0]=P.x+M.x,U._eye[1]=P.y+M.y,U._eye[2]=P.z+M.z,H=gr(U),zg(H,H,Cj(U)),u=!0,R=-1/0,I=0;S>I;I++){if(z=W[I],f=ho([z.x,z.y,z.z,1],H),f[3]<k&&j){P.multiplyScalar(2),u=!1;break}R=Math.max(R,Math.max(Math.abs(f[0])/s,Math.abs(f[1])/c)-f[3])}if(u)break}P.setLength(R+P.length())}P.manhattanLength()<1e-6&&P.copy(A)}else P.setLength(X);var O=P.add(M),h=vi(q.animation);if(h){U.setEye(D.x,D.y,D.z),U.setCenter(Y.x,Y.y,Y.z);var d=O.clone().sub(M),b=d.length();b&&d.multiplyScalar(1/b);var v=D.clone().sub(Y),K=v.length();K&&v.multiplyScalar(1/K);var w=(new vr).lookAtDirection(v,J),T=(new vr).lookAtDirection(d,J),y=(new eo).setFromRotationMatrix(w),n=(new eo).setFromRotationMatrix(T),F=(new Or).subVectors(M,Y);if(l)var Ne=U.getOrthoWidth();var yn=new Or,Oc=new Or,zs=new Or,Og=h.action,If=h._37o,Pi=Y.clone();return h.action=function(e,A){Oc.copy(Pi).addScaledVector(F,e);var $=y.clone().slerp(n,e);yn.set(0,0,1).applyQuaternion($).setLength(K+(b-K)*e).add(Oc),zs.set(0,1,0).applyQuaternion($),U.setCenter(Oc.x,Oc.y,Oc.z),U.setEye(yn.x,yn.y,yn.z),U.setUp(zs.x,zs.y,zs.z),l&&U.setOrthoWidth((l-Ne)*e+Ne),Og&&Og(e,A)},h._37o=function(){delete U._flyAnim;var f=U.getUp(),s=x?m.graph3dViewUp:J.toArray();(f[0]!==s[0]||f[1]!==s[1]||f[2]!==s[2])&&U.setUp(s),If&&If()},{lastEye:D,lastCenter:Y,eye:O,center:M,orthoWidth:l,animation:U._flyAnim=om(h)}}return U.setEye(O.x,O.y,O.z),U.setCenter(M.x,M.y,M.z),l&&U.setOrthoWidth(l),delete U._flyAnim,{lastEye:D,lastCenter:Y,eye:O,center:M,orthoWidth:l}}}(),getBoundingBox:function(){function F(l,M,f){r.fromArray(vs(f,M.getMat(f)));var m=f.getAnchor3d();l.push((new Or).set(0-m.x,0-m.y,0-m.z).applyMatrix4(r)),l.push((new Or).set(0-m.x,0-m.y,1-m.z).applyMatrix4(r)),l.push((new Or).set(0-m.x,1-m.y,0-m.z).applyMatrix4(r)),l.push((new Or).set(0-m.x,1-m.y,1-m.z).applyMatrix4(r)),l.push((new Or).set(1-m.x,0-m.y,0-m.z).applyMatrix4(r)),l.push((new Or).set(1-m.x,0-m.y,1-m.z).applyMatrix4(r)),l.push((new Or).set(1-m.x,1-m.y,0-m.z).applyMatrix4(r)),l.push((new Or).set(1-m.x,1-m.y,1-m.z).applyMatrix4(r))}var r=new vr;return function(X){if(X=X||this.sm().getSelection(),X instanceof _.Node&&(X=[X]),0===X.length)return z;var A=[];X.forEach(function(j){Dk(j)&&F(A,this,j)},this);var Z=[1/0,1/0,1/0],C=[-1/0,-1/0,-1/0];return A.forEach(function(h){Z[0]=Math.min(h.x,Z[0]),Z[1]=Math.min(h.y,Z[1]),Z[2]=Math.min(h.z,Z[2]),C[0]=Math.max(h.x,C[0]),C[1]=Math.max(h.y,C[1]),C[2]=Math.max(h.z,C[2])}),{min:Z,max:C}}}(),setBatchInfo:function(q,k){var X=this._batchInfoMap[q];this._batchInfoMap[q]=k,this.fp("batchInfo",X,k)},getBatchInfo:function(V){return this._batchInfoMap[V]||mf[V]},setOrthoWidth:function(K){var w=this._orthoWidth;if(this._orthoWidth=K,this._syncEyeWithOrthoWidth){var a=K/this.getAspect(),q=a/2/Qn(this.getFovy()/2),A=(new Or).fromArray(this.getEye()),W=(new Or).fromArray(this.getCenter());A.sub(W).setLength(q).add(W),this.setEye(A.toArray())}this.fp("orthoWidth",w,K)},getCamera:function(i){var X=this;i||(i=X._mainCamera,i||(i=X._mainCamera=new _.Camera)),i.s({"camera.type":X.isOrtho()?"ortho":"perspective","camera.aspect":X.getAspect(),"camera.fovy":X.getFovy(),"camera.ortho.width":X.getOrthoWidth(),"camera.near":X.getNear(),"camera.far":X.getFar()});var H=X.getEye();return i.p3(H.slice()),i.lookAt(X.getCenter(),X.getUp()),i},syncFromCamera:function(p){var L=this,v=new Or(L.getEye()),M=new Or(L.getCenter()),R=new Or,y=M.sub(v).length();L.setEye(p.p3());var K=p.getEuler();return R.set(0,0,-1).applyEuler(K),v.copy(R).setLength(y).add(M.copy(p.p3())),L.setCenter(v.toArray()),v.set(0,1,0).applyEuler(K),M.set(0,1,0),Math.abs(R.cross(v).dot(M))<1e-5?L.setUp(M.toArray()):L.setUp(v.toArray()),L.setOrtho("ortho"===p.s("camera.type")),L.setAspect(p.s("camera.aspect")),L.setFovy(p.s("camera.fovy")),L.setOrthoWidth(p.s("camera.ortho.width")),L.setNear(p.s("camera.near")),L.setFar(p.s("camera.far")),!0},resetHeadlightProperties:function(){this._headlightColor=m.graph3dViewHeadlightColor,this._headlightIntensity=m.graph3dViewHeadlightIntensity,this._headlightRange=m.graph3dViewHeadlightRange,this._headlightDirection=m.graph3dViewHeadlightDirection,this._headlightGroup=m.graph3dViewHeadlightGroup,this._headlightAmbientIntensity=m.graph3dViewHeadlightAmbientIntensity,this._headlightDisabled=m.graph3dViewHeadlightDisabled},resetFogProperties:function(){this._fogDisabled=m.graph3dViewFogDisabled,this._fogMode=m.graph3dViewFogMode,this._fogDensity=m.graph3dViewFogDensity,this._fogColor=m.graph3dViewFogColor,this._fogNear=m.graph3dViewFogNear,this._fogFar=m.graph3dViewFogFar}}),function(){function Z(s,b,q){var Z=s[b];Z&&Z.releaseTexture(),s[b]=q}function P(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function Q(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function V(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function J(){return{vs:V(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",Q(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function D(){return{vs:V(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",Q(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function K(_){return{vs:V(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+_+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",Q(),"\n #define ENVMAP_TYPE_CUBE_UV \n",P(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}
}var y=ae.EnvmapRenderer=function(r){this.gv=r,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};y.prototype={},y.prototype.constructor=y,y.prototype.changeEnvmapType=function(M){"legacy"===M?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},y.prototype.invalidateEnvmap=function(b){var _=this.gv;if("legacy"!==_.getEnvmapType()){var n=_.getGL();n&&(b?(delete this._envmapHash[b],delete this._probeCaptureTime[b]):(this._envmapHash={},this._probeCaptureTime={}),_.iv())}},y.prototype.contextLost=function(){var f=this;f._envmaps={},f._envmapHash={},f._pingPongRenderTarget=null,f._equirectShader=f._cubemapShader=f._blurMaterial=null,f._envmapLegacy=null,f._lastLegacyImage=null},y.prototype.onBeforeRenderLegacy=function(Q){this.assureTextureLegacy(Q)},y.prototype.assureTextureLegacy=function(c){var l=this,_=l.gv,O=_.getEnvmap();if(O!==l._lastLegacyImage){if(l._envmapLegacy&&(c.deleteTexture(l._envmapLegacy),l._envmapLegacy=null),!O)return l._lastLegacyImage=O,void 0;var P=m.getImage(O);if(P&&P.tagName){P=m.resizeImagePOT(P,!0);var R=l._envmapLegacy=c.createTexture();c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_CUBE_MAP,R),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,P),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,P),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,P),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,P),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,P),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,P),c.bindTexture(c.TEXTURE_CUBE_MAP,c._emptyCubeTexture),l._lastLegacyImage=O}}},y.prototype.setEnvmapLegacy=function(_){_.uEnvMap=this._envmapLegacy},y.prototype.onBeforeRenderNew=function(S){this.assureTextureNew(S),this.resetUniformCache()},y.prototype.assureTextureNew=function(S){var D=this,F=D.gv,b=F.getEnvmap(),P=D._envmapHash,j=D._envmaps,B=S._renderInfo.frame;if(!(this._lastCaptureFrame>=B||F._picking))for(var k in b){var x,v=b[k],h=v.type;switch(h){case"sphere":x=v.image,x!==P[k]&&(si=m.getImage(x),si&&(P[k]=x,Z(j,k,D.fromEquirectangular(x))));break;case"cube":var y=v.images;if(y&&6===y.length&&(x=y.join(","),x!==P[k])){for(var $=!0,d=0;6>d;d++)if(!m.getImage(y[d])){$=!1;break}$&&(P[k]=x,Z(j,k,D.fromCubemap(y)))}break;case"skybox":var c=F.getSkybox();if(c){var J=c.s("shape3d");if(x="sphere"===J?c._id+"_"+c.s("shape3d.image"):c._id+"_"+c.s("front.image"),x!==P[k]){var $;if("sphere"===J)$=m.getImage(c.s("shape3d.image"));else{$=!0;for(var u=["front","back","left","right","top","bottom"],d=0;6>d;d++)if(!m.getImage(c.s(u[d]+".image"))){$=!1;break}}$&&(P[k]=x,Z(j,k,D.fromSkybox()))}}break;case"probe":var n=v.pos,Y=v.size;if(x=n[0]+"_"+n[1]+"_"+n[2]+"_"+Y,x!==P[k]){var l=this._probeCaptureTime[x],t=Date.now();l||(this._probeCaptureTime[x]=l=t),t-l>m.envmapProbeMinWaitTime&&!Bf&&!dp||t-l>m.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[x],P[k]=x,Z(j,k,D.fromSceneProbe(n,Y,v.filter))):F.iv()}}}},y.prototype.resetUniformCache=function(){this._frameUniformCache={}},y.prototype.setEnvmap=function(Y,S){var F=Y.uuid,b=this._frameUniformCache,_=this._envmaps[S];_&&(_=_.texture),b[F]!==_&&(b[F]=_,Y.uEnvMap=_)},y.prototype.fromEquirectangular=function(B){var N=_.Default.getImage(B);return this.rectSize=[1/N.width,1/N.height],B=this.gv.getTexture(B),this.fromTexture(B)},y.prototype.fromCubemap=function(G){var k=this.gv.getGL(),Q=k.createTexture();k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,Q),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MAG_FILTER,k.LINEAR),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MIN_FILTER,k.LINEAR);for(var f=[],O=X/3,L=0;6>L;L++)f[L]=m.resizeImage(_.Default.getImage(G[L]),O);return k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,f[0]),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,f[1]),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,f[2]),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,f[3]),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,f[4]),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,f[5]),k.bindTexture(k.TEXTURE_CUBE_MAP,k._emptyCubeTexture),this.fromTexture(Q,!0)},y.prototype.fromTexture=function(W,e){var j=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var t=this.gv,l=t.getGL(),G=Gh.for(l).directState(),y=G.depth.enabled;G.scissor.enabled=!0,G.depth.enabled=!1;var a=t.getViewport(l);return this._textureToCubeUV(W,j,e),this._applyPMREM(j),j.unbind(l),t.setViewport(l,a[0],a[1],a[2],a[3]),G.depth.enabled=y,G.scissor.enabled=!1,j},y.prototype.fromSkybox=function(){return this._fromCamera(function(g){g.s({"camera.onlySky":!0})})},y.prototype.fromScene=function(m){return this._fromCamera(function(M){M.s({"camera.onlySky":!1}),m&&m(M)})},y.prototype.fromNode=function(w){var t=this.gv.getData3dUI(w),C=t._42;t._42=uo;var a=this.gv.getSkybox(),R=w.p3();if(a){var u=a.p3();a.p3(R)}var J=this.fromScene(function(S){S.p3(R)});return t._42=C,a&&a.p3(u),J},y.prototype.fromSceneProbe=function(u,h,M){var f=this.gv,Z=f.getSkybox();if(Z){var P=Z.p3();Z.p3(u)}if(M){var H=f.isVisible;f.isVisible=function(p){var S=M(p);return S!==B?S:H.call(f,p)}}var d=this.fromScene(function(R){R.p3(u),R.s("camera.near",h)});return M&&(f.isVisible=H),Z&&Z.p3(P),d},y.prototype._fromCamera=function(y){var K=this.gv,N=K.getCamera();y&&y(N);var B=new Ns(K,X,X,{cube:!0}),d=K.getGL(),G=K.getViewport(d),k=this.setEnvmapByProbeId,o=this.onBeforeRender;this.setEnvmapByProbeId=function(c){c.envMap=d._emptyTexture},this.onBeforeRender=uo,N.attachRenderTarget(B),N.render(K),N.detachRenderTarget(),this.setEnvmapByProbeId=k,this.onBeforeRender=o,K.setViewport(d,G[0],G[1],G[2],G[3]);var h=this.fromTexture(B.texture,!0);return B.releaseTexture(),h},y.prototype._allocateTargets=function(){return new Ns(this.gv,3*t,3*t,{magFilter:Uk.NEAREST,minFilter:Uk.NEAREST})},y.prototype._textureToCubeUV=function(q,U,w){var R,n=this.gv;w?null==(R=this._cubemapShader)&&(this._cubemapShader=R=this.createShader(J())):null==(R=this._equirectShader)&&(this._equirectShader=R=this.createShader(D()));var Z=n.getGL();U.bind(Z),this._setViewport(U,0,0,3*t,2*t);var M=n.getRenderState();M.useProgram(R);var P=M.directUniforms(),c=M.directAttribs();P.envMap=q,w||(P.texelSize=this.rectSize);var e=u[0];c.position=Cs(Z,null,e.vs,z,3),c.uv=Cs(Z,null,e.uv,z,2),c.faceIndex=Cs(Z,null,e.faceIs,z,1),am(Z,0,e.vs.length/3)},y.prototype._applyPMREM=function(l){for(var v,I,m,v=1;p>v;v++)I=Math.sqrt(o[v]*o[v]-o[v-1]*o[v-1]),m=e[(v-1)%e.length],this._blur(l,v-1,v,I,m)},y.prototype._setViewport=function(f,X,i,n,d){var C=this.gv;C.setViewport(C.getGL(),X,i,n,d),C.getRenderState().directState().scissor.box=[X,i,n,d]},y.prototype._blur=function(K,s,A,T,t){var p=this._pingPongRenderTarget;this._halfBlur(K,p,s,A,T,"latitudinal",t),this._halfBlur(p,K,A,A,T,"longitudinal",t)},y.prototype.createShader=function(J){var s=this.gv;return s.getPostProcessing().createShader(s.getGL(),J).program},y.prototype._halfBlur=function(c,V,$,s,x,M,N){var j=this.gv,L=this._blurMaterial;if("latitudinal"===M||"longitudinal"===M){L||(this._blurMaterial=L=this.createShader(K(v)));var X=j.getGL();V.bind(X);var a=3,g=j.getRenderState();g.useProgram(L);var l,o,b,E=g.directUniforms(),S=g.directAttribs(),D=F[$]-1,G=isFinite(x)?Math.PI/(2*D):2*Math.PI/(2*v-1),f=x/G,A=isFinite(x)?1+Math.floor(a*f):v,C=[],H=0;for(l=0;v>l;++l)o=l/f,b=Math.exp(-o*o/2),C.push(b),0==l?H+=b:A>l&&(H+=2*b);for(l=0;l<C.length;l++)C[l]=C[l]/H;E.envMap=c.texture,E.samples=A,E.weights=C,E.latitudinal="latitudinal"===M,N&&(E.poleAxis=N),E.dTheta=G,E.mipInt=r-$;var d=F[s],o=3*Math.max(0,t-2*d),y=(0===s?0:2*t)+2*d*(s>r-T?s-r+T:0);this._setViewport(V,o,y,3*d,2*d);var Y=u[s];S.position=Cs(X,null,Y.vs,z,3),S.uv=Cs(X,null,Y.uv,z,2),S.faceIndex=Cs(X,null,Y.faceIs,z,1),am(X,0,Y.vs.length/3),V.unbind(X)}};var T=4,r=8,t=Math.pow(2,r),N=[.125,.215,.35,.446,.526,.582],p=r-T+1+N.length,v=20,c=(1+Math.sqrt(5))/2,O=1/c,e=[new Or(1,1,1),new Or(-1,1,1),new Or(1,1,-1),new Or(-1,1,-1),new Or(0,c,O),new Or(0,c,-O),new Or(O,0,c),new Or(-O,0,c),new Or(c,O,0),new Or(-c,O,0)],R=function(){for(var j=[],m=[],J=[],R=r,c=0;p>c;c++){var M=Math.pow(2,R);m.push(M);var F=1/M;c>r-T?F=N[c-r+T-1]:0==c&&(F=0),J.push(F);for(var z=1/(M-1),G=-z/2,q=1+z/2,y=6,u=[],$=[],d=[],E=0;y>E;E++){var f=2*(E%3)/3-1,s=E>2?0:-1;u.push(f,s,0,f+2/3,s,0,f+2/3,s+1,0,f,s,0,f+2/3,s+1,0,f,s+1,0),$.push(G,G,q,G,q,q,G,G,q,q,G,q),d.push(E,E,E,E,E,E)}j.push({vs:new al(u),uv:new al($),faceIs:new al(d)}),R>T&&R--}return{_lodPlanes:j,_sizeLods:m,_sigmas:J}}(),u=R._lodPlanes,F=R._sizeLods,o=R._sigmas,X=m.EnvmapTextureSize}();var Ks=["left","front","right","back","top","bottom"],Ls=ae._RenderList=function(i){function w(){V.length=0,M.length=0,C={}}function n(e){var v,K,F,i,N=e.gv,b=e.data,f=e.shapeModel;if(f){var S,A,I,T=b.s("shape3d.transparent")||b.s("points.transparent");for(Jm(f)||(S=Gq(f.transparent,b,N),f=[f]),F=0,i=f.length;i>F;F++)I=f[F],A=Gq(I.transparent,b,N),A===B&&(A=S),A===B&&(A=T),A?K=!0:v=!0}for(F=0,i=Ks.length;i>F;F++){var R=e[Ks[F]];R&&(R.transparent?K=!0:v=!0)}N.isLabelVisible(b)&&(e.labelInfo&&(b.s(dk+".transparent")?K=!0:v=!0),e.label2Info&&(b.s(Sn+".transparent")?K=!0:v=!0)),N.isNoteVisible(b)&&(e.noteInfo&&(b.s(kb+".transparent")?K=!0:v=!0),e.note2Info&&(b.s(Wb+".transparent")?K=!0:v=!0)),e._38o&&(K=v=!0),K||(v=!0),e._renderParams={opaque:v,transparent:K}}function c(z,S){S&&n(z);var c=z.data,T=c._id;if(!C[T]){C[T]=!0;var l=z._renderParams;l&&l.visible!==!1&&(z={ui:z,data:c,z:0,id:T},l.opaque&&V.push(z),l.transparent&&M.push(z))}}function K(D,Z){if(M.length>1){for(var L,J,z=[0,0,0,0],K=0,Q=M.length;Q>K;K++)L=M[K].data,(J=L._position)?(z[0]=J.x,z[1]=L._54O,z[2]=J.y,z[3]=1,ho(z,Z),M[K].z=z[2]/z[3]):M[K].z=0;M.sort(D||G)}}function J(D){D?(ih(Z,x,D,i),ih(a,T,D,i),ih(f,A,D,i)):(Z=this.batchModelMap={},x=this.batchIndexMap={},a=this.polylineModelMap={},T=this.polylineIndexMap={},f=this.wireframeModelMap={},A=this.wireframeIndexMap={}),this.markBatchInvalid()}function o(b){b?ih(Z,x,b,i):(Z=this.batchModelMap={},x=this.batchIndexMap={}),this.markBatchInvalid()}function L(_){_?ih(a,T,_,i):(a=this.polylineModelMap={},T=this.polylineIndexMap={}),this.markBatchInvalid()}function N(W){W?ih(f,A,W,i):(f=this.wireframeModelMap={},A=this.wireframeIndexMap={}),this.markBatchInvalid()}function H(){return this._batchInvalid}function I(){this._batchInvalid=!0}function j(){this._batchInvalid=null}var V=[],M=[],Z={},x={},a={},T={},f={},A={},C={};return{opaque:V,transparent:M,init:w,push:c,batchModelMap:Z,batchIndexMap:x,polylineModelMap:a,polylineIndexMap:T,wireframeModelMap:f,wireframeIndexMap:A,ivBatch:J,ivModelBatch:o,ivPolylineBatch:L,ivWireframeBatch:N,markBatchInvalid:I,isBatchInvalid:H,onUpdated:j,sort:K}},Ms=ae._RenderLists=function(V){function t(){for(var K in F)F[K].init()}function E(){for(var b in F)F[b].onUpdated()}function h(K,$){K=K||"main";var Y=F[K];return!Y&&$&&(Y=F[K]=new Ls(V)),Y}function k(B,d){var s=B.data.getRenderLayer(),O=h(s,!0);O.push(B,d)}function l(r){for(var c in F)r(F[c])}var F={};return{init:t,onUpdated:E,get:h,push:k,each:l,lists:F}},Ns=ae.RenderTarget=function(Z,W,k,B){var N,z=this;null!=W&&W.canvas?(N=W,W=k,k=B,B=arguments[4]):N=Z.getGL(),B=B||{},B.cube===!!B.cube,B.samples=B.cube?0:Math.min(Z._glCapabilities.maxSamples,B.samples&&B.samples>1&&2===Z._webGLVersion?B.samples:0),z.options=B,z.uuid=_.Math.generateUUID(),z.gv=Z,z.init(Z,N,B),z.format=B.format||Uk.RGBA,z.generateMipmaps=!!B.generateMipmaps,z.depthInternalFormat=B.depthFormat||N.DEPTH_COMPONENT16,B.samples&&!Z._glCapabilities._maxSamplesChecked?z.setSize(N,W||1,k||1):z.setSize(N,W,k)};S.assign(ae.RenderTarget.prototype,{bind:function(h,X){var L=this.options;if(L.autoSize){var J=this.gv,M=J.getDevicePixelRatio(),f=J.getWidth()*M,e=J.getHeight()*M;this.setSize(h,f,e)}L.cube?Kp(h,this.frame[X]):Kp(h,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(b){kg(b),this.options.samples&&(b.bindFramebuffer(b.READ_FRAMEBUFFER,this._MSAAFbo),b.bindFramebuffer(b.DRAW_FRAMEBUFFER,this.frame),b.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,b.COLOR_BUFFER_BIT,b.NEAREST),b.bindFramebuffer(b.READ_FRAMEBUFFER,null),b.bindFramebuffer(b.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(U,P,p){var T=this,m=p.samples,E=p.cube,g=T.texture=P.createTexture(),s=E?Uk.TEXTURE_CUBE_MAP:Uk.TEXTURE_2D;P.activeTexture(P.TEXTURE0),P.bindTexture(s,g),P.texParameteri(s,P.TEXTURE_WRAP_S,p.wrapS||P.CLAMP_TO_EDGE),P.texParameteri(s,P.TEXTURE_WRAP_T,p.wrapT||P.CLAMP_TO_EDGE);var n=m?P.NEAREST:P.LINEAR;if(P.texParameteri(s,P.TEXTURE_MIN_FILTER,p.minFilter||n),P.texParameteri(s,P.TEXTURE_MAG_FILTER,p.magFilter||n),P.bindTexture(s,null),E){T.depth=[],T.frame=[];for(var e=0;6>e;e++)T.depth[e]=P.createRenderbuffer(),T.frame[e]=P.createFramebuffer()}else T.depth=P.createRenderbuffer(),T.frame=P.createFramebuffer();T.assureTexture()},assureTexture:function(){var A=this;A.gv._2Oi(A.uuid,A.texture,"default"),_.Default.setImage(A.uuid,null)},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(D,u,y){var U=this;if(u=Math.round(u),y=Math.round(y),u&&y&&(U.width!==u||U.height!==y)){U.width=u,U.height=y;var p=D.RENDERBUFFER,v=D.FRAMEBUFFER,T=U.options.samples,I=U.options.cube,P=I?Uk.TEXTURE_CUBE_MAP:Uk.TEXTURE_2D;if(T){var V=U.gv._glCapabilities;if(!V._maxSamplesChecked){for(D.bindRenderbuffer(p,U.depth),D.getError();T>1&&(D.renderbufferStorageMultisample(p,T,U.depthInternalFormat,u,y),D.getError());)T=Math.floor(T>>1);1>=T&&(T=0,D.texParameteri(P,D.TEXTURE_MIN_FILTER,U.options.minFilter||D.LINEAR),D.texParameteri(P,D.TEXTURE_MAG_FILTER,U.options.magFilter||D.LINEAR),D.renderbufferStorage(p,U.depthInternalFormat,u,y)),V._maxSamplesChecked=!0,V.maxSamples=U.options.samples=T,D.bindRenderbuffer(p,z)}}if(T&&(U._MSAAFbo||(U._MSAAFbo=D.createFramebuffer(),U._MSAARbO=D.createRenderbuffer()),D.bindRenderbuffer(p,U._MSAARbO),D.renderbufferStorageMultisample(D.RENDERBUFFER,T,D.RGBA8,u,y),D.bindFramebuffer(v,U._MSAAFbo),D.framebufferRenderbuffer(v,D.COLOR_ATTACHMENT0,p,U._MSAARbO),D.framebufferRenderbuffer(v,D.DEPTH_ATTACHMENT,p,U.depth),D.bindFramebuffer(v,null),D.bindRenderbuffer(p,null)),D.activeTexture(D.TEXTURE0),D.bindTexture(P,U.texture),I)for(var h=D.TEXTURE_CUBE_MAP_POSITIVE_X,o=0;6>o;o++)U.setupFrameBufferTextureAndDepth(D,U.frame[o],U.depth[o],h+o);else U.setupFrameBufferTextureAndDepth(D,U.frame,U.depth,D.TEXTURE_2D);if(U.generateMipmaps&&(2===gv._webGLVersion||_k.isPOT(u)&&_k.isPOT(y))){D.generateMipmap(P);var K=U.options.minFilter||(T?D.NEAREST:D.LINEAR);D.texParameteri(P,D.TEXTURE_MIN_FILTER,K===D.NEAREST?D.NEAREST_MIPMAP_NEAREST:D.LINEAR_MIPMAP_LINEAR)}D.bindTexture(P,null)}},setupFrameBufferTextureAndDepth:function($,O,c,t){var L=this,H=L.format;$.texImage2D(t,0,H,this.width,this.height,0,H,$.UNSIGNED_BYTE,null),$.bindFramebuffer($.FRAMEBUFFER,O),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,t,L.texture,0),this.setupRenderBufferStorage($,c),$.bindFramebuffer($.FRAMEBUFFER,null)},setupRenderBufferStorage:function(Z,q){var r=this,i=Z.RENDERBUFFER;Z.bindRenderbuffer(i,q);var y=r.options.samples;y?Z.renderbufferStorageMultisample(i,y,r.depthInternalFormat,r.width,r.height):(Z.renderbufferStorage(i,r.depthInternalFormat,r.width,r.height),Z.framebufferRenderbuffer(Z.FRAMEBUFFER,Z.DEPTH_ATTACHMENT,i,q)),Z.bindRenderbuffer(Z.RENDERBUFFER,null)},toCanvas:function(){var O=this,S=O.gv.getGL();Kp(S,O.frame);var G=O.width,d=O.height,V=new Uint8Array(4*G*d);S.readPixels(0,0,G,d,O.format,S.UNSIGNED_BYTE,V),kg(S);var I=T.createElement("canvas");I.width=G,I.height=d;var D=I.getContext("2d"),i=D.createImageData(G,d);return i.data.set(V),D.putImageData(i,0,0),I}});var Os=ae.Interactor=function(W){this.gv=this.g3d=W};yc("Interactor",S,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(u){this.gv.fi(u)},startDragging:function(x){Gk(this,x)}});var Ps=ae.DefaultInteractor=function(m){mg(Ps,this,[m])};yc("DefaultInteractor",Os,{getState:function(){return this._62O},setState:function(r){this._62O=r},getDataInfoAt:function(x,C){var f=this.gv,k=f.getDataInfoAt(x);if(!f.isBlockSelectable()||!k||!k.data)return k;if(!C&&f.isSelected(k.data))return k;for(var p=k.data;(p=p.getParent())&&p instanceof _.Block&&f.isSelectable(p);){var e=f.isSelected(p);if(e&&C)break;if(k={data:p,part:k.part},e&&!C)break}return k},handle_contextmenu:function(I){pd(I)},handle_mousewheel:function(O){this.gv.handleScroll(O,O.wheelDelta/40)},handle_DOMMouseScroll:function(V){2===V.axis&&this.gv.handleScroll(V,-V.detail)},handle_keydown:function(x){this.gv.handleKeyDown(x)},handle_mousedown:function(Z){this.handle_touchstart(Z)},handle_touchstart:function(m){pd(m);var n=this,Q=n.gv,D=ti(m),M=n.getDataInfoAt(m),H=M?M.data:z,Z=M?M.part:z,J=Q.sm(),W=th(m),g=js(m);Q.setFocus(m)&&(n._62O=z,n._57I=z,n.pendingClickThrough=z,n.__lastClientPoint__=el(m),H?Wo(m)?J.co(H)?J.rs(H):J.as(H):J.co(H)?H instanceof Sm&&H.isClickThroughEnabled()&&ti(m)&&(n.pendingClickThrough=el(m)):J.ss(H):D&&(Wo(m)?Q.isRectSelectable()&&(n._62O=qc):n._57I=el(m)),n._31Q&&(Ig(n._31Q),delete n._31Q,delete n._32Q),n._62O||(Q.isFirstPersonMode()&&(Vn(m)||Mi(m)||g>2?n._62O="pan":Q.isMouseRoamable()||wg(m)?(n._62O="roaming",n.foward=W&&ti(m),n._32Q=cr(),n._31Q=sg(n.tick,n)):D||(n._62O="roaming")),n._62O||(D&&W&&ht[Z]?(n._62O=Z,n.p3=H.p3()):D&&W&&Dk(H)&&Q.isSelected(H)?Q.isMovable(H)?(n._62O="move",n.p3=H.p3(),n.movedata=H):Q._39Q(H)&&(n._62O="none"):wg(m)&&(g>2?n._62O="pan":2===g&&(n.dist=vq(m),n._62O="pinch")))),n.point=Q.lp(m),Gk(n,m),ds(m)?Q.handleDoubleClick(m,H,Z):Q.handleClick(m,H,Z))},tick:function(){var D=this,g=D.gv,F=g._moveStep;D.point&&g.isWalkable()&&(D._32Q&&(F*=(cr()-D._32Q)/50),g.walk(D.foward?F:-F),D._32Q=cr(),D._31Q=sg(D.tick,D))},handle_mouseup:function(w){this.handle_touchend(w)},handle_touchend:function(N){var m=this._57I;if(m&&(bh(m,el(N))<=1&&this.gv.sm().cs(),this._57I=z),m=this.pendingClickThrough){if(bh(m,el(N))<=1){var b=this.getDataInfoAt(N);b&&b.data instanceof Sm&&b.data.isClickThroughEnabled()&&(b=this.getDataInfoAt(N,!0),b&&(N.clickThrough=!0,this.gv.sm().ss(b.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(F){var U,j,c=this,J=c.gv,X=c._62O,O=c.point,y=J.dm(),M=J.lp(F),W=M.x-O.x,k=M.y-O.y,v=J.getWidth(),A=J.getHeight();if(v&&A){var Y=el(F),s=Oo(J,Y,c.__lastClientPoint__),e=bh({x:0,y:0},s),V=-Q*W/v,N=-Q*k/A;if("roaming"===X)c.rotate(F,V/2,N/2);else if(X===bt||X===ct||X===dt)J._86O||y.beginTransaction(),J.fi({kind:J._86O?"betweenEditRotation":"beginEditRotation",event:F}),J._86O=1,J.sm().each(function(m){if(Dk(m)&&J.isRotationEditable(m)){var Y=n(V)>n(N)?V:N;X===bt?m.setRotationX(m.getRotationX()+Y):X===ct?m.setRotationY(m.getRotationY()+Y):X===dt&&m.setRotationZ(m.getRotationZ()+Y)}});else if("move"===X||ht[X]){if(X===et||X===ft||X===gt)J._87O||y.beginTransaction(),J.fi({kind:J._87O?"betweenEditScale":"beginEditScale",event:F}),J._87O=1;else{if(!J._moving){if(e<m.touchMoveThreshold)return;y.beginTransaction()}J.fi({kind:J._moving?"betweenMove":"beginMove",event:F}),J._moving=1}var w,r=c.p3,h=J.getPositionInfo(r),Z=Cj(J);w=X===$s?"x":X===_s?"y":X===at?"z":X===et?"sx":X===ft?"sy":X===gt?"sz":J.getMoveMode(F,c.movedata),W=W/v*h.width,k=-1*k/A*h.height;var H,t,g=[Z[0]*W,Z[4]*W,Z[8]*W],f=[Z[1]*k,Z[5]*k,Z[9]*k],K=g[0]+f[0],b=g[1]+f[1],z=g[2]+f[2],p=[r[0]+K,r[1]+b,r[2]+z],x=of(J.getEye(),p,!0);if("xyz"===w?(H=p,J.moveSelection(K,b,z)):"xz"===w?(H=Ye(J,r,[0,1,0],p),H&&J.moveSelection(H[0]-r[0],0,H[2]-r[2])):"xy"===w?(H=Ye(J,r,[0,0,1],p),H&&J.moveSelection(H[0]-r[0],H[1]-r[1],0)):"yz"===w?(H=Ye(J,r,[1,0,0],p),H&&J.moveSelection(0,H[1]-r[1],H[2]-r[2])):"x"===w||"sx"===w?(x[0]=0,H=Ye(J,r,x,p),H&&(t=H[0]-r[0],"x"===w?J.moveSelection(t,0,0):J.sm().each(function(g){Dk(g)&&J.isSizeEditable(g)&&(U=g.getScaleX()+t/100,j=U/g.getScaleX(),g.setScaleX(U),Vn(F)&&(g.setScaleY(g.getScaleY()*j),g.setScaleTall(g.getScaleTall()*j)))}))):"y"===w||"sy"===w?(x[1]=0,H=Ye(J,r,x,p),H&&(t=H[1]-r[1],"y"===w?J.moveSelection(0,t,0):J.sm().each(function(E){Dk(E)&&J.isSizeEditable(E)&&(U=E.getScaleTall()+t/100,j=U/E.getScaleTall(),E.setScaleTall(U),Vn(F)&&(E.setScaleY(E.getScaleY()*j),E.setScaleX(E.getScaleX()*j)))}))):("z"===w||"sz"===w)&&(x[2]=0,H=Ye(J,r,x,p),H&&(t=H[2]-r[2],"z"===w?J.moveSelection(0,0,t):J.sm().each(function(u){Dk(u)&&J.isSizeEditable(u)&&(U=u.getScaleY()+t/100,j=U/u.getScaleY(),u.setScaleY(U),Vn(F)&&(u.setScaleX(u.getScaleX()*j),u.setScaleTall(u.getScaleTall()*j)))}))),!H)return;c.p3=H}else if(X===qc){var l=c.div;l||(l=c.div=fo(),as(c.getView(),l),l.op=O,l.style.background=J.getRectSelectBackground()),J.fi({kind:J._rectSelecting?"betweenRectSelect":"beginRectSelect",event:F}),J._rectSelecting=1,l.rect=sf(l.op,M),fs(l,l.rect)}else if("pinch"===X&&2===js(F)){J.fi({kind:J._pinching?"betweenPinch":"beginPinch",event:F}),J._pinching=1;var t=vq(F);J._lastZoomLP||(J._lastZoomLP=Lq(F)),J.handlePinch(t,c.dist),c.dist=t}else"pan"===X||Vn(F)||Mi(F)?c.pan(F,W,k):"none"===X||J.isFirstPersonMode()||c.rotate(F,V,N);c.point=M}},pan:function(C,c,q){var e=this.gv;if(e.isPannable()){var r=e.getWidth(),Z=e.getHeight();if(!r||!Z)return;var w=e.getCenterInfo(),E=c/r*w.width,f=-1*q/Z*w.height;e.fi({kind:e._panning?"betweenPan":"beginPan",event:C}),e._panning=1,e.pan(-E,-f)}},rotate:function(X,s,y){var x=this.gv;x.isRotatable()&&(x.fi({kind:x._rotating?"betweenRotate":"beginRotate",event:X}),x._rotating=1,x.rotate(s,y))},handleWindowMouseUp:function(_){this.handleWindowTouchEnd(_)},handleWindowTouchEnd:function(n){var k=this,b=k.gv,m=b.dm(),h=k.div;if(h){var $=b.getDatasInRect(h.rect);if(!$.isEmpty()){var a=b.sm(),j=a.toSelection(),R=Vn(n),p=n.altKey;$.each(function(E){a.co(E)?(!R||R&&p)&&j.remove(E):(!p||R&&p)&&j.add(E)}),a.ss(j)}zr(h)}b._moving&&(delete b._moving,b.fi({kind:"endMove",event:n}),b.onMoveEnded(),m.endTransaction()),b._panning&&(delete b._panning,b.fi({kind:"endPan",event:n}),b.onPanEnded()),b._rotating&&(delete b._rotating,b.fi({kind:"endRotate",event:n}),b.onRotateEnded()),b._86O&&(delete b._86O,b.fi({kind:"endEditRotation",event:n}),m.endTransaction()),b._87O&&(delete b._87O,b.fi({kind:"endEditScale",event:n}),m.endTransaction()),b._pinching&&(delete b._pinching,b.fi({kind:"endPinch",event:n}),b.onPinchEnded()),b._rectSelecting&&(delete b._rectSelecting,b.fi({kind:"endRectSelect",event:n}),b.onRectSelectEnded()),b._walking&&(delete b._walking,b.fi({kind:"endWalk",event:n}),b.onWalkEnded()),b._lastZoomLP=b._lastZoomHit=null,k.dist=k.point=k._62O=k.p3=k.movedata=k.div=k._57I=k.pendingClickThrough=k._32Q=k._31Q=k.foward=z,k.__lastClientPoint__=z}});var Qs=ae.MapInteractor=function(v){mg(Qs,this,[v]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};yc("MapInteractor",Os,{setUp:function(){Qs.superClass.setUp.call(this);var p=this.gv;this.__oldMinPhi__=p.getRotateMinPhi(),this.__oldMaxPhi__=p.getRotateMaxPhi(),p.setRotateMinPhi(this._minPhi),p.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Qs.superClass.tearDown.call(this);var z=this.gv;z.setRotateMinPhi(this.__oldMinPhi__),z.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(f){pd(f)},handle_mousewheel:function(u){this.gv.handleScroll(u,u.wheelDelta/40)},handle_DOMMouseScroll:function(N){2===N.axis&&this.gv.handleScroll(N,-N.detail)},handle_keydown:function(B){this.gv.handleKeyDown(B)},handle_mousedown:function(u){this.handle_touchstart(u)},handle_touchstart:function(i){pd(i);var y=this,B=y.gv;if(B.setFocus(i)){var c=B.getDataInfoAt(i),o=c?c.data:z,w=c?c.part:z;y.__lastClientPoint__=el(i);var k=y.editing={point:B.lp(i),data:o,part:w};wg(i)?k.touch=!0:(k.touch=!1,k.clickLeft=ti(i),k.pan=Mi(i)?!0:"left"===this.panButton===k.clickLeft),o&&B._39Q(o)&&(k.preventDefault=!0),Gk(y,i),ds(i)?B.handleDoubleClick(i,o,w):B.handleClick(i,o,w)}},handle_mouseup:function(W){this.handle_touchend(W)},handle_touchend:function(){},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(t){var A=this,e=A.gv,p=A.editing;if(p){var y=e.lp(t),P=p.point,b=y.x-P.x,j=y.y-P.y;if(!p.moved){if(Math.abs(b)<A.threshold&&Math.abs(j)<A.threshold&&!(t.touches&&t.touches.length>1))return;p.moved=!0}if(!p.preventDefault){p.point=y;var K=p.part;if(ht[K]){var C=p.data,L=e.dm(),i=e.getWidth(),F=e.getHeight(),J=-Q*b/i,v=-Q*j/F;if(K===bt||K===ct||K===dt){e._86O||L.beginTransaction(),e.fi({kind:e._86O?"betweenEditRotation":"beginEditRotation",event:t}),e._86O=1;var B=n(J)>n(v)?J:v;e.sm().each(function(C){Dk(C)&&e.isRotationEditable(C)&&(K===bt?C.setRotationX(C.getRotationX()+B):K===ct?C.setRotationY(C.getRotationY()+B):K===dt&&C.setRotationZ(C.getRotationZ()+B))})}else{var a=C.p3(),E=e.getPositionInfo(a);b=b/i*E.width,j=-1*j/F*E.height;var l,r=Cj(e),X=[r[0]*b,r[4]*b,r[8]*b],T=[r[1]*j,r[5]*j,r[9]*j],H=X[0]+T[0],N=X[1]+T[1],Y=X[2]+T[2],h=[a[0]+H,a[1]+N,a[2]+Y],g=of(e.getEye(),h,!0);if(K===et||K===ft||K===gt){if(e._87O||L.beginTransaction(),e.fi({kind:e._87O?"betweenEditScale":"beginEditScale",event:t}),e._87O=1,l=Ye(e,a,g,h)){var f,x=0,q=["X","Y","Tall"];K===et?f="X":K===ft?(f="Tall",x=1):K===gt&&(f="Y",x=2),q.splice(q.indexOf(f),1);var d=Vn(t),W=(l[x]-a[x])/100;e.sm().each(function(J){if(Dk(J)&&e.isSizeEditable(J)){var L=J["getScale"+f](),y=L+W;if(J["setScale"+f](y),d){var p=y/L;q.forEach(function(E){J["setScale"+E](J["getScale"+E]()*p)})}}})}}else if(K===$s||K===_s||K===at){if(!e._moving){var $=el(t),O=Oo(e,$,A.__lastClientPoint__),U=bh({x:0,y:0},O);if(U<m.touchMoveThreshold)return;L.beginTransaction()}e.fi({kind:e._moving?"betweenMove":"beginMove",event:t}),e._moving=1;var x=0;if(K===$s?x=0:K===_s?x=1:K===at&&(x=2),g[x]=0,l=Ye(e,a,g,h)){var W=l[x]-a[x],o=[0,0,0];o[x]=W,e.moveSelection.apply(e,o)}}}}else if(p.touch){var k=t.touches.length;if(2!==k)A.pan(t,b,j);else{if(1>=k)return;var R=t.touches,I={x:R[0].clientX,y:R[0].clientY},G={x:R[1].clientX,y:R[1].clientY},S={x:G.x-I.x,y:G.y-I.y},D=p.lastCenter,V=Math.atan2(S.y,S.x),w=p.theta,_=0;w==z?w=p.theta=V:(_=V-w,p.thetaStarted||Math.abs(_)>A.touchRotateThreshold?(p.thetaStarted=!0,p.theta=V):_=0);var M=s*(I.y+G.y)/2/e.getHeight(),Z=p.phi,c=0;Z==z?Z=p.phi=M:(c=M-Z,p.phiStarted||Math.abs(c)>A.touchRotateThreshold?(p.phiStarted=!0,p.phi=M):c=0);var u,eq=Math.sqrt(S.x*S.x+S.y*S.y),Fr=p.vlen;if(Fr){var Mq=I.x-D.x,cn=I.y-D.y,wn=G.x-D.x,Hb=G.y-D.y,Sb=Math.sqrt(Mq*Mq+cn*cn),we=Math.sqrt(wn*wn+Hb*Hb),Xl=Fr/2,sh=A._sign2(Sb-Xl),Cm=A._sign2(we-Xl);0>sh*Cm||0===sh&&0===Cm?(u=1,p.vlen=eq):(u||(u=eq/Fr),p.scaleStarted||Math.abs(u-1)>A.touchScaleThreshold?(p.vlen=eq,p.scaleStarted=!0):u=1)}else Fr=p.vlen=eq,u=1;1!==u&&e.setZoom(u),(c||_)&&A.rotate(t,_,-c),p.lastCenter={x:(G.x+I.x)/2,y:(G.y+I.y)/2}}}else if(p.pan)A.pan(t,b,j);else{var i=e.getWidth(),F=e.getHeight();if(!i||!F)return;var J=-Q*b/i,v=-Q*j/F;A.rotate(t,J,v)}}}},_sign2:function(P){return Math.abs(P)<this._touchScaleCheckAccuracy?0:P>0?1:-1},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},getDataInfoAt:function(A,w){var V=this.gv,B=V.getDataInfoAt(A);if(!V.isBlockSelectable()||!B||!B.data)return B;if(!w&&V.isSelected(B.data))return B;for(var $=B.data,h=B.part;($=$.getParent())&&$ instanceof _.Block&&V.isSelectable($);){var z=V.isSelected($);if(z&&w)break;if(B={data:$,part:h},z&&!w)break}return B},handleWindowTouchEnd:function(o){var p=this,m=p.editing;if(p.editing=null,m){var y=p.gv;if(m.moved||!m.clickLeft&&!m.touch)y._panning=null,y._rotating=null,y.fi({kind:m.pan?"endPan":"endRotate",event:o});else{var Z=p.getDataInfoAt(o),s=Z&&Z.data;s instanceof Sm&&s.isClickThroughEnabled()&&(Z=p.getDataInfoAt(o,!0),Z&&(s=Z.data)),s?y.sm().setSelection([s]):y.sm().clearSelection()}var c=y.dm();y._moving&&(delete y._moving,y.fi({kind:"endMove",event:o}),y.onMoveEnded(),c.endTransaction()),y._86O&&(delete y._86O,y.fi({kind:"endEditRotation",event:o}),c.endTransaction()),y._87O&&(delete y._87O,y.fi({kind:"endEditScale",event:o}),c.endTransaction())}},pan:function(o,T,h){var N=this,g=N.gv;if(g.isPannable()){var w=g.getWidth(),U=g.getHeight();if(w&&U){var C=g.getCenterInfo(),y=-T/w*C.width,M=1*h/U*C.height;g.fi({kind:g._panning?"betweenPan":"beginPan",event:o}),g._panning=1;var m=N.keepHorizon,Z=N.editing.touch;if((Z&&o.touches&&o.touches.length>1||!Z&&Vn(o))&&(m=!m),!m)return g.pan(y,M);if(y||M){var O=Cj(g),t=[O[0]*y,O[4]*y,O[8]*y],F=[O[1],0,O[9]],W=Math.sqrt(F[0]*F[0]+F[2]*F[2]);W&&(F=[F[0]/W*M,0,F[2]/W*M]);var E=t[0]+F[0],q=t[1]+F[1],V=t[2]+F[2],u=g._center,n=g._eye;u[0]+=E,u[1]+=q,u[2]+=V,n[0]+=E,n[1]+=q,n[2]+=V,g.fp(xe,z,n),g.fp(Gp,z,u)}}}},rotate:function(w,X,n){var I=this,P=I.gv;if(P.isRotatable()){var L=P._center,V=P._eye,p=of(V,L),G=Wc(l(p[0]*p[0]+p[2]*p[2]),p[1]),g=Mr(P,G+n);n=g-G,P.fi({kind:P._rotating?"betweenRotate":"beginRotate",event:w}),P._rotating=1,P.rotate(X,n)}}}),S.defineProperties(Qs.prototype,{panButton:{get:function(){return this._panButton},set:function(z){this._panButton=z}},minPhi:{get:function(){return this._minPhi},set:function(S){this.gv.setRotateMinPhi(this._minPhi=S)}},maxPhi:{get:function(){return this._maxPhi},set:function(u){this.gv.setRotateMaxPhi(this._maxPhi=u)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(k){this._keepHorizon=k}},threshold:{get:function(){return this._threshold},set:function(J){this._threshold=J}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function($){this._touchScaleThreshold=$}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(l){this._touchRotateThreshold=l}}});var Rs,Ss="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Ts=32,Us=ae.GlobeInteractor=function(g,c){mg(Us,this,[g]);
var i,m=c.radius||6378137,F=this,U=null;Rs||(Rs=fo(),Rs.style.border="",Rs.style.backgroundImage="url("+Ss+")");var x=new eo,H=new Or,S=new Or,t=new Or,b=new kq,k="number"==typeof m?{x:m,y:m,z:m}:m,G={center:new Or(0,0,0),radius:k},e=function(v){g._81O=null;var n=g.getHitPosition(v,g.getCenter(),H.copy(g.getEye()).sub(S.copy(g.getCenter())).toArray());return b.origin.copy(g.getEye()),b.direction.copy(n).sub(b.origin).normalize(),b.intersectEllipsoid(G)},M=function(E,D){g._81O=null,b.origin.copy(g.getEye());for(var k,s,a=g.getCenter(),N=H.copy(g.getEye()).sub(S.copy(g.getCenter())).toArray(),Y=1,f=16,A=0,T=1,q={x:0,y:0};f--;){if(q.x=D.x+(E.x-D.x)*Y,q.y=D.y+(E.y-D.y)*Y,k=g.getHitPosition(q,a,N),b.direction.copy(k).sub(b.origin).normalize(),s=b.intersectEllipsoid(G),s&&1===Y)return{hit:s};s?A=Y:T=Y,Y=(A+T)/2}return{hit:s,out:1>Y}},N=function(A,T){if(U){var p=Date.now();U.deltaTime=U.lastTime?p-U.lastTime:1e3,U.lastTime=p,U.lastAxis=A,U.lastAngle=T}T&&(x.setFromAxisAngle(A,T),g.setEye(H.copy(g.getEye()).applyQuaternion(x).toArray()),g.setCenter(H.copy(g.getCenter()).applyQuaternion(x).toArray()),g.setUp(H.copy(g.getUp()).applyQuaternion(x).toArray()))};F._showCrossIcon=function(H){as(F.getView(),Rs),fs(Rs,{x:H.clientX-Ts/2,y:H.clientY-Ts/2,width:Ts,height:Ts})},F._hideCrossIcon=function(){zr(Rs)},F._scrollImpl=function(n,m){U={point:g.lp(n),screen:el(n),hit:e(n),type:"right"},U.hitNormalize=U.hit?U.hit.clone().normalize():new Or;var p={clientX:U.screen.x,clientY:U.screen.y+10*m};F._handleMoveImpl(p),F._endMoveImpl(p)},F._startMoveImpl=function(f){i&&(i.stop(!0),i=null),U={point:g.lp(f),screen:el(f),hit:e(f)},U.hitNormalize=U.hit?U.hit.clone().normalize():new Or,wg(f)?1===f.touches.length?U.hit&&(U.type="left"):2===f.touches.length&&(U.type="touch2"):(ti(f)?U.hit&&(U.type="left"):hp(f)?U.type="right":Mi(f)&&U.hit&&(U.type="middle"),!U.hit||"right"!==U.type&&"middle"!==U.type||F._showCrossIcon(f)),U.type&&Gk(F,f)},F._handleMoveImpl=function(e){if(U)switch(U.type){case"left":return F._handleLeft(e);case"right":return F._handleRight(e);case"middle":return F._handleMiddle(e);case"touch2":return F._handleTouch2(e)}},F._endMoveImpl=function(){if(U){if(this._hideCrossIcon(),"left"===U.type||"middle"===U.type){var R=1e3*(U.lastAngle/(U.deltaTime||30)),D=U.lastAxis,W=U.lastTime,C=function(){var T=Date.now(),j=(T-W)/1e3;return W=T,R*=Math.pow(Math.abs(F.decelerationRate),3*j),Math.abs(R)<.01?(R=0,i&&i.stop(),void 0):(N(D,R*j),void 0)};i=om({action:function(){C(arguments)},duration:5e3})}U=null}},F._handleLeft=function(s){if(!U.finished){var R=el(s),W=M(R,U.lastScreen||U.screen);if(U.lastScreen=R,!W.hit)return U.finished=!0,F._endMoveImpl(s),void 0;var q=W.hit;q.normalize();var L=U.hitNormalize,X=Math.acos(q.dot(L)),_=q.cross(L).normalize();N(_,X),W.out&&(U.finished=!0,F._endMoveImpl(s))}},F._handleRight=function(w){var A=U.lastScreen||U.screen,C=A.y;A=U.lastScreen=el(w);var l=A.y,z=l-C;if(z){var r=Math.min(.5,z*F.scaleSpeed);H.copy(g.getEye());var E=U.hit;E||(E=H.clone().divide(k).normalize().multiply(k)),S.copy(H).lerp(E,r),g.setEye(S.toArray()),H.copy(g.getUp()),S.normalize();var y=H.clone().cross(S).normalize();if(t.copy(g.getCenter()),t.sub(y.multiplyScalar(t.dot(y))),g.setCenter(t.toArray()),U.hit){var Z=e(U.screen),X=U.hitNormalize;if(Z){Z.normalize();var i=Math.acos(Z.dot(X)),u=Z.cross(X).normalize();i&&N(u,i)}}}};var q=function(H){return Math.abs(H)<.01?0:H>0?1:-1};F._handleTouch2=function($){var F=$.touches.length;if(2===F){var n=$.touches,c={x:n[0].clientX,y:n[0].clientY},i={x:n[1].clientX,y:n[1].clientY},R={x:i.x-c.x,y:i.y-c.y},Z=U.lastCenter,j=Math.atan2(R.y,R.x),d=U.theta,L=0;d==z?d=U.theta=j:(L=j-d,U.thetaStarted||Math.abs(L)>.03?(U.thetaStarted=!0,U.theta=j):L=0);var s,X=Math.sqrt(R.x*R.x+R.y*R.y),G=U.vlen;if(G){var O=c.x-Z.x,h=c.y-Z.y,E=i.x-Z.x,B=i.y-Z.y,T=Math.sqrt(O*O+h*h),D=Math.sqrt(E*E+B*B),K=G/2,y=q(T-K),l=q(D-K);0>y*l||0===y&&0===l?(s=1,U.vlen=X):(s||(s=X/G),U.scaleStarted||Math.abs(s-1)>.05?(U.vlen=X,U.scaleStarted=!0):s=1)}else G=U.vlen=X,s=1;var R=S.copy(g.getEye()).clone();1!==s&&g.setEye(R.setLength((R.length()-m)/s+m).toArray()),L&&N(R.normalize(),L),U.lastCenter={x:(i.x+c.x)/2,y:(i.y+c.y)/2}}},F._handleMiddle=function(i){var Z=el(i),p=U.screen;U.screen=Z;var C=(Z.y-p.y)/180*Math.PI*F.rollSpeed;S.copy(g.getCenter()).sub(H.copy(g.getEye())).normalize(),H.copy(g.getUp()).cross(S).normalize(),S.copy(g.getEye()).sub(U.hit).applyAxisAngle(H,C).add(U.hit);var W=S.clone();S.copy(g.getCenter()).sub(U.hit).applyAxisAngle(H,C).add(U.hit);var R=S.clone(),c=S.copy(g.getUp()).applyAxisAngle(H,C).clone(),e=!1;C>0&&(t.copy(c),S.copy(R).sub(W).normalize(),H.copy(W).multiplyScalar(-1).normalize(),H.dot(t)-S.dot(t)>0&&(e=!0)),e||t.copy(U.hit).sub(W).dot(U.hitNormalize)>=0&&(e=!0),e||(g.setEye(W.toArray()),g.setCenter(R.toArray()),g.setUp(c.toArray()));var G=-(Z.x-p.x)/180*Math.PI*F.rotateSpeed;N(U.hitNormalize,G)}};yc("GlobeInteractor",Os,{handle_contextmenu:function(A){pd(A)},handle_mousewheel:function(X){this._scrollImpl(X,X.wheelDelta/40)},handle_DOMMouseScroll:function(q){2===q.axis&&this._scrollImpl(q,-q.detail)},handle_keydown:function(o){this.gv.handleKeyDown(o)},handle_mousedown:function(k){this.handle_touchstart(k)},handle_touchstart:function(V){pd(V);var J=this.gv;if(J.setFocus(V)){var o=J.getDataInfoAt(V),g=o?o.data:z;g&&J.isInteractive(g)||this._startMoveImpl(V);var c=o?o.part:z;ds(V)?J.handleDoubleClick(V,g,c):J.handleClick(V,g,c)}},handle_mouseup:function(g){this.handle_touchend(g)},handle_touchend:function(){},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(C){this._handleMoveImpl(C)},handleWindowMouseUp:function(Z){this.handleWindowTouchEnd(Z)},handleWindowTouchEnd:function(v){this._endMoveImpl(v)}}),S.defineProperties(Us.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(U){this._rotateSpeed=U}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(r){this._rollSpeed=r}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(g){this._scaleSpeed=g}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(r){this._decelerationRate=r}}});var Vs=function($){var E=2147483648|$;return[(255&E>>16)/255,(255&E>>8)/255,(255&E)/255,(255&E>>24)/255]},Ws=function(D){this.gv=D,this.gv.pickColorMap={_pickIdUsed:2e3}};Fm(Ws,S,{_iv:!0,iv:function(){this._iv=!0},get:function(P,x,l){this.validate();var K=this,c=K.gv.getGL();if(!c)return z;var Q,q,O=K._resolution,D=Math.round(P.x*O),j=Math.ceil(P.width*O),A=Math.ceil(P.height*O),u=K.height-Math.round(P.y*O)-A,F=e(j/2),H=new Uint8Array(4*j*A),W=0,b=H.length,d=x?z:new An,v=x?z:{};if(Kp(c,K.frame),c.readPixels(D,u,j,A,c.RGBA,c.UNSIGNED_BYTE,H),kg(c),x){for(;F>=W;W++)for(var a=F-W,G=F+W,g=a;G>=g;g++)for(var r=a;G>=r;r++)if((g===a||g===G||r===a||r===G)&&(Q=K.info(H,4*(g*j+r)))){if(l&&l(Q)===!1)continue;return Q}}else for(;b>W;W+=4)if(Q=K.info(H,W)){if(l&&l(Q)===!1)continue;q=Q.data,v[q._id]||(d.add(q),v[q._id]=q)}return d},info:function(T,S){return this.gv.pickColorMap[(T[S]<<16)+(T[S+1]<<8)+T[S+2]+((127&T[S+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var J=this,D=J.gv,K=D.getGL();if(K){var u=J._resolution=D._pickerResolution*D.getDevicePixelRatio(),q=Math.round(u*D.getWidth()),G=Math.round(u*D.getHeight()),E=K.RGBA,w=K.TEXTURE_2D,b=K.RENDERBUFFER,p=K.FRAMEBUFFER;if(J.texture||(J.texture=cm(K),J.render=K.createRenderbuffer(),J.frame=K.createFramebuffer()),(J.width!==q||J.height!==G)&&(K.activeTexture(K.TEXTURE0),cj(K,J.texture),K.texImage2D(w,0,E,q,G,0,E,K.UNSIGNED_BYTE,z),bo(K,K.TEXTURE_MIN_FILTER,K.LINEAR),K.bindRenderbuffer(b,J.render),K.renderbufferStorage(b,K.DEPTH_COMPONENT16,q,G),Kp(K,J.frame),K.framebufferTexture2D(p,K.COLOR_ATTACHMENT0,w,J.texture,0),K.framebufferRenderbuffer(p,K.DEPTH_ATTACHMENT,b,J.render),cj(K,z),K.bindRenderbuffer(b,z),kg(K),J.width=q,J.height=G),J._iv){J._iv=!1;var d=!1;D._40Q.each(function(R){!d&&R.isBatchInvalid()&&(d=!0)}),d&&D.updateScene(),Kp(K,J.frame),K.clear(K.COLOR_BUFFER_BIT),D.overlappingBox.clear(),D.setViewport(K,0,0,q,G),D.renderPickScene(),kg(K)}}}});var Xs=function(_){this.gv=_};Fm(Xs,S,{gap:0,size:0,_42:function(e,S){var p=this,s=p.gv,W=s._gridGap,H=s._gridSize;if(s._gridVisible){if(p.gap!==W||p.size!==H){for(var Y=[],v=s._gridSize/2,E=W*v,J=0;2*v+1>J;J++){var u=6*J,o=6*(2*v+1)+u;Y[u]=-E,Y[u+1]=0,Y[u+2]=-E+J*W,Y[u+3]=E,Y[u+4]=0,Y[u+5]=-E+J*W,Y[o]=-E+J*W,Y[o+1]=0,Y[o+2]=-E,Y[o+3]=-E+J*W,Y[o+4]=0,Y[o+5]=E}p.vs=new al(Y),p.gap=W,p.size=H}Zm(s),ff(e),vf(e);var k=!s._fogDisabled;if(k){var M=Gh.for(e).directUniforms();M.uFog=!1}zm(e,S,1,s._gridColor,s._buffer.vs,p.vs),am(e,0,p.vs.length/3,e.LINES),k&&(M.uFog=!0),uf(e),Rn(e)}else p.vs=p.gap=p.size=z}});var Ys=function(D){this.gv=D};Fm(Ys,S,{_42:function(q,G){var a=this.gv,O=a._buffer.vs,o=a._axisXColor,n=a._axisYColor,s=a._axisZColor,R=a._originAxisVisible,v=a._centerAxisVisible;if(R||v){var I=Md?q.TRIANGLES:q.TRIANGLE_FAN,u=q.LINES;if(Zm(a),ff(q),vf(q),R){var J=a.getCenterInfo(),j=H(J.width,J.height)/5,m=.8*j,B=.05*j;zm(q,G,1.5,o,O,new al([0,0,0,j,0,0,m,B,0,m,0,B,m,-B,0,m,0,-B,m,B,0,0,0,0,0,j,0,B,m,0,0,m,B,-B,m,0,0,m,-B,B,m,0,0,0,0,0,0,j,B,0,m,0,B,m,-B,0,m,0,-B,m,B,0,m])),am(q,0,2,u),am(q,1,6,I),zm(q,G,z,n),am(q,7,2,u),am(q,8,6,I),zm(q,G,z,s),am(q,14,2,u),am(q,15,6,I)}if(v){var T=a._center,A=T[0],L=T[1],U=T[2],J=a.getPositionInfo(T);j=H(J.width,J.height)/20,zm(q,G,1.5,o,O,new al([A,L,U,A+j,L,U,A,L,U,A,L+j,U,A,L,U,A,L,U+j])),am(q,0,2,u),zm(q,G,z,n),am(q,2,2,u),zm(q,G,z,s),am(q,4,2,u)}uf(q),Rn(q)}}});var Zs=function(d){this.gv=d},$s="edit_tx",_s="edit_ty",at="edit_tz",bt="edit_rx",ct="edit_ry",dt="edit_rz",et="edit_sx",ft="edit_sy",gt="edit_sz",ht={};ht[$s]=101,ht[_s]=102,ht[at]=103,ht[bt]=104,ht[ct]=105,ht[dt]=106,ht[et]=107,ht[ft]=108,ht[gt]=109,Fm(Zs,S,{_42:function(q,N,E){var X=this,a=X.gv,e=a.sm().ld();if(e&&a.isEditable(e)&&!a.isEditHelperDisabled()&&Dk(e)&&(!a.isFirstPersonMode()||!a.isMouseRoamable()&&!Xl)){Zm(a);var k,d=a.isMovable(e),W=a.isRotationEditable(e),r=a.isSizeEditable(e),T=a._axisXColor,h=a._axisYColor,O=a._axisZColor,U=a._editSizeColor,b=e.p3();if(a.isOrtho()){var s=a.getCenterInfo();k=H(s.width,s.height)/8}else k=bh(a.getEye(),b)/10;var m,j,M=k/(E?5:10),p=.7*k,n=.4*p,t=b[0],$=b[1],I=b[2];m=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],d&&X._17O(q,N,e,E,$s,T,m,[t,$-M,I,t+p,$-M,I,t+p,$,I,t+p,$,I,t,$,I,t,$-M,I,t,$-M,I+M,t+p,$-M,I+M,t+p,$-M,I,t+p,$-M,I,t,$-M,I,t,$-M,I+M]),j=t+p,r&&X._17O(q,N,e,E,et,U,m,[j,$-M,I,j+n,$-M,I,j+n,$,I,j+n,$,I,j,$,I,j,$-M,I,j,$-M,I+M,j+n,$-M,I+M,j+n,$-M,I,j+n,$-M,I,j,$-M,I,j,$-M,I+M]),j+=n,W&&X._17O(q,N,e,E,bt,T,m,[j,$-M,I,j+n,$-M,I,j+n,$,I,j+n,$,I,j,$,I,j,$-M,I,j,$-M,I+M,j+n,$-M,I+M,j+n,$-M,I,j+n,$-M,I,j,$-M,I,j,$-M,I+M]),m=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],d&&X._17O(q,N,e,E,_s,h,m,[t,$,I,t,$+p,I,t-M,$+p,I,t-M,$+p,I,t-M,$,I,t,$,I,t,$,I,t,$,I-M,t,$+p,I-M,t,$+p,I-M,t,$+p,I,t,$,I]),j=$+p,r&&X._17O(q,N,e,E,ft,U,m,[t,j,I,t,j+n,I,t-M,j+n,I,t-M,j+n,I,t-M,j,I,t,j,I,t,j,I,t,j,I-M,t,j+n,I-M,t,j+n,I-M,t,j+n,I,t,j,I]),j+=n,W&&X._17O(q,N,e,E,ct,h,m,[t,j,I,t,j+n,I,t-M,j+n,I,t-M,j+n,I,t-M,j,I,t,j,I,t,j,I,t,j,I-M,t,j+n,I-M,t,j+n,I-M,t,j+n,I,t,j,I]),m=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],d&&X._17O(q,N,e,E,at,O,m,[t,$,I,t,$,I+p,t,$-M,I+p,t,$-M,I+p,t,$-M,I,t,$,I,t,$-M,I,t-M,$-M,I,t-M,$-M,I+p,t-M,$-M,I+p,t,$-M,I+p,t,$-M,I]),j=I+p,r&&X._17O(q,N,e,E,gt,U,m,[t,$,j,t,$,j+n,t,$-M,j+n,t,$-M,j+n,t,$-M,j,t,$,j,t,$-M,j,t-M,$-M,j,t-M,$-M,j+n,t-M,$-M,j+n,t,$-M,j+n,t,$-M,j]),j+=n,W&&X._17O(q,N,e,E,dt,O,m,[t,$,j,t,$,j+n,t,$-M,j+n,t,$-M,j+n,t,$-M,j,t,$,j,t,$-M,j,t-M,$-M,j,t-M,$-M,j+n,t-M,$-M,j+n,t,$-M,j+n,t,$-M,j])}},_17O:function(b,h,J,c,o,$,I,A){var k=this.gv,u=k._buffer,t=Gh.for(b),e=t.directUniforms(),C=t.directAttribs();if(k._picking){c=k.pickColorMap;var R=ht[o];c[R]={data:J,part:o},e.uFixPickReverseColor=Vs(R)}wn(b,h,z,!0,z,!0,z,!1),e.uDiffuse=$,C.aPosition=wr(b,u.vs,new al(A),z),C.aNormal=wr(b,u.ns,new al(I),z),vf(b),am(b,0,12),uf(b),xj(b,h)}});var it=_.Raycaster=function($){this.gv=$,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Fh("Raycaster",S,{intersect:function(Z){var o=this,M=o.gv,I=M.getDataAt(Z);return I?o.intersectObject(Z,I):null},intersectObjects:function(y,g,w){var z,Y,d,N,C=this,f=1/0,T=y.origin||(new Or).fromArray(C.gv.getEye()),l=C.maxTriangleTest,W=[];g.forEach(function(E){w&&w(E)===!1||E.s("intersect")!==!1&&W.push(E)});var J=T.distanceToSquared2([0,0,0]);return W.sort(function(w,v){return(w.p3?T.distanceToSquared2(w.p3()):J)-(v.p3?T.distanceToSquared2(v.p3()):J)}),C.countTriangles=0,W.forEach(function(c){C.countTriangles>l||(z=C.intersectObject(y,c),z&&(Y=T.distanceToSquared(z.world),f>Y&&(d=c,N=z,f=Y)))}),C.countTriangles=0,{data:d,intersect:N}},intersectObjectAndRecordTriangle:function(o,z){this._4GQ=!0;var R=this.intersectObject(o,z);return this._4GQ=!1,R},intersectLastTriangle:function(P,Y){var b=this.getRay(P);b.applyMatrix4(Y.inverseMatrix);var i=b.intersectPlane(Y.plane);if(!i)return null;var A=We.uvIntersection(i,Y.p1,Y.p2,Y.p3,Y.uv1.clone(),Y.uv2.clone(),Y.uv3.clone());return{world:i.clone().applyMatrix4(Y.matrixWorld),local:i.clone(),uv:A}},getRay:function(H){if(H instanceof kq)return H;var g=this,e=g.gv,f=e.unproject(H),v=new Or,M=e.getEye(),t=new Or;if(e.isOrtho()){var R=new Or(M);t.copy(e.getCenter()).sub(R).normalize();var i=v.copy(f).sub(R).dot(t);v.copy(t).setLength(-i).add(R.copy(f))}else v.copy(M),t.copy(f).sub(v).normalize();return new _.Math.Ray(v,t)},intersectObject:function(v,p){return this._intersectObjectImpl(this.getRay(v),p)},_intersectObjectImpl:function(){function R(){var e=new Or;return e.subVectors(z,a),q.subVectors(T,a),e.cross(q).normalize(),e}var F=new vr,X=new vr,i=new kq,K=new Or,r=new Or,c=new Or,J=new Or,n=new Or,T=new Or,a=new Or,z=new Or,B=new sm,y=new sm,w=new sm,q=new Or,L={vs:On,is:lg,uv:gn},k=mc.slice(0);return k.push("csg"),function(h,s){var U=this.gv.getData3dUI(s),M=s.mat||U.mat;M?F.fromArray(M):F.identity(),X.getInverse(F),i.copy(h).applyMatrix4(X);var m,Y,G,A="body",j=U.shapeModel;if(!j&&(s instanceof _.Polyline||s instanceof _.Edge)&&U.lineShapeModel&&(j=U.lineShapeModel),j||(j=qb(U)),j||(_.CSGNode&&s instanceof _.CSGNode||_.CSGShape&&s instanceof _.CSGShape?(G=!0,j=[U.left,U.front,U.right,U.back,U.top,U.bottom,U.csg]):s instanceof _.Node&&!(s instanceof _.Shape)?(m=!0,j=L):(Y=!0,j=[U.left,U.front,U.right,U.back,U.top,U.bottom])),!j)return console.log("Can not find shape model."),null;Jm(j)||(j=[j]);var P,D,b,g,t,V,x,Z,O,Q,f,H,o,e,u,q,p=1/0,d=["","top_","bottom_"],W=!1,v=this.backfaceCulling,E=[];for(Gd(j,U,E),P=0,D=E.length;D>P;P++)if(o=E[P])for(b=0,g=d.length;g>b;b++)if(e=d[b],x=o[e+"vs"],Z=o[e+"is"],O=o[e+"uv"]||o[e+"tuv"],x){if(u=o[e+"boundingBox"]){var f=i.intersectBox(u);if(!f)continue;if(i.origin.distanceTo(f)>p)continue;q=!1}else o[e+"boundingBox"]=u=new _.Math.Box3,q=!0;for(t=0,V=Z?Z.length:x.length/3;V>t;t+=3)this.countTriangles++,Z?(r.fromArray(x,3*Z[t]),c.fromArray(x,3*Z[t+1]),J.fromArray(x,3*Z[t+2])):(r.fromArray(x,3*t),c.fromArray(x,3*(t+1)),J.fromArray(x,3*(t+2))),q&&(u.expandByPoint(r),u.expandByPoint(c),u.expandByPoint(J)),Q=i.intersectTriangle(r,c,J,v,K),Q&&(H=i.origin.distanceTo(Q),p>H&&(p=H,n.copy(Q),T.copy(r),a.copy(c),z.copy(J),""!==e?A=e.slice(0,-1):m?A=mc[Math.floor(t/6)]:Y?A=mc[P]:G&&(A=k[P]),O&&(W=!0,Z?(B.fromArray(O,2*Z[t]),y.fromArray(O,2*Z[t+1]),w.fromArray(O,2*Z[t+2])):(B.fromArray(O,2*t),y.fromArray(O,2*(t+1)),w.fromArray(O,2*(t+2))))))}if(!isFinite(p))return null;var I,S,$=n.clone().applyMatrix4(F),C=this._4GQ;W&&(C&&(S={inverseMatrix:X.clone(),matrixWorld:F.clone(),p1:T.clone(),p2:a.clone(),p3:z.clone(),uv1:B.clone(),uv2:y.clone(),uv3:w.clone(),plane:(new _.Math.Plane).setFromCoplanarPoints(T,a,z)}),I=We.uvIntersection(n,T,a,z,B,y,w));var l=R(T,a,z),N=R(T.applyMatrix4(F),a.applyMatrix4(F),z.applyMatrix4(F)),xc=i.direction.dot(l);xc>0&&(l.multiplyScalar(-1),N.multiplyScalar(-1));var Hm={world:$,local:n.clone(),worldNormal:N,normal:l,uv:I,part:A};return S&&(Hm.triangleInfo=S),Hm}}()});var jt=function(P,Y){this.gv=P,this.s=function(f,w,H){return w==z&&(w=H),w==z?Y.getStyle(f):Gq(w,Y,P)},this.data=Y};Fm(jt,S,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:B,iv:function(){this._iv=!0},update:function(T,n,c){var d=this,K=d.data;if(T||(T=d.gv,n=T.getGL(),c=T._40Q),!d.needValidate(n)||!T.isVisible(K))return c.push(this,!1),void 0;var U,D,h,V,Z,S=K._id,X=K._47Q?null:d.s("batch"),m=K.getRenderLayer(),b=c.get(m,!0),R=b.batchIndexMap,M=b.batchModelMap,B=T.getBrightness(K),s=B!=z&&1!==B;U=cb(R,M,K,X,T);var k=X?T.getBatchInfo(X)||df:z,G=d.validate(U,k);if(U&&(!k.ms||!k.ms.length)&&(D=R[S],h=D.size=U.vs.length/3-D.begin,Z=U.rs))for(B=s?B:1,V=0;h>V;V++)Z.push(B);var u=T.getWireframeGeometry(K);if(u)Hk(T,K,u);else if(Dk(K)){var o=T.getWireframe(K);o&&Hk(T,K,o)}d.labelInfo=d.label2Info=d.noteInfo=d.note2Info=d._38o=z,d._24O(dk,"getLabel"),d._24O(Sn,"getLabel2"),d._26O(kb,"getNote"),d._26O(Wb,"getNote2"),d._15O(),d.interactiveInfo=T.isInteractive(K)?{}:z,b.push(this,!0),G!==!1&&(d._iv=!1)},clearWireframeGeometryCache:function(){var k=this;Lf(k),k.data.iv()},_46Q:function(f,Q){var k=this,_=k.data,H=k.gv;if(H.isVisible(_)){var T=_._id,E=H._40Q.get(_._renderLayer,!0),s=E.batchIndexMap[T],R=E.polylineIndexMap[T],h=E.wireframeIndexMap[T];(s||R||h)&&(Q==z&&(Q=zq(f,H.pickColorMap,H.isSelectable(_),k,wo,!0)),Q&&(Fg(Q,s,E.batchModelMap,H),Fg(Q,R,E.polylineModelMap,H),Fg(Q,h,E.wireframeModelMap,H)))}},_42:function(I,d,l){function W(N,b,h){var d=b.getBrightness(h),g=h.s("alphaTest"),m=h.s("envmap"),R=Gh.for(N),o=R.directUniforms();d!=z&&1!==d&&(o.uBrightness=d),o.uAlphaTest=g,o.uUseEnvMap=m?!0:!1,o.uReflectivity=m||.01,o.roughness=h.s("roughness"),b._setEnvmapByProbeId(o,h.s("envmap.probe")),o.shadowReceive=!c&&h.s("shadow.receive"),o.shadowCull=!c&&!!h.s("shadow.cull"),Vj(b,o,h.s("3d.clipbox")?Wn:h.s("3d.clipbox.mask"));var D=L.s("3d.clip.direction");if(D){var A=L.s("3d.clip.percentage");0===A&&(C=!1);var K=L._formatClipUniforms(D,A,h);o.uClipPercent=K[1],o.uClipDirection=K[0]}else o.uClipDirection=0;N._blooming&&!h.s("bloom")&&(o.blackout=!0),c||(b._flowObjects.length&&b.flowMap.resetDataFlowEnabld(h,o),op(b,o,h.s("light.mask"),h.s("headlight.ambientIntensity")))}var L=this,J=L.data,T=L.gv;if(T.isVisible(J)){var j,c=T._picking;if(c)j=T.pickColorMap;else{if(T.isTransparentMask(J)||T.isReflecting(I)&&J.s("3d.reflectable")===!1)return;j=B}if(jt.getTitle===B){jt.getTitle=0;for(var u in m)if(u.length===Sn.length+1&&u[Sn.length]===tf[4].toUpperCase()&&u[Sn.length-1]===tf[Sn.length+1].toUpperCase()){jt.getTitle=Zh;break}}if(!jt.getTitle||Wl[Sn.length+2]){if(jt.getHead===B){jt.getHead=0;for(var u in i){var v="box-sizing";6===u.length&&u[0]===tf[4]&&u[3]===v[0]&&u[4]===v[1]&&u[5]===v[2]&&(jt.getHead=Jf)}}if(!jt.getHead||Wl[Sn.length]){if(jt.getTitle2===B){jt.getTitle2=0;for(var u in i){var q="uv";6===u.length&&u[0]===ls[1].toUpperCase()&&u[1]===q[0]&&(jt.getTitle2=xm)}}if(!jt.getTitle2||Wl[Jq.length]){var k,U,R=J._id,N=T._40Q.get(J._renderLayer,!0),w=N.batchIndexMap,t=N.batchModelMap,Q=T.isSelectable(J),Y=!1,C=!0,n=w[R];if(c&&(U=zq(I,j,Q,L,wo,n),U&&!T._45Q&&(Fg(U,n,t,T),Fg(U,N.polylineIndexMap[R],N.polylineModelMap,T),Fg(U,N.wireframeIndexMap[R],N.wireframeModelMap,T))),n||(Y||(Y=!0,W(I,T,J)),C&&L._80o(I,d,l)),T.isLabelVisible(J)&&((k=L.labelInfo)&&(c&&zq(I,j,Q,L,dk),Y||(Y=!0,W(I,T,J)),L._28O(k,dk,l)),(k=L.label2Info)&&(c&&zq(I,j,Q,L,Sn),Y||(Y=!0,W(I,T,J)),L._28O(k,Sn,l))),T.isNoteVisible(J)&&((k=L.noteInfo)&&(c&&zq(I,j,Q,L,kb),Y||(Y=!0,W(I,T,J)),L._29O(k,kb,l)),(k=L.note2Info)&&(c&&zq(I,j,Q,L,Wb),Y||(Y=!0,W(I,T,J)),L._29O(k,Wb,l))),(k=L._38o)&&(Y||(Y=!0,W(I,T,J)),L._99O(I,d,k,j,Q,l)),Y){var F=Gh.for(I).directUniforms();F.uBrightness=1,F.uClipDirection=0,I._blooming&&(F.blackout=!1)}}}}}},_formatClipUniforms:function(S,w,R){switch(S){case"uv.right":S=7;break;case"uv.left":S=8;break;case"left":S=2;break;case"top":S=3;break;case"bottom":S=4;break;case"front":S=5;break;case"back":S=6;break;case"right":default:S=1}if(0===S%2&&(w=1-w),7===S||8===S){var W=this.shapeModel;W&&W.internalUvScale&&(w*=W.internalUvScale)}else if(R instanceof _.Shape){var G=R.s3(),v=R.p3(),m=R.getAnchor3d();w=3>S?(w-m.x)*G[0]+v[0]:5>S?(w-m.y)*G[1]+v[1]:(w-m.z)*G[2]+v[2]}else w-=.5;return[S,w]},prepare:function(){var _=this,y=_.data;if(!(y instanceof Sm)){var $,A,i,c,m,O=_.gv,v=O.getGL(),U=y._id,s=_.s("batch"),g=O._batchIndexMap,K=O._batchModelMap,w=O.getBrightness(y),F=w!=z&&1!==w;if(_.needValidate(v)){$=cb(g,K,y,s,O);var H=s?O.getBatchInfo(s)||df:z;if(_.validate($,H),$&&(!H.ms||!H.ms.length)&&(A=g[U],i=A.size=$.vs.length/3-A.begin,m=$.rs))for(w=F?w:1,c=0;i>c;c++)m.push(w);if(Dk(y)){var p=O.getWireframeGeometry(y);if(p)Hk(O,y,p);else{var Y=O.getWireframe(y);Y&&Hk(O,y,Y)}}_.labelInfo=_.label2Info=_.noteInfo=_.note2Info=_._38o=z,_._24O(dk,"getLabel"),_._24O(Sn,"getLabel2"),_._26O(kb,"getNote"),_._26O(Wb,"getNote2"),_._15O(),_.interactiveInfo=O.isInteractive(y)?{}:z,_._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=B},getBoundingBox:function(){var v,p,M,D,r,e;return function(m){if(this._cacheBoundingBox)return this._cacheBoundingBox;v||(v={vs:On,is:lg,uv:gn},p=new Or,M=new Or,D=new Or,r=new Or,e=new Or);var f=this,b=f.data,a=f.shapeModel;if(!a&&(b instanceof _.Polyline||b instanceof _.Edge)&&f.lineShapeModel&&(a=f.lineShapeModel),a||(a=qb(f)),a||(_.CSGNode&&b instanceof _.CSGNode||_.CSGShape&&b instanceof _.CSGShape?(isCSG=!0,a=[f.left,f.front,f.right,f.back,f.top,f.bottom,f.csg]):b instanceof _.Node&&!(b instanceof _.Shape)?a=v:(f.left||f.front||f.right||f.back||f.top||f.bottom)&&(a=[f.left,f.front,f.right,f.back,f.top,f.bottom])),!a)return B;Jm(a)||(a=[a]);var W,q,x,E,c,L,h,w,l,Q,Z,R,N=["","top_","bottom_"],t=new _.Math.Box3,$=!1;if(f._needRecoverPosition){r.set.apply(r,b.p3());var J=b.s3();e.set(1/(J[0]||1),1/(J[1]||1),1/(J[2]||1))}else r.set(0,0,0),e.set(1,1,1);var s=[];for(Gd(a,f,s),W=0,q=s.length;q>W;W++)if(l=s[W])for(x=0,E=N.length;E>x;x++)if(Q=N[x],h=l[Q+"vs"],w=l[Q+"is"],h){if(R=Q+"boundingBox",Z=l[R],!Z)for(l[R]=Z=new _.Math.Box3,c=0,L=w?w.length:h.length/3;L>c;c+=3)w?(p.fromArray(h,3*w[c]).sub(r).multiply(e),M.fromArray(h,3*w[c+1]).sub(r).multiply(e),D.fromArray(h,3*w[c+2]).sub(r).multiply(e)):(p.fromArray(h,3*c).sub(r).multiply(e),M.fromArray(h,3*(c+1)).sub(r).multiply(e),D.fromArray(h,3*(c+2)).sub(r).multiply(e)),!p.isNaN()&&Z.expandByPoint(p),!M.isNaN()&&Z.expandByPoint(M),!D.isNaN()&&Z.expandByPoint(D);t.expandByBox(Z),$=!0}return $?(this._cacheBoundingBox=t,S.freeze(t),S.freeze(t.min),S.freeze(t.max),m||De(f.gv,b),t):B}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Sb},_80o:function(){},dispose:function(){var k=this,_=k._pickId;if(_){var x=k.gv.pickColorMap;x[_]&&delete x[_]}},getBodyColor:function(n){var P=this.data,M=this.gv.getBodyColor(P);return M?M:n?P.getStyle(n):z},contextLost:function(){this._cachedTextures&&this.gv.invalidateCachedTexture(this.data)},getCachedTexture:function(G){var B=this._cachedTextures;return B?B[G||"main"]:null},setCachedTexture:function(p,S){var c=this._cachedTextures;return c||(c=this._cachedTextures={}),c[S||"main"]=p,p},invalidateCachedTexture:function(o){var e=this._cachedTextures;if(e){for(var z in e)o.deleteTexture(e[z]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(i,h){var P=this,w=P.data,W=P.gv,Q=P.s,R=W[h](w);if(R!=z){var b=Q(i+".scale"),F=Q(i+".max"),d=P[i+"Info"]={label:R,textureScale:Q(i+".texture.scale"),color:W[h+"Color"](w),font:Q(i+".font"),align:Q(i+".align"),background:W[h+"Background"](w)},j=d.rect=kp(d,R);F>0&&F<j.width&&(d.labelWidth=j.width,j.width=F),j.x=j.y=0,j.width*=b,j.height*=b,d.mat=P._16O(Q(i+".autorotate"),Q(i+".position"),j,Q(i+".face"),Q(i+".t3"),Q(i+".r3"),Q(i+".rotationMode"));var S=j.width/2,E=j.height/2;d.vs=new al([-S,E,0,-S,-E,0,S,-E,0,S,E,0]),j.width/=b,j.height/=b}},_26O:function(S,c){var V=this,R=V.data,N=V.gv,C=V.s,s=N[c](R);if(s!=z){var M=C(S+".scale"),Y=this[S+"Info"]={note:s,textureScale:C(S+".texture.scale"),expanded:C(S+".expanded"),font:C(S+".font"),color:C(S+".color"),align:C(S+".align"),borderWidth:C(S+".border.width"),borderColor:C(S+".border.color"),background:N[c+"Background"](R)};if(Y.expanded){var X=C(S+".max"),P=kp(Y,s);P.width+=6,P.height+=2,X>0&&X<P.width&&(Y.labelWidth=P.width,P.width=X);var w={x:-P.width/2,y:-8-P.height,width:P.width,height:P.height+8}}else w={x:-6,y:-18,width:12,height:18};Y.mat=V._16O(C(S+".autorotate"),C(S+".position"),z,C(S+".face"),C(S+".t3"),C(S+".r3"),C(S+".rotationMode")),Y.rect=w,1!==M&&(w=zs(w),w.x*=M,w.height*=M,w.y=-w.height,w.width*=M);var D=w.x,e=w.y,E=w.width,k=w.height;Y.vs=new al([D,-e,0,D,-e-k,0,D+E,-e-k,0,D+E,-e,0])}},eachShapeModel:function(c,q){function N(s){bj(s),s.vs&&c(s.vs,s.is,s.ns,s.uv),s.top_vs&&c(s.top_vs,s.top_is,s.top_ns,s.top_uv),s.bottom_vs&&c(s.bottom_vs,s.bottom_is,s.bottom_ns,s.bottom_uv),s.from_vs&&c(s.from_vs,s.from_is,s.from_ns,s.from_uv),s.to_vs&&c(s.to_vs,s.to_is,s.to_ns,s.to_uv)}function j(e){var S,F,q;if(Jm(e))for(F=0,q=e.length;q>F;F++)S=e[F],S&&j(S);else hq(e)?j(qb(R,e),R):Th(e)&&(e.shape3d?j(e.shape3d):N(e))}var R=this,B=R.data,q=q||R.shapeModel||qb(R);q||(q=B instanceof _.Node&&!(B instanceof _.Shape)?{vs:On,is:lg}:[R.left,R.front,R.right,R.back,R.top,R.bottom]),j(q)},_28O:function(b,k,p){if(p(this.s(k+".transparent"))){var r=b.rect,x=b.textureScale,_=r.width*x,n=r.height*x;if(_>=1&&n>=1){var A=ee(_,n);1!==x&&(A.translate(r.x,r.y),A.scale(x,x),A.translate(-r.x,-r.y)),aj(A,b),A.restore(),xd(this,k,b.mat,b.vs,!0)}}},_29O:function(D,u,o){if(o(this.s(u+".transparent"))){var B=D.rect,C=D.textureScale,n=B.x,V=B.y,Z=B.width*C,l=B.height*C;if(Z>=1&&l>=1){B.x=B.y=0;var c=ee(Z,l);1!==C&&c.scale(C,C),hi(c,D),c.restore(),B.x=n,B.y=V,xd(this,u,D.mat,D.vs,!1)}}},_99O:function(n,Z,p,v,q,s){if(p){var b=this,a=b.gv,j=b.data,A=a._buffer,G=a._1O,M=p.icons,J=Gh.for(n),V=J.directAttribs();for(var g in M){var m=M[g],P=p.rects[g];if(P&&s(Gq(m.transparent,j,a))){a._picking&&zq(n,v,q,b,g);var S=Gq(m.shape3d,j,a),D=S?[S]:Gq(m.names,j,a),x=D?D.length:0,e=Gq(m.textureScale,j,a)||1,r=Gq(m.light,j,a);r==z&&(r=S?!0:!1),wn(n,Z,Gq(m.blend,j,a),r,Gq(m.opacity,j,a),Gq(m.reverseFlip,j,a),Gq(m.reverseColor,j,a),Gq(m.reverseCull,j,a));for(var h=0;x>h;h++){var O=D[h],K=P[h];if(ce(b,K.mat),S)Pf(a,j,qb(b,S),b);else{var i=Om(O);if(i){var u=K.width*e,y=K.height*e;if(u>=1&&y>=1){var F=ee(u,y);Le(F,i,Gq(m.stretch,j,a),0,0,u,y,j,a),F.restore(),cm(n,Pj,G),vf(n,Z,G,Gq(m.discardSelectable,j,a),A.uv,zi),V.aPosition=wr(n,A.vs,K.vs,z),V.aNormal=Cs(n,A.ns,Fo,z),Wj(n,A.is,me),Ck(n,0,me.length),uf(n,Z,G)}}}nc(a)}xj(n,Z)}}}}});var kt=function(T,S){mg(kt,this,[T,S])};Fm(kt,jt,{_16O:function(v,G,s,y,j,Z,R,e,g){var t,W=this.data,B=W.getFinalScale3d();if(W.hasOwnProperty("_anchor")||W.hasOwnProperty("_anchorElevation")){var p=W.getAnchor3d();t=[-(p.x-.5)*B[0],-(p.y-.5)*B[1],-(p.z-.5)*B[2]]}if(W.s("part.boundingBox")){var i=this.getBoundingBox(!0);if(i){var n=i.max.clone().sub(i.min),f=i.max.clone().add(i.min).divideScalar(2);t||(t=[0,0,0]),t[0]+=f.x*B[0],t[1]+=f.y*B[1],t[2]+=f.z*B[2],B[0]*=n.x,B[1]*=n.y,B[2]*=n.z}}var x=wd(G,B,s,y,e,g);return t&&(x[0]+=t[0],x[1]+=t[1],x[2]+=t[2]),Ue(Cd(),x,W.p3(),y,j,Z,R,v,W.getFinalRotation3d(),W.getRotationMode())},clear:function(){var i=this;i.faceMat=i.mat=i.shapeModel=i.left=i.right=i.front=i.back=i.top=i.bottom=i.csg=z},needValidate:function(x){if(this._iv)return this._validateFrameId=x._renderInfo.frame,!0;if(this.data._47Q){var H=x._renderInfo.frame;if(this._validateFrameId!==H)return this._validateFrameId=H,!0}return!1},invalidateUnstableWireframe:function(){var T=this.data;if(T._47Q){var G=T.getRenderLayer(),j=this.gv._40Q.get(G);j&&j.ivWireframeBatch(T)}},validate:function(Z,n){var s=this,O=s.gv,x=s.data,g=s.shapeName=s.s(um),v=qb(s,g);s._updateAutoRotation(),s._updateFixSize2d(),s._updateOverlapping(),s.dispatchBoundingBoxChanged(),s.invalidateUnstableWireframe();var o=vs(x,O.getMat(x),v?s.s("shape3d.scaleable"):!0);if(x.appendAnchorMatrix3d(o),s.clear(),s.mat=x.mat=o,v||!g)if(s.shapeModel=v,Z)if(v)n.instanced?O.batchInstancedModel(x,v,s,s.getBodyColor(),[o],Z):oo(O,x,v,s,s.getBodyColor(),[o],Z);else{var $=pq(o);n.instanced?O.batchInstancedFace(x,Z,n,o,$):Zj(O,x,Z,n,o,$)}else v||(s._cubeUvs=null,s.vf(Mq,0),s.vf(ze,16),s.vf(Dn,8),s.vf(Zl,24),s.vf(Ih,32),s.vf(Vd,40))},_updateAutoRotation:function(){var v=new hs,D=new vr,Y=new Or,F=new Or,j=new Or;return function(){var n=this,q=n.data,R=n.s("autorotate")||n.s("shape3d.autorotate");if(!R)return q._dynamicRotation&&delete q._dynamicRotation,void 0;var U=n.gv;j.copy(n.s("shape3d.autorotate.up")||U._up);var b;b="string"==typeof R?[R.indexOf("x")<0?U._eye[0]:U._center[0],R.indexOf("y")<0?U._eye[1]:U._center[1],R.indexOf("z")<0?U._eye[2]:U._center[2]]:U._eye;var O=U._center,y=q.p3();Y.copy(y),F.set(b[0]-O[0],b[1]-O[1],b[2]-O[2]).add(Y),D.lookAt(F,Y,j),v.set(0,0,0,q.getRotationMode(),!0).setFromRotationMatrix(D);var k=q._dynamicRotation;k&&Math.abs(k[0]-v.x)<1e-5&&Math.abs(k[1]-v.y)<1e-5&&Math.abs(k[2]-v.z)<1e-5||(q._dynamicRotation=[v.x,v.y,v.z])}}(),_updateFixSize2d:function(){var K=this,N=K.data,L=K.s("fixSizeOnScreen")||K.s("shape3d.fixSizeOnScreen");if(!L)return N._dynamicScale3d&&delete N._dynamicScale3d,void 0;var E=K.gv,d=vs(N,E.getMat(N)),c=jd([0,0,0],d),n=E.toViewPosition(c);if(!isNaN(n.x)&&!isNaN(n.y)){var r=jd([1,0,0],d),B=E.toViewPosition(r),G=jd([0,1,0],d),v=E.toViewPosition(G),b=B.x-n.x,F=v.y-n.y;if(b&&F){var a,I,q=N._dynamicScale3d||[1,1,1],A=Om(N.s("shape3d.image"));if(L[0]>0&&(a=L[0]),L[1]>0&&(I=L[1]),!a||!I){var O=L>0?L:1;a||(a=(To(A,N)||N.getWidth())*O),I||(I=(Of(A,N)||N.getTall())*O)}var Y=Math.abs(b/a),j=Math.abs(F/I);Math.abs(Y-1)<.001&&Math.abs(j-1)<.001||(N._dynamicScale3d=[q[0]/Y,q[1]/j,q[2]])}}},_updateOverlapping:function(){var I=this,q=I.s("hide.overlapping.group");if(!q)return I._rectOverlapping&&(I._rectOverlapping=B),void 0;var S,Y,K,W=I.gv,J=I.data,m=vs(J,W.getMat(J)),P=1/0,h=1/0,N=-1/0,T=-1/0,E=J.getAnchor3d(),F=E.x,k=E.y,Q=E.z;for(S=0;8>S;S++){if(Y=jd([(S>>2)-F,(1&S>>1)-k,(1&S)-Q],m),K=W.toViewPosition(Y),isNaN(K.x)||isNaN(K.y))return;P=Math.min(P,K.x),N=Math.max(N,K.x),h=Math.min(h,K.y),T=Math.max(T,K.y)}var e={x:P,y:h,w:N-P,h:T-h};I._rectOverlapping=W.overlappingBox.isOverlapping(q,e)},getVectorDynamicSize:function(){var i,a=this,Y=a.s("shape3d"),S=a.data;if("billboard"===Y||"plane"===Y||(i=S._currentCubeElementId)!=z){var D,e,J=a.gv,F=vs(S,J.getMat(S)),A=S.getAnchor3d(),r=.5-A.x,B=.5-A.y,U=.5-A.z,R=Math.min(a.s("vector.dynamic.maxsize"),J._glCapabilities.maxTextureSize)/J.getDevicePixelRatio(),H=function(v,X){v[0]+=r,v[1]+=B,v[2]+=U,X[0]+=r,X[1]+=B,X[2]+=U;var x=J.toViewPosition(jd(v,F)),h=J.toViewPosition(jd(X,F)),I=x.x-h.x,$=x.y-h.y;return Math.min(R,Math.sqrt(I*I+$*$))};if("billboard"===Y)D=H([-.5,0,0],[.5,0,0]),e=H([0,-.5,0],[0,.5,0]);else if("plane"===Y)D=H([-.5,0,0],[.5,0,0]),e=H([0,0,-.5],[0,0,.5]);else if(S._currentCubeElementId!=z){var q=3*lg[i+1],g=3*lg[i],N=3*lg[i+2];D=H([On[q],On[q+1],On[q+2]],[On[N],On[N+1],On[N+2]]),e=H([On[q],On[q+1],On[q+2]],[On[g],On[g+1],On[g+2]])}return[D,e]}},vf:function(l,i){var M=this;if(M.gv.getFaceVisible(M.data,l)){var w=uh(M,l);w.mat&&(M.faceMat=!0);var Q=w.uv;if(Q){var L=M._cubeUvs;L||(L=M._cubeUvs=new al([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var p=0;8>p;p++)L[i+p]=Q[p]}return w}},_billboardInView:function(){var E=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],L=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],b=new $k,s=new Or,V=new vr;return function(O){var t=this;if(!t.mat)return!0;var Z=t.gv.getFrustum(),H="billboard"===O?E:L;b.makeEmpty(),V.fromArray(t.mat);for(var B=0,v=H.length;v>B;B+=3)b.expandByPoint(s.fromArray(H,B).applyMatrix4(V));return Z.intersectsBox(b)}}(),_80o:function(R,A,Q){var _=this;if(_._rectOverlapping)return!0;var L=_.shapeModel;
if(L||!_.shapeName){var B=_.s("shape3d");if(("billboard"===B||"plane"===B)&&!_._billboardInView(B))return!0;var N=_.gv,q=_.data,F=N._cube,V=Gh.for(R),X=V.directAttribs();if(fl&&!fd){var G=_.mat;if(G)for(var e=0;e<G.length;e++)_.mat[e]=G[G.length-e-1]}Zm(N,_.mat),!R._picking&&_.s("shape3d.reflector")||_.s("effect.flow")||(L?Pf(N,q,L,_,_.getBodyColor(),Q):(X.aPosition=wr(R,F.vs,z,z),X.aNormal=wr(R,F.ns,z,z),Vg(R,F.is),_._18O(R,A,"left",0,Q),_._18O(R,A,"front",6,Q),_._18O(R,A,"right",12,Q),_._18O(R,A,"back",18,Q),_._18O(R,A,"top",24,Q),_._18O(R,A,"bottom",30,Q))),nc(N),_.faceMat&&(_._18O(R,A,"left",0,Q,!0),_._18O(R,A,"front",6,Q,!0),_._18O(R,A,"right",12,Q,!0),_._18O(R,A,"back",18,Q,!0),_._18O(R,A,"top",24,Q,!0),_._18O(R,A,"bottom",30,Q,!0))}},_18O:function(W,U,q,m,G,N){var o=this[q];if(o){if(!G(o.transparent))return;if(N&&!o.mat||!N&&o.mat)return;var i=this.data.s("polygonOffset");i&&Pr(W,i),N&&Zm(this.gv,o.mat);var E=this,l=E.data,V=Gh.for(W),x=V.directUniforms();l._currentCubeElementId=m;var s=E.gv,A=s.getTexture(o.texture,l,q),X=o.uv,O=o.uvScale,T=o.uvOffset,e=o.uvRotation,H=o.uvAnchor,Y=o.discardSelectable;A?X?vf(W,U,A,Y,s._buffer.uv,E._cubeUvs,T,O,e,H):vf(W,U,A,Y,s._cube.uv,z,T,O,e,H):vf(W),wn(W,U,o.blend,o.light,o.opacity,o.reverseFlip,o.reverseColor,o.reverseCull),x.uDiffuse=o.color||b["color.empty"],Ck(W,m,6),xj(W,U),uf(W,U,A),N&&nc(s),i&&pi(W),l._currentCubeElementId=null}},contextLost:function(){kt.superClass.contextLost.apply(this,arguments),this.data.s("shape3d.reflector")&&(this._reflectorRenderTarget=null,this._reflectNormal=null)},drawReflector:function(){var n=new Or,A=new Or,E=new hs,U=new vr,t=new Or,W=new Or,H=new Or,j=new Or,I=new vr,d=new vr,R=new jl,h=new il,r=new il,p=function(M,L,J){M[J]=L[0],M[J+1]=L[1],M[J+2]=L[2]},_=function(t,S,s){s=s||0,t[0]=S[s],t[1]=S[s+1],t[2]=S[s+2]},C=function(z,N){p(z,N.getEye(),0),p(z,N.getCenter(),3),p(z,N.getUp(),6)},M=function(G,E){_(E._eye,G,0),_(E._center,G,3),_(E._up,G,6),E._18Q=z;var J=E._skybox;J&&(J.p3([G[0],G[1],G[2]]),E.getData3dUI(J).iv())};return function(F){var $=this;$._reflectorInfo=null;var D=$.data;if(D._reflecting)return!1;var X=$.gv;if(X._picking)return!1;var K=D instanceof gf,J=$._reflectorRenderTarget,k=X._canvas.width,g=X._canvas.height;if(J?J.setSize(F,k,g):J=$._reflectorRenderTarget=new ae.RenderTarget(X,F,k,g),K){var N=D.getPointsMatrix3d().getElements(),O=D.p3();O[1]+=(1-D.getAnchorElevation())*D.getTall(),n.copy(jd(O,N))}else n.copy(D.p3());if(A.copy(X.getEye()),U.makeRotationFromEuler(E.set(D.r3(),D.getRotationMode(),!0)),!$._reflectNormal){var e;if(K&&D.getThickness()<0){if(!$.shapeModel||!$.shapeModel.top_vs)return!1;e={vs:$.shapeModel.top_vs,ns:$.shapeModel.top_ns}}else{if(e=qb($,$.s("shape3d")),!e)return!1;!e.ns&&e.length&&(e=e[0])}if(!e.ns||!e.vs)return!1;$._reflectNormal=[e.ns[0],e.ns[1],e.ns[2]],$._reflectorVbuffer=vb.Buffer.createVertexBuffer(F,new Float32Array(e.vs))}if(t.copy($._reflectNormal),t.applyMatrix4(U),W.subVectors(n,A),W.dot(t)>0)return!1;W.reflect(t).negate(),W.add(n),H.copy(X.getCenter()).negate().add(n),H.reflect(t).negate(),H.add(n),j.copy(X.getUp()),j.reflect(t);var s=[0,0,0,0,0,0,0,0,0];C(s,X),_(X._eye,W.toArray()),_(X._center,H.toArray()),_(X._up,j.toArray()),X._18Q=z;var f=X._skybox;f&&(f.p3(X._eye),X.getData3dUI(f).iv()),Kp(F,J.frame),X.setViewport(F,0,0,J.width,J.height);var c=D.s("shape3d.reflector.background");if(c){var u=F.getParameter(F.COLOR_CLEAR_VALUE);br(F,c)}else br(F,[0,0,0,1]);Gh.for(F).glState.depth.mask=!0,F.clear(F.COLOR_BUFFER_BIT|F.DEPTH_BUFFER_BIT);var l=D.s("shape3d.reflector.clip"),p=l===B?.003:l,Z=gr(X),i=Cj(X);R.setFromNormalAndCoplanarPoint(t,n.add(t.clone().multiplyScalar(p))),R.applyMatrix4(d.fromArray(i)),h.set(R.normal.x,R.normal.y,R.normal.z,R.constant),d.fromArray(Z).getInverse(d),r.set(Math.sign(h.x),Math.sign(h.y),1,1).applyMatrix4(d),h.multiplyScalar(2/h.dot(r)),Z[2]=h.x-Z[3],Z[6]=h.y-Z[7],Z[10]=h.z-Z[11],Z[14]=h.w-Z[15];var S=X._computedProjectMatrix;X._computedProjectMatrix=Z,D._reflecting=!0;var a=D.s("shape3d.reflector.shadow"),m={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===a?(m.createShadowMap=!1,m.renderShadow=!1):"scene"===a?m.createShadowMap=!1:m.useReflectorSelfShadowMap=!0,X.renderScene(m),X._computedProjectMatrix=S,I.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),I.multiply(d.fromArray(X._projectMatrix)),I.multiply(d.fromArray(X._viewMatrix)),c&&br(F,u),kg(F),M(s,X);var y=D.s("shape3d.reflector.blur");if(y){var V=X.getPostProcessingModule("Blur");V&&V.drawImpl(F,J,y,y>=3,D.s("shape3d.reflector.blur.iterations"))}var w=X.getPostProcessingModule("Glitch");w&&w.enable&&w.onlyReflector&&(J=w._42(F,J));var Y=F._compiledShader.reflector;Y||(Y=F._compiledShader.reflector=new vb.Shader(F,_e.Reflector.vs,_e.Reflector.fs)),Y.bind(),F.activeTexture(F.TEXTURE0),cj(F,J.texture),Y.uniforms.tDiffuse=0,Y.uniforms.color=Qk(D.s("shape3d.reflector.color")||"rgb(128,128,128)"),Y.uniforms.textureMatrix=I.toArray(),Y.uniforms.modelMatrix=K?N:vs(D),Y.uniforms.viewMatrix=Cj(X),Y.uniforms.projectionMatrix=gr(X);var T=$._reflectorVbuffer;T.upload(),Y.attributes.pos.pointer(T);var L=this.s("shape3d.transparent");if(L){var b=Gh.for(F).glState,x=b.depth.mask;b.depth.mask=!1}return F.drawArrays(F.TRIANGLES,0,T.data.length/3),L&&(b.depth.mask=x),D._reflecting=!1,F.useProgram(X._prg),cj(F,z),!0}}()}),_e.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var lt=function(l,b){mg(lt,this,[l,b])};Fm(lt,kt,{_80o:function(){}});var mt=function(E,x){mg(mt,this,[E,x])};Fm(mt,jt,{_25Q:1,validate:function(k){var d=this,X=d.s;if(X(um)!==Vb||X("batch")!=z||!d.info||d.data._needChangeGeometry){var C=d.gv,f=d.data,S=X("edge.width"),g=f._40I,O=f._41I;if(f._needChangeGeometry=d.shapeModel=d.info=d.lineShapeModel=z,g&&O){var i,V,_,x,R,j,w,r,y,J,v=f.isLooped(),K=X(Ur),I=m.getEdgeType(K);if(I){var A=I(f,xk(d,C,f,v,K),C,d._19Q);if(!A.points||A.points.isEmpty())return;j=d.info={},w=A.segments,R=A.points,r=R.size();for(var W=g.getElevation(),D=O.getElevation(),M=0;r>M;M++){var E=R.get(M);E.e==z&&(E.e=W+(D-W)*M/(r-1))}y=Jb(R.get(0)),J=Jb(R.get(r-1));var G=r%2,e=(r-G)/2;j.c1=Jb(R.get(e-1)),j.c2=Jb(R.get(e)),0!==G&&(j.p3=j.c2),j.s1=y,j.s2=Jb(R.get(1)),j.t1=Jb(R.get(r-2)),j.t2=J}else{R=new An,j=d.info={};var u=X("edge.offset"),Q=X("edge.center"),N=X("edge.source.t3"),T=X("edge.target.t3"),p=be(C,f,"source"),$=be(C,f,"target");if(!p||!$)return C.invalidateData(f),delete d.info,!1;if(N&&(p[0]+=N[0],p[1]+=N[1],p[2]+=N[2]),T&&($[0]+=T[0],$[1]+=T[1],$[2]+=T[2]),K===Bj){w=X("edge.segments");var t=j.points=X(vp)||Yg;if(r=t.size()){if(y=Jb(t.get(0)),J=Jb(t.get(r-1)),!Q&&u){var b=u;_=of(y,p,!0),u=H(b,bh(p,y)),p=[p[0]+_[0]*u,p[1]+_[1]*u,p[2]+_[2]*u],_=of($,J,!0),u=H(b,bh(J,$)),$=[$[0]-_[0]*u,$[1]-_[1]*u,$[2]-_[2]*u]}if(1===r)j.p3=y;else{var G=r%2,e=(r-G)/2;i=Jb(t.get(e-1)),V=Jb(t.get(e)),0!==G&&(j.p3=V),j.s1=p,j.s2=y,j.t1=J,j.t2=$}}else!Q&&u&&(_=of($,p,!0),x=bh(p,$),u=we(u,x),p=[p[0]+_[0]*u,p[1]+_[1]*u,p[2]+_[2]*u],$=[$[0]-_[0]*u,$[1]-_[1]*u,$[2]-_[2]*u]),i=p,V=$;R.add({x:p[0],y:p[2],e:p[1]}),R.addAll(t),R.add({x:$[0],y:$[2],e:$[1]})}else{var l=xk(d,C,f,v,K);if(d._19Q||(l=-l),v){var n=p[0],q=p[1],U=p[2],B=g.getTall()/2+l;i=[n-l,q+B,U],V=[n+l,q+B,U],R.add({x:n-l,y:U,e:q}),R.add({x:n-l,y:U,e:q+B}),R.add({x:n+l,y:U,e:q+B}),R.add({x:n+l,y:U,e:q})}else{_=of($,p,!0),x=bh(p,$);var L={x:p[0],y:p[2]},h={x:$[0],y:$[2]},Z=uq(z,L,h,l),P=Z.x-L.x,s=Z.y-L.y;u=we(u,x),_[0]*=u,_[1]*=u,_[2]*=u,i=[p[0]+_[0]+P,p[1]+_[1],p[2]+_[2]+s],V=[$[0]-_[0]+P,$[1]-_[1],$[2]-_[2]+s],Q?(R.add({x:p[0],y:p[2],e:p[1]}),R.add({x:i[0],y:i[2],e:i[1]}),R.add({x:V[0],y:V[2],e:V[1]}),R.add({x:$[0],y:$[2],e:$[1]})):(R.add({x:i[0],y:i[2],e:i[1]}),R.add({x:V[0],y:V[2],e:V[1]}))}}j.c1=i,j.c2=V}j._lastPointsSegments={points:R,segments:w},j.list=X(um)===Vb?d.createTubeModel(R,w,S/2,k):d.createLineModel(R,w,S,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=z}});var nt=function(G,f){mg(nt,this,[G,f]),this._needRecoverPosition=!0};Fm(nt,kt,{_80o:function(_,T,e){var g=this,U=g._matWithExtraction||g.mat;if(U&&(!g.s("shape3d.reflector")||_._picking)){var J=g.gv,t=g.shapeModel;Zm(J,U),t?Pf(J,g.data,t,g,g.getBodyColor(),e):(_f(g,_,T,"left",e),_f(g,_,T,"front",e),_f(g,_,T,"right",e),_f(g,_,T,"back",e),_f(g,_,T,"top",e),_f(g,_,T,"bottom",e)),nc(J)}},validate:function(G,n){var K,k,e=this,p=e.s,Q=e.data,$=Q._thickness/2,T=Q.isClosePath(),q=Q.getPoints(),X=Q.getSegments(),y=p(ao),x=G&&G.uv;if(e.invalidateUnstableWireframe(),e.clear(),e.dispatchBoundingBoxChanged(),m.extractShapeTranslation||m.extractVerticesTranslation){var A=new _k.Vector3(Q.p3());q=zs(q),q.forEach(function(y){y.x-=A.x,y.y-=A.z}),e._vsTranslation=(new _k.Matrix4).setPosition(A);var F=Q.getShapeElevation;Q.getShapeElevation=function(){return-(this.getTall()||0)*(this._anchorElevation-.5)}}else e._vsTranslation=null;if(0>$){e.s("shape3d.reflector")&&(e._reflectNormal=null);try{var g=p("shape3d.image.projection");if(g&&g[4]){var r=Q.p3(),w=r[0],P=r[2];g=[w+g[0],g[1]+P,w+g[2],g[3]+P]}k=e.shapeModel=jo(q,X,p(gg),p(kc),y,p(gh),Q.getTall(),Q.getShapeElevation(),T,g)}catch(R){k=e.shapeModel={}}p(Nc)?p("shape3d.image")||delete k.uv:(delete k.vs,delete k.ns,delete k.uv),p("shape3d.top.image")||delete k.top_uv,p("shape3d.bottom.image")||delete k.bottom_uv}else if(p(um)===Vb)K=Qf(q,X,y,T),k=e.shapeModel={vs:[]},p("shape3d.image")&&(k.uv=[],k.sum=p(gh)||ko(K)||1,k.len=0),p(gg)&&!T&&(k.top_vs=[],p("shape3d.top.image")&&(k.top_uv=[])),p(kc)&&!T&&(k.bottom_vs=[],p("shape3d.bottom.image")&&(k.bottom_uv=[])),e._12O(K,$);else{var b,o,E,M,d,c,I,H,N,u;if(K=Qf(q,X,y,T),d=e.vf(Dn,x,!1,n),$&&(c=e.vf(Zl,x,!1,n),I=T?z:e.vf(Mq,x,!1,n),H=T?z:e.vf(ze,x,!1,n),N=e.vf(Ih,x,!1,n),u=e.vf(Vd,x,!1,n)),$){for(var Y=0,J=K.length;J>Y;Y++)K[Y]=e._tryRemoveBezierPoints(K[Y],$);e._12O(K,$)}else d&&K.forEach(function(n){if(M=n.length,M>0)for(b=n[0],E=1;M>E;E++)o=n[E],e.addV(d.vs,b,o),b=o});e._20Q(K),G||(d&&(d.ns=gq(d.vs),yj(d,"vs"),yj(d,Nm)),$&&(c&&(c.ns=gq(c.vs),yj(c,"vs"),yj(c,Nm)),I&&(I.ns=gq(I.vs),yj(I,"vs"),yj(I,Nm)),H&&(H.ns=gq(H.vs),yj(H,"vs"),yj(H,Nm)),N&&(N.ns=gq(N.vs),yj(N,"vs"),yj(N,Nm)),u&&(u.ns=gq(u.vs),yj(u,"vs"),yj(u,Nm))))}var j=e.mat=Q.getPointsMatrix3d().getElements();e._vsTranslation?j=e._matWithExtraction=(new _k.Matrix4).fromArray(j).multiply(e._vsTranslation).toArray():e._matWithExtraction=null,G&&(xn(e,j,G,k,n),e.clear()),F!=z&&(Q.getShapeElevation=F)},_20Q:function(p){var C,Z,v,f,t,g,X,Q,H,q,F,i,n,j=this,V=j.front,_=j.back,s=j.top,$=j.bottom,P=V?V.tuv:z,e=_?_.tuv:z,w=s?s.tuv:z,l=$?$.tuv:z,W=0,k={front:0,back:0,top:0,bottom:0};(P||e||w||l)&&(n=j.s(gh),C=n||ko(p)||1,F=j.s("all.uv.union"),p.forEach(function(N){if(Z=N.length,Z>0){for(q in k)i=j.s(q+".uv.union"),(i===!1||i==z&&F===!1)&&(k[q]=0,n||(C=ko([N])));for(g=N[0],v=1;Z>v;v++){X=N[v],Q=bh(g,X);for(q in k)W=k[q],f=W/C,k[q]=W+=Q,t=W/C,"back"===q&&(H=f,f=1-t,t=1-H),j._14O(j[q],f,t);g=X}}}))},_14O:function(d,A,u){if(d){var W=d.uv,f=d.tuv;if(f){if(W)var m=W[0]+(W[6]-W[0])*A,z=W[1]+(W[7]-W[1])*A,l=W[2]+(W[4]-W[2])*A,S=W[3]+(W[5]-W[3])*A,L=W[2]+(W[4]-W[2])*u,q=W[3]+(W[5]-W[3])*u,E=W[0]+(W[6]-W[0])*u,J=W[1]+(W[7]-W[1])*u;else m=A,z=0,l=A,S=1,L=u,q=1,E=u,J=0;f.push(l,S,L,q,E,J,E,J,m,z,l,S)}}},_13O:function(L){var k=L.uv,M=L.tuv;M&&(k?M.push(k[2],k[3],k[4],k[5],k[6],k[7],k[6],k[7],k[0],k[1],k[2],k[3]):M.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(B,a){var O=B.length;if(4>O)return B;var E,d,X,D,v,t,L=!1,H=function(I){return B[I]},x=function(k){return B[O-1-k]};for(v=0;1>=v;v++)for(t=v?x:H,d=t(0),X=t(1),E=2;O-1>E;E++)if(D=t(E),!D.remove)if(D.b){var l=uq(d,X,D,a);l.adjust?(D.remove=!0,L=!0):(d=X,X=D)}else d=X,X=D;if(!L)return B;var w=[];for(E=0;O>E;E++)B[E].remove||w.push(B[E]);return w},_12O:function(O,K){var H,M,r,u,w,e=this.s("shape3d.point.epsilon"),P=this;O.forEach(function(X){if(w=X.length,w>0)for(H={p:X[0],n:!0},u=1;w>u;u++)M=X[u],r=w-1>u?X[u+1]:z,r&&Math.abs(M.x-r.x)<e&&Math.abs(M.y-r.y)<e||P.addPoint(H,M,r,K,X)})},addPoint:function(L,C,f,Q,a){var u,d,D,T,W,I,h,A,E,n=this,_=L.p,v=L.f,Z=L.b,k=n.s("shape3d.side")||Zo,G=n.s("shape3d.start.angle"),P=n.s("shape3d.sweep.angle"),t=n.shapeModel,N=n.data.isClosePath();if(L.n&&(L.n=!1,v=N&&a.length>2?uq(a[a.length-2],_,C,Q):uq(z,_,C,Q),Z=ok(_,v),t?t.top_vs&&n._10O(Z,v,k,G,P,t.top_vs,t.top_uv):(u=n.left)&&(n.addV(u.vs,Z,v),n._13O(u))),d=f?uq(_,C,f,Q):N&&a.length>2?uq(_,C,a[1],Q):uq(_,C,z,Q),D=ok(C,d),t){var q,H,y=t.vs,U=t.uv,V=t.sum;for(U&&(q=t.len/V,t.len+=bh(_,C),H=t.len/V),I=n._9O(Z,v,k,G,P),h=n._9O(D,d,k,G,P),A=0;k>A;A++)E=A+1,re(y,I[E]),re(y,h[A]),re(y,I[A]),re(y,h[A]),re(y,I[E]),re(y,h[E]),U&&(T=A/k,W=E/k,U.push(q,W,H,T,q,T,H,T,q,W,H,W));!f&&t.bottom_vs&&n._10O(D,d,k,G,P,t.bottom_vs,t.bottom_uv,!0)}else!f&&(u=n.right)&&(n.addV(u.vs,d,D),n._13O(u)),(u=n.front)&&n.addV(u.vs,v,d),(u=n.back)&&n.addV(u.vs,D,Z),(u=n.top)&&n.addH(u.vs,v,d,D,Z,!0),(u=n.bottom)&&n.addH(u.vs,Z,D,d,v);L.p=C,L.f=d,L.b=D},_10O:function(t,X,F,B,W,e,p,O){var m,P,G=this,$=G.data,A=G._9O(t,X,F,B,W),g=(t.x+X.x)/2,D=(t.y+X.y)/2,I=$.getShapeElevation(),n=0;for(n=0;F>n;n++)O?(re(e,A[n]),re(e,A[n+1])):(re(e,A[n+1]),re(e,A[n])),re(e,[g,I,D]),p&&(O?(m=Q*(n+1)/F+B,P=Q*n/F+B):(m=Q*n/F+B,P=Q*(n+1)/F+B),p.push(.5-.5*c(P),.5-.5*N(P),.5-.5*c(m),.5-.5*N(m),.5,.5))},_9O:function(t,X,a,y,w){var f,F,I=this,P=I.data,R=[],j=(t.x+X.x)/2,x=(t.y+X.y)/2,l=P.getTall()/2,e=P.getShapeElevation(),W=0;for(w==z&&(w=Q);a>=W;W++)f=w*W/a+y,F=c(f),R.push([j+(t.x-j)*F,e+l*N(f),x+(t.y-x)*F]);return R},addV:function(t,O,H){var V=O.x,h=O.y,p=H.x,y=H.y,e=this.data,C=e.getShapeElevation(),P=e.getTall()/2;t.push(V,C-P,h,p,C-P,y,p,C+P,y,p,C+P,y,V,C+P,h,V,C-P,h)},addH:function(r,x,j,_,Q,n){var a=this.data,h=a.getTall()/2,u=a.getShapeElevation()+(n?h:-h);r.push(x.x,u,x.y,j.x,u,j.y,_.x,u,_.y,_.x,u,_.y,Q.x,u,Q.y,x.x,u,x.y)},vf:function(H,L,G,X){var g,S=this,U=S.gv.getFaceVisible(S.data,H);return(G||U)&&(g=uh(S,H,X),g.vs=[],g.tuv=U&&(g.texture||L)?[]:z,g.visible=U),g}});var ot=function(l,M){mg(ot,this,[l,M])},pt={},qt=function(p){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(p)};Fm(ot,kt,{validate:function(){var G=this,D=G.gv,v=G.data,O=G.s,f=Qk(O("points.color")),Y=O("points.size"),u=O("points.uv.offset"),m=O("points.image");!m||qt(m)||bp.test(m)||(pt[m]||(pt[m]=G._createCachedImage(m)),m=pt[m]);var F,r,T=v._modelDirty,P=O("points.model");if(P){if(G._lastShapeModel!==P||!G.shapeModel){var Q=qb(G,P);if(!Q)return;var y=[],H={};G.eachShapeModel(function(z){for(var c=0,h=z.length;h>c;c+=3){var M=z[c],q=z[c+1],l=z[c+2],n=""+M+"_"+q+"_"+l;H[n]||(H[n]=!0,y.push(M,q,l))}},Q),G._setShapeModelPoints(new al(y)),G._lastShapeModel=P,T=!0}F=G.shapeModel.vs.length,r=F/3}else{var N=v.getPoints();if(r=F=N.length,T||v._pointsDirty||!G.shapeModel){for(var K=[],V=0;r>V;V++){var U=N[V];U&&K.push(U.x,U.e,U.y)}G._setShapeModelPoints(new al(K)),v._pointsDirty=!1,G._lastShapeModel=null,T=!0}}if(G.info={mat:vs(v),size:Y,diffuse:f,opacity:O("points.opacity"),texture:m,alphaTest:O("points.transparent")?0:O("alphaTest"),uvScale:O("points.uv.scale"),uvOffset:u,discardSelectable:O("points.discard.selectable")},T||v._colorsDirty){var s=!1,X=v.getColors();if(X&&X.length>0)for(var d=[],V=0;r>V;V++)for(var o=X[V],x=o?(s=!0,Qk(o)):f,h=4*V,t=0;4>t;t++)d[h+t]=x[t];G.shapeModel.cs=s?new al(d):null,v._colorsDirty=!1}if(T||v._sizesDirty){var g=!1,k=v.getSizes();if(k&&k.length>0)for(var n,z=[],V=0;r>V;V++)n=k[V],n>=0?(z.push(n),g=!0):z.push(Y);G.shapeModel.ss=g?new al(z):null,v._sizesDirty=!1}if(T||v._offsetsDirty){var L=!1,A=v.getUvoffsets();if(A&&A.length>0)for(var S,c,M,$=[],V=0;r>V;V++)S=2*V,c=A[S],M=A[S+1],c!=B&&M!=B?($.push(c,M),L=!0):$.push(u[0],u[1]);G.shapeModel.os=L?new al($):null,v._offsetsDirty=!1}if(T||G._lastPointNumber!==r){this.dispose();var W=D.pickColorMap,i=G._startPickId=W._pickIdUsed;W._pickIdUsed=i+r;for(var K=[],V=0;r>V;V++){var j=i+V,E=Vs(j);K.push(E[0],E[1],E[2],E[3]),W[j]||(W[j]={data:v,part:V})}G.shapeModel.ps=new al(K),G._lastPointNumber=r}v._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(_){var Y=this,k=Y.shapeModel,O=Y.shapeModel={vs:_};if(!k)return O;var U=_.length,v=Math.round(U/3);return k.cs&&k.cs.length==4*v&&(O.cs=k.cs),k.ss&&k.ss.length==v&&(O.ss=k.ss),k.os&&k.os.length==2*v&&(O.os=k.os),k.ps&&k.ps.length==4*v&&(O.ps=k.ps),O},_createCachedImage:function(F){var O=128,A=km(),y=A.getContext("2d");Eg(A,O,O,1),sl(y,{width:O,height:O,comps:[{type:F,background:"white",borderWidth:0,rect:[0,0,O,O]}]},0,0,O,O);var d=_.Math.generateUUID();return Rb[d]=A,d},_80o:function(d,U){var A=this,F=A.gv,N=F._picking;if(!N||F.isSelectable(A.data)){var o=A.shapeModel,g=A.info;if(o&&o.vs&&o.vs.length){var x=Gh.for(d);x.useProgram(A._asureProgram(d));var S=x.directUniforms(),C=x.directAttribs();S.modelMatrix=g.mat,S.modelViewMatrix=zg([],F._viewMatrix,g.mat),S.projectionMatrix=F._projectMatrix,S.viewMatrix=F._viewMatrix,S.scale=F.getHeight()/2,S.size=g.size,S.diffuse=g.diffuse,S.opacity=g.opacity,S.map=F.getTexture(g.texture,A.data),S.alphaTest=g.alphaTest,S.resolution=F.getDevicePixelRatio(),S.discardSelectable=g.discardSelectable,S.uvScale=g.uvScale,C.uvOffset=!N&&o.os?Cs(d,F._buffer.os,o.os,z):g.uvOffset,S.blackout=d._blooming&&!A.data.s("bloom"),C.position=Cs(d,F._buffer.vs,o.vs,z),N?(S.picking=!0,C.pickColor=Cs(d,F._buffer.ps,o.ps,z),S.useColor=!1,C.color=null):(S.picking=!1,C.pickColor=null,o.cs?(S.useColor=!0,C.color=Cs(d,F._buffer.cs,o.cs,z)):(S.useColor=!1,C.color=null)),o.ss?(S.useSizeArray=!0,C.sizeArray=Cs(d,F._buffer.ss,o.ss,z)):(S.useSizeArray=!1,C.sizeArray=null),am(d,0,o.vs.length/3,d.POINTS),x.useProgram(U),C.disable(),F.shadowMap.enable&&F.shadowMap.createShadow(),F.flowMap.createFlow(S)}}},_asureProgram:function(D){return D._pointsShader||(D._pointsShader=this.gv._postProcessing.createShader(D,ot.shaderSrc)),D._pointsShader.program},dispose:function(){ot.superClass.dispose.call(this);var F=this._startPickId,Z=this._lastPointNumber;if(F&&Z){for(var b=this.gv.pickColorMap,x=0;Z>x;x++){var i=F+x;b[i]&&delete b[i]}delete this._startPickId,delete this._lastPointNumber}}}),ot.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var rt=function(d,P){mg(rt,this,[d,P]),this._needRecoverPosition=!0};Fm(rt,jt,{_25Q:1,validate:function(J){var o=this,U=o.data,P=o.s,w=U.getPoints(),S=w.size();o.dispatchBoundingBoxChanged();var R=U.p3(),b=o.mat=Cd();hk(b,R),wj(b,U.getFinalRotation3d(),U.getRotationMode());var c=U.getScale3d(),h=U._dynamicScale3d;if(h&&(c[0]*=h[0],c[1]*=h[1],c[2]*=h[2]),Tl(b,c),hk(b,Qm(R)),(P(um)!==Vb||P("batch")!=z||!o.shapeModel||U._needChangeGeometry)&&(U._needChangeGeometry=o.shapeModel=o.info=o.lineShapeModel=z,S>1)){var G=o.info={},d=U.getSegments(),a=U.getThickness(),f=Jb(w.get(0)),H=Jb(w.get(S-1)),s=S%2,T=(S-s)/2;if(G.c1=Jb(w.get(T-1)),G.c2=Jb(w.get(T)),0!==s&&(G.p3=G.c2),G.s1=f,G.s2=Jb(w.get(1)),G.t1=Jb(w.get(S-2)),G.t2=H,P(um)===Vb){if(m.extractPolylineTranslation||m.extractVerticesTranslation){var R=new _k.Vector3(U.p3());w=zs(w),w.forEach(function(r){r.x-=R.x,r.e-=R.y,r.y-=R.z}),o._vsTranslation=(new _k.Matrix4).setPosition(R),o._matWithExtraction=(new _k.Matrix4).fromArray(b).multiply(o._vsTranslation).toArray()}else o._vsTranslation=null,o._matWithExtraction=null;G.list=o.createTubeModel(w,d,a/2,J)}else G.list=o.createLineModel(w,d,a,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=z},_80o:function(y,i,s){var g=this,w=g.shapeModel;if(w){var T=g.mat;(m.extractPolylineTranslation||m.extractVerticesTranslation)&&g._matWithExtraction&&(T=g._matWithExtraction);var E=g.gv;Zm(E,T);var Y,X=g.s("3d.clip.direction");if(E._uvClipEnabled&&("uv.left"===X||"uv.right"===X)&&(Y=g.s("3d.clip.percentage"))<1){var u=!0,N=!0;bj(w);var o=w.top_vs,h=w.bottom_vs,U=w.vs,k=Gh.for(y),p=k.directUniforms(),e=k.directAttribs();"uv.left"==X?(1>Y&&(u=!1),0>=Y&&(N=!1)):(1>Y&&(N=!1),0>=Y&&(u=!1)),w.top_vs=w.bottom_vs=B,e.aUv=Cs(y,E._buffer.uv,w.uv,z,2),Pf(E,g.data,w,g,g.getBodyColor(),s),e.aUv=!1,p.uClipDirection=0,w.vs=B,u&&(w.top_vs=o),N&&(w.bottom_vs=h),Pf(E,g.data,w,g,g.getBodyColor(),s),w.vs=U,w.top_vs=o,w.bottom_vs=h}else Pf(E,g.data,w,g,g.getBodyColor(),s);nc(E)}}});var st=_.graph3d.PostProcessing=function(l){var g,j,x,y,r=this,v={},V=!1,G=!1;!function(){S.keys(st).forEach(function(r){v[r]=new st[r](l)})}(),r.getModule=function(z){return z?v[z]:r},r.getModuleList=function(){return S.keys(v)},r._serializable=!0,r.handleDataModleChange=function(l,p){l&&(r._serializable&&l.setPostProcessingData(r.serialize()),l.removeSerializeListener(r.onDataModelSerialize,r)),p&&(p.addSerializeListener(r.onDataModelSerialize,r),r.deserialize(p))},r.onDataModelSerialize=function(z){"serialize"===z.type?r._serializable&&(l.dm()._postProcessingData=r.serialize()):"deserialize"===z.type&&r.deserialize(l.dm())},r.isDeserializeDisabled=function(E){return!r._serializable||E.a("sceneBloom")!==B},r.isSerializable=function(){return r._serializable},r.setSerializable=function(j){r._serializable=j,j||l.dm().setPostProcessingData(B)},r.serialize=function(){var H,w,r,V,B={};for(w in v)if(r=v[w],V=r.serializeProperties){H={},r.enable&&(H.enable=!0);for(var m in V){var n=r[m];n!=V[m]&&(H[m]=n)}S.keys(H).length&&(B[w.toLowerCase()]=H)}return B},r.deserialize=function(Z){var G,P,u,i,U,z={},H={};for(G in v){u=v[G],i=u.serializeProperties;var $={},y="scene"+G,T=Z.a(y);T!==B&&($.enable=T);for(var U in i)T=Z.a(y+U[0].toUpperCase()+U.slice(1)),T!==B&&T!==i[U]&&($[U]=T);od($)||(H[G[0].toLowerCase()+G.slice(1)]=$)}if(od(H)&&(H=Z.getPostProcessingData()),H)for(P in H)if(P&&(G=P[0].toUpperCase()+P.slice(1),u=v[G])){z[G]=!0,i=H[P];var j=!!i.enable;r.enableModule(G,j),G="scene"+G,Z.a(G,j),u.resetProperties&&u.resetProperties();for(U in i)if("enable"!==U){var T=i[U];u[U]=T,Z.a(G+U[0].toUpperCase()+U.slice(1),T)}}for(G in v)z[G]||(u=v[G],u.enable=!1,u.resetProperties&&u.resetProperties())},r.getRenderTarget=function(){return g},r.blitScreen=function(u,A,O,W,$){var b=l.getGL();if(b&&(G||Q())){u&&(u.bind(b),l.setViewport(b,0,0,u.width,u.height)),$&&$.clear===!1||b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),O||(O=j),O.bind(),b.activeTexture(b.TEXTURE0+0),cj(b,A||b._emptyTexture);var s=O.uniforms;s.image=0;var C=1;if(W)for(var R in W){var i=W[R];i instanceof WebGLTexture&&(b.activeTexture(b.TEXTURE0+C),cj(b,i),i=C,C++),s[R]=i}if(x.upload(),y.upload(),O.attributes.pos.pointer(y),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0),C>1)for(;--C>=0;)b.activeTexture(b.TEXTURE0+C),cj(b,null);else cj(b,null);u&&u.unbind(b)}},r.decodeShader=function(b){var I,A,E,k="",R="";for(E=0;E<b.length;E++)I=b[E],"%"===I?I="'":"a"===I?I='"':"]"===I&&(I="\\"),A=String.fromCharCode(I.charCodeAt(0)-1),E%2?R+=A:k=A+k;return R+k},r.createShader=function(l,I,J){var h,Y;if("string"==typeof I){var Z=I.indexOf("^#");h=r.decodeShader(I.substr(0,Z)),Y=r.decodeShader(I.substr(Z+2))}else h=I.vs,Y=I.fs;if(J){var o=J(h,Y);o&&o.vs&&(h=o.vs),o&&o.fs&&(Y=o.fs)}return new vb.Shader(l,h,Y)},r.enableModule=function(w,S){var C,B,P,q=w.split(",");for(C=0,B=q.length;B>C;C++)P=q[C].trim(),v[P]&&(v[P].enable=S);V=!1;for(P in v)if(v[P].enable){V=!0;break}};var Q=function(){if(G)return!1;var s=l.getGL();return s?(g=new ae.RenderTarget(l,s,null,null,{samples:b.renderTextureSamples||1,minFilter:s.LINEAR,magFilter:s.LINEAR,depthFormat:l.isWebGL2()?s.DEPTH_COMPONENT32F:null}),j=new vb.Shader(s,L.vs,L.fs),x=vb.Buffer.createIndexBuffer(s,new Uint16Array([0,2,1,1,2,3])),y=vb.Buffer.createVertexBuffer(s,new Float32Array([0,0,1,0,0,1,1,1])),G=!0):!1},L=r.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};r.contextLost=function(){G=!1;for(var A in v)v[A].contextLost&&v[A].contextLost()},r.render=function(Y,u,n,j){if(V&&(G||Q())){g.setSize(Y,u,n),g.bind(Y);var Z=Y.getParameter(Y.COLOR_CLEAR_VALUE);Z&&0===Z[0]&&0===Z[1]&&0===Z[2]&&0===Z[3]?Z=null:br(Y,[0,0,0,0]),Y.clear(Y.COLOR_BUFFER_BIT|Y.DEPTH_BUFFER_BIT),l.setViewport(Y,0,0,u,n),j=j||{};var L=j.renderAxis!==!1,e=j.renderEdit!==!1;j.renderAxis=j.renderEdit=!1,l.renderScene(j),g.unbind(Y);for(var B=0,t=l._glCapabilities.maxAttributes;t>B;B++)Y.disableVertexAttribArray(B);var $,A=g;for($ in v)A=v[$]._42(Y,A)||A;l.setViewport(Y,0,0,u,n),Z&&br(Y,Z);var U=r.getModule("Fxaa");return U&&U.enable?r.blitScreen(null,A.texture,U.getShader(Y),{resolution:[1/u,1/n]}):r.blitScreen(null,A.texture),Y.useProgram(l._prg),l._renderAxisAndEditHelper(L,e),!0}}},tt=_.graph3d.PostProcessing.HueSaturation=function(m){function v(){var M=m.getGL();return M?(l=new ae.RenderTarget(m,M),V=m._postProcessing.createShader(M,tt.hueSaturationShader),x=vb.Buffer.createIndexBuffer(M,new Uint16Array([0,2,1,1,2,3])),n=vb.Buffer.createVertexBuffer(M,new Float32Array([0,0,1,0,0,1,1,1])),s=!0):!1}var x,n,V,l,O=this,E=!1,s=!1,F=[],u=[],o=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var t=this.serializeProperties;for(var G in t)this[G]=t[G]},this.resetProperties(),S.defineProperties(O,{enable:{get:function(){return E},set:function(V){!!E!=!!V&&(E=V,m.iv())}},hue:{get:function(){return F.map(function(h){return e(180*h)})},set:function(s){if(F!==s&&7===s.length){for(var A=0;7>A;A++)F[A]=s[A]/180;m.iv()}}},saturation:{get:function(){return u.map(function(M){return e(100*M)})},set:function(T){if(u!==T&&7===T.length){for(var I=0;7>I;I++)u[I]=T[I]/100;m.iv()}}},lightness:{get:function(){return o.map(function(P){return e(100*P)})},set:function(r){if(o!==r&&7===r.length){for(var u=0;7>u;u++)o[u]=r[u]/100;m.iv()}}}}),O.contextLost=function(){s=!1},O._42=function(Q,c){if(E&&(s||v())){var S=c.width,g=c.height;if(S&&g){l.setSize(Q,S,g),Kp(Q,l.frame),m.setViewport(Q,0,0,l.width,l.height),Q.clear(Q.COLOR_BUFFER_BIT|Q.DEPTH_BUFFER_BIT),V.bind(),Q.activeTexture(Q.TEXTURE0+0),cj(Q,c.texture);var i=V.uniforms;return i.image=0,i.hue=F,i.saturation=u,i.lightness=o,x.upload(),n.upload(),V.attributes.pos.pointer(n),Q.drawElements(Q.TRIANGLES,6,Q.UNSIGNED_SHORT,0),cj(Q,null),kg(Q),l}}}};tt.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";
var ut=_.graph3d.PostProcessing.Bloom=function(h){function Y(){var n=h.getGL();if(n)for(var J=h._postProcessing,u=0;v>u;u++)A[u]=J.createShader(n,ut._35Q,function(D,y){return{fs:y.replace(/DEFINE_VALUE/g,Z[u]).replace("%OVERRIDE_ALPHA_DEFINE%",I?"#define OVERRIDE_ALPHA":"")}})}function m(){var H=h.getWidth(),J=h.getHeight();if(!H||!J)return!1;var B=h.getGL();if(!B)return!1;u=[H,J];var x,X=Math.round(u[0]/2),F=Math.round(u[1]/2);for(r=new ae.RenderTarget(h,B,X,F),p=[],L=[],x=0;v>x;x++)p.push(new ae.RenderTarget(h,B,X,F)),L.push(new ae.RenderTarget(h,B,X,F)),X=Math.round(X/2),F=Math.round(F/2);var E=h._postProcessing;return g=E.createShader(B,ut._34Q),Y(),C=E.createShader(B,ut._36Q,function(I,K){return{fs:K.replace(/NUM_MIPS/g,v)}}),R=E.createShader(B,ut.finalShader),j=vb.Buffer.createIndexBuffer(B,new Uint16Array([0,2,1,1,2,3])),Q=vb.Buffer.createVertexBuffer(B,new Float32Array([0,0,1,0,0,1,1,1])),d=!0}var W,w,l,I,D,j,Q,s,E=this,P=!1,d=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var q=this.serializeProperties;for(var U in q)this[U]=q[U]},S.defineProperties(E,{enable:{get:function(){return P},set:function(X){!!P!=!!X&&(P=X,h.iv())}},strength:{get:function(){return W},set:function(o){W!==o&&(W=o,h.iv())}},threshold:{get:function(){return w},set:function(d){w!==d&&(w=d,h.iv())}},radius:{get:function(){return l},set:function(t){l!==t&&(l=t,h.iv())}},overrideAlpha:{get:function(){return I},set:function(P){!!I!=!!P&&(I=P,d&&Y(),h.iv())}},selective:{get:function(){return D},set:function(F){!!D!=!!F&&(D=!!F,h.iv())}}}),this.resetProperties();var r,g,C,R,u=[256,256],p=[],L=[],v=5,Z=[3,5,7,9,11],A=[];E.contextLost=function(){d=!1,s=null},E._42=function(Y,K){function o(R,c,t,U){Kp(Y,c.frame),h.setViewport(Y,0,0,c.width,c.height),U?U(Y):Y.clear(Y.COLOR_BUFFER_BIT|Y.DEPTH_BUFFER_BIT),E!==R&&R.bind();var m=0;for(var f in t){var Z=t[f];Z instanceof WebGLTexture&&(Y.activeTexture(Y.TEXTURE0+m),cj(Y,Z),Z=m,m++),R.uniforms[f]=Z}for(E!==R&&(j.upload(),Q.upload(),R.attributes.pos.pointer(Q),E=R),Y.drawElements(Y.TRIANGLES,6,Y.UNSIGNED_SHORT,0);m--;)Y.activeTexture(Y.TEXTURE0+m),cj(Y,null);kg(Y)}if(P&&(d||m())){var E;if(D){s||(s=new ae.RenderTarget(h,Y)),s.setSize(Y,K.width,K.height),s.bind(Y);var G=Y.getParameter(Y.COLOR_CLEAR_VALUE);G&&0===G[0]&&0===G[1]&&0===G[2]&&1===G[3]?G=null:br(Y,[0,0,0,1]),Y.clear(Y.COLOR_BUFFER_BIT|Y.DEPTH_BUFFER_BIT),h.setViewport(Y,0,0,K.width,K.height),Y._blooming=!0,h.syncRenderState(),h.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),Y._blooming=!1,G&&br(Y,G),s.unbind(Y)}o(g,r,{smoothWidth:.01,luminosityThreshold:w,tDiffuse:D?s.texture:K.texture});var V,q=r,b=Math.round(u[0]/2),n=Math.round(u[1]/2);for(V=0;v>V;V++)o(A[V],p[V],{colorTexture:q.texture,direction:[1,0],texSize:[b,n]}),o(A[V],L[V],{colorTexture:p[V].texture,direction:[0,1],texSize:[b,n]}),b=Math.round(b/2),n=Math.round(n/2),q=L[V];return o(C,p[0],{blurTexture1:L[0].texture,blurTexture2:L[1].texture,blurTexture3:L[2].texture,blurTexture4:L[3].texture,blurTexture5:L[4].texture,bloomStrength:W,bloomRadius:l,bloomTintColor:[1,1,1]}),o(R,K,{image:p[0].texture},function(K){Gh.for(K).glState.blend.apply({enabled:!0,equation:K.FUNC_ADD,func:[K.SRC_ALPHA,K.ONE]})}),Gh.for(Y).glState.blend.apply({equation:Y.FUNC_ADD,func:[Y.SRC_ALPHA,Y.ONE_MINUS_SRC_ALPHA,Y.ONE,Y.ONE_MINUS_SRC_ALPHA]}),K}}};ut._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",ut._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",ut._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",ut.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var vt=_.graph3d.PostProcessing.Dof=function(T){function P(){var m=T.getGL();return m?(h=new ae.RenderTarget(T,m),$=T._postProcessing.createShader(m,vt._38Q),p=vb.Buffer.createIndexBuffer(m,new Uint16Array([0,2,1,1,2,3])),a=vb.Buffer.createVertexBuffer(m,new Float32Array([0,0,1,0,0,1,1,1])),i=!0):!1}function U(c,P,h,t){J=null;var j=c.getCanvas(),z=j.width,g=j.height;if(h=h||1024,z>h||g>h){var b=h/Math.max(z,g);z=Math.round(z*b),g=Math.round(g*b),n||(n=km()),j=m.resizeImage(j,z,g,n)}var K=T.getGL();if(y||(y=K.createTexture()),H=cm(K,j,y),X=P||.01,Q=!0,T.iv(),t--){if(J)return;J=m.callLater(function(){U(c,P,h,t)})}}var h,$,p,a,H,q,W,B,n,y,J,r=this,C=!1,i=!1,X=0,Q=!1,R=_k.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var u=this.serializeProperties;for(var t in u)this[t]=u[t]},S.defineProperties(r,{enable:{get:function(){return C},set:function(k){!!C!=!!k&&(C=k,k||(Q=!1),T.iv())}},image:{get:function(){return q},set:function(O){q!==O&&(q=O,Q=!1,H&&(T.deleteTexture(R),H=null),T.iv())}},maxblur:{get:function(){return W},set:function(n){W!==n&&(W=n,T.iv())}},aperture:{get:function(){return B},set:function(K){B!==K&&(B=K,T.iv())}}}),this.resetProperties(),r.contextLost=function(){i=!1,H&&(T.deleteTexture(R),H=null)},r.setImageFromGraphView=function(w,P,E){this.image=null,U(w,P,E,2)},r._42=function(G,N){function w(o,k,c,v){Kp(G,k.frame),T.setViewport(G,0,0,k.width,k.height),v?v(G):G.clear(G.COLOR_BUFFER_BIT|G.DEPTH_BUFFER_BIT),q!==o&&o.bind();var r=0;for(var l in c){var N=c[l];N instanceof WebGLTexture&&(G.activeTexture(G.TEXTURE0+r),cj(G,N),N=r,r++),o.uniforms[l]=N}for(q!==o&&(p.upload(),a.upload(),o.attributes.pos.pointer(a),q=o),G.drawElements(G.TRIANGLES,6,G.UNSIGNED_SHORT,0);r--;)G.activeTexture(G.TEXTURE0+r),cj(G,null);kg(G)}if(C&&(i||P())){var q;if(!H){var d=Om(this.image);if(!d||!d.comps&&!d.tagName)return N;_.Default.setImage(R,d),H=T.getTexture(R)}var u=N.width,A=N.height;if(u&&A)return h.setSize(G,u,A),w($,h,{tColor:N.texture,tDepth:H,aspect:u/A,aperture:this.aperture,maxblur:this.maxblur,useG2d:Q,threshold:X}),h}}};vt._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<dfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!)vEo3jfgspvsuny!fgum!p>b,u!!mopfdbs<D*m!j5qs<vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3fdspvoutyuf!ug!m>p,b!um!pVdoq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dwf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdmf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<tbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E3!fssfvuuvysfou!!e>p,u!)m!pwd-!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<ud~fsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdCB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<df~w!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!j<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|sp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1.~!-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|fu\n!s>f,u!vmspod!q<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!,~!zwyp/jweV!wn!b-jsop)m*p!D|u!w)fEd33f!sevpugycfmuv!s><,!wmfpdd3!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</1j!g-!:)3v/t1f.E!f)q3udif*w!!|)!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!w<V*w!!8*s!v*m<cg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<du~dffqmttbf!!+|!*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*!<**<!8gsmvpmbcug!pbem!q+i!b*<!ujdgf!s)svptdfuHd3feq*t!b|!+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db!<**<!8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdyc<m*v!s:!s*v!m*c<gp~e!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<62w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E3wffsdv3u!yefpug!c>m,v!sm5p!d>!<e*p!g:csmvvmsc!g+p!e1!/+5!<*!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<Dud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!duD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfs";var wt=_.graph3d.PostProcessing.Blur=function(P){function u(){var Y=P.getGL();return Y?(j=new ae.RenderTarget(P,Y),G=P._postProcessing.createShader(Y,wt.hBlurShader),Z=P._postProcessing.createShader(Y,wt.vBlurShader),K=!0):!1}var G,Z,j,J,M,v,n,W,c,r=this,U=!1,K=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var H=this.serializeProperties;for(var z in H)this[z]=H[z]},S.defineProperties(r,{enable:{get:function(){return U},set:function(H){!!U!=!!H&&(U=H,H?P.addRenderLayerListener(g,this):P.removeRenderLayerListener(g,this),P.iv())}},downSample:{get:function(){return n},set:function(M){n!==M&&(n=M,P.iv)}},value:{get:function(){return v},set:function(K){v!==K&&(v=K,P.iv())}},iterations:{get:function(){return W},set:function(m){W!==m&&(W=m,P.iv())}},layer:{get:function(){return c},set:function(i){c!==i&&(c=i,P.iv())}}}),this.resetProperties();var g=function(_){if(U&&_.layer===c&&"post"===_.phase){var x=P.getGL();if(!P._picking&&!P.isReflecting(x)){var G=P._postProcessing.getRenderTarget();G.unbind(x);for(var Z=0,W=P._glCapabilities.maxAttributes;W>Z;Z++)x.disableVertexAttribArray(Z);r.drawImpl(x,G),G.bind(x),x.useProgram(P._prg)}}};r._42=function(){},r.contextLost=function(){K=!1,J=null},r.drawImpl=function(s,p,h,L,q){if(K||u()){var X,$;if(p?(X=p.width,$=p.height):(X=P._viewport[2],$=P._viewport[3]),X&&$){var g=P._postProcessing;"boolean"!=typeof L&&(L=n),h==z&&(h=v),q==z&&(q=W),q=Math.max(1,Math.round(q));var C=Gh.for(s).glState.depth,w=C.enabled;if(C.enabled=!1,L){h/=2;var f=[X,$];X/=2,$/=2,J||(J=new ae.RenderTarget(P,s),M=g.createShader(s,wt.downSampleShader)),J.setSize(s,X,$),g.blitScreen(J,p.texture,M,{texelSize:[1/f[0],1/f[1]]}),p.setSize(s,X,$)}else J&&J.setSize(0,0);j.setSize(s,X,$);for(var e=[],a=0;q>a;a++)e.push(h),h=Math.max(1,Math.floor(h/2));for(var a=0;q>a;a++){var E=e[q-a-1],A=L&&0===a?J.texture:p.texture;g.blitScreen(j,A,G,{value:E/X}),L&&a===q-1&&p.setSize(s,f[0],f[1]),g.blitScreen(p,j.texture,Z,{value:E/$})}return C.enabled=w,p}}}};wt.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",wt.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",wt.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var xt=_.graph3d.PostProcessing.Glitch=function(o){function u(){if(g&&r){V=Date.now(),h=0,Y=1e3*$(r[0],r[1]),d=[];for(var Q=1,E=g.length;E>Q;Q+=2)d.push((Q>1?d[d.length-1]:0)+Y*g[Q]/L)}}function D(){o.redraw()}function K(){var m=o.getGL();if(!m)return!1;x=new ae.RenderTarget(o,m),M=o._postProcessing.createShader(m,xt.Shader);for(var b=s*s,e=ee(s,s),c=e.getImageData(0,0,s,s),R=c.data,k=0;b>k;k++)R[3*k+0]=W(256),R[3*k+1]=W(256),R[3*k+2]=W(256),R[3*k+3]=W(256);return e.putImageData(c,0,0),v=cm(m,Pj),Z=!0}var x,M,Y,V,h,d,v,k,r,g,f=this,N=!1,Z=!1,$=_k.randomFloat,W=_k.randomInt,L=0,s=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var r=this.serializeProperties;for(var U in r)this[U]=r[U]},S.defineProperties(f,{enable:{get:function(){return N},set:function(E){!!N!=!!E&&(N=E,E&&u(),o.iv())}},onlyReflector:{get:function(){return k},set:function(m){!!k!=!!m&&(k=m,o.iv())}},period:{get:function(){return r},set:function(d){r=d,u(),o.iv()}},intensity:{get:function(){return g},set:function(W){W||(W=[1,1]),g=W,L=0;for(var n=1,E=W.length;E>n;n+=2)L+=W[n];u(),o.iv()}}}),this.resetProperties(),f.contextLost=function(){Z=!1},f._42=function(w,B){if(N&&(Z||K())){var q=!!o.isReflecting(w);if(q===!!k){var l=B.width,X=B.height;if(l&&X){var E=o._postProcessing,y=Gh.for(w).glState.depth,c=y.enabled;y.enabled=!1,x.setSize(w,l,X);var Q,b=Date.now();b-V>d[h]&&(h++,h>=d.length&&u()),Q=g[2*h];var e={seed:Math.random(),byp:Q?0:1,tDisp:v};return Q&&(e.angle=$(-Math.PI,Math.PI),e.distortion_x=$(0,1),e.distortion_y=$(0,1),e.amount=Math.random()/30*Q,e.seed_x=$(-1,1)*Q,e.seed_y=$(-1,1)*Q),E.blitScreen(x,B.texture,M,e),y.enabled=c,requestAnimationFrame(D),x}}}}};xt.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var yt=_.graph3d.PostProcessing.Fxaa=function(A){var y,Q=this,O=!1;S.defineProperties(Q,{enable:{get:function(){return O},set:function(D){!!O!=!!D&&(O=D,A.iv())}}}),Q.contextLost=function(){y=null},Q.getShader=function(C){if(y)return y;var t=A.getPostProcessingModule();return y=t.createShader(C,{vs:t.blitScreenShaderSrc.vs,fs:t.decodeShader(yt.ShaderSourceFs)})},Q._42=function(){}};yt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",Lp(m,{accordionViewExpandIcon:Jf(Fk),accordionViewCollapseIcon:Jf(Fk,!0),accordionViewLabelColor:_c,accordionViewLabelFont:Fc,accordionViewTitleBackground:Sg,accordionViewSelectBackground:Up,accordionViewSelectWidth:3,accordionViewSeparatorColor:B,splitViewDividerSize:1,splitViewDividerBackground:Sg,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:qn,rect:[2,2,12,12],background:Fk}]},propertyViewLabelColor:ne,propertyViewLabelSelectColor:_c,propertyViewLabelFont:Fc,propertyViewExpandIcon:Jf(hh),propertyViewCollapseIcon:Jf(hh,!0),propertyViewBackground:Rr,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Jd,propertyViewColumnLineColor:Jd,propertyViewSelectBackground:Up,listViewLabelColor:ne,listViewLabelSelectColor:_c,listViewLabelFont:Fc,listViewRowLineVisible:!1,listViewRowLineColor:Jd,listViewSelectBackground:Up,treeViewLabelColor:ne,treeViewLabelSelectColor:_c,treeViewLabelFont:Fc,treeViewExpandIcon:Jf(Sr),treeViewCollapseIcon:Jf(Sr,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Jd,treeViewSelectBackground:Up,treeViewDoubleClickToToggle:!0,tableViewLabelColor:ne,tableViewLabelSelectColor:_c,tableViewLabelFont:Fc,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Jd,tableViewColumnLineColor:Jd,tableViewSelectBackground:Up,treeTableViewLabelColor:ne,treeTableViewLabelSelectColor:_c,treeTableViewLabelFont:Fc,treeTableViewExpandIcon:Jf(Sr),treeTableViewCollapseIcon:Jf(Sr,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Jd,treeTableViewColumnLineColor:Jd,treeTableViewSelectBackground:Up,tableHeaderLabelColor:ne,tableHeaderLabelFont:Fc,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:hr,tableHeaderBackground:Rr,tableHeaderMoveBackground:an,tableHeaderInsertColor:Up,tableHeaderSortDescIcon:If(hh,!0),tableHeaderSortAscIcon:If(hh),tabViewTabGap:1,tabViewLabelColor:_c,tabViewLabelFont:Fc,tabViewTabBackground:Sg,tabViewSelectWidth:3,tabViewSelectBackground:Up,tabViewMoveBackground:an,tabViewInsertColor:Up,toolbarLabelColor:ne,toolbarLabelSelectColor:_c,toolbarLabelFont:Fc,toolbarBackground:Rr,toolbarSelectBackground:Up,toolbarItemGap:8,toolbarSeparatorColor:Dr},!0);
var zt={translateX:1,sortColumn:1},At={sortable:1,sortOrder:1,sortFunc:1},Bt={focusData:1},Ct={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Dt={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Et=function(H,V){V.add(H),H.hasChildren()&&H.eachChild(function(F){Et(F,V)})},Ft=function(y,L,i,H,J,t,W,f,e,U,w){var V,I=i.getValueType(U),P=i.getAlign(U);if(i.getEnumValues(U)){var Y=i.toEnumLabel(L,U),v=Vp||0,F=0,N=t,n=m.getTextSize(H,Y).width;return V=Om(i.toEnumIcon(L,U)),V&&(F=t+Vp/2,"center"===P?F+=(f-(v+n))/2:"right"===P&&(F=F+f-(v+n)),Mn(y,V,F,W+e/2,U,w),N=F+Vp/2),Y!=z&&(V?Rd(y,Y,H,J,N,W,f-(N-t),e):Rd(y,Y,H,J,t,W,f,e,P)),void 0}return L=i.formatValue(L),L!=z?I===Wq?(rr(y,t,W,f,e,L),void 0):I===Qh||!I&&Zn(L)?(V=Om(L?Bn:qq),Mn(y,V,t+f/2,W+e/2,U,w),void 0):(Rd(y,L,H,J,t,W,f,e,P),void 0):void 0},Gt=function(l,N){var L=N.view,i=Ll(l),v=N.column||N.property;L.getDataModel().beginTransaction(),N.editor=l,l.info=N,L.setCurrentEditor(l),L.getView().insertBefore(i,L._79O),fs(l,N.editorRect),l.setFocus?l.setFocus():pk(l),l.commitValue=function(y,D){l._17Q&&(l=l._17Q),D||L.setValue(N.data,v,l.getValue?l.getValue():l.value),l.close&&l.close(),zr(i)},v.onEditorCreated&&v.onEditorCreated(N)},Ht=function(c,E,x,e,f){var o=ai(c,x),i=E.value,s=E.view,p=f.getValueType(E.data);return o.onblur=o.onchange=function(){s.endEditing()},"input"===c?(i=f.formatValue(i),i!=z&&(o.value=i),o.onkeydown=function(f){Ud(f)?s.endEditing():Vq(f)&&s.endEditing(!0)},(p===Tr||p===tg)&&C(o,Mb,m.numberListener)):c===qc&&e.forEach(function(Z){var w=T.createElement("option");w.innerHTML=f.toEnumLabel(Z),w.value=Z,f.isEnumEqual(i,Z)&&(w.selected=!0),as(o,w)}),Gt(o,E),o},It=_.widget={},Jt=function(b,c,p){Fm(j+".widget."+b,c,p)};Lp(Yh,{ms_value:function(A){A.getValue=function(B){var F=this.getItemById(B),T=F.element;return hq(T)?T:T?T.getValue?T.getValue():T.value:F.selected},A.setValue=function(e,I){var z=this.getItemById(e);if(z){var Z=z.element;Z&&!hq(Z)?Z.setValue?Z.setValue(I):Z.value=I:Zn(I)?(z.selected=I,this.iv()):(z.element=I,this.iv())}},A.v=function(t,E){var p=this;if(2===arguments.length)p.setValue(t,E);else{if(!Th(t))return p.getValue(t);for(var F in t)p.setValue(F,t[F])}return p}},_46o:function(J){J._icon=z,J._accessType=z,J._valueType=z,J._editable=!1,J._batchEditable=!0,J._align=Mq,J._nullable=!0,J._emptiable=!1,J.setParent=gm,J.formatValue=function(R){var V=this,P=V._valueType;return V.getEnumValues()?V.toEnumLabel(R):P===Qh?!!R:R!=z&&P===Tr?w(R):R},J.setEnum=function(v,y,H,K,R,$,B){var o=this;v&&!Jm(v)&&v.values&&(K=v.editable,H=v.icons,y=v.labels,R=v.strict,$=v.maxHeight,B=v.dropDownWidth,v=v.values),pj(v)&&(v=v._as),pj(y)&&(y=y._as),pj(H)&&(H=H._as),o._enumValues=v,o._enumLabels=y,o._enumIcons=H,o._enumEditable=K,o._enumStrict=R==z?!0:R,o._enumMaxHeight=$,o._enumDropDownWidth=B,v&&v.length&&Aj(v[0])&&(o._valueType=tg),o.fp("enum",!1,!0)},J.getEnumDropDownWidth=function(){return this._enumDropDownWidth},J.getEnumMaxHeight=function(){return this._enumMaxHeight},J.isEnumEditable=function(){return this._enumEditable},J.getEnumValues=function(){return this._enumValues},J.getEnumLabels=function(){return this._enumLabels},J.getEnumIcons=function(){return this._enumIcons},J.isEnumStrict=function(){return this._enumStrict},J.isEnumEqual=function(F,j){return this._enumStrict?F===j:F==j},J.toEnumLabel=function(D,h){var F=this,M=F.getEnumValues(h),y=F.getEnumLabels(h);if(M&&y)for(var N=0;N<M.length;N++)if(F.isEnumEqual(D,M[N]))return y[N];return D},J.toEnumIcon=function(s,K){var y=this,S=y.getEnumValues(K),i=y.getEnumIcons(K);if(S&&i)for(var b=0;b<S.length;b++)if(y.isEnumEqual(s,S[b]))return i[b];return B}},_45o:function(o){o._87o=function(r,H,X,z,V,P){if(r){var G=this,v=G._90I,S=fo(1);G._columnLineVisible&&(V-=1),G._rowLineVisible&&(P-=1),0>=V||0>=P||(G._90I||(v=G._90I={}),v[H]||(v[H]=new An),fs(S,G.tx()+X,G.ty()+z,V,P),as(S,r),G._view.insertBefore(S,G._79O),r.onParentAdded&&r.onParentAdded(S),v[H].add(S))}},o._76o=function(){var U=this,n=U._90I;if(n){for(var B in n)n[B].each(function(q){zr(q)});delete U._90I}},o._77o=function(S){var W=this;if(W._90I){var y=W._90I[S];y&&(y.each(function(V){zr(V)}),delete W._90I[S])}}},_47o:function(u){u.getValue=function(q,J){return J.getValue?J.getValue(q,J,this):Zh(q,J.getAccessType(),J.getName())},u.setValue=function(K,P,c){if(P.isEmptiable(K)||""!==c||(c=B),P.isNullable(K)||c!=z){var _=this,V=P.getName(K),n=P.getAccessType(K),Z=P.getValueType(K);Z===Tr&&hq(c)?c=Mm(c):Z===tg&&hq(c)?c=parseFloat(c):Z===Qh&&hq(c)&&(c="true"===c),_._batchEditable&&P._batchEditable&&_.isSelected(K)?_.sm().each(function(H){P.setValue?P.setValue(H,P,c,_):Ij(H,n,V,c)}):P.setValue?P.setValue(K,P,c,_):Ij(K,n,V,c)}},u.setCurrentEditor=function(R){this.endEditing(),this._currentEditor=R,this.redraw()},u.isEditing=function(T,B){var b=this,Z=b._currentEditor;if(!Z)return!1;if(B){var X=Z.info;return X?(X.column||X.property)===B&&X.data===T:!1}return!0},u.endEditing=function(d){var O=this,g=O._currentEditor;g&&(delete O._currentEditor,g.commitValue&&g.commitValue(g.info,d),O.redraw(),O.getDataModel().endTransaction())},u.beginEditing=function(A){this.endEditing();var c=this,W=A.column||A.property;if(W.beginEditing)W.beginEditing(A);else{var E=A.data,Q=A.value,O=c.getSelectBackground(E),S=W.getEnumValues(E),P=W.getSlider(E),x=W.getColorPicker(E);if(P){var G=Hn(It.Slider,P);return G.setValue(Q),G.getView().onblur=function(){c.endEditing()},G.isInstant()&&(G.onValueChanged=function(){c.setValue(E,W,G.getValue())}),Gt(G,A),void 0}if(x||W.getValueType(E)===Wq){var K=Hn(It.ColorPicker,x);K.setValue(Q);var C=K.onClosed;return K.onClosed=function(){c.endEditing(),C&&C.call(this)},K.isInstant()&&(K.onValueChanged=function(q,D){c.setValue(E,W,D)}),Gt(K,A),K.open(),void 0}if(S){if(It.ComboBox){var g=new It.ComboBox;g.setValue(Q),g.setValues(S),g.setLabels(W.getEnumLabels(E)),g.setIcons(W.getEnumIcons(E)),g.setEditable(W.isEnumEditable(E)),g.setStrict(W.isEnumStrict(E)),g.setMaxHeight(W.getEnumMaxHeight(E)),g.setDropDownWidth(W.getEnumDropDownWidth(E)),g.onClosed=function(){c.endEditing()},Gt(g,A),g.open()}else Ht(qc,A,O,S,W);return}var b=W.getValueType(E);if(b===Qh||Zn(Q))return c.setValue(E,W,!Q),void 0;if(W.getItemEditor(E)){var _=Br(W.getItemEditor(E)),l=new _(E,W,c,A),j=l.getView();return j._17Q=l,l.setValue(Q),Ro(j),Gt(j,A),l.editBeginning&&l.editBeginning(),void 0}Ht("input",A,O,z,W)}}},_44o:function(B){B.init=function(p){var N=this,k=N.th=new Yt(p),S=N._view=Oc(1,N);N.tv=N._tableView=p,as(S,k.getView()),as(S,p.getView()),k.mp(function(z){z.property===bg&&N.iv()}),N.iv()},B.getTableView=function(){return this.tv},B.getTableHeader=function(){return this.th},B.getDataModel=function(){return this.tv.dm()},B.getColumnModel=function(){return this.tv.getColumnModel()},B.setColumns=function(w){this.tv.setColumns(w)},B.addColumns=function(X){this.tv.addColumns(X)},B.endEditing=function(){this.tv.endEditing()},B.validateImpl=function(){var i=this,Y=i.th,o=dm(Y),g={x:0,y:0,width:i.getWidth(),height:o};fs(Y,g),g.y=o,g.height=$(0,i.getHeight()-o),fs(i.tv,g)}},ms_vs:function(X){X._41o=function(){return this._29I.height<this._59I},X._43o=function(){var F=this;F._41o()&&(F._58I||(Vr(function(){F._94O()},Yc),F.iv()),F._58I=new Date)},X._94O=function(){var W=this;if(W._58I){var h=new Date;h.getTime()-W._58I.getTime()>=Yc?(delete W._58I,W.iv()):Vr(function(){W._94O()},Yc)}},X._93I=function(){var g=this,M=g._27I;if(g._58I||!g._autoHideScrollBar){M||as(g._79O,M=g._27I=fo());var P=g._29I,E=P.height,l=g._59I,L=g.getScrollBarSize(),D=P.width-L-2,s=E*(-g.ty()/l),w=E*(E/l),B=M.style;l>E?(Xq>w&&(s=s+w/2-Xq/2,0>s&&(s=0),s+Xq>E&&(s=E-Xq),w=Xq),B.visibility=xp,B.background=g.getScrollBarColor(),B.borderRadius=L/2+Eq,fs(M,D,s,L,w)):B.visibility=kf}else M&&(M.style.visibility=kf)}},ms_hs:function(B){B._40o=function(){return this._29I.width<this._91I},B._42o=function(){var C=this;C._40o()&&(C._95O||(Vr(function(){C._94I()},Yc),C.iv()),C._95O=new Date)},B._94I=function(){var z=this;if(z._95O){var s=new Date;s.getTime()-z._95O.getTime()>=Yc?(delete z._95O,z.iv()):Vr(function(){z._94I()},Yc)}},B._92I=function(){var g=this,y=g._28I;if(g._95O||!g._autoHideScrollBar){y||as(g._79O,y=g._28I=fo());var b=g._29I,a=b.width,F=g._91I,f=g.getScrollBarSize(),M=b.height-f-2,O=a*(-g.tx()/F),J=a*(a/F),C=y.style;F>a?(Xq>J&&(O=O+J/2-Xq/2,0>O&&(O=0),O+Xq>a&&(O=a-Xq),J=Xq),C.visibility=xp,C.background=g.getScrollBarColor(),C.borderRadius=f/2+Eq,fs(y,O,M,J,f)):C.visibility=kf}else y&&(y.style.visibility=kf)}}}),ej(Bn,$c(16,16,[{type:Ol,rect:[1,1,14,14],background:Up},{type:Kh,rect:[1,1,14,14],width:1,color:Iq},{type:Sd,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),ej(qq,$c(16,16,{type:Kh,rect:[1,1,14,14],width:1,color:Iq})),ej(_r,$c(16,16,[{type:qs,rect:[2,2,12,12],borderWidth:1,borderColor:Iq,background:"#FFF"},{type:qs,rect:[4,4,8,8],background:Up}])),ej(_q,$c(16,16,{type:qs,rect:[2,2,12,12],borderWidth:1,borderColor:Iq})),Yh._15Q=function(R){R._29I=ac,R._59I=0,R._91I=0,R._5o=function(w){var K=this;K._30I=new An,K._rows=new An,K._rowMap={},K._31I=0,K._14I=0,K._view=Oc(1,K),K._canvas=km(K._view),as(K._view,K._79O=fo()),K.dm(w?w:new wp)},R.getCheckIcon=function(F){var k=this.sm(),J=k.co(F);return k.sg()?Om(J?_r:_q):Om(J?Bn:qq)},R.checkData=function(w){var I=this.sm(),B=I.co(w);I.sg()&&B||(this._32o=1,B?I.rs(w):I.as(w),delete this._32o)},R.getDataAt=function(D){D.target&&(D=this.lp(D));var F=e(D.y/this._rowHeight),O=this._rows;return 0>F||F>=O.size()?z:O.get(F)},R.onDataDoubleClicked=function(){},R.onDataClicked=function(){},R.adjustTranslateX=function(){return 0},R.adjustTranslateY=function(v){var q=this.getHeight()-this._59I;return q>v&&(v=q),v>0?0:w(v)},R.onPropertyChanged=function(A){var s=this,p=A.property;Ct[p]?s.ivm():Bt[p]||s.redraw(),p===Kr?s._42o():p===Kc&&s._43o()},R.getLabel=function(P){return P.toLabel()},R.getLabelFont=function(){return this._labelFont},R.getLabelColor=function(I){var O=this;if(O.isCheckMode()){if(O._focusData===I)return O._labelSelectColor}else if(O.isSelected(I))return O._labelSelectColor;return O._labelColor},R.getStartRowIndex=function(){return this._31I},R.getEndRowIndex=function(){return this._14I},R.getRowDatas=function(){return this._rows},R.getRowIndex=function(b){return this._rowMap[b._id]},R.getRowSize=function(){return this._rows.size()},R.getViewRect=function(){return zs(this._29I)},R.isVisible=function(i){return this._visibleFunc?this._visibleFunc(i):!0},R.getCurrentSortFunc=function(){return this._sortFunc},R.setDataModel=function(R){var g=this,Q=g._dataModel,k=g._selectionModel;Q!==R&&(Q&&(Q.umm(g.handleDataModelChange,g),Q.umd(g.handleDataPropertyChange,g),Q.umh(g.handleHierarchyChange,g),k||Q.sm().ums(g.handleSelectionChange,g)),g._dataModel=R,R.mm(g.handleDataModelChange,g),R.md(g.handleDataPropertyChange,g),R.mh(g.handleHierarchyChange,g),k?k._21I(R):R.sm().ms(g.handleSelectionChange,g),g.fp("dataModel",Q,R))},R.validateModel=function(){var W=this;W._rows.clear(),W._rowMap={},W.buildChildren(W._dataModel._roots);var X=W._rows=W._rows.toList(W.isVisible,W),p=0,d=W.getCurrentSortFunc(),z=X.size();for(d&&X.sort(d);z>p;p++)W._rowMap[X.get(p)._id]=p},R.buildChildren=function(U){var L=this;U.each(function(g){L._rows.add(g),L.buildChildren(g._children)})},R.handleDataModelChange=function(){this.ivm()},R.handleDataPropertyChange=function(v){"parent"===v.property?this.ivm():this.invalidateData(v.data)},R.handleHierarchyChange=function(){this.ivm()},R.handleSelectionChange=function(c){c.datas.each(this.invalidateData,this),this.onSelectionChanged(c)},R.onSelectionChanged=function(U){var l=this,G=l.sm();!l.isAutoMakeVisible()||1!==G.size()||"set"!==U.kind&&"append"!==U.kind||l._32o||l.makeVisible(G.ld())},R.handleBackgroundClick=function(A){ti(A)&&!this.isCheckMode()&&this.sm().cs()},R.makeVisible=function(e){e&&(this._23I=e,this.iv())},R.scrollToIndex=function(G){var L=this,S=L._29I,u=S.height,T=L._rowHeight,E=T*G;G>=0&&G<L._rows.size()&&u>0&&(E+T>S.y+u?L.ty(-E+u-T):E<S.y&&L.ty(-E))},R.autoScroll=function(A,t){var p=this,y=p._rowHeight,m=y,o=y/4,B=p._29I,g=p.lp(A),H={x:p.tx(),y:p.ty()};return y>0&&B&&(g.x-B.x<m?p.translate(o,0):B.x+B.width-g.x<m&&p.translate(-o,0),g.y-B.y<m?p.translate(0,o):B.y+B.height-g.y<m&&p.translate(0,-o)),H.x=p.tx()-H.x,H.y=p.ty()-H.y,t&&(t.x+=H.x,t.y+=H.y),H},R.getTopRowOrderSelection=function(){var C=this.sm().getTopSelection(),o={},x=new An;return C.each(function(b){o[b._id]=b}),this._rows.each(function(c){o[c._id]&&x.add(c)}),x},R.getRowOrderSelection=function(){var H=new An;return this._rows.each(function(g){this.isSelected(g)&&H.add(g)},this),H},R.ivm=function(){this.invalidateModel()},R.invalidateModel=function(){var g=this;g._96I||(g._96I=1,g._32I=1,delete g._24I),g.iv()},R.redraw=function(){var m=this;m._32I||(m._32I=1,delete m._24I,m.iv())},R.invalidateData=function(e){var Q=this;Ko?Q.redraw():Q._32I||(Q._24I||(Q._24I={}),Q._24I[e._id]=e,Q.iv())},R.getFocusData=function(){return this._focusData},R.setFocusDataById=function(m){this.setFocusData(this.dm().getDataById(m))},R.setFocusData=function(X){var j=this,v=j._focusData;v!==X&&(j._focusData=X,j.fp("focusData",v,X),v&&j.invalidateData(v),X&&(j.invalidateData(X),j.isAutoMakeVisible()&&j.makeVisible(X)))},R.drawRowBackground=function(x,E,h,o,G,v,f){var C=this,I=C.isCheckMode();(E===C._focusData&&I||h&&!I)&&rr(x,o,G,v,f,C.getSelectBackground(E))},R.drawData=function(h,H,y){var s=this,q=s._rowHeight,T=q*y,X=s._29I,u=X.x,l=X.width;h.save(),h.beginPath(),h.rect(u,T,l,q),h.clip(),s._87o(s.drawRow(h,H,s.isSelected(H),u,T,l,q),y,u,T,l,q),h.restore(),s._rowLineVisible&&rr(h,u,T+q-1,l,1,s._rowLineColor)},R._12I=function(H){var U=this,i=U._31I,D=U._29I,h=D.x,m=D.y,p=D.width,w=D.height;for(H.beginPath(),H.rect(h,m,p,w),H.clip(),H.clearRect(h,m,p,w),U._76o(),U._93db(H);i<U._14I;i++)U.drawData(H,U._rows.get(i),i);U._92db(H)},R._13I=function(u){for(var _,J=this,l=J._rowHeight,t=J._29I,o=t.x,H=t.width,O=J._31I,M=J._30I;O<J._14I;O++)_=J._rows.get(O),J._24I[_._id]&&M.add({data:_,index:O});M.isEmpty()||(u.beginPath(),M.each(function(L){u.rect(o,L.index*l,H,l)}),u.clip(),M.each(function(Y){u.clearRect(o,Y.index*l,H,l)}),M.each(function(H){J._77o(H.index)}),J._93db(u),M.each(function(h){J.drawData(u,h.data,h.index)}),J._92db(u),M.clear())},R.preValidateModel=function(){this.endEditing&&this.endEditing()},R.validateImpl=function(){var k=this,Y=k._canvas,H=k.getWidth(),C=k.getHeight(),I=k._rowHeight,B=k._32I;(H!==Y.clientWidth||C!==Y.clientHeight)&&(Eg(Y,H,C),B=1),k._96I&&(k.preValidateModel(),k.validateModel());var b=k._29I,T={x:-k.tx(),y:-k.ty(),width:H,height:C},w=k._rows.size(),v=rk(Y),n=k._23I;B||Df(T,b)||(B=1),k._29I=T,k._59I=w*I,k._31I=e(T.y/I),k._14I=u((T.y+T.height)/I),k._31I<0&&(k._31I=0),k._14I>w&&(k._14I=w),k._99I&&B&&k._99I();var f=k.tx(),Z=k.ty();(k._40o()||k._41o())&&(k._59I+=k.getScrollBarSize(),k._99I&&B&&(k._91I+=k.getScrollBarSize())),fl&&!fd&&(v.save(),tl(v,H/Vb.length,C/Vb.length,1)),tl(v,f,Z,1),B?k._12I(v):k._24I&&k._13I(v),k._93I(),k._92I(),v.restore(),k._32I=k._24I=k._96I=z,n&&(k.scrollToIndex(k.getRowIndex(n)),delete k._23I),k.tx(k.tx()),k.ty(k.ty())},R.canHandleSelectMode=function(){return!0}},Yh._48o=function(x){x._rootVisible=!0,x._rootData=z,x._35o=function(){this._expandMap={},this._levelMap={}},x.validateModel=function(){var L=this,F=L._rootData;L._rows.clear(),L._levelMap={},L._rowMap={},L._currentLevel=0,F?L._rootVisible?L.isVisible(F)&&L.buildData(F):L.buildChildren(F):L.buildChildren(),delete L._currentLevel},x.buildData=function(x){var G=this,c=x._id,i=G._rows;G._rowMap[c]=i.size(),i.add(x),G._levelMap[c]=G._currentLevel,G.isExpanded(x)&&(G._currentLevel++,G.buildChildren(x),G._currentLevel--)},x.buildChildren=function(w){var K=this,x=w?w._children:K._dataModel._roots,O=K.getCurrentSortFunc();O&&K.isChildrenSortable(w)?x.toList(K.isVisible,K).sort(O).each(K.buildData,K):x.each(function(h){K.isVisible(h)&&K.buildData(h)})},x.getLevel=function(p){return this._levelMap[p._id]},x.getToggleIcon=function(G){var A=this,p=A._loader,t=A._collapseIcon;return p&&!p.isLoaded(G)?t:G.hasChildren()?A.isExpanded(G)?A._expandIcon:t:z},x.isCheckMode=function(){return this._checkMode!=z},x.isChildrenSortable=function(){return!0},x.handleDataModelChange=function(u){var D=this;u.kind===Zf?delete D._expandMap[u.data._id]:u.kind===hm&&(D._expandMap={}),D.ivm()},x.toggle=function(c){var j=this;j.isExpanded(c)?j.collapse(c):j.expand(c)},x.isExpanded=function(P){return 1===this._expandMap[P._id]},x.expand=function(e){var q=this,V=q._loader;q.isExpanded(e)||(V&&!V.isLoaded(e)&&V.load(e),q._expandMap[e._id]=1,q.ivm(),q.onExpanded(e))},x.onExpanded=function(){},x.collapse=function(L){var P=this;P.isExpanded(L)&&(delete P._expandMap[L._id],P.ivm(),P.onCollapsed(L))},x.onCollapsed=function(){},x.expandAll=function(u){if(u)this.expand(u),u.eachChild(function(C){this.expandAll(C)},this);else{var _=this;_._dataModel.each(function(t){t.hasChildren()&&(_._expandMap[t._id]=1)}),_.ivm()}},x.collapseAll=function(){this._expandMap={},this.ivm()},x.makeVisible=function(F){if(F){var C=this;if(!C._rootData||F.isDescendantOf(C._rootData)){for(var p=F._parent;p;)C.expand(p),p=p._parent;C._23I=F,C.iv()}}},x.checkData=function(n){var k,D=this,M=D._checkMode,z=D.sm(),t=z.co(n);if(!z.sg()||!t){if(D._32o=1,M===ck)t?z.rs(n):z.as(n);else if(M===jn)k=new An(n),k.addAll(n._children);else if("descendant"===M)k=new An,Et(n,k);else if("all"===M&&(k=new An,Et(n,k),!t))for(var c=n._parent;c;)k.add(c),c=c._parent;k&&(t?z.rs(k):z.as(k)),delete D._32o}},x.drawTree=function(J,y,P,c,X,k,V){var h=this,b=h._indent,j=h._levelMap[y._id],Z=h.getIconWidth(y),x=Om(h.getToggleIcon(y));x?(c+=b*j,Mn(J,x,c+b/2,X+V/2,y,h),c+=b):c+=b*(j+1),h._checkMode&&(Mn(J,h.getCheckIcon(y),c+b/2,X+V/2,y,h),c+=b),h.drawIcon(J,y,c,X,Z,V),h.drawLabel(J,y,c+Z,X,V)}},Yh._14Q=function($){$.getIcon=function(r){return r.getIcon()},$.getIconWidth=function(i){return this.getIcon(i)?this._indent:0},$.drawIcon=function(h,K,R,N,w,Q){if(w){var r=this,$=r.getBodyColor(K),P=Om(r.getIcon(K),$);P&&(Q-=r.isRowLineVisible()?1:0,Le(h,P,cl,R,N,w,Q,K,r,$),rl(h,r.getBorderColor(K),R,N,w,Q))}},$.drawLabel=function(B,K,g,W,r){var N=this;Rd(B,N.getLabel(K),N.getLabelFont(K),N.getLabelColor(K),g,W,0,r)}},Yh._50o=function(K){K._98I=function(){var R=this,p=R._39o=new wp;R._60I=new An,p.mm(R._17o,R),p.md(R._18o,R),p.mh(R._19o,R)},K.setColumns=function(W){this._39o.clear(),this.addColumns(W)},K.addColumns=function(e){var B=this._39o;e.forEach(function(a){if(!(a instanceof Lt)){var Y=Br(a.className);a=Hn(Y?Y:Lt,a)}B.add(a)})},K.onColumnClicked=function(){},K.onCheckColumnClicked=function(){},K._3Q=function(u){for(var d,y=0,Z=this._60I,Q=Z.size();Q>y;y++)if(d=Z.get(y),d.column===u)return d;return z},K.getColumnAt=function(J){var b=this._4Q(J);return b?b.column:z},K._4Q=function(F){for(var x=this,N=F.target?x.lp(F).x:F.x,b=x._60I,R=0;R<b.size();R++){var E=b.get(R),t=E.startX;if(N>=t&&N<t+E.column.getWidth())return E}return z},K.getToolTip=function(k){var m=this,G=m.getDataAt(k),N=m.getColumnAt(k);return G&&N?N.getToolTip(G,m):z},K.adjustTranslateX=function(b){var Q=this.getWidth()-this._91I;return Q>b&&(b=Q),b>0?0:w(b)},K._99I=function(){var t=this,s=t._29I,x=t._60I;x.clear(),t._91I=0,t._39o._roots.each(function(D){if(D.isVisible()){var y=t._91I+D.getWidth();t._91I<=s.x+s.width&&y>=s.x&&x.add({column:D,startX:t._91I}),t._91I=y}})},K.drawData=function(e,O,l){var S=this,g=S._rowHeight,M=g*l,w=S.isSelected(O),D=S._29I,x=D.x,F=D.width;S.drawRowBackground(e,O,w,x,M,F,g),S._60I.each(function(j){var K=j.column,E=j.startX,D=K.getWidth();D>0&&!S.isEditing(O,K)&&(e.save(),e.beginPath(),e.rect(E,M,D,g),e.clip(),S._87o(S.drawCell(e,O,w,K,E,M,D,g),l,E,M,D,g),S._columnLineVisible&&rr(e,E+D-1,M,1,g,S._columnLineColor),e.restore())}),S._rowLineVisible&&rr(e,x,M+g-1,F,1,S._rowLineColor)},K.drawCell=function(r,E,A,a,l,k,Z,J){var s=this;if(a.drawCell)return a.drawCell(r,E,A,a,l,k,Z,J,s);var h=s.getValue(E,a);Ft(r,h,a,s.getLabelFont(E,a,h),s.getLabelColor(E,a,h),l,k,Z,J,E,s)},K.getColumnModel=function(){return this._39o},K._17o=function(){this.redraw()},K._18o=function(m){var N=this;m.data===N._sortColumn&&At[m.property]?N.ivm():(N._42o(),N.redraw())},K._19o=function(){this.redraw()},K.getCurrentSortFunc=function(){var C=this,I=C._sortColumn;if(I&&I.isSortable()){var Y=I.getSortFunc(),c=Tp===I.getSortOrder()?1:-1;return Y||(Y=lp),function(f,_){return Y.call(C,C.getValue(f,I),C.getValue(_,I),f,_)*c}}return C._sortFunc},K.isCellEditable=function(F,Y,s){return Y.isEditable()&&this.isEditable()?Y.isCellEditable?Y.isCellEditable(F,Y,s,this):!0:!1},K._37O=function(q,p){if(ti(p))for(var l=this,C=l.lp(p),U=l._60I,L=l._rowHeight,R=l._29I,S=R.x,E=R.y,Q=R.width,P=R.height,i=0;i<U.size();i++){var s=U.get(i),Y=s.startX,I=s.column,B=I.getWidth();if(I!==l._31o&&I!==l._4o&&C.x>=Y&&C.x<Y+B&&l.isCellEditable(q,I,p)){var n={x:Y,y:l.getRowIndex(q)*L,width:B,height:L},z={x:n.x+l.tx(),y:n.y+l.ty(),width:n.width,height:n.height},A=0,X=0;return n.x<S?A=n.x-S:n.x+n.width>S+Q&&(A=n.x+n.width-S-Q),A&&(l.tx(l.tx()-A),z.x-=A),n.y<E?X=n.y-E:n.y+L>E+P&&(X=n.y+L-E-P),X&&(l.ty(l.ty()-X),z.y-=X),l.beginEditing({data:q,column:I,value:l.getValue(q,I),event:p,rect:n,editorRect:z,view:l}),void 0}}}},It.BaseItemEditor=function(a,i,r,Z){this._data=a,this._column=i,this._master=r,this._editInfo=Z},Jt("BaseItemEditor",S,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Kt=_.Tab=function(){mg(Kt,this)};Fh("Tab",fk,{ms_ac:["view","closable","disabled","visible"],_icon:z,_closable:!1,_disabled:!1,_visible:!0,setParent:gm});var Lt=_.Column=function(){mg(Lt,this)};Fh("Column",fk,{_46o:1,ms_ac:["accessType","valueType",xp,so,Vi,yb,"align",Wq,"sortOrder",Yd,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Tp,_sortFunc:z,_sortable:!0,_clickable:!0,setWidth:function(z){16>z&&(z=16);var q=this._width;this._width=z,this.fp(yb,q,z)},getToolTip:function(B,u){return this.formatValue(u.getValue(B,this))}});var Mt=_.Property=function(){mg(Mt,this)};Fh("Property",fk,{_46o:1,ms_ac:["accessType","valueType",so,Vi,"categoryName",Wq,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:z,getToolTip:function(F,M,V){var J=this;return M?J.formatValue(V.getValue(F,J)):V.getPropertyName(J)}}),It.AccordionView=function(){var J=this;J._20o={},J._21o=new An,J._10o=z,J._9o=z,J._11o=z,J._view=Oc(0,J),J.iv()},Jt("AccordionView",S,{ms_v:1,ms_fire:1,ms_ac:[cd,lr,"titleHeight",Mf,Ac,"titleBackground","selectWidth",md,"orientation","separatorColor"],_expandIcon:m.accordionViewExpandIcon,_collapseIcon:m.accordionViewCollapseIcon,_titleHeight:Ci,_labelColor:m.accordionViewLabelColor,_labelFont:m.accordionViewLabelFont,_titleBackground:m.accordionViewTitleBackground,_selectBackground:m.accordionViewSelectBackground,_selectWidth:m.accordionViewSelectWidth,_orientation:"v",_separatorColor:m.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(w,c,i,Y){var W=this,d=fo(),O={content:c,div:d,canvas:km(d),icon:Y};if(W._20o[w])throw w+" already exists";var V=O.downEventFunc=function(l){pd(l)},Q=O.upEventFunc=function(z){pd(z),ti(z)&&(W._10o===w?W.collapse():W.expand(w))};[Km,ah].forEach(function(M){C(d,M,V)}),[Dd,Hj].forEach(function(z){C(d,z,Q)}),d.style.cursor=Gr,as(W._view,d),W._20o[w]=O,W._21o.add(w),i&&W.expand(w),W.iv()},remove:function(V){var O=this,e=O._20o[V];if(e){var n=e.div;zr(n),[Km,ah].forEach(function(s){v(n,s,e.downEventFunc)}),[Dd,Hj].forEach(function(Q){v(n,Q,e.upEventFunc)}),delete O._20o[V],O._21o.remove(V),O.iv()}},clear:function(){var m=this;m._21o.toArray().forEach(m.remove,m),m._20o={},m._21o.clear(),m.iv()},isExpanded:function(Q){return this._10o===Q},expand:function(n){var b=this;b._20o[n]&&b._10o!==n&&(b._10o=n,b.onExpanded(n),b.iv())},onExpanded:function(){},collapse:function(){var T=this;T._10o&&(T.onCollapsed(T._10o),delete T._10o,T.iv())},onCollapsed:function(){},initCanvas:function(E,R,O){Eg(E,R,O);var b=rk(E);return tl(b,0,0,1),b.clearRect(0,0,R,O),b},drawTitle:function(O,A,S,H,t){var y=this,D=Om(t.icon),I=y.isExpanded(A),X=y._titleHeight,U=y._titleBackground,l=y._selectWidth,M=y._separatorColor,F=Om(I?y._expandIcon:y._collapseIcon),_=l+4;rr(O,0,0,S,H,U),I&&l&&rr(O,0,0,l,H,y._selectBackground),(I||y._21o.get(y._21o.size()-1)!==A)&&rr(O,0,H-1,S,1,M?M:Xj(U)),D&&(Mn(O,D,_+To(D)/2,X/2),_+=To(D)+2),Rd(O,A,y.getLabelFont(A),y.getLabelColor(A),_,0,0,X),F&&Mn(O,F,S-To(F)/2-4,X/2)},validateImpl:function(){var R=this,N=R._view,j=0,J=0,m=R.getWidth(),r=R.getHeight(),p=R._titleHeight,D=R._21o.size()*p,t=R._11o,g=R._9o;delete R._11o,delete R._9o,R._21o.each(function(z){var k,T,t=R._20o[z],H=t.content,U=R._10o===z;Jl(R)?(fs(t.div,j,0,p,r),k=R.initCanvas(t.canvas,p,r),Jo(k,0,r),af(k,-Yp),R.drawTitle(k,z,r,p,t),k.restore(),U?(T=$(0,m-D),H&&(R._11o=H,R._9o=Ll(H),fs(H,j+p,0,T,r)),j+=p+T):j+=p):(fs(t.div,0,J,m,p),k=R.initCanvas(t.canvas,m,p),R.drawTitle(k,z,m,p,t),k.restore(),U?(T=$(0,r-D),H&&(R._11o=H,R._9o=Ll(H),fs(H,0,J+p,m,T)),J+=p+T):J+=p)});var O=R._9o;t&&t!==R._11o&&t.endEditing&&t.endEditing(),O&&O!==g&&as(N,O),g&&g!==O&&zr(g)}}),It.SplitView=function(p,t,W,q){var R=this,s=R._dividerDiv=fo(),n=R._60O=km(),C=R._61O=km(),i=n.style,l=C.style;R._view=Oc(1,R),as(R._view,s),i.msTouchAction=uj,i.pointerEvents=uj,i.cursor=Gr,l.msTouchAction=uj,l.pointerEvents=uj,l.cursor=Gr,p&&R.setLeftView(p),t&&R.setRightView(t),W&&R.setOrientation(W),q!=z&&R.setPosition(q),R.setStatus(rh),new Nt(R)},Jt("SplitView",S,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:m.splitViewDividerSize,_dividerBackground:m.splitViewDividerBackground,_dragOpacity:m.splitViewDragOpacity,_toggleIcon:m.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(J,d){var L=this,M=L._position;isNaN(J)||(d||(L._82O=0>J?-1:J>1?1:0),L._position=J,L.fp(Yq,M,J))},getLeftView:function(){return this._leftView},setLeftView:function(s){var g=this,q=g._leftView,K=g._view;if(g._leftView!==s){if(q&&q!==g._rightView){var H=Ll(q);H.parentNode===K&&zr(H)}if(g._leftView=s,s){var m=Ll(s);m.parentNode!==K&&K.insertBefore(m,g._dividerDiv)}g.fp("leftView",q,s)}},getRightView:function(){return this._rightView},setRightView:function(A){var P=this,o=P._rightView,c=P._view;if(P._rightView!==A){if(o&&o!==P._leftView){var J=Ll(o);J.parentNode===c&&zr(J)}if(P._rightView=A,A){var d=Ll(A);d.parentNode!==c&&c.insertBefore(d,P._dividerDiv)}P.fp("rightView",o,A)}},validateImpl:function(){var b=this,Z=b._draggable,U=b._position,K=b.getWidth(),g=b.getHeight(),G=b._dividerSize,p=b._dividerBackground,B=Xl?18:8,q=b._dividerDiv,R=b._82O,l=b._60O,C=b._61O,k=b._toggleIcon,Q=b._status,L=q.style,c=null,d=Xl?20:4,o=k.comps[0];G>=B||0===G?b._coverDiv&&(zr(b._coverDiv),delete b._coverDiv):b._coverDiv||(b._coverDiv=fo(),Md&&(b._coverDiv.style.background=ki),as(q,b._coverDiv)),b._togglable?l.parentNode||(as(q,l),as(q,C)):(zr(l),zr(C));var t=b._coverDiv,W=b._leftView,A=b._rightView;if(Jl(b)){if(G>K&&(G=K),Q===rh)if(1===R)var O=H(U,K),y=$(0,K-G-O);else-1===R?(y=H(-U,K),O=$(0,K-G-y)):(O=w((K-G)*U),y=$(0,K-G-O));else"cl"===Q?(O=0,y=$(0,K-G)):"cr"===Q&&(y=0,O=$(0,K-G));W&&fs(W,0,0,O,g),A&&fs(A,O+G,0,y,g),fs(q,O,0,G,g),b._22o=O,t&&(fs(t,G/2-B/2,0,B,g),t.style.cursor=Z?Cc:""),q.style.cursor=Z?Cc:"";var f=q.clientHeight/2,j=q.clientWidth;Eg(l,j,j),fs(l,0,f-j-d,j,j),c=rk(l),tl(c,0,0,1),o.rotation=-Yp,sl(c,k,0,0,j,j),c.restore(),Eg(C,j,j),fs(C,0,f+d,j,j),c=rk(C),tl(c,0,0,1),o.rotation=Yp,sl(c,k,0,0,j,j),c.restore()}else{if(G>g&&(G=g),Q===rh)if(1===R)var I=H(U,g),r=$(0,g-G-I);else-1===R?(r=H(-U,g),I=$(0,g-G-r)):(I=w((g-G)*U),r=$(0,g-G-I));else"cl"===Q?(I=0,r=$(0,g-G)):"cr"===Q&&(r=0,I=$(0,g-G));W&&fs(W,0,0,K,I),A&&fs(A,0,I+G,K,r),fs(q,0,I,K,G),b._22o=I,t&&(fs(t,0,G/2-B/2,K,B),t.style.cursor=Z?Be:""),L.cursor=Z?Be:"";var m=q.clientWidth/2,j=q.clientHeight;Eg(l,j,j),fs(l,m-j-d,0,j,j),c=rk(l),tl(c,0,0,1),o.rotation=0,sl(c,k,0,0,j,j),c.restore(),Eg(C,j,j),fs(C,m+d,0,j,j),c=rk(C),tl(c,0,0,1),o.rotation=s,sl(c,k,0,0,j,j),c.restore()}L.background=p}});var Nt=function(q){this.sv=q,this.addListeners()};Fm(Nt,S,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(S){var K=this,v=K.sv,g=v._dividerDiv,l=v._60O,G=v._61O,O=v._status,f=S.target;if(f===l)O===rh?v.setStatus("cl"):"cr"===O&&v.setStatus(rh);else if(f===G)O===rh?v.setStatus("cr"):"cl"===O&&v.setStatus(rh);else if(th(S)&&(f===g||f===v._coverDiv)&&(pd(S),v.isDraggable())){v.getLeftView(),v.getRightView();var H=K.maskDiv=fo();if(H.style.left=0,H.style.top=0,H.style.width=v.getWidth()+"px",H.style.height=v.getHeight()+"px",v.getView().appendChild(H),!v.isContinuousLayout()){var h=K.resizeDiv=fo();h.style.left=g.style.left,h.style.top=g.style.top,h.style.width=g.style.width,h.style.height=g.style.height,h.style.opacity=v.getDragOpacity(),h.style.background=v.getDividerBackground(),as(K.getView(),h)}K._lastAbsPosition=v._22o,K._86o=Jl(v)?el(S).x:el(S).y,Gk(K,S)}},handleWindowTouchMove:function(w){th(w)&&this.update(w,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(N){var I=this;I.update(N,!0),I.sv.setStatus(rh),I.maskDiv&&zr(I.maskDiv),I.resizeDiv&&zr(I.resizeDiv),I.maskDiv=I.resizeDiv=z},handle_mousedown:function(g){ti(g)&&this.handle_touchstart(g)},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowMouseUp:function(d){this.handleWindowTouchEnd(d)},update:function(O,R){var n=this,P=n.sv,T=Jl(P)?P.getWidth():P.getHeight(),q=P._dividerSize,G=n._lastAbsPosition-n._86o;Jl(P)?(G+=el(O).x,G>T-q&&(G=T-q),0>G&&(G=0),n.resizeDiv&&(n.resizeDiv.style.left=G+Eq)):(G+=el(O).y,G>T-q&&(G=T-q),0>G&&(G=0),n.resizeDiv&&(n.resizeDiv.style.top=G+Eq)),R&&T!==q&&(1===P._82O?P.setPosition(G,1):-1===P._82O?P.setPosition(G-T+q,1):P.setPosition(G/(T-q),1))}}),It.TabView=function(){var E=this,L=E._view=Oc(1,E),h=E._91O=fo(1),$=E._tabModel=new wp,D=$.sm(),C=E.invalidate;E._7o=new An,E._canvas=km(h),as(L,h),as(L,E._92O=fo(1)),D.setSelectionMode(bb),D.ms(E.handleSelectionChange,E),$.mm(C,E),$.mh(C,E),$.md(C,E),E._interactor=new Ot(E),E.iv()},Jt("TabView",S,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Mf,Ac,"tabHPadding","tabBackground","selectWidth",md,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Ih,_tabHeight:Ci,_tabGap:m.tabViewTabGap,_labelColor:m.tabViewLabelColor,_labelFont:m.tabViewLabelFont,_tabBackground:m.tabViewTabBackground,_selectWidth:m.tabViewSelectWidth,_selectBackground:m.tabViewSelectBackground,_moveBackground:m.tabViewMoveBackground,_insertColor:m.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(U,n,q){var f,z=this._tabModel;return U instanceof Kt?(f=U,n&&f.setView(n)):(f=new Kt,f.setName(U),f.setView(n)),z.add(f),q&&z.sm().ss(f),f},getLabel:function(y){return y.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(Z){this._23o=Z,this.iv()},get:function(P){var A=this,M=A._tabModel;if(Aj(P))return M._roots.get(P);if(hq(P)){var J;return M.each(function(w){P===A.getLabel(w)&&(J=w)}),J}return P instanceof Kt?P:z},select:function(P){this._tabModel.sm().ss(this.get(P))},remove:function(L){var u=this;if(L=u.get(L)){var r=u._tabModel,c=r._roots.indexOf(L);u._tabModel.remove(L),u.selectByIndex(--c)}},getCurrentTab:function(){return this._8o},hideTabView:function(s,V){V.parentNode===this._92O&&(zb(V)?(V.style.display=Ip,V._tab_=s):zr(V),yd())
},showTabView:function(s,O){zb(O)&&(O.style.display="block",O._tab_=s),O.parentNode!==this._92O&&(as(this._92O,O),yd())},_24o:function(){var A,Y=this,n=Y._8o,t=Y._9o,_=Y._tabModel.sm().ld();_&&(A=Ll(_.getView())),A!==t&&(t&&(n.getView()&&n.getView().endEditing&&n.getView().endEditing(),Y.hideTabView(n,t)),A&&Y.showTabView(_,A)),Y._8o=_,Y._9o=A,n!==_&&Y.onTabChanged(n,_)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(w,A){this.selectByIndex(--A)},selectByIndex:function(l){var U=this,D=U._tabModel,b=D.size();if(b&&!D.sm().ld()){l==z&&(l=0),l>=b&&(l=b-1),0>l&&(l=0);for(var r=l;r>=0;r--){var e=U.get(r);if(!e.isDisabled())return U.select(e),e}for(r=l+1;b>r;r++)if(e=U.get(r),!e.isDisabled())return U.select(e),e}},getTabWidth:function(w){var r=this.getTabHPadding(),Z=4+2*r,O=Om(w.getIcon());O&&(Z+=To(O,w)+4);var z=this.getLabel(w);return z&&(Z+=nd(this.getLabelFont(w),z).width+4),w.isClosable()&&(Z+=10),Z},drawTab:function(f,X,W,d,A,t,$){var u,B=this,I=B._tabPosition,C=this.getTabHPadding(),n=W+4+C,E=B._selectWidth,g=Om(X.getIcon()),p=X.isDisabled(),K=B.getLabelColor(X),D=B.getLabelFont(X),m=B.getLabel(X),z=B._selectBackground,x=I===Mq+"-vertical",Q=I===ze+"-vertical";(x||Q)&&(n=d+4+C),p&&(f.globalAlpha=Xn),rr(f,W,d,A,t,$),X===B._8o&&E&&(I===Ih?rr(f,W,d+t-E,A,E,z):I===Mq?rr(f,W+A-E,d,E,t,z):I===ze?rr(f,W,d,E,t,z):x?rr(f,W+A-E,d,E,t,z):Q?rr(f,W,d,E,t,z):rr(f,W,d,A,E,z));var F=A/2;if(x&&(Jo(f,F,d+t/2),af(f,s),Jo(f,-F,-d-t/2)),g){var H=Of(g,X),j=To(g,X);if(x||Q){var r=W+A/2,N=n+H/2;Jo(f,r,N),af(f,Yp),Jo(f,-r,-N),Mn(f,g,W+A/2,n+H/2,X,B),Jo(f,r,N),af(f,-Yp),Jo(f,-r,-N),n+=H+4}else Mn(f,g,n+j/2,d+t/2,X,B),n+=j+4}return x||Q?(Jo(f,A/2,n+A/2),af(f,Yp),Jo(f,-A/2,-n-A/2),Rd(f,m,D,K,W,n,t,A),Jo(f,A/2,n+A/2),af(f,-Yp),Jo(f,-A/2,-n-A/2)):Rd(f,m,D,K,n,d,A,t),x&&(Jo(f,F,d+t/2),af(f,-s),Jo(f,-F,-d-t/2)),X.isClosable()&&(u=Q?{x:W+A-12,y:d+t-12,width:12,height:12}:{x:W+A-12,y:d+2,width:12,height:12},this.drawCloseIcon(X,f,K,u)),p&&(f.globalAlpha=1),u},drawCloseIcon:function(f,g,E,q){var V=q.x,I=q.y;g.strokeStyle=E,g.lineWidth=1,g.beginPath(),g.moveTo(V+2,I+8),g.lineTo(V+8,I+2),g.moveTo(V+8,I+8),g.lineTo(V+2,I+2),g.stroke()},getTabAt:function(U){var W=this._interactor._8Q(U);return W?W.tab:null},validateImpl:function(){var G=this;G._24o();var o,i=G._canvas,P=G._tabPosition,K=G._91O,g=G._92O,y=G._tabModel,S=G.getWidth(),z=G.getHeight(),F=G._tabHeight,m=G._7o,d=G._tabGap,T=P===Ih,r=P===Mq,p=P===ze,h=P===Mq+"-vertical",x=P===ze+"-vertical",v=G._23o,w=0;if((r||p)&&y._roots.each(function(V){w=$(G.getTabWidth(V),w)}),T?(fs(K,0,0,S,F),o={x:0,y:F,width:S,height:$(0,z-F)}):r?(fs(K,0,0,w,z),o={x:w,y:0,width:$(0,S-w),height:z}):p?(fs(K,S-w,0,w,z),o={x:0,y:0,width:$(0,S-w),height:z}):h?(fs(K,0,0,F,z),o={x:F,y:0,width:$(0,S-F),height:z}):x?(fs(K,S-F,0,F,z),o={x:0,y:0,width:$(0,S-F),height:z}):(fs(K,0,z-F,S,F),o={x:0,y:0,width:S,height:$(0,z-F)}),fs(g,o),h||x){G._9o&&(o.x=0,fs(G._8o.getView(),o)),Eg(i,F,z);var V=rk(i),W=0;if(tl(V,0,G.ty(),1),V.clearRect(0,0,F,z),m.clear(),y._roots.each(function(a){if(a.isVisible()){var X,q=G.getTabWidth(a);if(!v||v.tab!==a){var l=G.getTabBackground(a);X=G.drawTab(V,a,0,W,F,q,l)}m.add({_75o:X,tab:a,startY:W,endY:W+q,height:q}),W+=q+d}}),G._23Q=$(0,W-d),v){var l=v.position;G.drawTab(V,v.tab,0,v.startY,F,v.height,G._moveBackground),rr(V,0,l,F,1,G._insertColor)}if(V.restore(),G._selectionChanged){G._selectionChanged=!1;for(var s=G.ty(),H=0;H<m.size();H++){var e=m.get(H);if(e.tab===G._8o){if(e.endY+s<0){G.ty(-e.startY);break}if(e.startY+s>z){G.ty(z-e.endY);break}}}}G.ty(G.ty())}else if(r||p){G._9o&&(o.x=0,fs(G._8o.getView(),o)),Eg(i,w,z);var V=rk(i),W=0;if(tl(V,0,G.ty(),1),V.clearRect(0,0,w,z),m.clear(),y._roots.each(function(L){if(L.isVisible()){var k;if(!v||v.tab!==L){var c=G.getTabBackground(L);k=G.drawTab(V,L,0,W,w,F,c)}m.add({_75o:k,tab:L,startY:W,endY:W+F,height:F}),W+=F+d}}),G._23Q=$(0,W-d),v){var l=v.position;G.drawTab(V,v.tab,0,v.startY,w,v.height,G._moveBackground),rr(V,0,l,w,1,G._insertColor)}if(V.restore(),G._selectionChanged){G._selectionChanged=!1;for(var s=G.ty(),H=0;H<m.size();H++){var e=m.get(H);if(e.tab===G._8o){if(e.endY+s<0){G.ty(-e.startY);break}if(e.startY+s>z){G.ty(z-e.endY);break}}}}G.ty(G.ty())}else{G._9o&&(o.y=0,fs(G._8o.getView(),o)),Eg(i,S,F);var V=rk(i),k=0;if(tl(V,G.tx(),0,1),V.clearRect(0,0,S,F),m.clear(),y._roots.each(function(P){if(P.isVisible()){var w,o=G.getTabWidth(P);if(!v||v.tab!==P){var u=G.getTabBackground(P);w=G.drawTab(V,P,k,0,o,F,u)}m.add({_75o:w,tab:P,startX:k,endX:k+o,width:o}),k+=o+d}}),G._64I=$(0,k-d),v){var l=v.position;G.drawTab(V,v.tab,v.startX,0,v.width,F,G._moveBackground),ve(V,G._insertColor,l,0,F)}if(V.restore(),G._selectionChanged){G._selectionChanged=!1;for(var N=G.tx(),H=0;H<m.size();H++){var e=m.get(H);if(e.tab===G._8o){if(e.endX+N<0){G.tx(-e.startX);break}if(e.startX+N>S){G.tx(S-e.endX);break}}}}G.tx(G.tx())}for(var Z=[],Q=g.children,H=0;H<Q.length;H++){var J=Q[H],U=J._tab_;U&&!y.contains(U)&&Z.push(J)}Z.forEach(function(k){g.removeChild(k)})}});var Ot=function(Z){this.tv=Z,this.addListeners()};Fm(Ot,S,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(T){this.handleScroll(T,10*(T.wheelDelta/40))},handle_DOMMouseScroll:function(z){this.handleScroll(z,10*-z.detail)},handleScroll:function(d,G){pd(d);var e=this.tv,B=e._tabPosition;!e._40o()||B!==Ih&&B!==Vd||e.tx(this.tv.tx()+G),!e._41o()||B!==Mq&&B!==ze&&B!==Mq+"-vertical"&&B!==ze+"-vertical"||e.ty(this.tv.ty()+G)},_8Q:function(V){var w,_,G=this.tv,B=G._tabPosition,s=G._7o;if(B===Ih||B===Vd){var U=G.lp(V).x;for(w=0;w<s.size();w++)if(_=s.get(w),_.startX<=U&&U<=_.endX)return _}else if(B===Mq||B===ze||B===Mq+"-vertical"||B===ze+"-vertical"){var W=G.lp(V).y;for(w=0;w<s.size();w++)if(_=s.get(w),_.startY<=W&&W<=_.endY)return _}return z},isClickable:function(d){var L=this.tv,h=L._tabPosition,c=this._73o=this._8Q(d);return!L._40o()||h!==Ih&&h!==Vd?!L._41o()||h!==Mq&&h!==ze&&h!==Mq+"-vertical"&&h!==ze+"-vertical"?c&&(!c.tab.isDisabled()||L.isMovable()):!0:!0},handle_mousemove:function(K){var g=this;es?g._74o=g._8Q(K):g.getView().style.cursor=g.isClickable(K)?Gr:""},handle_mousedown:function(l){this.handle_mousemove(l),this.handle_touchstart(l)},handle_touchstart:function(v){var d=this,_=d.tv,P=_._tabPosition;pd(v),ti(v)&&d.isClickable(v)&&(P===Ih||P===Vd?(d.x=el(v).x,d.lp=_.lp(v),d.tx=_.tx()):(d.y=el(v).y,d.lp=_.lp(v),d.ty=_.ty()),Gk(d,v))},handle_mouseup:function(F){this.handle_touchend(F)},handle_touchend:function(i){if(Mi(i)){var r=this._73o;if(!r)return;var u=this.tv,G=u.getTabModel(),M=r.tab;if(!M.isDisabled()&&M.isClosable()){var x=function(){var E=G._roots.indexOf(M);G.remove(M),u.onTabClosed(M,E)};u.onTabClosing(M,x)&&x()}}},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowTouchMove:function(x){var p,d=this,B=d.tv,Y=B._tabPosition,W=d._73o;if(Y===Ih||Y===Vd){if(p=el(x).x-d.x,!d._25o&&!d.moving&&n(p)>2&&(B._40o()&&!Wo(x)?d._25o=1:W&&B.isMovable()&&(d.moving=1)),d._25o)B.tx(d.tx+p);else if(d.moving){var u=d.lp.x+p,N=B._tabGap/2;B._7o.each(function(a){var Y=a.endX,o=u-a.startX<Y-u;u>=a.startX&&Y>=u&&B._7Q({tab:W.tab,startX:W.startX+p,width:W.width,front:o,insertTab:a.tab,position:o?$(0,a.startX-N):H(B._64I,Y+N)})})}}else if(p=el(x).y-d.y,!d._25o&&!d.moving&&n(p)>2&&(B._41o()&&!Wo(x)?d._25o=1:W&&B.isMovable()&&(d.moving=1)),d._25o)B.ty(d.ty+p);else if(d.moving){var m=d.lp.y+p,N=B._tabGap/2;B._7o.each(function(T){var x=T.endY,D=m-T.startY<x-m;m>=T.startY&&x>=m&&B._7Q({tab:W.tab,startY:W.startY+p,height:W.height,front:D,insertTab:T.tab,position:D?$(0,T.startY-N):H(B._23Q,x+N)})})}},handleWindowMouseUp:function(v){this.handleWindowTouchEnd(v)},handleWindowTouchEnd:function(){var $=this,L=$.tv,c=L._tabPosition,g=L.getTabModel(),K=g._roots,C=$._73o;if($.moving){var W=L._23o;if(W&&W.insertTab!==W.tab){var N=W.tab,f=K.remove(N),u=K.indexOf(W.insertTab);u>=0&&(W.front||u++,u<=K.size()&&(K.add(N,u),g._38I(N,f,u)))}L._7Q(z),delete $.moving}else if(!$._25o&&C){N=C.tab;var j=$._74o;if(!j||j.tab===N)if(!N.isDisabled()&&tq(C._75o,$.lp)){var E=function(){var a=K.indexOf(N);g.remove(N),L.onTabClosed(N,a)};L.onTabClosing(N,E)&&E()}else N.isDisabled()||L._8o===N||g.sm().ss(N)}$._25o=$._73o=$._74o=c===Ih||c===Vd?$.x=$.lp=$.tx=z:$.y=$.lp=$.ty=z}}),It.PropertyView=function(Y){var G=this;G._view=Oc(1,G),G._canvas=km(G._view),as(G._view,G._79O=fo()),G._rows=new An,G._28o=new An,G._26o={},G._26Q={};var I=G._propertyModel=new wp,E=G.ivm;I.mm(E,G),I.md(E,G),I.mh(E,G),G.dm(Y?Y:new wp),new Pt(G)},Jt("PropertyView",S,{ms_ac:[Mf,cf,Ac,so,Vi,"categorizable",xc,Yd,yp,cd,lr,Di,gk,rm,"selectRowIndex",md,"background",Qb,sd,uk,xl,tf],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:ac,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Vp,_background:m.propertyViewBackground,_expandIcon:m.propertyViewExpandIcon,_collapseIcon:m.propertyViewCollapseIcon,_scrollBarColor:cg,_scrollBarSize:Vf,_autoHideScrollBar:Yn,_selectBackground:m.propertyViewSelectBackground,_rowHeight:As,_rowLineVisible:m.propertyViewRowLineVisible,_rowLineColor:m.propertyViewRowLineColor,_10I:.5,_columnLineVisible:m.propertyViewColumnLineVisible,_columnLineColor:m.propertyViewColumnLineColor,_labelColor:m.propertyViewLabelColor,_labelSelectColor:m.propertyViewLabelSelectColor,_labelFont:m.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(z){0>z&&(z=0),z>1&&(z=1);var h=this,I=h._10I;h._10I=z,h.fp("columnPosition",I,z)},getPropertyName:function(S){return S.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(c,P,X){return X===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(z,R){return R===this._selectRowIndex?this._labelSelectColor:z.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(K){var c=this.getHeight()-this._59I;return c>K&&(K=c),K>0?0:w(K)},isExpanded:function(D){if(!D)return!0;var L=this._26o[D];return L?L.isExpanded:!(this._26Q[D]===!1)},toggle:function(M){var l=this;l.isExpanded(M)?l.collapse(M):l.expand(M)},expandAll:function(){this.validate();for(var B in this._26o)this.expand(B)},expand:function(T){if(T&&T!==Ip){var k=this,C=k._26o[T];C&&!C.isExpanded&&(C.isExpanded=!0,k.onExpanded(T),k.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var z in this._26o)this.collapse(z)},collapse:function(s){if(s&&s!==Ip){var G=this,V=G._26o[s];V&&V.isExpanded&&(V.isExpanded=!1,G.onCollapsed(s),G.ivm())}},onCollapsed:function(){},getCategoryName:function(S){if(!this.isCategorizable())return Ip;var b=S.getCategoryName();return b?b:Ip},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(W){var y=this,D=y._dataModel;D!==W&&(D&&(D.umd(y.handlePropertyChange,y),y._selectionModel||D.sm().ums(y.handleSelectionChange,y)),y._dataModel=W,W.md(y.handlePropertyChange,y),y._selectionModel?y._selectionModel._21I(W):W.sm().ms(y.handleSelectionChange,y),y.fp(Kd,D,W))},isVisible:function(Y){return this._visibleFunc?this._visibleFunc(Y):!0},onPropertyChanged:function(z){var $=this,U=z.property;Dt[U]?$.ivm():$.iv(),U===Kc&&$._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Yg},handlePropertyChange:function(C){this._27o===C.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var o=this;o._96I||(o.setSelectRowIndex(-1),o._96I=1,o.iv())},redraw:function(){this.iv()},validateModel:function(){var C=this,x=C._rows,p=C._28o,e={},y=new An,$=C._27o;C.updateCurrentData(),$!==C._27o&&C.endEditing(),x.clear(),p.clear(),C.getRawProperties().each(function(v){if(C.isVisible(v)){y.add(v);var M=C.getCategoryName(v);e[M]||(p.add(M,M===Ip?0:B),e[M]={isExpanded:C.isExpanded(M),properties:new An})}}),C._sortFunc&&y.sort(C._sortFunc);for(var R in C._26o)C._26Q[R]=C.isExpanded(R);C._26o=e,p.each(function(F){F!==Ip&&x.add(F);var Z=e[F];Z.isExpanded&&y.each(function(M){C.getCategoryName(M)===F&&(Z.properties.add(M),x.add({property:M,data:C._27o}))},C)})},validateImpl:function(){var w=this;w._76o(),w._96I&&(w.validateModel(),delete w._96I);var Y=w._canvas,n=w.getWidth(),y=w.getHeight(),l=-w.ty(),H=w._rowHeight,$=w._indent,V=n-$,D=w._rows,R=D.size(),g=w._9I=$+V*w._10I,q=w._59I=R*H;Eg(Y,n,y),w._29I={x:0,y:l,width:n,height:y},w._31I=e(l/H),w._14I=u((l+y)/H),w._31I<0&&(w._31I=0),w._14I>R&&(w._14I=R);var L,o=rk(Y),x=w._background;tl(o,0,-l,1),o.beginPath(),o.rect(0,l,n,y),o.clip(),o.clearRect(0,l,n,y),w._93db(o),x&&rr(o,0,0,$,q,x);for(var C=w._31I;C<w._14I;C++){var K=D.get(C),l=H*C;if(hq(K))x&&rr(o,$,l,V,H,x),L=Om(w.isExpanded(K)?w._expandIcon:w._collapseIcon),L&&Le(o,L,cl,0,l,$,H),o.save(),o.beginPath(),o.rect($,l,V,H),o.clip(),w.drawCategoryName(o,K,C,$,l,V,H),o.restore();else{var A=K.property,O=K.data,L=Om(A.getIcon()),I=w._selectRowIndex===C?w.getSelectBackground():z;if(L&&Le(o,L,cl,0,l,$,H),I&&rr(o,$,l,V,H,I),o.save(),o.beginPath(),o.rect($,l,g-$,H),o.clip(),w.drawPropertyName(o,A,C,$,l,g-$,H),o.restore(),!w.isEditing(O,A)){var U=g+1,c=n-g-1;o.save(),o.beginPath(),o.rect(U,l,c,H),o.clip(),w._87o(w.drawPropertyValue(o,A,w.getValue(O,A),C,U,l,c,H,O),C,U,l,c,H),o.restore()}}w._rowLineVisible&&rr(o,$,l+H-1,V,1,w._rowLineColor)}w._columnLineVisible&&(rr(o,g,0,1,q,w._columnLineColor),rr(o,n-1,0,1,q)),w._92db(o),w._93I(),o.restore(),w.ty(w.ty())},drawCategoryName:function(s,l,S,N,h,b,H){Rd(s,l,this.getCategoryFont(l),this.getCategoryColor(l),N,h,b,H)},drawPropertyName:function(P,z,u,t,v,l,_){return z.drawPropertyName?(z.drawPropertyName(P,z,u,t,v,l,_,this),void 0):(Rd(P,this.getPropertyName(z),this.getPropertyFont(z,u),this.getPropertyColor(z,u),t,v,l,_),void 0)},drawPropertyValue:function(L,t,H,X,U,M,N,v,c){return t.drawPropertyValue?t.drawPropertyValue(L,t,H,X,U,M,N,v,c,this):(Ft(L,H,t,this.getLabelFont(t,H,X),this.getLabelColor(t,H,X),U,M,N,v,c,this),void 0)},isPropertyEditable:function(k){return k.isEditable()&&this.isEditable()},setProperties:function(m){this._propertyModel.clear(),this.addProperties(m)},addProperties:function(v){if(v){var j=this._propertyModel;v.forEach(function(n){if(!(n instanceof Mt)){var f=Br(n.className);n=Hn(f?f:Mt,n)}j.add(n)})}},getRowIndexAt:function(m){var C=this,j=e(C.lp(m).y/C._rowHeight);return j>=0&&j<C._rows.size()?j:-1},getPropertyAt:function(x){var V=this,n=V.getRowIndexAt(x);return n>=0?V._rows.get(n).property:z},getToolTip:function(w){var L=this,I=L.getPropertyAt(w),h=L._27o;return I&&h?I.getToolTip(h,L._9I<L.lp(w).x,L):z}});var Pt=function(z){this.pv=z,this.addListeners()};Fm(Pt,S,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(s){this.getView().style.cursor=s},clear:function(){var N=this;N._62O=N.cp=N.ty=N.p=z,N.setCursor(ck)},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(d){var h=this,v=h.pv;pd(d),v.setFocus(d)&&(ti(d)?(h.cp=el(d),h.ty=v.ty(),h.p=v.getColumnPosition(),h.handle_touchmove(d)):v.setSelectRowIndex(v.getRowIndexAt(d)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(x){this.handle_touchend(x)},handle_touchend:function(_){var w=this;if(w.cp&&!w._62O){var l=w.pv,h=l.lp(_),o=h.x,s=h.y,e=l._indent,G=l.getRowIndexAt(_),d=l._9I;if(G>=0){var b=l._rowHeight,u=b*G,i=l._rows.get(G),H=i.property;if(hq(i))Om(l.isExpanded(i)?l._expandIcon:l._collapseIcon)&&o>=0&&e>=o&&s>=u&&u+b>=s?l.toggle(i):ds(_)&&l.toggle(i);else if(o>d&&l.isPropertyEditable(H,_)){var T={x:d+1,y:u,width:l.getWidth()-d-1,height:b},Y={x:T.x+l.tx(),y:T.y+l.ty(),width:T.width,height:T.height},S=0,y=l._29I;T.y<y.y?S=T.y-y.y:T.y+b>y.y+y.height&&(S=T.y+b-y.y-y.height),S&&(l.ty(l.ty()-S),Y.y-=S),l.beginEditing({data:i.data,property:H,value:l.getValue(i.data,H),event:_,rect:T,editorRect:Y,view:l})}}l.setSelectRowIndex(G)}w.clear()},handleWindowMouseMove:function(j){this.handleWindowTouchMove(j)},handleWindowTouchMove:function(d){var g=this,B=g.pv,M=g.ty,y=g.cp,s=el(d),P=g._62O;if("p"===P)B.setTranslateY(M+s.y-y.y);else if("c"===P){var T=B.getWidth()-B._indent;if(T>16){var S=g.p-(y.x-s.x)/T,o=16/T;o>S&&(S=o),S>1-o&&(S=1-o),B.setColumnPosition(S)}}else"s"===P&&B.setTranslateY(M+(y.y-s.y)*B._59I/B._29I.height)},handle_mousemove:function(n){this.handle_touchmove(n)},handle_touchmove:function(x){if(!es&&ti(x)){var e=this,z=e.pv,C=n(z.lp(x).x-z._9I)<=(Xl?8:3);e.cp?e._62O||(C?(e._62O="c",Gk(e,x)):n(el(x).y-e.cp.y)>=2&&(e._62O=e.isV(x)?"s":"p",Gk(e,x))):(C?e.setCursor(Cc):e.setCursor(ck),e.isV(x)&&z._43o())}},isV:function(c){var i=this.pv,d=i._29I;return i._41o()&&d.x+d.width-i.lp(c).x<eg},handle_mousewheel:function(V){this.handleScroll(V,V.wheelDelta/40)},handle_DOMMouseScroll:function(_){2===_.axis&&this.handleScroll(_,-_.detail)},handleScroll:function(r,c){var X=this.pv;pd(r),X.endEditing(),X.translate(0,c*X.getRowHeight())},handle_keydown:function(z){var c=this.pv,i=c._rows.size(),Q=c._selectRowIndex+(jc(z)?-1:1);(jc(z)||Cg(z))&&(0>Q&&(Q=0),Q>=i&&(Q=i-1),c.setSelectRowIndex(Q))}}),It.ListView=function(k){this._5o(k),new Qt(this)},Jt("ListView",S,{ms_ac:[Mf,cf,Ac,Qb,xc,sd,uk,Yd,yp,Di,gk,rm,Fd,md],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Vp,_rowHeight:As,_rowLineVisible:m.listViewRowLineVisible,_rowLineColor:m.listViewRowLineColor,_scrollBarColor:cg,_scrollBarSize:Vf,_autoMakeVisible:yl,_autoHideScrollBar:Yn,_selectBackground:m.listViewSelectBackground,_labelColor:m.listViewLabelColor,_labelSelectColor:m.listViewLabelSelectColor,_labelFont:m.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(D){var B=this,Z=B._checkMode;B._checkMode=D,B.fp(Jq,Z,D)},drawRow:function(U,z,_,b,S,y,X){var d=this,a=0,P=d._indent,h=d.getIconWidth(z);d.drawRowBackground(U,z,_,b,S,y,X),d._checkMode&&(Mn(U,Om(d.getCheckIcon(z)),a+P/2,S+X/2,z,d),a+=P),d.drawIcon(U,z,a,S,h,X),d.drawLabel(U,z,a+h,S,X)}});var Qt=function(y){this.list=y,this.addListeners()};Fm(Qt,S,{ms_listener:1,getView:function(){return this.list._view},clear:function(q){var b=this,j=b.list;q&&"d"===b._62O&&!b.dragCancel&&j.handleDragAndDrop(q,"end"),j.draggingData&&(j.draggingData=null,j.redraw()),b.dragCancel=b._62O=b._isV=b._isH=b.cp=b.tx=b.ty=z},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(t){var l=this,r=l.list;if(pd(t),r.setFocus(t)){var Q=r.getDataAt(t);l.cp=el(t),l.tx=r.tx(),l.ty=r.ty(),ti(t)?Q&&r.handleDragAndDrop&&!l.isV(t)&&!l.isH(t)&&(r.draggingData=Q,r.redraw(),r.handleDragAndDrop(t,"prepare")):(Q?l._33o(t,Q):this._cancelDataDoubleSelect(),l.clear(t))}},handleWindowMouseUp:function(E){this.clear(E)},handleWindowTouchEnd:function(H){this.clear(H)},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(P){var t=this,X=t.list;if(!t._isV&&!t._isH&&t.cp&&!t._62O){var p=X.getDataAt(P);p?(X.isCheckMode()?t._34o(P,p):t._33o(P,p),ds(P)?X.onDataDoubleClicked(p,P):X.onDataClicked(p,P)):(t._cancelDataDoubleSelect(),X.handleBackgroundClick(P))}t.clear(P)},handleWindowMouseMove:function(m){this.handleWindowTouchMove(m)},handleWindowTouchMove:function(A){var l=this,u=l.list,h=l._62O,E=l.tx,W=l.ty,z=l.cp,d=el(A),m=u._29I;"p"===h?u.setTranslate(E+d.x-z.x,W+d.y-z.y):"v"===h?u.ty(W+(z.y-d.y)*u._59I/m.height):"h"===h?u.tx(E+(z.x-d.x)*u._91I/m.width):"d"===h&&(l.dragCancel||u.handleDragAndDrop(A,"between"))},handle_mousemove:function(Q){this.handle_touchmove(Q)},handle_touchmove:function(P){if(!es&&ti(P)){var a=this,V=a.list;if(a._isV=a.isV(P),a._isH=a.isH(P),a.cp){if(!a._62O){if(bh(el(P),a.cp)<2)return;a._isV?a._62O="v":a._isH?a._62O="h":V.draggingData&&!this.dragCancel?(a._62O="d",V.handleDragAndDrop(P,"begin")):a._62O="p",a._62O&&"d"!==a._62O&&V.draggingData&&(V.draggingData=null,V.redraw()),Gk(a,P)}}else a._isV&&V._43o(),a._isH&&V._42o()}},isV:function(J){var m=this.list,e=m._29I;return m._41o()&&e.x+e.width-m.lp(J).x<eg},isH:function(C){var c=this.list,_=c._29I;return c._40o()&&_.y+_.height-c.lp(C).y<eg},handle_mousewheel:function(f){this.handleScroll(f,f.wheelDelta/40,f.wheelDelta!==f.wheelDeltaX)},handle_DOMMouseScroll:function(A){this.handleScroll(A,-A.detail,1)},handleScroll:function(k,p,t){var L=this.list;pd(k),L.endEditing&&L.endEditing(),t&&L._41o()?L.translate(0,p*L.getRowHeight()):L._40o()&&L.translate(10*p,0)},handle_keydown:function(n){if(!m.isInput(n.target)){var W,X=this.list,B=X.sm(),e=X._rows,J=e.size();if(jq(n))X.selectAll();else if(xi(n))X.handleDelete&&X.handleDelete(n);else if(Vq(n))"d"!==this._62O||this.dragCancel||(X.handleDragAndDrop(n,"cancel"),this.dragCancel=!0);else if(sc(n))X.isCheckMode()&&(W=X.getFocusData(),W&&X.checkData(W));else if(jc(n)||Cg(n)){var L=X.isCheckMode();if(W=L?X.getFocusData():B.ld()){var K=X.getRowIndex(W);K>=0&&(jc(n)?0!==K&&(W=e.get(K-1),L?X.setFocusData(W):B.ss(W)):K!==J-1&&(W=e.get(K+1),L?X.setFocusData(W):B.ss(W)))}else J>0&&(W=e.get(0),L?X.setFocusData(W):B.ss(W))}}},_34o:function(C,y){var j=this.list,q=j.lp(C).x;return q>=0&&q<=j._indent?(j.checkData(y),void 0):(j.setFocusData(y),void 0)},_33o:function(C,Z){var _=this.list,G=_.sm(),g=G.ld();if(!_.canHandleSelectMode(C,Z))return this._cancelDataDoubleSelect(),void 0;if(Wo(C))_.isSelected(Z)?G.rs(Z):G.as(Z);else if(Vn(C))if(g)for(var n=_.getRowIndex(g),t=_.getRowIndex(Z);n!==t;)n+=t>n?1:-1,G.as(_._rows.get(n));else G.ss(Z);else ti(C)?(G.contains(Z)?_.handleDataDoubleSelect&&(this._handleDataDoubleSelect(C,Z),ds(C)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),G.ss(Z)):G.contains(Z)||G.ss(Z)},_handleDataDoubleSelect:function(X,Z){this._cancelDataDoubleSelect(),this._doubleSelectTimer=Vr(function(){this.list.handleDataDoubleSelect(X,Z),this._doubleSelectTimer=B}.bind(this),m.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(Eh(this._doubleSelectTimer),this._doubleSelectTimer=B)}}),It.TreeView=function(x){var j=this;j._35o(),j._5o(x),new Rt(j)},Jt("TreeView",S,{ms_ac:[Mf,cf,Ac,"rootVisible",Jq,"rootData",Yd,yp,Di,gk,rm,xc,Qb,sd,uk,cd,lr,Fd,md,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:z,_indent:Vp,_rowHeight:As,_rowLineVisible:m.treeViewRowLineVisible,_rowLineColor:m.treeViewRowLineColor,_scrollBarColor:cg,_scrollBarSize:Vf,_autoHideScrollBar:Yn,_expandIcon:m.treeViewExpandIcon,_collapseIcon:m.treeViewCollapseIcon,_autoMakeVisible:yl,_selectBackground:m.treeViewSelectBackground,_labelColor:m.treeViewLabelColor,_labelSelectColor:m.treeViewLabelSelectColor,_labelFont:m.treeViewLabelFont,_doubleClickToToggle:m.treeViewDoubleClickToToggle,drawRow:function(j,D,u,d,r,t,S){var Q=this;Q.drawRowBackground(j,D,u,d,r,t,S),Q.drawTree(j,D,u,0,r,t,S)},isOnToggleIcon:function(T){var H=this.getDataAt(T);if(H){var g=this.getIndent(),s=this.lp(T).x;if(Om(this.getToggleIcon(H))){var p=g*this.getLevel(H);if(s>=p&&p+g>=s)return!0}}return!1}});var Rt=function(L){mg(Rt,this,[L])};Fm(Rt,Qt,{toggle:function(h,d,e,L){var V=this.list,T=V.lp(h).x;if(Om(V.getToggleIcon(d))){var g=e*L;if(T>=g&&g+e>=T)return V.toggle(d),!0}return V.isDoubleClickToToggle()&&ds(h)?(V.toggle(d),!0):!1},_34o:function(n,l){var I=this.list,f=I.lp(n).x,h=I._levelMap[l._id],u=I._indent,b=u*(h+1);return f>=b&&b+u>=f?(I.checkData(l),void 0):(this.toggle(n,l,u,h)||I.setFocusData(l),void 0)},_33o:function(R,_){var S=this,b=S.list;if(!S.toggle(R,_,b._indent,b.getLevel(_)))if(Vn(R)){var D=b.sm();if(D.size()>0){for(var G=b._rows,K=null,j=0,B=G.size();B>j;j++)if(b.isSelected(G.get(j))){K=j;break}for(var c=null,j=G.size()-1;j>=0;j--)if(b.isSelected(G.get(j))){c=j;break}var M,k,T=b.getRowIndex(_);for(K>T?(M=T-1,k=K):T>c?(M=c,k=T):(M=K,k=c);M!==k;)M++,D.as(b._rows.get(M))}else D.ss(_)}else Rt.superClass._33o.call(S,R,_)},handle_keydown:function(r){if(kr(r)||Zg(r)){var j=this.list,u=j._rows,G=j.isCheckMode(),x=j.sm(),_=G?j.getFocusData():x.ld();_?_.hasChildren()&&(kr(r)?j.collapse(_):j.expand(_)):u.size()>0&&(_=u.get(0),G?j.setFocusData(_):x.ss(_))}else Rt.superClass.handle_keydown.call(this,r)}});var St=It.TableView=function(j){this._98I(),this._5o(j),new Tt(this)};Jt("TableView",S,{ms_ac:[Mf,cf,Ac,"sortMode",so,Vi,Qb,sd,uk,xl,tf,"sortColumn",Yd,yp,Di,gk,rm,Fd,md],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ps,_editable:!0,_batchEditable:!1,_rowHeight:As,_rowLineVisible:m.tableViewRowLineVisible,_rowLineColor:m.tableViewRowLineColor,_columnLineVisible:m.tableViewColumnLineVisible,_columnLineColor:m.tableViewColumnLineColor,_scrollBarColor:cg,_scrollBarSize:Vf,_autoHideScrollBar:Yn,_autoMakeVisible:yl,_selectBackground:m.tableViewSelectBackground,_labelColor:m.tableViewLabelColor,_labelSelectColor:m.tableViewLabelSelectColor,_labelFont:m.tableViewLabelFont,getCheckColumn:function(){var g=this;if(!g._31o){var O=g._31o=new Lt;O.setEditable(!0),O.setWidth(40),O.getValue=g.getCheckColumValue,O.drawCell=g.drawCheckColumnCell}return g._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(x){var a=this,S=a._39o,E=a.getCheckColumn();x!==a.isCheckMode()&&(x?S.add(E,0):S.remove(E),a.fp(Jq,!x,x))},getCheckColumValue:function(o,I,j){return j.isSelected(o)},drawCheckColumnCell:function(X,_,R,s,i,W,E,C,J){Mn(X,J.getCheckIcon(_),i+E/2,W+C/2,_,J)}});var Tt=function(h){mg(Tt,this,[h])};Fm(Tt,Qt,{_34o:function(h,W){var P=this.list,T=P._31o;if(P.isCellEditable(W,T,h)){var r=P._3Q(T),j=P.lp(h).x;if(r&&j>=r.startX&&j<r.startX+T.getWidth())return P.checkData(W),void 0}P._37O(W,h),P.setFocusData(W)},_33o:function(n,K){this.list._37O(K,n),Tt.superClass._33o.apply(this,arguments)}});var Ut=It.TreeTableView=function(A){var Y=this,v=Y._4o=new Lt;Y._35o(),Y._98I(),Y._5o(A),v.setDisplayName("Name"),v.setEditable(!0),v.setWidth(180),v.drawCell=Vt,v.getValue=Wt,Y._39o.add(v),new Xt(Y)},Vt=function(m,I,R,Q,D,v,w,L,c){c.drawTree(m,I,R,D,v,w,L)},Wt=function(W,r,V){return V.getLabel(W)};Jt("TreeTableView",S,{ms_ac:[Mf,cf,Ac,"sortMode",so,Vi,xc,Jq,"rootData","rootVisible",Yd,yp,"sortColumn",cd,lr,Di,gk,rm,Fd,uk,Qb,sd,xl,tf,md,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ps,_checkMode:z,_editable:!0,_batchEditable:!1,_indent:Vp,_rowHeight:As,_rowLineVisible:m.treeTableViewRowLineVisible,_rowLineColor:m.treeTableViewRowLineColor,_columnLineVisible:m.treeTableViewColumnLineVisible,_columnLineColor:m.treeTableViewColumnLineColor,_expandIcon:m.treeTableViewExpandIcon,_collapseIcon:m.treeTableViewCollapseIcon,_scrollBarColor:cg,_scrollBarSize:Vf,_autoHideScrollBar:Yn,_autoMakeVisible:yl,_selectBackground:m.treeTableViewSelectBackground,_labelColor:m.treeTableViewLabelColor,_labelSelectColor:m.treeTableViewLabelSelectColor,_labelFont:m.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Xt=function(Q){mg(Xt,this,[Q])};Fm(Xt,Qt,{_34o:function(Q,l){var E=this.list,s=E._4o,b=E._3Q(s),x=E.lp(Q).x;if(b){var u=E._indent,K=b.startX+u*E.getLevel(l);if(Om(E.getToggleIcon(l))&&x>=K&&K+u>=x)return E.toggle(l),void 0;if(E.isCellEditable(l,s)&&(K+=u,x>=K&&K+u>=x))return E.checkData(l),void 0}E._37O(l,Q),E.setFocusData(l)},_33o:function(W,R){var J=this.list,B=J.lp(W).x;if(Om(J.getToggleIcon(R))){var Q=J._3Q(J._4o);if(Q){var C=J._indent,v=Q.startX+C*J.getLevel(R);if(B>=v&&v+C>=B)return J.toggle(R),void 0}}J._37O(R,W),Xt.superClass._33o.apply(this,arguments)}});var Yt=It.TableHeader=function(O){var l=this,H=l._view=Oc(1,l),g=l._39o=O.getColumnModel(),z=l.iv;l.tv=l._tableView=O,l._60I=new An,l._canvas=km(H),H.style.background=m.tableHeaderBackground||"",H.style.height=Ki+Eq,g.mm(z,l),g.md(z,l),g.mh(z,l),O.mp(function(y){zt[y.property]&&l.iv()},l),new Zt(l),l.iv()};Jt("TableHeader",S,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Mf,Ac,xc,"moveBackground","insertColor",xl,tf,"resizable","movable"],_checkIcon:qq,_movable:!0,_resizable:!0,_labelColor:m.tableHeaderLabelColor,_labelFont:m.tableHeaderLabelFont,_columnLineColor:m.tableHeaderColumnLineColor,_columnLineVisible:m.tableHeaderColumnLineVisible,_sortDescIcon:m.tableHeaderSortDescIcon,_sortAscIcon:m.tableHeaderSortAscIcon,_moveBackground:m.tableHeaderMoveBackground,_insertColor:m.tableHeaderInsertColor,_indent:Vp,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(f){return f.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(J){return J.getColor()||this._labelColor},getLabelAlign:function(q){return q._align},onPropertyChanged:function(){this.iv()},_5Q:function(_){this._61I=_,this.iv()},getLogicalPoint:function(n){return Xi(n,this._canvas,this.tv.tx())},validateImpl:function(){var d=this,U=d._canvas,i=d.getWidth(),z=d.getHeight(),e=d.tv,Q=d._60I,M=d._61I,q=-e.tx(),R=0;(i!==U.clientWidth||z!==U.clientHeight)&&Eg(U,i,z),Q.clear(),d._39o._roots.each(function(N){if(N.isVisible()){var M=R+N.getWidth();q+i>=R&&M>=q&&Q.add({column:N,startX:R}),R=M}});var S=rk(U);if(tl(S,-q,0,1),S.beginPath(),S.rect(q,0,i,z),S.clip(),S.clearRect(q,0,i,z),Q.each(function(L){var R=L.column,c=L.startX,X=R.getWidth();X>0&&(S.save(),S.beginPath(),S.rect(c,0,X,z),S.clip(),M&&M.column===R||d.drawColumn(S,R,c,0,X,z),d._columnLineVisible&&rr(S,c+X-1,0,1,z,d._columnLineColor),S.restore())}),M){var Y=M.column,R=M.startX,o=M.position,j=Y.getWidth();S.save(),S.beginPath(),S.rect(R,0,j,z),S.clip(),S.fillStyle=d._moveBackground,S.fill(),d.drawColumn(S,Y,R,0,j,z),S.restore(),ve(S,d._insertColor,o,0,z)}S.restore()},_6Q:function(t){var O=this.tv;return O._31o===t&&O.sm().getSelectionMode()===Ok},drawColumn:function(A,T,N,L,z,p){var M=this,o=M.tv,h=Om(T.getIcon()),w=M.getLabelAlign(T);if(M._6Q(T)){var q=Om(M._checkIcon);Mn(A,q,N+z/2,L+p/2,T,M)}else{var K=M.getLabel(T),D=M.getLabelFont(T),m=M.getLabelColor(T),g=nd(D,K).width,f=h?M._indent:0;w===Mq?(h&&Le(A,h,cl,N,L,f,p),Rd(A,K,D,m,N+f,L,z,p,Mq)):w===ze?(h&&Le(A,h,cl,N+z-g-f,L,f,p),Rd(A,K,D,m,N,L,z,p,ze)):(h&&Le(A,h,cl,N+(z-g-f)/2,L,f,p),Rd(A,K,D,m,N+(z-g+f)/2,L,0,p,Mq))}if(T.isSortable()&&o.getSortColumn()===T&&(h=Om(T.getSortOrder()===Tp?M._sortAscIcon:M._sortDescIcon))){var k=To(h,T)/2+2;Mn(A,h,w===ze?N+k:N+z-k,L+p/2,T,o)}}});var Zt=function(Q){var $=this;$.th=Q,$.tv=Q._tableView,$.addListeners()};Fm(Zt,S,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(Z){this.getView().style.cursor=Z},handle_mousemove:function(c){if(!es){var A=this;delete A._29o,A.setCursor(ck);for(var q=A.th,k=q._60I,V=q.lp(c).x,u=k.size()-1;u>=0;u--){var i=k.get(u),f=i.column,Y=i.startX+f.getWidth();if(q.isResizable()&&n(Y-V)<=(Xl?10:3))return A._29o=i,A.setCursor(Cc),void 0;V>i.startX&&Y>V&&(A._29o=i),(f.isClickable()||f.isSortable()||q.isMovable()||A.tv.getCheckColumn&&f===A.tv.getCheckColumn())&&V>i.startX&&Y>V&&A.setCursor(Gr)}}},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(I){var O=this;pd(I),O.tv.endEditing(),O.handle_mousemove(I),O._29o&&(O.x=el(I).x,O.lx=O.th.lp(I).x,O.w=O._29o.column.getWidth(),Gk(O,I))},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowTouchMove:function(O){var w=this,B=w.th,o=w.getView().style.cursor,z=w._29o,I=el(O).x-w.x;if(w.resizing||w.moving||(o===Cc?w.resizing=1:B.isMovable()&&o===Gr&&n(I)>2&&(w.moving=1)),w.resizing)z.column.setWidth(w.w+I);else if(w.moving){var P=w.lx+I;B._60I.each(function(C){var U=C.startX,n=U+C.column.getWidth();if(P>=U&&n>=P){var R={column:z.column,startX:z.startX+I,front:n-P>P-U,insertColumn:C.column};R.position=R.front?U:n,B._5Q(R)}})
}},_16Q:function(y,q){var h=this,H=h.tv,x=h.th,L=x._checkIcon;if(x._6Q(y)){var A=Om(L),E=h.lx,l=y.getWidth(),c=To(A,y);if(E>=q+l/2-c&&q+l/2+c>=E){x.setCheckIcon(L===Bn?qq:Bn);var w=H.sm(),V=H._rows;return L===Bn?w.rs(V):w.ss(V),H.onCheckColumnClicked(y),!0}}return!1},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(T){var s=this,O=s.tv,b=s.th,k=s._29o;if(s.moving){var N=b._61I;if(N&&N.insertColumn!==N.column){var $=N.column,w=O.getColumnModel()._roots,e=w.remove($),U=w.indexOf(N.insertColumn);U>=0&&(N.front||U++,U<=w.size()&&(w.add($,U),O.getColumnModel()._38I($,e,U)))}b._5Q(z),delete s.moving}else if(!s.resizing&&k){$=k.column;var A=b.lp(T).x,q=k.startX,P=!0;if(b.onColumnClicked){var n=b.onColumnClicked($,T,q);n===!1&&(P=!1)}if(P&&A>=q&&A<=q+$.getWidth()&&!s._16Q($,q)){if($.isSortable()){var d=O.getSortMode(),h=$.getSortOrder();d===ps?O.getSortColumn()===$?(h===ll&&O.setSortColumn(z),$.setSortOrder(h===Tp?ll:Tp)):O.setSortColumn($):"bistate"===d&&(O.getSortColumn()===$?$.setSortOrder(h===Tp?ll:Tp):O.setSortColumn($))}O.onColumnClicked($,T,q)}}s._29o=s.resizing=s.x=s.lx=s.w=z}}),It.TablePane=function(z){this.init(new St(z))},Jt("TablePane",S,{ms_v:1,_44o:1}),It.TreeTablePane=function(z){this.init(new Ut(z))},Jt("TreeTablePane",S,{ms_v:1,_44o:1}),It.Toolbar=function(p){var x=this,C=x._view=Oc(1,x),e=C.style;e.background=m.toolbarBackground||"",e.height=Ci+Eq,x._canvas=km(C),x._30o=new An,x._90I=new An,x.setItems(p||[]),C.handleGroupSelectedChanged=function(X){if(X.isSelected()){var j=X.getGroupId();null!=j&&x._items.forEach(function(O){var l=O.element;l&&l!==X&&l.setSelected&&l.getGroupId&&l.getGroupId()===j&&l.setSelected(!1)})}},new $t(x)},Jt("Toolbar",S,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Zd,Mf,Ac,cf,md,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:m.toolbarLabelColor,_labelSelectColor:m.toolbarLabelSelectColor,_labelFont:m.toolbarLabelFont,_selectBackground:m.toolbarSelectBackground,_itemGap:m.toolbarItemGap,_separatorColor:m.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(H){var O=this.getItemInfoAt(H);return O?O.item.toolTip:z},getLabelColor:function(r){return r&&r.selected&&r.type!==Bn&&r.type!==_g?this._labelSelectColor:this._labelColor},onPropertyChanged:function(Q){this.iv(),Q.property===Zd&&this._items.forEach(function(V){Nk(V)})},redraw:function(){this.iv()},addItem:function(d,J){var K=this._items;J==z?K.push(d):K.splice(J,0,d),this.fp(Zd,z,K)},removeItem:function(Y){if(Y)for(var F=this._items,x=0;x<F.length;x++)Y===F[x]&&(F.splice(x,1),this.fp(Zd,z,F))},removeItemById:function(g){if(g!=z)for(var E=this._items,W=0;W<E.length;W++)if(g===E[W].id){var j=E.splice(W,1)[0];return this.fp(Zd,z,E),j}},getItemById:function(Y){if(Y!=z)for(var T=this._items,h=0;h<T.length;h++){var g=T[h];if(Y===g.id)return g}},setItemVisible:function(g,x){var U=this.getItemById(g);U&&(U.visible=x)},getItemInfos:function(){return this._30o},getItemInfoAt:function(h){var u=this,b=0,A=u._30o,_=u.lp(h),Q=_.x,f=_.y;if(f>=0&&f<=u.getHeight())for(;b<A.size();b++){var l=A.get(b);if(l.startX<=Q&&Q<=l.endX)return l}return z},drawItem:function(T,P,q,r,B){if(P.visible===!1)return 0;if(Qr(P.visible)&&!P.visible())return 0;var I=this,u=P.disabled;u&&(T.globalAlpha=Xn);var d=I.drawItemImpl(T,P,q,r,B),V=I._itemGap;return u&&(T.globalAlpha=1),this._currentItem!==P||"separator"===P||P.separator===!0||P.unfocusable||rl(T,I._separatorColor,q-V/2,0,d+V,r),d},drawItemImpl:function(P,V,I,t,e){var R=this,n=R._view,C=R._itemGap,q=t/2,F=V.type,M=V.element,T=V.label;hq(M)&&(T=M,M=z);var K,a=R.getLabelFont(V),s=R.getLabelColor(V),U=V.selected,c=Om(V.icon),v=To(c,V),X=0,m=v+(T?nd(a,T).width:0);if("separator"===V||V.separator===!0)return ve(P,R._separatorColor,I,t/4,q),1;if(M){c&&Mn(P,c,I+v/2,q,V,R),Rd(P,T,a,s,I+v,0,0,t);var O=Ll(M);e||R._90I.add(O),O.parentNode!==n&&as(n,O),M.iv&&M.iv(),M.validate&&M.validate();var L=O.getBoundingClientRect(),p=L.width,x=O.style;return Ro(O),x.left=R.tx()+I+m+Eq,x.top=(t-L.height)/2+Eq,m+p}return F===_g?K=Om(U?_r:_q):F===Bn&&(K=Om(U?Bn:qq)),K?(X=To(K,V),Mn(P,K,I+X/2,q,V,R),I+=X,m+=X):U&&rr(P,I-C/2,0,m+C,t,R.getSelectBackground(V)),c&&Mn(P,c,I+v/2,q,V,R),Rd(P,T,a,s,I+v,0,0,t),m},validateImpl:function(){var f=this,M=f._canvas,x=f.getWidth(),b=f.getHeight(),l=f._30o,Y=f._items;Eg(M,x,b);var z=rk(M),N=f._itemGap,T=N/2;tl(z,f.tx(),0,1),z.clearRect(0,0,x,b);var B=f._90I;f._90I=new An,l.clear(),Y.forEach(function(m){var F=f.drawItem(z,m,T,b);l.add({item:m,startX:T,endX:T+F,width:F}),F&&(T+=F+N)}),B.each(function(m){f._90I.contains(m)||zr(m)});var E=f._64I;f._64I=$(0,T-N/2),z.restore(),f._stickToRight?(f._65O=0,z=rk(M),T=x-f._64I+N/2,tl(z,0,0,1),z.clearRect(0,0,x,b),l.clear(),Y.forEach(function(h){var Z=f.drawItem(z,h,T,b,!0);l.add({item:h,startX:T,endX:T+Z,width:Z}),Z&&(T+=Z+N)}),z.restore()):f.tx(f.tx()),E!==f._64I&&f.onSumWidthChanged(E,f._64I)},onSumWidthChanged:function(){},handleClick:function(N,s){var a=this,k=N.type,V=N.action,h=N.groupId,L=N.selected;N.disabled||(h!=z?L||(N.selected=!0,this._items.forEach(function(H){H.groupId===h&&N!==H&&(H.selected=!1)}),V&&N.action(N,a,s)):k===Bn||"toggle"===k?(N.selected=!L,V&&N.action(N,a,s)):V&&N.action(N,a,s)),yd(),a.iv()}});var $t=function(n){this.tb=n,this.addListeners()};Fm($t,S,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(Z){this.handleScroll(Z,10*(Z.wheelDelta/40))},handle_DOMMouseScroll:function(N){this.handleScroll(N,10*-N.detail)},handleScroll:function(b,E){pd(b);var l=this.tb;l.isScrollable()&&!l._stickToRight&&(l.tx(l.tx()+E),Nj())},handle_mousemove:function(t){var y=this;es||y.setItem(t)},handle_mouseout:function(M){var D=this;M.target===D.getView()?D.tb.setCurrentItem(z):D.handle_mousemove(M)},handle_mousedown:function(v){this.handle_mousemove(v),this.handle_touchstart(v)},handle_touchstart:function(e){var B=this,I=B.tb,H=e.target;ti(e)&&(H===B.getView()||H===I._canvas)&&(pd(e),I.setFocus(e)&&(this.setItem(e,!0),(I.isScrollable()||B.info&&!B.info.item.disabled)&&(B.x=el(e).x,B.tx=I.tx(),Gk(B,e))))},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(c){var k=this,s=k.tb;if(!s._stickToRight){var y=el(c).x-k.x;!k._25o&&n(y)>2&&s.isScrollable()&&(k._25o=1),k._25o&&s.tx(k.tx+y)}},handleWindowMouseUp:function(P){this.handleWindowTouchEnd(P)},handleWindowTouchEnd:function(Q){var N=this,l=N.tb,C=N.info,k=N.tb.getItemInfoAt(Q);if(!N._25o&&C){var g=C.item;k&&k.item===g&&l.handleClick(g,Q)}N._25o=N.x=N.tx=z,N.setItem()},setItem:function(K,E){var _=this,q=_.tb,$=_.info=K?q.getItemInfoAt(K):z,b=$?$.item:z;q.setCurrentItem(b),E&&b&&Qr(b.onDown)&&b.onDown(K)}}),It.BorderPane=function(){this._view=Oc(1,this),this.iv()},Jt("BorderPane",S,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(t,v){this._12o("leftView",t),v!=z&&this.setLeftWidth(v)},getRightView:function(){return this._rightView},setRightView:function(M,c){this._12o("rightView",M),c!=z&&this.setRightWidth(c)},getTopView:function(){return this._topView},setTopView:function(X,J){this._12o("topView",X),J!=z&&this.setTopHeight(J)},getBottomView:function(){return this._bottomView},setBottomView:function(A,$){this._12o("bottomView",A),$!=z&&this.setBottomHeight($)},getCenterView:function(){return this._centerView},setCenterView:function(j){this._12o("centerView",j)},_12o:function($,P){var b=this,k="_"+$,O=b._view,A=b[k];A!==P&&(A&&(A.getView?zr(A.getView()):zr(A)),b[k]=P,P&&(P.getView?as(O,P.getView(),1):as(O,P,1)),b.fp($,A,P))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var G=this,I=G._topView,b=G._bottomView,u=G._leftView,K=G._rightView,e=G._centerView,t=G.getWidth(),U=G.getHeight(),v=0,q=0,p=t,Z=U,V=0,J=0,Q=0,k=0;I&&(V=G._topHeight==z?dm(I):G._topHeight,q=V),b&&(J=G._bottomHeight==z?dm(b):G._bottomHeight,Z=U-J),u&&(Q=G._leftWidth==z?Ce(u):G._leftWidth,v=Q),K&&(k=G._rightWidth==z?Ce(K):G._rightWidth,p=t-k);var x=$(0,p-v),l=$(0,Z-q);I&&fs(I,0,0,t,V),b&&fs(b,0,Z,t,J),u&&fs(u,0,q,Q,l),K&&fs(K,p,q,k,l),e&&fs(e,v,q,x,l)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);