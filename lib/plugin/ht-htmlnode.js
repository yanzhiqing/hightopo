!function(z){"use strict";var m="ht",A=z[m],t=function(){return document},R=function(){return t().body},D=function(N,m,R){N.style.setProperty(m,R,null)},c=function(M){return t().createElement(M)},G=function(){return c("div")},g=function(){var r=c("canvas");return r},$=function($,c){D($,"-webkit-transform",c),D($,"-ms-transform",c),D($,"transform",c)},W=function(i,L){D(i,"-webkit-transform-origin",L),D(i,"-ms-transform-origin",L),D(i,"transform-origin",L)},r=function(k,I){k.appendChild(I)},y=function(O,E){O.removeChild(E)},h=z.parseInt,M=A.Default,q=M.getInternal(),J=q.addEventListener,B=(q.removeEventListener,Math.PI),Q="white-space",F="visibility",i="left",a="top",X="width",f="height",U="position",o="display",Y="z-index",H="px",n="0 0",S="absolute",l="visible",j="hidden",k="none",T="block",L="nowrap",p="rgba(0, 0, 0, 0.005)";M.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var P=A.graph.GraphView.prototype,N=P._42;P.adjustHtmlNodeIndex=!0,P._42=function(U,y){if(N.call(this,U,y),this.adjustHtmlNodeIndex)for(var v=this.getDataModel()._datas._as,K=v.length,W=1,q=0;K>q;q++){var $=v[q];if($ instanceof e){var A=this.getDataUI($);D(A.$2f,Y,W+""),D(A.$3f,Y,W+1+""),W+=2}}};var V=A.HtmlNodeUI=function(y,b){var r=this;V.superClass.constructor.call(r,y,b);var X=r.$2f=G(),f=r.$3f=g();D(X,U,S),D(X,F,j),D(X,Q,L),f.draggable=!1,D(f,U,S),D(f,o,k),W(f,n),J(X,"change",function(E){var G=E.target,l=G.bind||G.getAttribute("bind"),s=G.type&&"checkbox"===G.type?G.checked:G.value,S=b.getContext();l&&S&&(S[l]=s,r.$4f=JSON.stringify(S))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(V){J(X,V,this.$9f.bind(this))},r)};M.def(V,q.ui().NodeUI,{_visible:!0,$11f:function(){var Z=this,G=Z.$3f,Q=Z._data,U=Q.getDraggerImageWidth(),V=Q.getDraggerImageHeight(),J=Q.getDraggerImage(),O=q.initContext(G);O.beginPath(),q.setCanvas(G,U,V),q.translateAndScale(O,0,0,1),O.clearRect(0,0,U,V),M.drawImage(O,M.getImage(J),0,0,U,V),O.restore()},_80o:function(C){V.superClass._80o.call(this,C);var L=this,n=L._data,t=n._padding,b=2*t,w=L.$2f,A=L.$3f,J=L.gv,E=J.getZoom(),e=J.getTranslateX(),z=J.getTranslateY(),g=J.getView(),M=L._83o,Z=n._width,s=n._height,P=M.position,v=M.rotation,R=(Z-b)/n.$5f*E,x=(s-b)/n.$6f*E,y=L._html,O=n._html,m=n.getHtmlType();if("html"===m){var d=n.getContext()||{},c=L.$4f,I=n.$10f,u=JSON.stringify(d);y&&c&&y===O&&c===u||(L.$4f=u,L._html=O,w.innerHTML=I?I(d):O)}else if(null!=m){var K=n.getHtml();"ht"===m&&(K=K.getView()),y&&y===K&&w.contains(y)||(L._html=K,w.innerHTML="",r(w,K))}if(!w.parentNode){var N=J.$1f;if(!N){var W=G();D(W,U,S),D(W,Y,"0"),N=J.$1f=W;var q=J._canvas.nextSibling;q?g.insertBefore(W,q):r(g,W)}r(N,w),r(N,A),n.onContentInitialized&&n.onContentInitialized(w)}if(n._scalable){var Q=n.$5f,_=n.$6f;$(w,"rotate("+180*(v/B)+"deg) scale("+R+","+x+")"),D(w,X,""),D(w,f,""),D(w,i,(P.x-Q/E/2)*E+e+H),D(w,a,(P.y-_/E/2)*E+z+H)}else{var _c=h(w.style.width),gi=h(w.style.height),hc=h((Z-b)*E),sj=h((s-b)*E),wn="100%",rq=w.children[0];D(rq,X,wn),D(rq,f,wn),(_c!==hc||gi!==sj)&&(D(w,X,hc+H),D(w,f,sj+H),"ht"===m&&O.invalidate()),$(w,"rotate("+180*(v/B)+"deg)"),D(w,i,(P.x-hc/E/2)*E+e+H),D(w,a,(P.y-sj/E/2)*E+z+H)}var uj=L.dragRect;J.isMovable(n)&&J.isSelected(n)&&uj?(C.save(),C.fillStyle=p,C.fillRect(uj.x,uj.y,uj.width,uj.height),C.restore(),D(A,i,uj.x*E+e+H),D(A,a,uj.y*E+z+H),$(A,"scale("+E+","+E+")"),D(A,o,T),L.$11f()):D(A,o,k),D(w,F,this._visible?l:j)},dispose:function(){var g=this.gv.$1f;this.$2f.parentNode===g&&g.removeChild(this.$2f),this.$3f.parentNode===g&&g.removeChild(this.$3f)},_84o:function(K){this._visible=K,D(this.$2f,F,K?l:j),D(this.$3f,o,K?T:k)},_3O:function(){var e=this,U=e.gv,r=e._data;V.superClass._3O.call(e);var x=r.getRect();U.isEditable(r)&&(e.dragRect={x:x.x+x.width+r._padding,y:x.y+10,width:r.getDraggerImageWidth(),height:r.getDraggerImageHeight()},e._68o(e.dragRect))},rectIntersects:function(e){var C=this._79o();return A.Default.intersection(C,e)?!0:void 0},$9f:function(t){var O=this.gv,U=this._data;O.sm().contains(U)&&t.stopPropagation()}});var e=A.HtmlNode=function(){e.superClass.constructor.call(this)};A.Default.def(e,A.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:A.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(l){var Z=this,k=Z._html;Z._html=l,"html"===Z.getHtmlType()&&"Handlebars"in z&&(Z.$10f=Handlebars.compile(l)),Z.$13f(),Z.fp("html",k,l)},setContext:function(S){var s=this,l=s._context;s._context=S,s.fp("context",l,S),s.$13f()},setScalable:function(e){var h=this,Y=h._scalable;h._scalable=e,h.fp("scalable",Y,e),h.$13f()},getHtmlType:function(){var P=this._html;return P?"string"==typeof P?"html":P.getView?"ht":"dom":null},$13f:function(){var v=this,c=v._html,t=v.$10f;if(c){var k=G(),X=!1,B=v.getHtmlType();if(D(k,U,S),D(k,Q,L),D(k,F,j),"html"===B?(k.innerHTML=t?t(v.getContext()||{}):c,X=!0):"ht"===B?(r(k,c.getView()),X=!0):"dom"===B&&(r(k,c),X=!0),X){var M=2*v._padding;r(R(),k),v.$5f=k.scrollWidth,v.$6f=k.scrollHeight,v._width=v.$5f+M,v._height=v.$6f+M,v._originWidth=v._width,v._originHeight=v._height,y(R(),k)}}},getUIClass:function(){return A.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);