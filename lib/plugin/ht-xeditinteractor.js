!function(y,Z,z){"use strict";var l="ht",s=y[l],N=s.Default,$=s.graph,f=N.getInternal(),t=f.ui(),V=t.NodeUI.prototype,g=t.ShapeUI.prototype,A=$.GraphView,e=A.prototype,o=t.EdgeUI.prototype,v=s.Node,b=s.Shape,T=s.Edge,I=s.Group,R=N.isTouchable,i=N.isTouchEvent,h=N.preventDefault,C=y.setTimeout,n=N.grow,H=N.isDragging,M=N.getDistance,L=null,w=s.List,G="undefined"!=typeof Float32Array?Float32Array:Array,q=Math,K=q.PI,p="Crossing",S="No Crossing",P=K/2,x=2*K,c=q.atan2,r=q.sqrt,Y=q.pow,Q=q.sin,E=q.cos,j=q.min,J=q.max,u=q.abs,W=q.ceil,B=q.round,m=N.unionPoint,U=N.unionRect,F=N.containsPoint,X=N.clone,d="rgb(52, 152, 219)",k="red",O={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},_={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var y=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],l=0;l<y.length;l++){var U=y[l];U=0===l%2?U/400*_.width:U/100*_.height,y[l]=U}return _.width>120&&(y[4]=_.width-26,y[6]=_.width-40,y[10]=_.width-40,y[12]=_.width-26,y[18]=33),y}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},D={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:d,rotation:.61},{type:"circle",rect:[200,120,70,70],background:d,rotation:.61},{type:"circle",rect:[200,220,70,70],background:d,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:d},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:d}]},a={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:k,rotation:.61}]},Yp={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:d},{type:"circle",rect:[0,210,90,90],background:d},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:d}]},Tl={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:k},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:k}]},lo={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:d}]},de={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:k}]},_e={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Xn={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Od=function(G){var e=G.touches[0];return e?e:G.changedTouches[0]},bc=function(C,P,$,g){return c(g-P,$-C)},ee=function(P,k){return{x:P.x*k,y:P.y*k}},Dn=function(p,m){p.each(function(A){return p.isSelected(A)?m(A):void 0})},Rc=function(l,V){l.reverseEach(function(d){return l.isSelected(d)?V(d):void 0})},Cp=function(e,Y,l){var O,i,y,o,H,P=this,n=Y,p=P.gv;if(e instanceof b){y=e.getSegments();var J=p.getDataUI(e);H=J._55O.$15l,y&&y.size()||(y=vo(H)),e.isClosePath()&&y.indexOf(5)<0&&(y=new w(y._as),y.add(5)),O=Xc(e,J,n),i=H[O]}else{var h=p.getDataUI(e);H=Qg(h,e.s("edge.points")),y=e.s("edge.segments"),y&&y.size()||(y=vo(H)),H=H._as,O=Xc(e,h,n),i=H[O]}if(y&&(o=y.get(n)),2===o||1===o||5===o){var C=H[O+1];5===o&&(C=H[0]);var $=Bc(i,l,C);return $}return l},ti=function(E,A,j,B){var r=A/2,l=j/2,U=Rb(E,-r,-l,B),C=Rb(E,r,-l,B),y=Rb(E,-r,l,B),W=Rb(E,r,l,B),P=Rb(E,0,-l,B),x=Rb(E,r,0,B),h=Rb(E,0,l,B),a=Rb(E,-r,0,B);return[U,C,y,W,P,x,h,a]},Bc=function(e,P,N){var _={x:P.x-e.x,y:P.y-e.y},s={x:N.x-e.x,y:N.y-e.y},O=r(Y(N.x-e.x,2)+Y(N.y-e.y,2)),W={x:s.x/O,y:s.y/O},F=_.x*W.x+_.y*W.y,C={x:W.x*F,y:W.y*F};return{x:e.x+C.x,y:e.y+C.y}},Rb=function(x,O,N,p){var v=E(p)*O-Q(p)*N,A=Q(p)*O+E(p)*N;return x?{x:x.x+v,y:x.y+A}:{x:v,y:A}},rd=function(N,a){return a>2*N?N:a/2},Jp=function(l,f,N,Q){var m=M(l,f);return N=Q?j(N,m):rd(N,m),m?N/=m:N=0,{x:l.x+(f.x-l.x)*N,y:l.y+(f.y-l.y)*N}},mq=function(U,c){var M,u,Y=U.gv,X=U._data,n=X._40I,Z=X._41I,Q=X.s("edge.offset"),a=X.s("edge.source.position"),l=X.s("edge.target.position"),P=X.s("edge.source.offset.x"),t=X.s("edge.source.offset.y"),O=X.s("edge.target.offset.x"),o=X.s("edge.target.offset.y"),v=X.s("edge.source.anchor.x"),E=X.s("edge.source.anchor.y"),$=X.s("edge.target.anchor.x"),p=X.s("edge.target.anchor.y");if(c?(M=f.getEdgeAgentPosition(Y,n,a,P,t,v,E),u=f.getEdgeAgentPosition(Y,Z,l,O,o,$,p)):(M=f.getEdgeAgentPosition(Y,n,a,0,0,v,E),u=f.getEdgeAgentPosition(Y,Z,l,0,0,$,p)),"points"===X.s("edge.type")&&Q&&!X.s("edge.center")&&M){var R=X.s("edge.points")||new w,H=R.size(),V=Jp(M,H?R.get(0):u,Q,H),x=Jp(u,H?R.get(H-1):M,Q,H);M=V,u=x}return[M,u]},Qg=function(K,I,n){var O=K._78o,F=K._data,d=F.s("edge.type"),m=[O.sourcePoint,O.targetPoint];return"points"===d?n&&(m=mq(K)):m=O.center?d?n?mq(K):mq(K,!0):n?mq(K):[O.c1,O.c2]:n?mq(K):mq(K,!0),I=new w(I?I._as:L),I.add(m[0],0),I.add(m[1]),I},Dp=function(o){return o=new w(o._as),o.removeAt(0),o.removeAt(o.size()-1),o},vo=function(j){j._as||(j=new w(j));var q=new w;q.add(1);for(var u=1;u<j.size();u++)q.add(2);return q},qm=function(G,w){return{x:(G.x+w.x)/2,y:(G.y+w.y)/2}},aq=function(Z,R){return{x:Z.x+1*(R.x-Z.x)/4,y:Z.y+1*(R.y-Z.y)/4}},wh=function(D,L){return{x:D.x+3*(L.x-D.x)/4,y:D.y+3*(L.y-D.y)/4}},Lg=function(w,I,K,g){var D=I.x+I.width/2,R=I.y+I.height/2,u=r(D*D+R*R),o=c(R,D)+K;return{x:g.x+u*E(o),y:g.y+u*Q(o)}},li=e.validateImpl,Nc=e.isRectEditable,db=e.isPointEditable,Jl=e._42,Hj=g._79o,lg=o._79o,Ro=g._48O,Ng=g._47O,Le=V._48O,Te=V._80o,yg=g._80o,Tg=V.getSelectWidth,Sr=V._47O,Gk=o._47O,$h=e.isEditable,ae=["northwest","north","northeast","east","southeast","south","southwest","west"],Hl=function(F,v,S,b,B,x,P,r,s,Z){var W=F.x,G=F.y,X=F.width,g=F.height,Q={x:W+X/2,y:G+g/2};b=b||0,v=Rb(Q,v.x-Q.x,v.y-Q.y,-b),P&&!r&&(v.x+=s,v.y+=Z);var q=.01;if("northwest"===S?(v.x+B>W+X-q&&(v.x=W+X-B-q),v.y+B>G+g-q&&(v.y=G+g-B-q),F=m(v,{x:W+X,y:G+g})):"north"===S?(v.y+B>G+g-q&&(v.y=G+g-B-q),F=m({x:W,y:v.y},{x:W+X,y:G+g})):"northeast"===S?(v.x<W+B+q&&(v.x=W+B+q),v.y+B>G+g-q&&(v.y=G+g-B-q),F=m({x:W,y:v.y},{x:v.x,y:G+g})):"west"===S?(v.x+B>W+X-q&&(v.x=W+X-B-q),F=m({x:v.x,y:G},{x:W+X,y:G+g})):"east"===S?(v.x<W+B+q&&(v.x=W+B+q),F=m({x:W,y:G},{x:v.x,y:G+g})):"southwest"===S?(v.x+B>W+X-q&&(v.x=W+X-B-q),v.y<G+B+q&&(v.y=G+B+q),F=m({x:v.x,y:G},{x:W+X,y:v.y})):"south"===S?(v.y<G+B+q&&(v.y=G+B+q),F=m({x:W,y:G},{x:W+X,y:v.y})):"southeast"===S&&(v.x<W+B+q&&(v.x=W+B+q),v.y<G+B+q&&(v.y=G+B+q),F=m({x:W,y:G},v)),"keepRatio"===x&&(!P&&r||P&&!r)&&("northeast"===S||"southeast"===S||"northwest"===S||"southwest"===S)){var f=F.width,n=F.height,y=f/X,t=n/g,e=j(y,t);F.width=X*e,F.height=g*e,"northeast"===S?F.y=G+(g-F.height):"northwest"===S?(F.y=G+(g-F.height),F.x=W+(X-F.width)):"southwest"===S&&(F.x=W+(X-F.width))}F.x-=Q.x,F.y-=Q.y;var Y=Lg(L,F,b,Q);return F.x=Y.x-F.width/2,F.y=Y.y-F.height/2,F},Ni=function(K,J,r,u){var t=K.getRotation(),H=J,f=H.x,e=H.y,b=H.width,g=H.height,d={x:f+H.width/2,y:e+H.height/2};u=Rb(d,u.x-d.x,u.y-d.y,-t),"northwest"===r?H=m(u,{x:f+b,y:e+g}):"north"===r?H=m({x:f,y:u.y},{x:f+b,y:e+g}):"northeast"===r?H=m({x:f,y:u.y},{x:u.x,y:e+g}):"west"===r?H=m({x:u.x,y:e},{x:f+b,y:e+g}):"east"===r?H=m({x:f,y:e},{x:u.x,y:e+g}):"southwest"===r?H=m({x:u.x,y:e},{x:f+b,y:u.y}):"south"===r?H=m({x:f,y:e},{x:f+b,y:u.y}):"southeast"===r&&(H=m({x:f,y:e},u)),K.setRect(H),H.x-=d.x,H.y-=d.y;var X=Lg(K,H,t,d);K.p(X.x,X.y)},jf=function($,X,h,A,q,_,Z,y){var w=L;_?(w=Rb(L,q.x-X.x,q.y-X.y,-h),w.x-=Z.x,w.y-=Z.y):w=Rb(L,q.x-X.x,q.y-X.y,0);var Y={x:X.x+w.x,y:X.y+w.y};y&&(Y=y(Y.x,Y.y)),Y.e=$.getPoints().get(A).e,$.setPoint(A,Y);var l=$.getWidth(),R=$.getHeight(),V=$.p().x-l/2,s=$.p().y-R/2;V-=X.x,s-=X.y;var f=Lg($,{x:V,y:s,width:l,height:R},h,X);$.p(f.x,f.y)},Xc=function(m,S,p){var I,M;if(m instanceof b?(I=m.getPoints(),M=m.getSegments()):m instanceof T&&"points"===m.s("edge.type")&&(I=m.s("edge.points"),M=m.s("edge.segments"),I=Qg(S,I)),M&&M.size()||(M=vo(I)),m instanceof b&&m.isClosePath()&&M.indexOf(5)<0&&(M=new w(M._as),M.add(5)),M)for(var F=-1,$=0;$<M.size();$++){if($===p)return F;var y=M.get($);1===y?F+=1:2===y?F+=1:3===y?F+=2:4===y&&(F+=3)}},Im=function(y,A,m){var k,P;if(y instanceof b?(k=y.getPoints(),P=y.getSegments()):y instanceof T&&"points"===y.s("edge.type")&&(k=y.s("edge.points"),P=y.s("edge.segments"),k=Qg(A,k)),P&&P.size()||(P=vo(k)),P)for(var v=-1,E=0;E<P.size();E++){var U=P.get(E);if(1===U?v+=1:2===U?v+=1:3===U?v+=2:4===U&&(v+=3),v===m)return E}},dp=function(q,s){var a=[q[0]-s[0],q[1]-s[1],q[2]-s[2]];return a},cd=function(){var X=new G(16);return X[0]=1,X[1]=0,X[2]=0,X[3]=0,X[4]=0,X[5]=1,X[6]=0,X[7]=0,X[8]=0,X[9]=0,X[10]=1,X[11]=0,X[12]=0,X[13]=0,X[14]=0,X[15]=1,X},Bs=function(l,k){var w=l[0],K=l[1],i=l[2];return l[0]=k[0]*w+k[4]*K+k[8]*i+k[12],l[1]=k[1]*w+k[5]*K+k[9]*i+k[13],l[2]=k[2]*w+k[6]*K+k[10]*i+k[14],l},oc=function(W,K){if(K){var x=Q(K),C=E(K),L=W[0],m=W[1],V=W[2],T=W[3],M=W[8],i=W[9],d=W[10],v=W[11];W[0]=L*C-M*x,W[1]=m*C-i*x,W[2]=V*C-d*x,W[3]=T*C-v*x,W[8]=L*x+M*C,W[9]=m*x+i*C,W[10]=V*x+d*C,W[11]=T*x+v*C}},rh=function(z,p){for(var Y=z.s("grid.row.count"),U=z.s("grid.column.count"),w=0;Y>w;w++)for(var D=0;U>D;D++){var g=z.getCellRect(w,D);if(F(g,p))return{rowIndex:w,columnIndex:D,rect:g,grid:z}}return null},yf=function(G,_,T,v,R,M){var A={},Z=T-G,b=v-_,D=q.sqrt(Z*Z+b*b),P=Z/D,E=b/D,m=(-G+R)*P+(-_+M)*E;return 0>=m?(A.x=G,A.y=_):m>=D?(A.x=T,A.y=v):(A.x=G+m*P,A.y=_+m*E),Z=R-A.x,b=M-A.y,A.z=q.sqrt(Z*Z+b*b),A},Cj=function(K,D){var G,_,e,Q,q,s,X,x,B=K.getPoints(),u=K.getSegments(),c=K.p(),S=K.getRotation();if(!u||!(u.indexOf(3)>0||u.indexOf(4)>0)){for(x=0;x<=B.size()-1;x++)if(x===B.size()-1?(q=B.get(0),Q=B.get(x)):(Q=B.get(x),q=B.get(x+1)),Q=Rb(c,Q.x-c.x,Q.y-c.y,S),q=Rb(c,q.x-c.x,q.y-c.y,S),s=yf(Q.x,Q.y,q.x,q.y,D.x,D.y),X=s.z,X<(K.s("shape.border.width")||10)){_=Q,e=q,G=x;break}if(G!=L){var C=yf(_.x,_.y,e.x,e.y,D.x,D.y),f=M(_,C);return{attachIndex:G,attachOffset:f}}}},_q=function(w){for(var H=w._data,j=H.p(),T=H.getRotation(),n=H.getPoints(),d=L,c=[],t=0;t<n.size();t++)d=n.get(t),c.push(Rb(j,d.x-j.x,d.y-j.y,T));w._55O.$15l=c};N.setImage("xeditinteractor_parentIcon",D),N.setImage("xeditinteractor_hostIcon",a),N.setImage("xeditinteractor_edgeIcon",Yp),N.setImage("xeditinteractor_removeIcon",Tl),N.setImage("xeditinteractor_sourceIcon",lo),N.setImage("xeditinteractor_targetIcon",de),N.setImage("xeditinteractor_elevationIcon",_e),N.setImage("xeditinteractor_tallIcon",Xn),e._editPointSize=R?24:9,e._edgeHelpers=["parent","remove","source","target"],e._leftTopHelpers=["parent"],e._rightTopHelpers=["host"],e._leftBottomHelpers=["edge"],e._rightBottomHelpers=["remove"],ae=ae.concat(ae).concat(ae),o._79o=function(){var T=this,A=T.gv,f=A.getZoom(),v=A._editInteractor,h=lg.call(T);if(!h)return null;var J=mq(T,!0),Q=J[0],G=J[1],g={x:h.x,y:h.y,width:h.width,height:h.height},V=m(Q,G);if(v instanceof $.XEditInteractor){g=U(g,V);var l=T._55O,j=A.getEditPointSize()/f+2,Y=0;l&&l._43O&&(Y+=j/2,n(g,Y))}return g},o._47O=function(g){var _=this,u=_.gv,a=u._editInteractor;a instanceof $.XEditInteractor||Gk.call(_,g)},o.rectIntersects=function(Z){var H=this,S=H._data,k=H.gv,J=k.getZoom(),u=H._55O,h=k._editInteractor;if(h instanceof $.XEditInteractor&&k.isEditable(S)&&u&&u._43O&&"points"===S.s("edge.type")){var z=S.s("edge.points"),X=S.s("edge.segments");z=Qg(H,z),X&&X.size()||(X=vo(z)),z=z._as;var l=!1,V=R?5:1,N=Z.x+V,b=Z.y+V,v={x:N,y:b};if(h._edge===S&&h._hoverSegmentIndex>=0){var y=k._editInteractor._hoverSegmentIndex,F=X.get(y),r=Xc(S,H,y),Q=L;if(r!=L&&r>=0){var B=z[r],U=k.getSegmentHoverWidth()/J;if(2===F||1===F){var i=z[r+1];Q=Ym(new zi(B.x,B.y),new zi(i.x,i.y),new zi(v.x-U,v.y-U),new zi(v.x+2*U,v.y+2*U)),Q.$62l===p&&(l=!0)}else if(3===F){var Y=z[r+1],i=z[r+2];Q=Fl(new zi(B.x,B.y),new zi(Y.x,Y.y),new zi(i.x,i.y),new zi(v.x-U,v.y-U),new zi(v.x+2*U,v.y+2*U)),Q.$62l===p&&(l=!0)}else if(4===F){var w=z[r+1],s=z[r+2];i=z[r+3],Q=an(new zi(B.x,B.y),new zi(w.x,w.y),new zi(s.x,s.y),new zi(i.x,i.y),new zi(v.x-U,v.y-U),new zi(v.x+2*U,v.y+2*U)),Q.$62l===p&&(l=!0)}}}if(l)return!0}return L},g._47O=function(Y){var H=this,R=H.gv,N=R._editInteractor;N instanceof $.XEditInteractor||Ng.call(H,Y)},g.rectIntersects=function(k){var x=this,f=x._data,O=x.gv,Z=O.getZoom(),z=x._55O,C=O._editInteractor;if(C instanceof $.XEditInteractor&&O.isEditable(f)&&z&&z._43O){var W=z.$15l,e=!1,l=R?5:1,d=k.x+l,m=k.y+l,q={x:d,y:m};if(W&&W.length===f.getPoints().size()||(_q(x),W=z.$15l),C._shape===f&&C._hoverSegmentIndex>=0){var b=f.getSegments();b&&b.size()||(b=vo(W));var v=O._editInteractor._hoverSegmentIndex,s=b.get(v),M=Xc(f,x,v),A=L;if(M!=L&&M>=0){var o=W[M],E=O.getSegmentHoverWidth()/Z;if(2===s||1===s){var Y=W[M+1];A=Ym(new zi(o.x,o.y),new zi(Y.x,Y.y),new zi(q.x-E,q.y-E),new zi(q.x+2*E,q.y+2*E)),A.$62l===p&&(e=!0)}else if(3===s){var r=W[M+1],Y=W[M+2];A=Fl(new zi(o.x,o.y),new zi(r.x,r.y),new zi(Y.x,Y.y),new zi(q.x-E,q.y-E),new zi(q.x+2*E,q.y+2*E)),A.$62l===p&&(e=!0)}else if(4===s){var t=W[M+1],V=W[M+2];Y=W[M+3],A=an(new zi(o.x,o.y),new zi(t.x,t.y),new zi(V.x,V.y),new zi(Y.x,Y.y),new zi(q.x-E,q.y-E),new zi(q.x+2*E,q.y+2*E)),A.$62l===p&&(e=!0)}}}if(e)return!0}return L},g._48O=function(){var Y=this,C=Y.gv,q=C._editInteractor;q instanceof $.XEditInteractor?(V._48O.call(Y),Y._55O._43O&&_q(Y)):Ro.call(Y)},g._79o=function(){var I=this,O=I.gv,E=O.getZoom(),F=O._editInteractor,Y=Hj.call(I);if(Y){var d={x:Y.x,y:Y.y,width:Y.width,height:Y.height};if(F instanceof $.XEditInteractor){var c=I._55O,t=O.getEditPointSize()/E+2,u=0;c&&c._43O&&(u+=t/2,n(d,u))}return d}},V._47O=function(g){var Y=this,C=Y.gv,N=C._editInteractor;if(N instanceof $.XEditInteractor);else{var Q=Y._55O;Q&&Q._98o&&Sr.call(Y,g)}},V.getSelectWidth=function(){var n=this,f=n.gv,w=f._editInteractor,r=n._data;return f.isEditable(r)&&w instanceof $.XEditInteractor?0:Tg.call(n)},V._80o=function(e){var S=this,i=S.gv._editInteractor;if(Te.call(S,e),i&&i._debug){e.save(),e.beginPath(),e.lineWidth=1,e.strokeStyle="green";var T=S._79o();T&&(e.rect(T.x,T.y,T.width,T.height),e.stroke()),e.restore()}},g._80o=function(W){var H=this,Y=H.gv._editInteractor;if(yg.call(H,W),Y&&Y._debug){W.save(),W.beginPath(),W.lineWidth=1,W.strokeStyle="green";var c=H._79o();W.rect(c.x,c.y,c.width,c.height),W.stroke(),W.restore()}},V._48O=function(){var j=this,G=j.gv,k=j._data,J=G._editInteractor,S=j._55O,L=k.p(),h=k.getRotation();if(J instanceof $.XEditInteractor){if(S._42O){var M=ti(L,k.getWidth(),k.getHeight(),h),O=M[0],F=M[1],a=M[2],I=M[3],y=M[4],X=M[5],t=M[6],W=M[7];S.$45l=[O,y,F,X,I,t,a,W]}}else Le.call(j)},e.getResizeMode=function(){return this.$25l||"normal"},e.setResizeMode=function(l){var c=this.$25l;this.$25l=l,this.fp("resizeMode",c,l)},e.getSnapAngle=function(){return this.$26l||Math.PI/36},e.setSnapAngle=function(t){var y=this.$26l;this.$26l=t,this.fp("snapAngle",y,t)},e.getSnapSpacing=function(){return this.$27l},e.setSnapSpacing=function(S){var V=this.$27l;this.$27l=S,this.fp("snapSpacing",V,S)},e.getPointSnapSpacing=function(){return this._pointSnapSpacing},e.setPointSnapSpacing=function(G){var J=this._pointSnapSpacing;this._pointSnapSpacing=G,this.fp("pointSnapSpacing",J,G)},e.setHelperEditableFunc=function(k){var l=this._helperEditableFunc;this._helperEditableFunc=k,this.fp("helperEditableFunc",l,k)},e.getHelperEditableFunc=function(){return this._helperEditableFunc},e.setLeftTopHelpers=function(y){var L=this._leftTopHelpers;this._leftTopHelpers=y,this.fp("leftTopHelpers",L,y)},e.getLeftTopHelpers=function(){return this._leftTopHelpers},e.setLeftTopHelpersAlign=function(X){var E=this._leftTopHelpersAlign;this._leftTopHelpersAlign=X,this.fp("leftTopHelpersAlign",E,X)},e.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},e.setRightTopHelpers=function(A){var $=this._rightTopHelpers;this._rightTopHelpers=A,this.fp("rightTopHelpers",$,A)},e.getRightTopHelpers=function(){return this._rightTopHelpers},e.setRightTopHelpersAlign=function(M){var i=this._rightTopHelpersAlign;this._rightTopHelpersAlign=M,this.fp("rightTopHelpersAlign",i,M)},e.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},e.setLeftBottomHelpers=function(a){var o=this._leftBottomHelpers;this._leftBottomHelpers=a,this.fp("leftBottomHelpers",o,a)},e.getLeftBottomHelpers=function(){return this._leftBottomHelpers},e.setLeftBottomHelpersAlign=function(F){var w=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=F,this.fp("leftBottomHelpersAlign",w,F)},e.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},e.setRightBottomHelpers=function(C){var U=this._rightBottomHelpers;this._rightBottomHelpers=C,this.fp("rightBottomHelpers",U,C)},e.getRightBottomHelpers=function(){return this._rightBottomHelpers},e.setRightBottomHelpersAlign=function(j){var d=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=j,this.fp("rightBottomHelpersAlign",d,j)},e.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},e.setEdgeHelpers=function(g){var H=this._edgeHelpers;this._edgeHelpers=g,this.fp("edgeHelpers",H,g)},e.getEdgeHelpers=function(){return this._edgeHelpers},e.isHelperEditable=function(G,R){return G instanceof T&&("host"===R||"edge"===R||"elevation"===R||"tall"===R)?!1:G instanceof v&&("source"===R||"target"===R)?!1:"pointElevation"===R?this._helperEditableFunc?this._helperEditableFunc(G,R):!1:this._helperEditableFunc?this._helperEditableFunc(G,R):!0},e.getEditHelperSize=function(){return this._editHelperSize||(R?28:16)},e.setEditHelperSize=function(_){var W=this._editHelperSize;this._editHelperSize=_,this.fp("editHelperSize",W,_)},e.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},e.setEditRectBorderColor=function(E){var Z=this.$28l;this.$28l=E,this.fp("editRectBorderColor",Z,E)},e.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},e.setNodeBorderColor=function(h){var n=this.$29l;this.$29l=h,this.fp("nodeBorderColor",n,h)},e.getEditRectBorderStyle=function(){return this.$30l||"dashed"},e.setEditRectBorderStyle=function(f){var k=this.$30l;this.$30l=f,this.fp("editRectBorderStyle",k,f)},e.getControlPointBackground=function(){return this.$31l||"#ff0"},e.setControlPointBackground=function(p){var R=this.$31l;this.$31l=p,this.fp("controlPointBackground",R,p)},e.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},e.setControlPointBorderColor=function(Y){var p=this.$32l;this.$32l=Y,this.fp("controlPointBorderColor",p,Y)},e.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},e.setJoinPointBackground=function(n){var d=this.$33l;this.$33l=n,this.fp("joinPointBackground",d,n)},e.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},e.setJoinPointBorderColor=function(n){var h=this.$34l;this.$34l=n,this.fp("joinPointBorderColor",h,n)},e.getDirectionLineColor=function(){return this.$35l||"#888"},e.setDirectionLineColor=function(S){var $=this.$35l;this.$35l=S,this.fp("directionLineColor",$,S)},e.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},e.setSegmentHoverColor=function(G){var l=this.$36l;this.$36l=G,this.fp("segmentHoverColor",l,G)},e.getSegmentHoverWidth=function(){return this.$22l||(R?16:8)},e.setSegmentHoverWidth=function(I){var k=this.$22l;this.$22l=I,this.fp("segmentHoverWidth",k,I)},e.getSnapPointBorderColor=function(){return this.$38l||"#f00"},e.setSnapPointBorderColor=function(Y){var c=this.$38l;this.$38l=Y,this.fp("snapPointBorderColor",c,Y)},e.getEditRectPadding=function(){return this.$39l!=L?this.$39l:6},e.setEditRectPadding=function(d){var q=this.$39l;this.$39l=d,this.fp("editRectPading",q,d)},e.isRectEditable=function(E){var j=this,I=j._editInteractor;return I instanceof $.XEditInteractor?j._rectEditableFunc?j._rectEditableFunc(E):!0:Nc.call(j,E)},e.isPointEditable=function(Y){var d=this,J=d._editInteractor;return J instanceof $.XEditInteractor?d._pointEditableFunc?d._pointEditableFunc(Y):!0:db.call(d,Y)},e.validateImpl=function(){var z=this,H=z.$14l,Z=z._editInteractor;if(H){var q=z.getWidth(),i=z.getHeight();(q!==H.clientWidth||i!==H.clientHeight)&&(Z&&(Z._68I=1),f.setCanvas(H,q,i),z._32I=1)}li.call(this)},e.isEditable=function(F){var i=$h.call(this,F),U=this._editInteractor;if(U instanceof $.XEditInteractor&&F instanceof T){if(!F.s("2d.editable"))return!1;var k=this.getEditableFunc();i=k?k(F):!0}return i},e._42=function(q,a){var g=this,M=g._editInteractor;Jl.call(g,q,a),M instanceof $.XEditInteractor&&M._68I&&M._42()},e.isSnapPoint=function(){return!0};var bd=function(D){arguments.length>0&&this.$58l(D)},nm=bd.prototype;nm.$58l=function(i){this.$62l=i,this.points=new Array},nm.$56l=function(C){this.points.push(C)},nm.$57l=function(Z){this.points=this.points.concat(Z)};var zi=function(t,m){arguments.length>0&&this.$58l(t,m)},sh=zi.prototype;sh.$58l=function(N,O){this.x=N,this.y=O},sh.add=function(I){return new zi(this.x+I.x,this.y+I.y)},sh.addEquals=function(G){return this.x+=G.x,this.y+=G.y,this},sh.$55l=function(J){return new zi(this.x*J,this.y*J)},sh.eq=function(F){return this.x==F.x&&this.y==F.y},sh.lt=function(C){return this.x<C.x&&this.y<C.y},sh.lte=function(N){return this.x<=N.x&&this.y<=N.y},sh.gt=function(f){return this.x>f.x&&this.y>f.y},sh.gte=function(_){return this.x>=_.x&&this.y>=_.y},sh.lerp=function(b,H){return new zi(this.x+(b.x-this.x)*H,this.y+(b.y-this.y)*H)},sh.distanceFrom=function(m){var x=this.x-m.x,J=this.y-m.y;return r(x*x+J*J)},sh.min=function(b){return new zi(j(this.x,b.x),j(this.y,b.y))},sh.max=function(T){return new zi(J(this.x,T.x),J(this.y,T.y))},sh.toString=function(){return this.x+","+this.y};var $j=function(){this.$58l(arguments)},Ob=$j.prototype;$j.TO=1e-6,$j.AC=6,Ob.$58l=function(g){this.co=new Array;for(var x=g.length-1;x>=0;x--)this.co.push(g[x])},Ob.$55l=function(j){for(var O=new $j,i=0;i<=this.$50l()+j.$50l();i++)O.co.push(0);for(var i=0;i<=this.$50l();i++)for(var X=0;X<=j.$50l();X++)O.co[i+X]+=this.co[i]*j.co[X];return O},Ob.$59l=function(){for(var y=this.$50l();y>=0&&u(this.co[y])<=$j.TO;y--)this.co.pop()},Ob.$50l=function(){return this.co.length-1},Ob.$51l=function(){var j;switch(this.$59l(),this.$50l()){case 0:j=new Array;break;case 1:j=this.$52l();break;case 2:j=this.$53l();break;case 3:j=this.$54l();break;case 4:j=this.$63l();break;default:j=new Array}return j},Ob.$52l=function(){var s=new Array,C=this.co[1];return 0!=C&&s.push(-this.co[0]/C),s},Ob.$53l=function(){var c=new Array;if(2==this.$50l()){var P=this.co[2],d=this.co[1]/P,C=this.co[0]/P,J=d*d-4*C;if(J>0){var h=r(J);c.push(.5*(-d+h)),c.push(.5*(-d-h))}else 0==J&&c.push(.5*-d)}return c},Ob.$63l=function(){var K=new Array;if(4==this.$50l()){var o=this.co[4],W=this.co[3]/o,T=this.co[2]/o,p=this.co[1]/o,q=this.co[0]/o,l=new $j(1,-T,W*p-4*q,-W*W*q+4*T*q-p*p).$54l(),H=l[0],k=W*W/4-T+H;if(u(k)<=$j.TO&&(k=0),k>0){var N=r(k),J=3*W*W/4-N*N-2*T,A=(4*W*T-8*p-W*W*W)/(4*N),t=J+A,D=J-A;if(u(t)<=$j.TO&&(t=0),u(D)<=$j.TO&&(D=0),t>=0){var g=r(t);K.push(-W/4+(N+g)/2),K.push(-W/4+(N-g)/2)}if(D>=0){var g=r(D);K.push(-W/4+(g-N)/2),K.push(-W/4-(g+N)/2)}}else if(0>k);else{var A=H*H-4*q;if(A>=-$j.TO){if(0>A&&(A=0),A=2*r(A),J=3*W*W/4-2*T,J+A>=$j.TO){var n=r(J+A);K.push(-W/4+n/2),K.push(-W/4-n/2)}if(J-A>=$j.TO){var n=r(J-A);K.push(-W/4+n/2),K.push(-W/4-n/2)}}}}return K},Ob.$54l=function(){var B=new Array;if(3==this.$50l()){var I=this.co[3],d=this.co[2]/I,X=this.co[1]/I,o=this.co[0]/I,w=(3*X-d*d)/3,k=(2*d*d*d-9*X*d+27*o)/27,D=d/3,T=k*k/4+w*w*w/27,i=k/2;if(u(T)<=$j.TO&&(T=0),T>0){var W,_,p=r(T);W=-i+p,_=W>=0?Y(W,1/3):-Y(-W,1/3),W=-i-p,W>=0?_+=Y(W,1/3):_-=Y(-W,1/3),B.push(_-D)}else if(0>T){var s=r(-w/3),q=c(r(-T),-i)/3,O=E(q),l=Q(q),G=r(3);B.push(2*s*O-D),B.push(-s*(O+G*l)-D),B.push(-s*(O-G*l)-D)}else{var W;W=i>=0?-Y(i,1/3):Y(-i,1/3),B.push(2*W-D),B.push(-W-D)}}return B};var Rh=function(A,K){arguments.length>0&&this.$58l(A,K)},$g=Rh.prototype;$g.$58l=function(B,E){this.x=B,this.y=E},$g.length=function(){return r(this.x*this.x+this.y*this.y)},$g.$60l=function(g){return this.x*g.x+this.y*g.y};var dn=function(v,s,C,F){var g,x=(F.x-C.x)*(v.y-C.y)-(F.y-C.y)*(v.x-C.x),G=(s.x-v.x)*(v.y-C.y)-(s.y-v.y)*(v.x-C.x),P=(F.y-C.y)*(s.x-v.x)-(F.x-C.x)*(s.y-v.y);if(0!=P){var o=x/P,X=G/P;o>=0&&1>=o&&X>=0&&1>=X?(g=new bd(p),g.points.push(new zi(v.x+o*(s.x-v.x),v.y+o*(s.y-v.y)))):g=new bd(S)}else g=0==x||0==G?new bd("C"):new bd("P");return g},Sq=function(E,o,J,T,C){var t,i,u,z,Z,G,Y,s=T.min(C),V=T.max(C),B=new bd(S);t=o.$55l(-2),u=E.add(t.add(J)),t=E.$55l(-2),i=o.$55l(2),z=t.add(i),Z=new zi(E.x,E.y),Y=new Rh(T.y-C.y,C.x-T.x),G=T.x*C.y-C.x*T.y;for(var D=new $j(Y.$60l(u),Y.$60l(z),Y.$60l(Z)+G).$51l(),y=0;y<D.length;y++){var q=D[y];if(q>=0&&1>=q){var g=E.lerp(o,q),O=o.lerp(J,q),M=g.lerp(O,q);T.x==C.x?s.y<=M.y&&M.y<=V.y&&(B.$62l=p,B.$56l(M)):T.y==C.y?s.x<=M.x&&M.x<=V.x&&(B.$62l=p,B.$56l(M)):M.gte(s)&&M.lte(V)&&(B.$62l=p,B.$56l(M))}}return B},Fl=function(W,R,i,E,V){var f=E.min(V),L=E.max(V),_=new zi(L.x,f.y),G=new zi(f.x,L.y),x=Sq(W,R,i,f,_),M=Sq(W,R,i,_,L),X=Sq(W,R,i,L,G),D=Sq(W,R,i,G,f),g=new bd(S);return g.$57l(x.points),g.$57l(M.points),g.$57l(X.points),g.$57l(D.points),g.points.length>0&&(g.$62l=p),g},_l=function($,O,Q,X,a,F){var P,m,A,G,N,s,d,K,i,u,D=a.min(F),h=a.max(F),_=new bd(S);P=$.$55l(-1),m=O.$55l(3),A=Q.$55l(-3),G=P.add(m.add(A.add(X))),N=new Rh(G.x,G.y),P=$.$55l(3),m=O.$55l(-6),A=Q.$55l(3),G=P.add(m.add(A)),s=new Rh(G.x,G.y),P=$.$55l(-3),m=O.$55l(3),A=P.add(m),d=new Rh(A.x,A.y),K=new Rh($.x,$.y),u=new Rh(a.y-F.y,F.x-a.x),i=a.x*F.y-F.x*a.y;for(var I=new $j(u.$60l(N),u.$60l(s),u.$60l(d),u.$60l(K)+i).$51l(),g=0;g<I.length;g++){var e=I[g];if(e>=0&&1>=e){var q=$.lerp(O,e),y=O.lerp(Q,e),J=Q.lerp(X,e),t=q.lerp(y,e),x=y.lerp(J,e),W=t.lerp(x,e);a.x==F.x?D.y<=W.y&&W.y<=h.y&&(_.$62l=p,_.$56l(W)):a.y==F.y?D.x<=W.x&&W.x<=h.x&&(_.$62l=p,_.$56l(W)):W.gte(D)&&W.lte(h)&&(_.$62l=p,_.$56l(W))}}return _},an=function(O,I,r,e,y,K){var U=y.min(K),A=y.max(K),N=new zi(A.x,U.y),m=new zi(U.x,A.y),b=_l(O,I,r,e,U,N),s=_l(O,I,r,e,N,A),i=_l(O,I,r,e,A,m),V=_l(O,I,r,e,m,U),v=new bd(S);return v.$57l(b.points),v.$57l(s.points),v.$57l(i.points),v.$57l(V.points),v.points.length>0&&(v.$62l=p),v},Ym=function(A,Y,J,$){var b=J.min($),t=J.max($),k=new zi(t.x,b.y),u=new zi(b.x,t.y),D=dn(b,k,A,Y),r=dn(k,t,A,Y),C=dn(t,u,A,Y),O=dn(u,b,A,Y),P=new bd(S);return P.$57l(D.points),P.$57l(r.points),P.$57l(C.points),P.$57l(O.points),P.points.length>0&&(P.$62l=p),P},Lr=$.XEditInteractor=function(j){var f=this,w=f._view=document.createElement("canvas");w.className="editCanvas",w.style.position="absolute",Lr.superClass.constructor.call(f,j)};N.def(Lr,$.Interactor,{ms_edit:1,setUp:function(){var f=this,Q=f.gv,w=Q.getView(),h=f._view;Lr.superClass.setUp.call(f),Q.setEditInteractor(f),Q.$14l=h,Q._79O?w.insertBefore(h,Q._79O):w.appendChild(h);var T=f.$49l=f.$11l.bind(f);Q.dm().md(T),Q.sm().ms(T),Q.mp(T)},tearDown:function(){var R=this,l=R.gv,x=l.getView(),b=R.$49l;Lr.superClass.tearDown.call(R),l.setEditInteractor(L),l.$14l=L,x.removeChild(R._view),l.dm().umd(b),l.sm().ums(b),l.ump(b)},clear:function(){var j=this,h=j.gv;delete j._hoverSegmentIndex,delete j._edge,delete j._shape,delete h._editing,delete j.$10l,delete j.$13l,delete j.$9l,delete j._removePointIndex,delete j._lp,j.$12l="",delete j.$40l,delete j.$67l,delete j.$72l,delete j.$73l,delete j.$75l,delete j.$1l,delete j.$3l,delete j.$2l,delete j.$92l,delete j.$93l,delete j.$94l,j.clearDragging()},handle_keydown:function(m){this.$48l!==m.shiftKey&&(this.$48l=m.shiftKey,this.handle_mousemove(m,z,!0))},handle_keyup:function(L){this.$48l!==L.shiftKey&&(this.$48l=L.shiftKey,this.handle_mousemove(L,z,!0))},handle_touchstart:function(R){this.handle_mousemove(R),this.handle_mousedown(R)},handle_mousedown:function(L){h(L);var A=this,u=A.$13l,m=A.gv,D=m.dm(),M=m.sm(),e=m.getZoom(),p=m.lp(L),r=N.isDoubleClick(L),Y=N.isLeftButton(L),x=A.$7l,I=A._shape,w=A._hoverSegmentIndex,Q=A._edge,g=A.$87l,_=A.$88l,G=function(){A._68I||g===A.$87l&&_===A.$88l||A.$43l()};if(7!==A.$67l&&(delete A.$87l,delete A.$88l),Y&&(I||Q)&&w>=0&&r&&(I&&M.contains(I)||Q&&M.contains(Q))){var y=Cp.call(A,I||Q,w,p);return A.addShapePoint(I||Q,w,y),C(function(){A.handle_mousemove(L)},40),void 0}if(Y&&(I||Q)&&A._removePointIndex>=0&&r)return A.removeShapePoint(),A.$5l=1,C(function(){A.handle_mousemove(L)},40),void 0;if(!Y||!m._editing)return G(),void 0;if(I&&u>=0){var j=I.getPoints().get(u),T=I.p(),b=Rb(T,j.x-T.x,j.y-T.y,-x+I.getRotation());P=Rb(T,p.x-T.x,p.y-T.y,-x),A.$24l={x:P.x-b.x,y:P.y-b.y},A.startDragging(L),D.beginTransaction(),A.fi({kind:"beginEditPoint",event:L,data:I,index:u}),A.$88l=u,A.$87l=I}else if(A.$10l){var W=m.sm().getSelection(),f=A.$6l,c=A.$1l={},n=A.$3l={},H=A.$16l[O[A.$10l]],l={x:f.x,y:f.y},R={x:f.x+f.width/2,y:f.y+f.height/2};A.$24l={x:p.x-H.x/e,y:p.y-H.y/e},A.$2l=X(A.$8l),A.$4l=X(f),W.each(function(J){if(J instanceof v){var Q=J.p(),j=J.getWidth(),P=J.getHeight(),z=Rb(R,Q.x-R.x,Q.y-R.y,-x);c[J.getId()]={x:Q.x-j/2,y:Q.y-P/2,width:j,height:P},n[J.getId()]={x:(z.x-l.x)/f.width,y:(z.y-l.y)/f.height}}}),A.startDragging(L),D.beginTransaction(),A.fi({kind:"beginEditRect",event:L,direction:A.$10l})}else if(Q&&u>=0){var K=Qg(m.getDataUI(Q),Q.s("edge.points")),j=K.get(u);A.$24l={x:p.x-j.x,y:p.y-j.y},A.startDragging(L),D.beginTransaction(),A.fi({kind:"beginEditPoint",event:L,data:Q,index:u}),A.$88l=u,A.$87l=Q}else if(A.$40l){var f=A.$6l,R={x:f.x+f.width/2,y:f.y+f.height/2},F=X(A.$23l);F.x/=e,F.y/=e;var B=Rb(R,F.x-R.x,F.y-R.y,-x),P=Rb(R,p.x-R.x,p.y-R.y,-x);A.$24l={x:P.x-B.x,y:P.y-B.y},A.startDragging(L),D.beginTransaction(),A.fi({kind:"beginEditRotation",event:L,data:A._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(A.$67l)>=0){var U=A.$67l;(7===U||8===U||9===U)&&D.beginTransaction(),A.startDragging(L)}else if(A.$71l&&r&&A.$79l(A.$71l,p)){var i=M.toSelection();D.beginTransaction(),i.each(function(p){D.remove(p)}),D.endTransaction()}G()},$11l:function(){var t=this,S=t.gv;S._editing&&(t.$13l==L||t._shape==L&&t._edge==L)&&(t.$73l==L||1!==t.$67l&&5!==t.$67l&&6!==t.$67l)||(t.$5l=1),t._68I=1},$46l:function(V){var W=this,o=W.gv,N=o.lp(V),r=[];return Rc(o,function(s){var p=o.getDataUI(s);if(p){var d=p._79o();F(d,N)&&r.push(s)}}),r},$47l:function(s){var w=this,i=w.$13l,X=w.gv.dm();w.$10l?(w.fi({kind:"endEditRect",event:s,direction:w.$10l}),X.endTransaction()):w._shape&&i>=0?(w.fi({kind:"endEditPoint",event:s,data:w._shape,index:i}),X.endTransaction()):w._edge&&i>=0?(w.fi({kind:"endEditPoint",event:s,data:w._edge,index:i}),X.endTransaction()):w.$23l&&w.$40l&&(w.fi({kind:"endEditRotation",event:s}),X.endTransaction())},handleWindowTouchEnd:function(s){this.handleWindowMouseUp(s)},handleWindowMouseUp:function(Y){var S=this,I=S.gv,W=I.dm(),r=S._shape,m=S._edge,C=S.$13l,R=S.$40l,p=S.$9l,U=S.$10l,F=S.$67l;if((r||m)&&C>=0&&p>=0){var j,D;if(r){var P=r.p(),g=r.getRotation();j=r.getPoints(),D=j.get(p),jf(r,P,g,C,D,!1)}else if(j=Qg(I.getDataUI(m),m.s("edge.points"),!0),D=j.get(p),0===C){var E=j.get(0);m.s("edge.source.offset.x",D.x-E.x),m.s("edge.source.offset.y",D.y-E.y)}else if(C===j.size()-1){var c=j.get(j.size()-1);m.s("edge.target.offset.x",D.x-c.x),m.s("edge.target.offset.y",D.y-c.y)}else"points"===m.s("edge.type")&&(j.set(C,D),m.s("edge.points",Dp(j)))}S.$47l(Y);var X=S.$73l;1===F?(W.beginTransaction(),X?I.sm().each(function(Y){if(Y.setHost&&I.isHelperEditable(Y,"host")){Y.setHost(X);
var u=S.$75l,i=S.$74l;u&&(Y.s("attach.row.index",u.rowIndex),Y.s("attach.column.index",u.columnIndex)),i&&(Y.s("attach.index",i.attachIndex),Y.s("attach.offset",i.attachOffset),Y.s("attach.offset.relative",!1),Y.s("attach.offset.opposite",!1))}}):I.sm().each(function(P){P.setHost&&I.isHelperEditable(P,"host")&&(P.setHost(L),P.s("attach.row.index",z),P.s("attach.column.index",z),P.s("attach.index",z),P.s("attach.offset",z),P.s("attach.offset.relative",!1),P.s("attach.offset.opposite",!1))}),W.endTransaction()):2===F?(W.beginTransaction(),X?I.sm().each(function(m){m.setParent&&I.isHelperEditable(m,"parent")&&m.setParent(X)}):I.sm().each(function(Z){Z.setParent&&I.isHelperEditable(Z,"parent")&&Z.setParent(L)}),W.endTransaction()):3===F?X&&(W.beginTransaction(),I.sm().each(function(D){if(I.isHelperEditable(D,"edge")&&D instanceof v&&X instanceof v){var u=new s.Edge;W.add(u),u.setSource(D),u.setTarget(X),S.onEdgeCreated&&S.onEdgeCreated(Y,u)}}),W.endTransaction()):5===F||6===F?X&&(W.beginTransaction(),I.sm().each(function(j){j instanceof T&&X instanceof v&&(5===F&&I.isHelperEditable(j,"source")?j.setSource(X):6===F&&I.isHelperEditable(j,"source")&&j.setTarget(X))}),W.endTransaction()):(7===F||8===F||9===F)&&W.endTransaction(),(U||R)&&S.$43l(!0),i(Y)?(S.clear(),delete S.$64l,S._68I||S.$43l()):(S.handle_mousemove(Y,!0),F&&!S._68I&&S.$43l())},handleWindowTouchMove:function(F){this.handleWindowMouseMove(F)},handleWindowMouseMove:function(D){this._78I(D)},handle_mousemove:function(m,z,P){if(!this._pause){if(!P){var u=i(m)?Od(m):m;this.$61l={clientX:u.clientX,clientY:u.clientY}}if(z===!0||!H()){var x=this,M=x.gv,w=!1,q=L;x.clear(),M.sm().size()>0&&(q=M.lp(P?x.$61l:m),w=x._79I(m,q)),w&&(M._editing=1),x.$12l!==x.$65l&&(x.$65l=x.$12l,x.setCursor(x.$12l)),x.$40l!==x.$64l&&(x.$64l=x.$40l,x._68I||x.$43l()),x._hoverSegmentIndex!==x.$66l&&(x.$66l=x._hoverSegmentIndex,x._68I||x.$43l())}}},_78I:function(Q){this.autoScroll(Q);var H=this,t=H.gv,y=t.lp(Q),l=t.getZoom(),n=H.$13l;if((H._shape||H._edge)&&n>=0){var m,D,w,j=H._shape,p=H._edge,G=H.$24l,e=t.getPointSnapSpacing(),F=function(Q,p){return e==L||isNaN(e)?{x:Q,y:p}:{x:B(Q/e)*e,y:B(p/e)*e}};if(j){m=j.getPoints();var i=j.p(),I=j.getRotation(),S=0;D=Rb(i,y.x-i.x,y.y-i.y,-I),jf(j,i,I,n,y,!0,G,F),H.fi({kind:"betweenEditPoint",event:Q,data:j,index:n})}else if(p){m=Qg(t.getDataUI(p),p.s("edge.points"),!0),y.x-=G.x,y.y-=G.y,D=y;var f,R,W=p.s("edge.offset"),E=m.size(),o=E>2;if(0===n){var g=m.get(0);W&&(g=Jp(g,m.get(1),-W,o),y=Jp(y,m.get(1),-W,o)),f=y.x-g.x,R=y.y-g.y,w=F(f,R),p.s("edge.source.offset.x",w.x),p.s("edge.source.offset.y",w.y)}else if(n===E-1){var X=m.get(E-1);W&&(X=Jp(X,m.get(E-2),-W,o),y=Jp(y,m.get(E-2),-W,o)),f=y.x-X.x,R=y.y-X.y,w=F(f,R),p.s("edge.target.offset.x",w.x),p.s("edge.target.offset.y",w.y)}else"points"===p.s("edge.type")&&(w=F(y.x,y.y),w.e=m.get(n).e,m.set(n,w),p.s("edge.points",Dp(m)));H.fi({kind:"betweenEditPoint",event:Q,data:p,index:n})}if(delete H.$9l,t.isSnapPoint(j)||t.isSnapPoint(p))for(S=0;S<m.size();S++)if(S!==n){var U=m.get(S);if(M(U,D)<t.getEditPointSize()/l){H.$9l=S;break}}}else if(H.$10l){var G=H.$24l;y.x-=G.x,y.y-=G.y;var Y=t.sm().getSelection(),J=H.$1l,$=H.$7l,k=H.$10l,z=H.$4l,h=H.$2l,A=t.getEditRectPadding()/l,s=2*A,V=t.getSnapSpacing(),q=V!=L&&!isNaN(V),Z=Hl(h,y,k,$,2*A,t.getResizeMode(),q,!0),O=H.$6l;if(q){var _=Z.width-s,d=Z.height-s,a=B(_/V)*V,Br=B(d/V)*V,$h=a-_,_h=Br-d;("west"===k||"northwest"===k||"southwest"===k)&&($h=-$h),("north"===k||"northwest"===k||"northeast"===k)&&(_h=-_h),Z=Hl(h,y,k,$,2*A,t.getResizeMode(),q,!1,$h,_h)}H.$8l=Z,O.x=Z.x+A,O.y=Z.y+A,O.width=Z.width-s,O.height=Z.height-s;var ch=Z.x+Z.width/2,ih=Z.y+Z.height/2,dh=O.x,Sl=O.y,sk=O.width/z.width,je=O.height/z.height;Y.each(function(F){if(F instanceof v&&t.isEditable(F)&&t.isRectEditable(F)){var V=J[F.getId()],L=H.$3l[F.getId()],b={x:V.x+V.width/2,y:V.y+V.height/2},o=0,s=0,w=k,Y=180*u($-F.getRotation())/K;"northeast"===k?Y>=315||45>Y?(o=V.width*sk+V.x,s=V.height*(1-je)+V.y,w="northeast"):Y>=45&&135>Y?(o=V.width*(1-je)+V.x,s=V.height*(1-sk)+V.y,w="northwest"):Y>=135&&225>Y?(o=V.width*(1-sk)+V.x,s=V.height*je+V.y,w="southwest"):(o=V.width*je+V.x,s=V.height*sk+V.y,w="southeast"):"north"===k?Y>=315||45>Y?(s=V.height*(1-je)+V.y,w="north"):Y>=45&&135>Y?(o=V.width*(1-je)+V.x,w="west"):Y>=135&&225>Y?(s=V.height*je+V.y,w="south"):(o=V.width*je+V.x,w="east"):"northwest"===k?Y>=315||45>Y?(o=V.width*(1-sk)+V.x,s=V.height*(1-je)+V.y,w="northwest"):Y>=45&&135>Y?(o=V.width*(1-je)+V.x,s=V.height*sk+V.y,w="southwest"):Y>=135&&225>Y?(o=V.width*sk+V.x,s=V.height*je+V.y,w="southeast"):(o=V.width*je+V.x,s=V.height*(1-sk)+V.y,w="northeast"):"west"===k?Y>=315||45>Y?(o=V.width*(1-sk)+V.x,w="west"):Y>=45&&135>Y?(s=V.height*sk+V.y,w="south"):Y>=135&&225>Y?(o=V.width*sk+V.x,w="east"):(s=V.height*(1-sk)+V.y,w="north"):"southwest"===k?Y>=315||45>Y?(o=V.width*(1-sk)+V.x,s=V.height*je+V.y,w="southwest"):Y>=45&&135>Y?(o=V.width*je+V.x,s=V.height*sk+V.y,w="southeast"):Y>=135&&225>Y?(o=V.width*sk+V.x,s=V.height*(1-je)+V.y,w="northeast"):(o=V.width*(1-je)+V.x,s=V.height*(1-sk)+V.y,w="northwest"):"east"===k?Y>=315||45>Y?(o=V.width*sk+V.x,w="east"):Y>=45&&135>Y?(s=V.height*(1-sk)+V.y,w="north"):Y>=135&&225>Y?(o=V.width*(1-sk)+V.x,w="west"):(s=V.height*sk+V.y,w="south"):"south"===k?Y>=315||45>Y?(s=V.height*je+V.y,w="south"):Y>=45&&135>Y?(o=V.width*je+V.x,w="east"):Y>=135&&225>Y?(s=V.height*(1-je)+V.y,w="north"):(o=V.width*(1-je)+V.x,w="west"):"southeast"===k&&(Y>=315||45>Y?(o=V.width*sk+V.x,s=V.height*je+V.y,w="southeast"):Y>=45&&135>Y?(o=V.width*je+V.x,s=V.height*(1-sk)+V.y,w="northeast"):Y>=135&&225>Y?(o=V.width*(1-sk)+V.x,s=V.height*(1-je)+V.y,w="northwest"):(o=V.width*(1-je)+V.x,s=V.height*sk+V.y,w="southwest"));var B=Rb(b,o-b.x,s-b.y,F.getRotation());Ni(F,V,w,{x:B.x,y:B.y});var D=dh+O.width*L.x,T=Sl+O.height*L.y,g={x:D,y:T};g=Rb({x:ch,y:ih},g.x-ch,g.y-ih,$),F.p(g.x,g.y)}}),H.fi({kind:"betweenEditRect",event:Q,direction:k})}else if(H.$23l&&H.$40l){var Zm=H.$8l,es=Zm.width,pb=Zm.height,i={x:Zm.x+es/2,y:Zm.y+pb/2},G=H.$24l,Em=H.$23l,km=Em.x/l-i.x,lm=Em.y/l-i.y,Sb=r(km*km+lm*lm),lc=Math.asin(G.x/Sb),kh=t.sm().getSelection(),uq=P+c(y.y-i.y,y.x-i.x)-lc,vh=t.getSnapAngle(),uq=B(uq/vh)*vh;0>uq&&(uq+=x);var yd=uq-H.$7l,di=[i.x,0,i.y];kh.each(function(a){if(t.isEditable(a)&&t.isRotationEditable(a)&&t.isVisible(a)){var N=dp(a.p3(),di),g=cd();oc(g,-yd),a.setRotation(a.getRotation()+yd),Bs(N,g),a.p3(di[0]+N[0],di[1]+N[1],di[2]+N[2])}}),H.$7l=uq,H.fi({kind:"betweenEditRotation",event:Q})}else if([1,2,3,5,6].indexOf(H.$67l)>=0)H.$72l=Q,H.$78l||(H.$78l=1,C(function(){N.isDragging()&&H.$43l(),delete H.$78l},12));else if(7===H.$67l){if(H.$87l instanceof b){var j=H.$87l,ek=H.$88l,Pd=N.clone(j.getPoints().get(ek)),eb=y.y-Pd.y;Pd.e||(Pd.e=0),H.$92l||(H.$92l=Pd.e),Pd.e=H.$92l-eb,j.setPoint(ek,Pd)}else if(H.$87l instanceof T){var p=H.$87l,ek=H.$88l,m=Qg(t.getDataUI(p),p.s("edge.points")),Pd=m.get(ek),eb=y.y-Pd.y;Pd.e||(Pd.e=0),H.$92l||(H.$92l=Pd.e),Pd.e=H.$92l-eb,m.set(ek,Pd),p.s("edge.points",Dp(m))}}else if(8===H.$67l){var kh=t.sm().getSelection(),so=H.$93l;so||(so=H.$93l={}),kh.each(function(k){if(k.p3){var J=k.p3(),r=so[k.getId()];r==L&&(r=so[k.getId()]=J[1]),k.p3([J[0],r-(y.y-H.$90l.y/l),J[2]])}})}else if(9===H.$67l){var kh=t.sm().getSelection(),Rd=H.$94l;Rd||(Rd=H.$94l={}),kh.each(function(P){if(P.s3){var _=P.s3(),N=Rd[P.getId()];N==L&&(N=Rd[P.getId()]=_[1]);var d=N-(y.y-H.$91l.y/l);0>d&&(d=.01),P.s3([_[0],d,_[2]])}})}},$79l:function(f,o){var g=this,K=g.gv,n=K.getZoom(),l=K.getEditHelperSize(),p=f.x/n,S=f.y/n,Z=l/n,d=Z/2;return F({x:p-d,y:S-d,width:Z,height:Z},o)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(f,m){for(var l=this,x=l.gv,g=x.getZoom(),P=x.getEditPointSize(),H=P/g,w=H/2,V=l.$46l(f),p=0;p<V.length;p++){var A,W,S=V[p],v=x.getDataUI(S);if(v&&v._55O){var C=v._55O;if(C._43O&&S instanceof T){if(A=S.s("edge.points"),A=Qg(v,A),W=S.s("edge.segments"),W&&W.size()||(W=vo(A)),l.$42l(S,m,A._as,W,"edge"))return!0;if("points"===S.s("edge.type")&&l.$41l(S,m,A._as,W,"edge"))return}if(C._43O&&S instanceof b&&C.$15l&&C.$15l.length===S.getPoints().size()){if(A=C.$15l,W=S.getSegments(),W&&W.size()||(W=vo(A)),l.$42l(S,m,A,W,"shape"))return!0;if(l.$41l(S,m,A,W,"shape"))return}}}if(l.$16l){var A,J=l.$16l,$=J[3].x-J[7].x,y=J[3].y-J[7].y,n=r($*$+y*y),k=J[1].x-J[5].x,Z=J[1].y-J[5].y,h=r(k*k+Z*Z),_={x:m.x*g,y:m.y*g};if(l._80I(_,0,J[0],"northwest",n,h)||l._80I(_,1,J[1],"north",n,h)||l._80I(_,2,J[2],"northeast",n,h)||l._80I(_,7,J[7],"west",n,h)||l._80I(_,3,J[3],"east",n,h)||l._80I(_,6,J[6],"southwest",n,h)||l._80I(_,5,J[5],"south",n,h)||l._80I(_,4,J[4],"southeast",n,h))return!0}if(l.$23l){var L=l.$23l,X=L.x/g,z=L.y/g;if(F({x:X-w,y:z-w,width:H,height:H},m))return l.$40l=1,l.$12l=l.getHelperCursor("rotation")||"crosshair",!0}return l.$68l&&l.$79l(l.$68l,m)?(l.$67l=1,l.$12l=l.getHelperCursor("host")||"crosshair",!0):l.$69l&&l.$79l(l.$69l,m)?(l.$67l=2,l.$12l=l.getHelperCursor("parent")||"crosshair",!0):l.$70l&&l.$79l(l.$70l,m)?(l.$67l=3,l.$12l=l.getHelperCursor("edge")||"crosshair",!0):l.$71l&&l.$79l(l.$71l,m)?(l.$67l=4,l.$12l=l.getHelperCursor("remove")||"crosshair",!0):l.$82l&&l.$79l(l.$82l,m)?(l.$67l=5,l.$12l=l.getHelperCursor("source")||"crosshair",!0):l.$83l&&l.$79l(l.$83l,m)?(l.$67l=6,l.$12l=l.getHelperCursor("target")||"crosshair",!0):l._pointElevationHelperPoint&&l.$79l(l._pointElevationHelperPoint,m)?(l.$67l=7,l.$12l=l.getHelperCursor("pointElevation")||"crosshair",!0):l.$90l&&l.$79l(l.$90l,m)?(l.$67l=8,l.$12l=l.getHelperCursor("elevation")||"crosshair",!0):l.$91l&&l.$79l(l.$91l,m)?(l.$67l=9,l.$12l=l.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(t,P,E,j,Q,q){var f=this,H=f.gv,$=H.getEditPointSize(),n=$/2,M=H.sm(),O=H.isDirectionEditable;if(O&&1===M.size()){var R=M.ld();if(O=O.bind(H),R instanceof v){if(!O(R,j))return!1;if("east"===j){if(O(R,"northeast")&&O(R,"southeast")&&2*$>=q)return!1}else if("west"===j){if(O(R,"northwest")&&O(R,"southwest")&&2*$>=q)return!1}else if("north"===j){if(O(R,"northwest")&&O(R,"northeast")&&2*$>=Q)return!1}else if("south"===j&&O(R,"southwest")&&O(R,"southeast")&&2*$>=Q)return!1}}else{if(2*$>=Q&&("north"===j||"south"===j))return!1;if(2*$>=q&&("east"===j||"west"===j))return!1}if(F({x:E.x-n,y:E.y-n,width:$,height:$},t)){if(f.$10l!==j){var J=180*f.$7l/K,e="";J>=337.5||22.5>J?e="north":J>=22.5&&67.5>J?e="northeast":J>=67.5&&112.5>J?e="east":J>=112.5&&157.5>J?e="southeast":J>=157.5&&202.5>J?e="south":J>=202.5&&247.5>J?e="southwest":J>=247.5&&292.5>J?e="west":J>=292.5&&337.5>J&&(e="northwest");var m=ae.indexOf(e),e=ae[P-(1-m)+8];switch(e){case"northwest":f.$12l="nwse-resize";break;case"northeast":f.$12l="nesw-resize";break;case"southwest":f.$12l="nesw-resize";break;case"southeast":f.$12l="nwse-resize";break;case"north":f.$12l="ns-resize";break;case"east":f.$12l="ew-resize";break;case"south":f.$12l="ns-resize";break;case"west":f.$12l="ew-resize"}f.$10l=j}return!0}return!1},$42l:function(j,w,i,Z,_){var A,J=this,y=J.gv,S=y.getEditPointSize(),p=S/y.getZoom(),g=-1,Y={x:w.x,y:w.y,width:0,height:0},T=function(i){"shape"===_?J._shape=j:J._edge=j,J._removePointIndex=i},W=function(s){"shape"===_?J._shape=j:J._edge=j,J.$13l=s,J.$12l="crosshair"};for(n(Y,p/2),g=i.length-1,A=Z.size()-1;A>=0;A--){var x=Z.get(A);if(1===x||2===x)g-=1;else if(3===x){var f=i[g-1];if(F(Y,f))return W(g-1),!0;g-=2}else if(4===x){var l=i[g-1],q=i[g-2];if(F(Y,l))return W(g-1),!0;if(F(Y,q))return W(g-2),!0;g-=3}}for(g=i.length-1,A=Z.size()-1;A>=0;A--){var x=Z.get(A),O=i[g];if(F(Y,O))return T(g),W(g),!0;1===x||2===x?g-=1:3===x?g-=2:4===x&&(g-=3)}return!1},$41l:function(Z,c,S,h,N){var Q=this,j=Q.gv,k=-1,z=0,g={x:c.x,y:c.y,width:0,height:0},Y=function(E,$){Q._hoverSegmentIndex=$,Q._lp=c,"shape"===N?Q._shape=Z:Q._edge=Z};for(n(g,j.getSegmentHoverWidth()/2/j.getZoom()),Z instanceof b&&Z.isClosePath()&&h.indexOf(5)<0&&(h=new w(h._as),h.add(5));z<h.size();z++){var E=h.get(z);if(1===E){var O=S[k],m=S[k+1];if(O){var X=Ym(new zi(O.x,O.y),new zi(m.x,m.y),new zi(g.x,g.y),new zi(g.x+g.width,g.y+g.height));if(X.$62l===p&&X.points.length>0)return Y(X,z),!0}k+=1}else if(2===E){var O=S[k],m=S[k+1],X=Ym(new zi(O.x,O.y),new zi(m.x,m.y),new zi(g.x,g.y),new zi(g.x+g.width,g.y+g.height));if(X.$62l===p&&X.points.length>0)return Y(X,z),!0;k+=1}else if(3===E){var O=S[k],P=S[k+1],K=S[k+2],X=Fl(new zi(O.x,O.y),new zi(P.x,P.y),new zi(K.x,K.y),new zi(g.x,g.y),new zi(g.x+g.width,g.y+g.height));if(X.$62l===p)return Y(X,z),!0;k+=2}else if(4===E){var O=S[k],B=S[k+1],t=S[k+2],K=S[k+3],X=an(new zi(O.x,O.y),new zi(B.x,B.y),new zi(t.x,t.y),new zi(K.x,K.y),new zi(g.x,g.y),new zi(g.x+g.width,g.y+g.height));if(X.$62l===p)return Y(X,z),!0;k+=3}else if(5===E){var O=S[k],m=S[0];if(O){var X=Ym(new zi(O.x,O.y),new zi(m.x,m.y),new zi(g.x,g.y),new zi(g.x+g.width,g.y+g.height));if(X.$62l===p&&X.points.length>0)return Y(X,z),!0}}}return!1},addShapePoint:function(S,I,c){var j=this,o=j.gv,x=o.dm();if(x.beginTransaction(),0===arguments.length&&(S=j._shape||j._edge,I=j._hoverSegmentIndex,c=j._lp),S instanceof b||S instanceof T){var B=Xc(S,o.getDataUI(S),I);if(!isNaN(I)&&c&&!isNaN(B)){var H=c;if(S instanceof b){var C=S.p(),y=S.getRotation(),z=S.toSegments();z&&z.size()||(z=vo(S.getPoints())),S.isClosePath()&&z.indexOf(5)<0&&(z=new w(z._as),z.add(5));var P=z.get(I),A="addPoint",s="removePointAt";if(2===P||1===P){var $={x:H.x,y:H.y};z.add(P,I),$=Rb(C,$.x-C.x,$.y-C.y,-y),S[A]($,B+1)}else if(3===P){var V=S.getPoints(),f=V.get(B),E=V.get(B+2),$={x:H.x,y:H.y};$=Rb(C,$.x-C.x,$.y-C.y,-y);var Y=qm(f,$),J=qm($,E);z.removeAt(I),z.add(3,I),z.add(3,I),S.setPoint(B+1,$),S[A](J,B+2),S[A](Y,B+1)}else if(4===P){var V=S.getPoints(),f=V.get(B),E=V.get(B+3),$={x:H.x,y:H.y};$=Rb(C,$.x-C.x,$.y-C.y,-y);var Y=aq(f,$),J=wh(f,$),L=aq($,E),Q=wh($,E);z.removeAt(I),z.add(4,I),z.add(4,I),S[s](B+1),S[s](B+1),S[A]($,B+1),S[A](Q,B+2),S[A](L,B+2),S[A](J,B+1),S[A](Y,B+1)}else if(5===P){var $={x:H.x,y:H.y};z.add(2,I),$=Rb(C,$.x-C.x,$.y-C.y,-y),S[A]($,B+1)}S.isClosePath()&&z.remove(5),S.setSegments(z);var X=S.getWidth(),m=S.getHeight(),n=S.p().x-X/2,W=S.p().y-m/2;n-=C.x,W-=C.y;var N=Lg(S,{x:n,y:W,width:X,height:m},y,C);S.p(N.x,N.y)}else if(S instanceof T){if("points"!==S.s("edge.type"))return x.endTransaction(),void 0;var V=S.s("edge.points");z=S.s("edge.segments"),V=Qg(o.getDataUI(S),V),z&&z.size()||(z=vo(V)),z=new w(z._as.slice(0)),V=new w(V._as.slice(0));var P=z.get(I);if(2===P||1===P){var $={x:H.x,y:H.y};z.add(P,I),V.add($,B+1)}else if(3===P){var f=V.get(B),E=V.get(B+2),$={x:H.x,y:H.y},Y=qm(f,$),J=qm($,E);z.removeAt(I),z.add(3,I),z.add(3,I),V.set(B+1,$),V.add(J,B+2),V.add(Y,B+1)}else if(4===P){var f=V.get(B),E=V.get(B+3),$={x:H.x,y:H.y},Y=aq(f,$),J=wh(f,$),L=aq($,E),Q=wh($,E);z.removeAt(I),z.add(4,I),z.add(4,I),V.removeAt(B+1),V.removeAt(B+1),V.add($,B+1),V.add(Q,B+2),V.add(L,B+2),V.add(J,B+1),V.add(Y,B+1)}S.s("edge.points",Dp(V)),S.s("edge.segments",z)}}}x.endTransaction()},removeShapePoint:function(l,g){var I=this,D="removeAt",O=I.gv,a=O.dm();if(a.beginTransaction(),0===arguments.length&&(l=I._shape||I._edge,g=I._removePointIndex),g>=0&&(l instanceof b||l instanceof T)){var V=Im(l,I.gv.getDataUI(l),g),Z=g;if(l instanceof b){var z=l.p(),c=l.toSegments();c&&c.size()||(c=vo(l.getPoints()));var i=c.get(V),q="removePointAt";if(1===i&&0===Z)if(l.getPoints().size()>1){var j=c.get(V+1);c[D](V+1),3===j?l[q](Z+1):4===j&&(l[q](Z+2),l[q](Z+1)),l[q](Z)}else l.dm().remove(l);else 2===i||1===i?(c[D](V),l[q](Z)):3===i?(c[D](V),l[q](Z),l[q](Z-1)):4===i&&(c[D](V),l[q](Z),l[q](Z-1),l[q](Z-2));l.setSegments(c);var N=l.getWidth(),y=l.getHeight(),J=l.p().x-N/2,h=l.p().y-y/2;J-=z.x,h-=z.y;var x=Lg(l,{x:J,y:h,width:N,height:y},l.getRotation(),z);l.p(x.x,x.y)}else if(l instanceof T){if("points"!==l.s("edge.type"))return a.endTransaction(),void 0;var E=l.s("edge.points");if(c=l.s("edge.segments"),E&&(E=Qg(I.gv.getDataUI(l),E),c&&c.size()||(c=vo(E))),0===g||g===E.size()-1)return a.endTransaction(),void 0;c=new w(c._as.slice(0)),E=new w(E._as.slice(0));var i=c.get(V);2===i||1===i?(c[D](V),E[D](Z)):3===i?(c[D](V),E[D](Z),E[D](Z-1)):4===i&&(c[D](V),E[D](Z),E[D](Z-1),E[D](Z-2)),l.s("edge.segments",c),l.s("edge.points",Dp(E))}}a.endTransaction()},changeShapeSegment:function(C,l,f){var I=this,e=I.gv,y=e.dm();if(y.beginTransaction(),1!==arguments.length||isNaN(C)||(f=C,C=I._shape||I._edge,l=I._hoverSegmentIndex),C instanceof b||C instanceof T){var G=Xc(C,I.gv.getDataUI(C),l);if(!isNaN(l)&&!isNaN(G))if(C instanceof b){var s=C.p(),J=C.toSegments();J&&J.size()||(J=vo(C.getPoints()));var k=J.get(l),Z=C.toPoints();if(1===f||2===f)1===k||2===k?J.set(l,f):3===k?(J.set(l,f),Z.removeAt(G+1)):4===k&&(J.set(l,f),Z.removeAt(G+1),Z.removeAt(G+1));else if(3===f){var r=function(){var d=Z.get(G),m=Z.get(G+1),Q=qm(d,m);J.set(l,3),Z.add(Q,G+1)};2===k||1===k?r():4===k&&(Z.removeAt(G+1),Z.removeAt(G+1),r())}else if(4===f){var M=function(){var w=Z.get(G),h=Z.get(G+1),g=aq(w,h),i=wh(w,h);J.set(l,4),Z.add(g,G+1),Z.add(i,G+2)};2===k||1===k?M():3===k&&(Z.removeAt(G+1),M())}C.setSegments(J),C.setPoints(Z);var $=C.getWidth(),L=C.getHeight(),h=C.p().x-$/2,o=C.p().y-L/2;h-=s.x,o-=s.y;var j=new Lg(C,{x:h,y:o,width:$,height:L},C.getRotation(),s);C.p(j.x,j.y)}else if(C instanceof T){if("points"!==C.s("edge.type"))return y.endTransaction(),void 0;var Z=C.s("edge.points");J=C.s("edge.segments"),Z&&(Z=Qg(I.gv.getDataUI(C),Z),J&&J.size()||(J=vo(Z))),J=new w(J._as.slice(0)),Z=new w(Z._as.slice(0));var k=J.get(l);if(1===f||2===f)1===k||2===k?J.set(l,f):3===k?(J.set(l,f),Z.removeAt(G+1)):4===k&&(J.set(l,f),Z.removeAt(G+1),Z.removeAt(G+1));else if(3===f){var r=function(){var I=Z.get(G),r=Z.get(G+1),X=qm(I,r);J.set(l,3),Z.add(X,G+1)};2===k||1===k?r():4===k&&(Z.removeAt(G+1),Z.removeAt(G+1),r())}else if(4===f){var M=function(){var Y=Z.get(G),$=Z.get(G+1),V=aq(Y,$),s=wh(Y,$);J.set(l,4),Z.add(V,G+1),Z.add(s,G+2)};2===k||1===k?M():3===k&&(Z.removeAt(G+1),M())}C.s("edge.points",Dp(Z)),C.s("edge.segments",J)}}y.endTransaction()},getDefaultSegments:function(X){var d=this.gv,u=d.getDataUI(X);if(X instanceof T){var _=X.s("edge.points");return _=Qg(u,_),vo(_)}if(X instanceof b){var _=X.getPoints(),z=X.getSegments();return z&&z.size()>0?z:vo(_)}},$43l:function(O){var X=this;O&&(X.$5l=1),X._68I=1,X._42()},_42:function(){var i=this;if(i._68I){delete i._68I;var p=i.gv,O=i.$5l,g=p.getZoom(),o=p.getEditPointSize(),e=o/2,z=new w,y=i._view,E=i._edge,Y=i._shape,C=y.getContext("2d"),$=p.tx(),l=p.ty(),q=L,M=p.getEditPointBackground(),A=p.getControlPointBackground(),c=p.getControlPointBorderColor(),G=p.getEditPointBorderColor(),P=p.getEditRectBorderColor(),h=p.getDirectionLineColor(),t=p.getSegmentHoverColor(),S=p.getSnapPointBorderColor(),V=p.getJoinPointBackground(),a=p.getJoinPointBorderColor(),B=p.getSegmentHoverWidth(),j=[5,5],Q=p.getEditRectBorderStyle();Dn(p,function(x){p.isSelected(x)&&p.isVisible(x)&&z.add(x)}),C.clearRect(0,0,W(y.width),W(y.height)),C.save(),f.translateAndScale(C,$,l,1);var R=L,F={x:0,y:0,width:0,height:0},u=0,D=0,H=0,K=0,J=0,Z=0,Ro=0,Kj=0,ms=0,kq=0,il=[];if(O?(delete i.$6l,delete i.$8l,delete i.$7l,delete i.$16l,delete i.$23l):(R=i.$6l,q=i.$7l),delete i.$68l,delete i.$69l,delete i.$71l,delete i.$70l,delete i.$82l,delete i.$83l,delete i._pointElevationHelperPoint,delete i.$90l,delete i.$91l,delete i.$75l,delete i.$74l,z.each(function(N){var r=p.getDataUI(N);if(r){var h=r._55O;if(p.isEditable(N))h._56O&&N instanceof v&&D++,il.push(N),h._42O&&N instanceof v&&u++,p.isHelperEditable(N,"host")&&K++,p.isHelperEditable(N,"parent")&&H++,p.isHelperEditable(N,"remove")&&J++,p.isHelperEditable(N,"edge")&&Z++,p.isHelperEditable(N,"source")&&Ro++,p.isHelperEditable(N,"target")&&Kj++,p.isHelperEditable(N,"elevation")&&ms++,p.isHelperEditable(N,"tall")&&kq++;else if(N instanceof I&&N.isExpanded()){var Y=!0,w=p.getEditableFunc();w&&(Y=w(N)),Y&&(p.isHelperEditable(N,"host")&&K++,p.isHelperEditable(N,"parent")&&H++,p.isHelperEditable(N,"remove")&&J++,p.isHelperEditable(N,"edge")&&Z++,p.isHelperEditable(N,"source")&&Ro++,p.isHelperEditable(N,"target")&&Kj++,p.isHelperEditable(N,"elevation")&&ms++,p.isHelperEditable(N,"tall")&&kq++,il.push(N))}}}),C.beginPath(),C.lineWidth=1,C.strokeStyle=p.getNodeBorderColor(),il.forEach(function(S){var P=p.getDataUI(S),H=P._55O;if(O)if(q==L&&(q=S instanceof T?0:S instanceof I&&S.isExpanded()?0:S.getRotation(),i.$7l=q),R==L){var J,h,o;if(S instanceof I&&S.isExpanded()||S instanceof T){var Q=p.getDataUIBounds(S);h=Q.width,o=Q.height,J={x:Q.x+h/2,y:Q.y+o/2}}else J=S.p(),h=S.getWidth(),o=S.getHeight();R={x:J.x,y:J.y,width:0,height:0},F.x=J.x-h/2,F.y=J.y-o/2,F.width=h,F.height=o,R=U(R,F)}else{var J,h,o,d,$=R.x+R.width/2,M=R.y+R.height/2,n={x:$,y:M};if(S instanceof I&&S.isExpanded()||S instanceof T){d=0;var Q=p.getDataUIBounds(S);h=Q.width,o=Q.height,J={x:Q.x+h/2,y:Q.y+o/2}}else J=S.p(),h=S.getWidth(),o=S.getHeight(),d=S.getRotation();var t={x:J.x-h/2,y:J.y-o/2,width:h,height:o},Z={x:t.x,y:t.y},D={x:t.x+t.width,y:t.y},W={x:t.x,y:t.y+t.height},r={x:t.x+t.width,y:t.y+t.height},Z=Rb(J,Z.x-J.x,Z.y-J.y,d),W=Rb(J,W.x-J.x,W.y-J.y,d),r=Rb(J,r.x-J.x,r.y-J.y,d),D=Rb(J,D.x-J.x,D.y-J.y,d),b=-q,e=Rb(n,Z.x-n.x,Z.y-n.y,b),_=Rb(n,D.x-n.x,D.y-n.y,b),A=Rb(n,W.x-n.x,W.y-n.y,b),Y=Rb(n,r.x-n.x,r.y-n.y,b),l=m([e,_,A,Y]);R=U(R,l),R.x-=$,R.y-=M;var G=Lg(L,R,q,n);R.x=G.x-R.width/2,R.y=G.y-R.height/2}if(u>1&&p.isEditable(S)&&p.isRectEditable(S)&&S instanceof v){var f=S.getRect(),V=H.$45l,y=ee(V[0],g),X=ee(V[2],g),j=ee(V[4],g),c=ee(V[6],g);S.getRotation()?(C.moveTo(y.x,y.y),C.lineTo(X.x,X.y),C.lineTo(j.x,j.y),C.lineTo(c.x,c.y),C.lineTo(y.x,y.y)):C.rect(f.x*g,f.y*g,f.width*g,f.height*g)}}),C.stroke(),R){i.$6l=X(R),n(R,p.getEditRectPadding()/g);var Lk={x:R.x+R.width/2,y:R.y+R.height/2},Mo=ti(Lk,R.width,R.height,q),Al=Mo[0],kk=Mo[1],Kl=Mo[2],rk=Mo[3],td=Mo[4],_p=Mo[5],Nb=Mo[6],Qk=Mo[7];if(Al=ee(Mo[0],g),kk=ee(Mo[1],g),Kl=ee(Mo[2],g),rk=ee(Mo[3],g),td=ee(Mo[4],g),_p=ee(Mo[5],g),Nb=ee(Mo[6],g),Qk=ee(Mo[7],g),i.$8l=R,u>0&&(i.$16l=[Al,td,kk,_p,rk,Nb,Kl,Qk],C.beginPath(),C.lineWidth=1,C.strokeStyle=P,"dashed"===Q&&C.setLineDash&&C.setLineDash(j),C.moveTo(Al.x,Al.y),C.lineTo(kk.x,kk.y),C.lineTo(rk.x,rk.y),C.lineTo(Kl.x,Kl.y),C.lineTo(Al.x,Al.y),C.stroke(),"dashed"===Q&&C.setLineDash&&C.setLineDash([])),C.beginPath(),C.lineWidth=1,C.fillStyle=M,C.strokeStyle=G,u>0){var ol=_p.x-Qk.x,_l=_p.y-Qk.y,kp=r(ol*ol+_l*_l),qe=td.x-Nb.x,Mb=td.y-Nb.y,Xn=r(qe*qe+Mb*Mb),oo=2*o;if(p.isDirectionEditable&&1===il.length){var Bb=il[0],ve=p.getDataUI(Bb),Wp=ve._55O,ak=p.isDirectionEditable.bind(p);if(Wp._42O){var Fi,Or,dn,kj;ak(Bb,"northwest")&&(Fi=!0,C.rect(Al.x-e,Al.y-e,o,o)),ak(Bb,"northeast")&&(Or=!0,C.rect(kk.x-e,kk.y-e,o,o)),ak(Bb,"southwest")&&(dn=!0,C.rect(Kl.x-e,Kl.y-e,o,o)),ak(Bb,"southeast")&&(kj=!0,C.rect(rk.x-e,rk.y-e,o,o)),ak(Bb,"north")&&(Fi&&Or?kp>oo&&C.rect(td.x-e,td.y-e,o,o):C.rect(td.x-e,td.y-e,o,o)),ak(Bb,"south")&&(kj&&dn?kp>oo&&C.rect(Nb.x-e,Nb.y-e,o,o):C.rect(Nb.x-e,Nb.y-e,o,o)),ak(Bb,"west")&&(dn&&Fi?Xn>oo&&C.rect(Qk.x-e,Qk.y-e,o,o):C.rect(Qk.x-e,Qk.y-e,o,o)),ak(Bb,"east")&&(kj&&Or?Xn>oo&&C.rect(_p.x-e,_p.y-e,o,o):C.rect(_p.x-e,_p.y-e,o,o))}}else kp>oo&&(C.rect(td.x-e,td.y-e,o,o),C.rect(Nb.x-e,Nb.y-e,o,o)),Xn>oo&&(C.rect(_p.x-e,_p.y-e,o,o),C.rect(Qk.x-e,Qk.y-e,o,o)),C.rect(Al.x-e,Al.y-e,o,o),C.rect(kk.x-e,kk.y-e,o,o),C.rect(Kl.x-e,Kl.y-e,o,o),C.rect(rk.x-e,rk.y-e,o,o)}if(D>0){var gf=i.$23l=Rb(td,0,2*-o,q);C.moveTo(gf.x+e,gf.y),C.arc(gf.x,gf.y,e,0,x,!1)}C.fill(),C.stroke(),i.$40l&&i.$44l(C,R,q);var Xi,Aq,Kq=p.getLeftTopHelpers(),dh=p.getRightTopHelpers(),Cn=p.getLeftBottomHelpers(),Pg=p.getRightBottomHelpers(),ze=p.getEdgeHelpers(),Kn=p.getEditHelperSize(),$f=Kn/2,Mm=function(b,f,r,G){"leftTop"===f?(Xi=R.x*g-Kn-e-("h"===G?r*(Kn+e):0)-1,Aq=R.y*g-Kn-e-("v"===G?r*(Kn+e):0)-1):"rightTop"===f?(Xi=(R.x+R.width)*g+e+("h"===G?r*(Kn+e):0)+1,Aq=R.y*g-Kn-e-("v"===G?r*(Kn+e):0)-1):"leftBottom"===f?(Xi=R.x*g-Kn-e-("h"===G?r*(Kn+e):0)-1,Aq=(R.y+R.height)*g+e+("v"===G?r*(Kn+e):0)+1):"rightBottom"===f&&(Xi=(R.x+R.width)*g+e+("h"===G?r*(Kn+e):0)+1,Aq=(R.y+R.height)*g+e+("v"===G?r*(Kn+e):0)+1);var L=Xi+$f,F=Aq+$f,_=(R.x+R.width/2)*g,x=(R.y+R.height/2)*g,B=Rb({x:_,y:x},L-_,F-x,q);if("host"===b){if(K>0)return i.$77l(C,q,B),!0}else if("edge"===b){if(Z>0)return i.$80l(C,q,B),!0}else if("remove"===b){if(J>0)return il&&1===il.length&&il[0]instanceof T?i.$81l(C,q,{x:_+Kn/2+5,y:x}):i.$81l(C,q,B),!0}else if("parent"===b){if(H>0)return il&&1===il.length&&il[0]instanceof T?i.$76l(C,q,{x:_-Kn/2-5,y:x}):i.$76l(C,q,B),!0}else if("elevation"===b){if(ms>0)return i.$85l(C,q,B),!0}else if("tall"===b){if(kq>0)return i.$86l(C,q,B),!0}else if("source"===b||"target"===b){var l=il[0],n=p.getDataUI(l),u=mq(n,!0),Q=u[0],s=u[1];if(Ro&&"source"===b)return i.$84l(C,R,Q,!0,l.isLooped(),f,r,G),!0;if(Kj&&"target"===b)return i.$84l(C,R,s,!1,l.isLooped(),f,r,G),!0}};if(Kq&&Kq.length>0){var Ho=0;Kq.forEach(function(e){Mm(e,"leftTop",Ho,p.getLeftTopHelpersAlign()||"h")&&Ho++})}if(dh&&dh.length>0){var Ho=0;dh.forEach(function(t){Mm(t,"rightTop",Ho,p.getRightTopHelpersAlign()||"h")&&Ho++})}if(Cn&&Cn.length>0){var Ho=0;Cn.forEach(function(M){Mm(M,"leftBottom",Ho,p.getLeftBottomHelpersAlign()||"h")&&Ho++})}if(Pg&&Pg.length>0){var Ho=0;Pg.forEach(function(k){Mm(k,"rightBottom",Ho,p.getRightBottomHelpersAlign()||"h")&&Ho++})}if(ze&&ze.length>0&&((Ro||Kj)&&il&&1===il.length&&il[0]instanceof T?!0:!1)){var Ho=0;ze.forEach(function(M){Mm(M,"edge",Ho,"h")&&Ho++})}if(i.$72l){var If,Eh=i.$67l,aj=i.$68l,Nm=i.$69l,pd=(i.$71l,i.$70l),ub=i.$82l,Ue=i.$83l;if(1===Eh?If=aj:2===Eh?If=Nm:3===Eh?If=pd:5===Eh?If=ub:6===Eh&&(If=Ue),If){var Ni=p.lp(i.$72l),Gc=p.getDataAt(i.$72l);if(Gc&&Gc instanceof v){var yo,up,Pj;if(i.$73l=Gc,1===Eh)if(Gc instanceof s.Grid)yo=i.$75l=rh(Gc,Ni);else if(Gc instanceof s.Shape){Pj=i.$74l=Cj(Gc,Ni);var On=Gc.getPoints();if(Pj){var Ti=Pj.attachIndex,Ud=Xc(Gc,p.getDataUI(Gc),Ti)+1,Mq=Ud+1>=On.size()?0:Ud+1,Jl=On.get(Ud),$c=On.get(Mq),Hc=Gc.p(),Zf=Gc.getRotation();Jl=Rb(Hc,Jl.x-Hc.x,Jl.y-Hc.y,Zf),$c=Rb(Hc,$c.x-Hc.x,$c.y-Hc.y,Zf),C.beginPath(),C.strokeStyle=t,C.lineWidth=B,C.moveTo(Jl.x*g,Jl.y*g),C.lineTo($c.x*g,$c.y*g),C.stroke()}}yo?up=yo.rect:(up=N.clone(p.getDataUIBounds(Gc)),N.grow(up,2)),C.beginPath(),C.rect(up.x*g,up.y*g,up.width*g,up.height*g),C.strokeStyle=1===Eh||4===Eh||6===Eh?k:d,C.lineWidth=2,C.setLineDash&&C.setLineDash([8,8]),C.stroke()}else delete i.$73l;Ni.x=Ni.x*g,Ni.y=Ni.y*g;var Qh=bc(If.x,If.y,Ni.x,Ni.y),Ek=Rb(If,Ni.x-If.x,Ni.y-If.y,-Qh),xj=Ek.x-If.x;C.save(),C.translate(If.x,If.y),C.rotate(Qh),_.width=xj,_.height=40;var Bn=d;(1===Eh||4===Eh||6===Eh)&&(Bn=k),_.comps[0].gradientColor=Bn,N.drawImage(C,_,0,-20,xj,40),C.restore()}}}if(z.each(function(W){var o=p.getDataUI(W);if(o){var j,r,X=o._55O,J=o._78o;if(X&&X._43O&&W instanceof b?(j=X.$15l,r=W.getSegments(),r&&r.size()||(r=vo(j)),W.isClosePath()&&r.indexOf(5)<0&&(r=new w(r._as),r.add(5))):X&&J&&X._43O&&(j=W.s("edge.points"),r=W.s("edge.segments"),j=Qg(o,j),r&&r.size()||(r=vo(j)),j&&(j=j._as)),j&&r){var K=0,G=r.size(),l=i._hoverSegmentIndex;j=j.slice(0);for(var T=0;T<j.length;T++)j[T]=ee(j[T],g);C.beginPath(),C.strokeStyle=h,C.lineWidth=1,K=0;for(var T=0;G>T;T++){var q=r.get(T);if(1===q||2===q)K++;else if(3===q){var R=j[K-1],y=j[K],U=j[K+1];C.moveTo(R.x,R.y),C.lineTo(y.x,y.y),C.lineTo(U.x,U.y),K+=2}else if(4===q){var R=j[K-1],v=j[K],_=j[K+1],U=j[K+2];C.moveTo(R.x,R.y),C.lineTo(v.x,v.y),C.moveTo(_.x,_.y),C.lineTo(U.x,U.y),K+=3}}if(C.stroke(),Y===W||E===W&&"points"===E.s("edge.type")){C.beginPath(),K=0,C.strokeStyle=t,C.lineWidth=B;for(var T=0;G>T;T++){var q=r.get(T);if(1===q||2===q){if(l===T){var R=j[K-1],U=j[K];C.moveTo(R.x,R.y),C.lineTo(U.x,U.y);break}K++}else if(3===q){if(l===T){var R=j[K-1],y=j[K],U=j[K+1];C.moveTo(R.x,R.y),C.quadraticCurveTo(y.x,y.y,U.x,U.y);break}K+=2}else if(4===q){if(l===T){var R=j[K-1],v=j[K],_=j[K+1],U=j[K+2];C.moveTo(R.x,R.y),C.bezierCurveTo(v.x,v.y,_.x,_.y,U.x,U.y);break}K+=3}else if(5===q&&l===T){var R=j[K-1],U=j[0];C.moveTo(R.x,R.y),C.lineTo(U.x,U.y);break}}C.stroke()}C.beginPath(),K=0,C.strokeStyle=a,C.lineWidth=1,C.fillStyle=V;for(var T=0;G>T;T++){var q=r.get(T);if(1===q||2===q){var U=j[K];C.moveTo(U.x+e,U.y),C.arc(U.x,U.y,e,0,x,!0),K++}else if(3===q){var U=j[K+1];C.moveTo(U.x+e,U.y),C.arc(U.x,U.y,e,0,x,!0),K+=2}else if(4===q){var U=j[K+2];C.moveTo(U.x+e,U.y),C.arc(U.x,U.y,e,0,x,!0),K+=3}}C.fill(),C.stroke(),C.beginPath(),K=0,C.strokeStyle=c,C.lineWidth=1,C.fillStyle=A;for(var T=0;G>T;T++){var q=r.get(T);if(1===q||2===q)K++;else if(3===q){var y=j[K];C.moveTo(y.x+e,y.y),C.arc(y.x,y.y,e,0,x,!0),K+=2}else if(4===q){var v=j[K],_=j[K+1];C.moveTo(v.x+e,v.y),C.arc(v.x,v.y,e,0,x,!0),C.moveTo(_.x+e,_.y),C.arc(_.x,_.y,e,0,x,!0),K+=3}}if(C.fill(),C.stroke(),C.beginPath(),K=0,C.strokeStyle=S,C.lineWidth=2,(Y===W||E===W)&&i.$9l!=L){var U=j[i.$9l];C.moveTo(U.x+e,U.y),C.arc(U.x,U.y,e,0,x,!0),C.stroke()}}}}),i.$87l&&p.sm().contains(i.$87l)){var wj,xk=i.$87l,gd=i.$88l,Kn=p.getEditHelperSize(),$f=Kn/2;if(p.isHelperEditable(xk,"pointElevation"))if(xk instanceof b){var Ri=xk.getPosition();wj=N.clone(xk.getPoints().get(gd)),wj=Rb({x:Ri.x,y:Ri.y},wj.x-Ri.x,wj.y-Ri.y,xk.getRotation()),wj.x*=g,wj.y*=g,C.translate(wj.x,wj.y),N.drawImage(C,N.getImage("xeditinteractor_elevationIcon"),$f,-$f,Kn,Kn),C.translate(-wj.x,-wj.y),i._pointElevationHelperPoint={x:wj.x+Kn,y:wj.y}}else if(xk instanceof T){var jl=Qg(p.getDataUI(xk),xk.s("edge.points")),wj=N.clone(jl.get(gd));wj.x*=g,wj.y*=g,C.translate(wj.x,wj.y),N.drawImage(C,N.getImage("xeditinteractor_elevationIcon"),$f,-$f,Kn,Kn),C.translate(-wj.x,-wj.y),i._pointElevationHelperPoint={x:wj.x+Kn,y:wj.y}}}C.restore(),i.$5l=0}},$89l:function(L,x,E,V){L.save();var Y=this,k=Y.gv,n=k.getEditHelperSize(),z=n/2;L.beginPath(),L.translate(E.x,E.y),L.rotate(x),N.drawImage(L,V,-z,-z,n,n),L.restore()},$85l:function(z,n,W){var b=this;b.$90l=W,b.$89l(z,n,W,N.getImage("xeditinteractor_elevationIcon"))},$86l:function($,p,w){var P=this;P.$91l=w,P.$89l($,p,w,N.getImage("xeditinteractor_tallIcon"))},$77l:function(s,L,p){var T=this;T.$68l=p,T.$89l(s,L,p,N.getImage("xeditinteractor_hostIcon"))},$80l:function(y,t,m){var b=this;b.$70l=m,b.$89l(y,t,m,N.getImage("xeditinteractor_edgeIcon"))},$81l:function(f,R,Q){var H=this;H.$71l=Q,H.$89l(f,R,Q,N.getImage("xeditinteractor_removeIcon"))},$76l:function(i,W,j){var q=this;q.$69l=j,q.$89l(i,W,j,N.getImage("xeditinteractor_parentIcon"))},$84l:function(n,c,O,z,h){var k,V=this,L=V.gv,x=L.getZoom(),m=L.getEditHelperSize(),s=m/2;O.x*=x,O.y*=x,h&&(z?O.x-=s+5:O.x+=s+5),O.y-=m-2,z?(V.$82l=O,k=N.getImage("xeditinteractor_sourceIcon")):(V.$83l=O,k=N.getImage("xeditinteractor_targetIcon")),n.beginPath(),n.translate(O.x,O.y),N.drawImage(n,k,-s,-s,m,m),n.translate(-O.x,-O.y)},$44l:function(h,L,y){h.save();var A=this.gv.getZoom(),z=r(Y(L.width,2)+Y(L.height,2))/2*A+10,V=z,S=V+8,p=V+18,o=y,G=L.x+L.width/2,v=L.y+L.height/2;h.translate(G*A,v*A),h.beginPath(),h.strokeStyle="rgb(150, 150, 150)";for(var I=0,R=0,l=0,M=0,t=0,D=0;360>D;D++)I=D*K/180,0===D%5&&(R=E(I)*V,l=Q(I)*V,M=E(I)*S,t=Q(I)*S,h.moveTo(R,l),h.lineTo(M,t)),0===D%45&&(R=E(I)*V,l=Q(I)*V,M=E(I)*p,t=Q(I)*p,h.moveTo(R,l),h.lineTo(M,t));h.stroke(),h.beginPath(),h.rotate(-P),h.beginPath(),h.fillStyle="rgba(255, 0, 0, 0.1)",h.strokeStyle="rgb(157, 157, 157)",h.moveTo(0,0),h.arc(0,0,p,0,y,!1),h.fill(),h.beginPath(),h.moveTo(0+p,0),h.arc(0,0,p,0,y,!1),h.stroke(),h.rotate(P),h.font="bold 12px Verdana, Arial";var C=20*Q(o),W=20*E(o),j=B(180*o/K)+"°";h.textAlign="center",h.textBaseline="middle",h.beginPath();var a=h.measureText("365.°").width;h.fillStyle="white",h.rect(C-a/2,-W-10,a,20),h.fill(),h.beginPath(),h.fillStyle="rgb(79,79,79)",h.fillText(j,C,-W),h.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);