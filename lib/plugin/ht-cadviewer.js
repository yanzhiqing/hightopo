!function(g,x,e){"use strict";function q($){this._pointer=0,this._data=$,this._eof=!1}function t(r,e){return 9>=r?e:r>=10&&59>=r?parseFloat(e):r>=60&&99>=r?parseInt(e):r>=100&&109>=r?e:r>=110&&149>=r?parseFloat(e):r>=160&&179>=r?parseInt(e):r>=210&&239>=r?parseFloat(e):r>=270&&289>=r?parseInt(e):r>=290&&299>=r?a(e):r>=300&&369>=r?e:r>=370&&389>=r?parseInt(e):r>=390&&399>=r?e:r>=400&&409>=r?parseInt(e):r>=410&&419>=r?e:r>=420&&429>=r?parseInt(e):r>=430&&439>=r?e:r>=440&&459>=r?parseInt(e):r>=460&&469>=r?parseFloat(e):r>=470&&481>=r?e:999===r?e:r>=1e3&&1009>=r?e:r>=1010&&1059>=r?parseFloat(e):r>=1060&&1071>=r?parseInt(e):(console.log("WARNING: Group code does not have a defined type: %j",{code:r,value:e}),e)}function a(z){if("0"===z)return!1;if("1"===z)return!0;throw TypeError("String '"+z+"' cannot be cast to Boolean type")}function M(P){P&&P.sanitize!==e&&(this.sanitize=P.sanitize)}function j(F){l.debug("unhandled group "+Q(F))}function Q(x){return x.code+":"+x.value}function h($){return Z[$]}var W="ht",m=g[W],$=m.Default,G=$.getInternal();m.CadViewer={},G.addMethod($,{toDxf:function(G){var k=new m.CadViewer.DxfWriter;k.snapshotView(G);var _=k.write();return _},viewToShape:function(E){var O=new m.CadViewer.DxfWriter;return O.snapshotView(E,!0),O.entities},viewDxf:function(I,J,$){var M=new m.CadViewer.DxfViewer(I,$);return I.addBottomPainter(M),M.parseFile(J),M}});var u=function(){},l={debug:u,warn:u,error:u},Z=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215];q.prototype.next=function(G){var y;if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);return y={code:parseInt(this._data[this._pointer])},this._pointer++,y.value=t(y.code,this._data[this._pointer].trim()),this._pointer++,G||0!==y.code||"EOF"!==y.value||(this._eof=!0),y},q.prototype.hasNext=function(){return this._eof?!1:this._pointer>this._data.length-2?!1:!0},q.prototype.isEOF=function(){return this._eof},M.prototype.parse=function(){throw new Error("read() not implemented. Use readSync()")},M.prototype.parseSync=function(s){return"string"==typeof s?this._parse(s):(console.error("Cannot read dxf source of type `"+typeof s),null)},M.prototype.parseStream=function(D,l){function E(z){J+=z}function A(){try{var S=g._parse(J)}catch(c){return l(c)}l(null,S)}function S(y){l(y)}var J="",g=this;D.on("data",E),D.on("end",A),D.on("error",S)},M.prototype.sanitizeFileName=function(){var N=/[\/\?<>\\:\*\|":]/g,U=/[\x00-\x1f\x80-\x9f]/g,G=/^\.+$/,_=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,M=/[\. ]+$/;return function(q){var l=this.sanitize;return null==l?q:q.replace(N,l).replace(U,l).replace(G,l).replace(_,l).replace(M,l)}}(),M.prototype._parse=function(R){var Y,d,b=this,s={},K=0,n=R.split(/\r\n|\r|\n/g);if(Y=new q(n),!Y.hasNext())throw Error("Empty file");var T=function(){for(d=Y.next();!Y.isEOF();)if(0===d.code&&"SECTION"===d.value){if(d=Y.next(),2!==d.code){console.error("Unexpected code %s after 0:SECTION",Q(d)),d=Y.next();continue}"HEADER"===d.value?(l.debug("> HEADER"),s.header=z(),l.debug("<")):"BLOCKS"===d.value?(l.debug("> BLOCKS"),s.blocks=m(),l.debug("<")):"ENTITIES"===d.value?(l.debug("> ENTITIES"),s.entities=X(!1),l.debug("<")):"TABLES"===d.value?(l.debug("> TABLES"),s.tables=B(),l.debug("<")):"EOF"===d.value?l.debug("EOF"):l.warn("Skipping section '%s'",d.value)}else d=Y.next()},c=function(J,P){return d.code===J&&d.value===P},z=function(){var k=null,u=null,L={};for(d=Y.next();;){if(c(0,"ENDSEC")){k&&(L[k]=u);break}9===d.code?(k&&(L[k]=u),k=d.value):10===d.code?u={x:d.value}:20===d.code?u.y=d.value:30===d.code?u.z=d.value:u=d.value,d=Y.next()}return d=Y.next(),L},m=function(){var u,g={};for(d=Y.next();"EOF"!==d.value&&!c(0,"ENDSEC");)c(0,"BLOCK")?(l.debug("block {"),u=o(),l.debug("}"),_(u),u.name?g[u.name]=u:l.error('block with handle "'+u.handle+'" is missing a name.')):(j(d),d=Y.next());return g},o=function(){var w={};for(d=Y.next();"EOF"!==d.value;){switch(d.code){case 1:w.xrefPath=d.value,d=Y.next();break;case 2:w.name=b.sanitizeFileName(d.value),d=Y.next();break;case 3:w.name2=b.sanitizeFileName(d.value),d=Y.next();break;case 5:w.handle=d.value,d=Y.next();break;case 8:w.layer=d.value,d=Y.next();break;case 10:w.position=A();break;case 67:w.paperSpace=d.value&&1==d.value?!0:!1,d=Y.next();break;case 70:0!=d.value&&(w.type=d.value),d=Y.next();break;case 100:d=Y.next();break;case 330:w.ownerHandle=d.value,d=Y.next();break;case 0:if("ENDBLK"==d.value)break;Y._pointer-=2,w.entities=X(!0);break;default:j(d),d=Y.next()}if(c(0,"ENDBLK")){d=Y.next();break}}return w},B=function(){var R={};for(d=Y.next();"EOF"!==d.value&&!c(0,"ENDSEC");)if(c(0,"TABLE")){d=Y.next();var m=E[d.value];m?(l.debug(d.value+" Table {"),R[E[d.value].tableName]=r(),l.debug("}")):l.debug("Unhandled Table "+d.value)}else d=Y.next();return d=Y.next(),R},w="ENDTAB",r=function(){var v,U=E[d.value],g={},k=0;for(d=Y.next();!c(0,w);)switch(d.code){case 5:g.handle=d.value,d=Y.next();break;case 330:g.ownerHandle=d.value,d=Y.next();break;case 100:"AcDbSymbolTable"===d.value?d=Y.next():(j(d),d=Y.next());break;case 70:k=d.value,d=Y.next();break;case 0:d.value===U.dxfSymbolName?g[U.tableRecordsProperty]=U.parseTableRecords():(j(d),d=Y.next());break;default:j(d),d=Y.next()}var B=g[U.tableRecordsProperty];return B&&(B.constructor===Array?v=B.length:"object"==typeof B&&(v=x.keys(B).length),k!==v&&l.warn("Parsed "+v+" "+U.dxfSymbolName+"'s but expected "+k)),d=Y.next(),g},J=function(){var z=[],U={};for(l.debug("ViewPort {"),d=Y.next();!c(0,w);)switch(d.code){case 2:U.name=d.value,d=Y.next();break;case 10:U.lowerLeftCorner=A();break;case 11:U.upperRightCorner=A();break;case 12:U.center=A();break;case 13:U.snapBasePoint=A();break;case 14:U.snapSpacing=A();break;case 15:U.gridSpacing=A();break;case 16:U.viewDirectionFromTarget=A();break;case 17:U.viewTarget=A();break;case 40:U.viewHeight=d.value,U.aspectRatio!==e&&(U.viewWidth=d.value*U.aspectRatio),d=Y.next();break;case 41:U.aspectRatio=d.value,U.viewHeight!==e&&(U.viewWidth=d.value*U.viewHeight),d=Y.next();break;case 42:U.lensLength=d.value,d=Y.next();break;case 43:U.frontClippingPlane=d.value,d=Y.next();break;case 44:U.backClippingPlane=d.value,d=Y.next();break;case 45:U.viewHeight=d.value,d=Y.next();break;case 50:U.snapRotationAngle=d.value,d=Y.next();break;case 51:U.viewTwistAngle=d.value,d=Y.next();break;case 79:U.orthographicType=d.value,d=Y.next();break;case 110:U.ucsOrigin=A();break;case 111:U.ucsXAxis=A();break;case 112:U.ucsYAxis=A();break;case 110:U.ucsOrigin=A();break;case 281:U.renderMode=d.value,d=Y.next();break;case 281:U.defaultLightingType=d.value,d=Y.next();break;case 292:U.defaultLightingOn=d.value,d=Y.next();break;case 330:U.ownerHandle=d.value,d=Y.next();break;case 63:case 421:case 431:U.ambientColor=d.value,d=Y.next();break;case 0:"VPORT"===d.value&&(l.debug("}"),z.push(U),l.debug("ViewPort {"),U={},d=Y.next());break;default:j(d),d=Y.next()}return l.debug("}"),z.push(U),z},y=function(){var N,C,W={},V={};for(l.debug("LType {"),d=Y.next();!c(0,"ENDTAB");)switch(d.code){case 2:V.name=d.value,N=d.value,d=Y.next();break;case 3:V.description=d.value,d=Y.next();break;case 73:C=d.value,C>0&&(V.pattern=[]),d=Y.next();break;case 40:V.patternLength=d.value,d=Y.next();break;case 49:V.pattern.push(d.value),d=Y.next();break;case 0:l.debug("}"),C>0&&C!==V.pattern.length&&l.warn("lengths do not match on LTYPE pattern"),W[N]=V,V={},l.debug("LType {"),d=Y.next();break;default:d=Y.next()}return l.debug("}"),W[N]=V,W},G=function(){var z,L={},v={};for(l.debug("Layer {"),d=Y.next();!c(0,"ENDTAB");)switch(d.code){case 2:v.name=d.value,z=d.value,d=Y.next();break;case 62:v.visible=d.value>=0,v.color=h(Math.abs(d.value)),d=Y.next();break;case 6:v.lineType=d.value,d=Y.next();break;case 0:"LAYER"===d.value&&(l.debug("}"),L[z]=v,l.debug("Layer {"),v={},z=e,d=Y.next());break;default:j(d),d=Y.next()}return l.debug("}"),L[z]=v,L},E={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:J},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:y},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:G}},X=function(e){var s=[],b=e?"ENDBLK":"ENDSEC";for(d=Y.next();;)if(0===d.code){if(d.value===b)break;var O;if("LWPOLYLINE"===d.value)l.debug("LWPOLYLINE {"),O=$(),l.debug("}");else if("POLYLINE"===d.value)l.debug("POLYLINE {"),O=C(),l.debug("}");else if("LINE"===d.value)l.debug("LINE {"),O=a(),l.debug("}");else if("CIRCLE"===d.value)l.debug("CIRCLE {"),O=N(),l.debug("}");else if("ARC"===d.value)l.debug("ARC {"),O=N(),l.debug("}");else if("ELLIPSE"===d.value)l.debug("ELLIPSE {"),O=D(),l.debug("}");else if("SPLINE"===d.value)l.debug("SPLINE {"),O=U(),l.debug("}");else if("TEXT"===d.value)l.debug("TEXT {"),O=P(),l.debug("}");else if("ATTRIB"===d.value)l.debug("ATTRIB {"),O=M(),l.debug("}");else if("DIMENSION"===d.value)l.debug("DIMENSION {"),O=t(),l.debug("}");else if("INSERT"===d.value)l.debug("INSERT {"),O=g(),l.debug("}");else if("HATCH"===d.value)l.debug("HATCH {"),O=V(),l.debug("}");else if("SOLID"===d.value)l.debug("SOLID {"),O=f(),l.debug("}");else if("POINT"===d.value)l.debug("POINT {"),O=W(),l.debug("}");else if("MTEXT"===d.value)l.debug("MTEXT {"),O=p(),l.debug("}");else{if("ATTDEF"!==d.value){l.warn("Unhandled entity "+d.value),d=Y.next();continue}l.debug("ATTDEF {"),O=Z(),l.debug("}")}O instanceof Array?O.forEach(function(H){_(H),s.push(H)}):(_(O),s.push(O))}else d=Y.next();return"ENDSEC"==b&&(d=Y.next()),s},H=function(W){switch(d.code){case 0:W.type=d.value,d=Y.next();break;case 5:W.handle=d.value,d=Y.next();break;case 6:W.lineType=d.value,d=Y.next();break;case 8:W.layer=d.value,d=Y.next();break;case 48:W.lineTypeScale=d.value,d=Y.next();break;case 60:W.visible=0===d.value,d=Y.next();break;case 62:W.colorIndex=d.value,W.color=h(Math.abs(d.value)),d=Y.next();break;case 67:W.inPaperSpace=0!==d.value,d=Y.next();break;case 210:W.extrusionDirection=A();break;case 230:W.extrusionDirection={x:0,y:0,z:d.value},d=Y.next();break;case 330:W.ownerHandle=d.value,d=Y.next();break;case 347:W.materialObjectHandle=d.value,d=Y.next();break;case 370:W.lineweight=d.value,d=Y.next();break;case 420:W.color=d.value,d=Y.next();break;case 100:if("AcDbEntity"==d.value){d=Y.next();break}default:j(d),d=Y.next()}},I=function(){var T={type:d.value};for(d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:T.x=d.value,d=Y.next();break;case 20:T.y=d.value,d=Y.next();break;case 30:T.z=d.value,d=Y.next();break;case 40:case 41:case 42:d=Y.next();break;case 70:T.curveFittingVertex=0!==(1|d.value),T.curveFitTangent=0!==(2|d.value),T.splineVertex=0!==(8|d.value),T.splineControlPoint=0!==(16|d.value),T.ThreeDPolylineVertex=0!==(32|d.value),T.ThreeDPolylineMesh=0!==(64|d.value),T.polyfaceMeshVertex=0!==(128|d.value),d=Y.next();break;case 50:case 71:case 72:case 73:case 74:d=Y.next();break;default:H(T)}return T},v=function(){var w={type:d.value};for(d=Y.next();"EOF"!=d&&0!=d.code;)H(w);return w},A=function(){var A={},B=d.code;if(A.x=d.value,B+=10,d=Y.next(),d.code!=B)throw new Error("Expected code for point value to be "+B+" but got "+d.code+".");return A.y=d.value,B+=10,d=Y.next(),d.code!=B?A:(A.z=d.value,d=Y.next(),A)},O=function(){var k={},m=d.code;return k.x=d.value,m+=1,d=Y.next(),d.code!=m?(Y._pointer-=2,k.y=1):k.y=d.value,m+=1,d=Y.next(),d.code!=m?(Y._pointer-=2,k.z=1):k.z=d.value,d=Y.next(),k},u=function(O){if(!O||0>=O)throw Error("n must be greater than 0 verticies");var Z,R=[],K=!1,c=!1;for(Z=0;O>Z;Z++){for(var s={};"EOF"!==d&&0!==d.code&&!c;){switch(d.code){case 10:if(K){c=!0;continue}s.x=d.value,K=!0;break;case 20:s.y=d.value;break;case 30:s.z=d.value;break;case 40:s.startWidth=d.value;break;case 41:s.endWidth=d.value;break;case 42:0!=d.value&&(s.bulge=d.value);break;default:if(K){c=!0;continue}}d=Y.next()}R.push(s),K=!1,c=!1}return R},i=function(){for(var h=[];"EOF"!==d;)if(0===d.code)if("VERTEX"===d.value)h.push(I());else if("SEQEND"===d.value){v();break}return h},p=function(){var O={type:d.value};for(d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 1:O.text=d.value,d=Y.next();break;case 3:O.text+=d.value,d=Y.next();break;case 10:O.position=A();break;case 40:O.height=d.value,d=Y.next();break;case 41:O.width=d.value,d=Y.next();break;case 71:O.attachmentPoint=d.value,d=Y.next();break;case 72:O.drawingDirection=d.value,d=Y.next();break;case 50:O.angle=2*d.value*Math.PI/360,d=Y.next();break;case 11:O.directionX=d.value,d=Y.next();break;case 21:O.directionY=d.value,d=Y.next();break;case 60:O.hidden=1===d.value,d=Y.next();break;default:H(O)}return O},Z=function(){var z={type:d.value,scale:1,textStyle:"STANDARD",halign:0,valign:0};for(d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 1:z.text=d.value,d=Y.next();break;case 2:z.tag=d.value,d=Y.next();break;case 3:z.prompt=d.value,d=Y.next();break;case 7:z.textStyle=d.value,d=Y.next();break;case 10:z.startPoint=A();break;case 11:z.endPoint=A();break;case 39:z.thickness=d.value,d=Y.next();break;case 40:z.textHeight=d.value,d=Y.next();break;case 41:z.scale=d.value,d=Y.next();break;case 50:z.rotation=d.value/180*Math.PI,d=Y.next();break;case 51:z.obliqueAngle=d.value,d=Y.next();break;case 70:z.invisible=!!(1&d.value),z.constant=!!(2&d.value),z.verificationRequired=!!(4&d.value),z.preset=!!(8&d.value),d=Y.next();break;case 71:z.backwards=!!(2&d.value),z.mirrored=!!(4&d.value),d=Y.next();break;case 72:z.halign=d.value,d=Y.next();break;case 73:z.fieldLength=d.value,d=Y.next();break;case 74:z.valign=d.value,d=Y.next();break;case 100:d=Y.next();break;case 210:z.extrusionDirectionX=d.value,d=Y.next();break;case 220:z.extrusionDirectionY=d.value,d=Y.next();break;case 230:z.extrusionDirectionZ=d.value,d=Y.next();break;default:H(z)}return z},$=function(){var k={type:d.value,vertices:[]},P=0;for(d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 38:k.elevation=d.value,d=Y.next();break;case 39:k.depth=d.value,d=Y.next();break;case 70:k.shape=1===d.value,d=Y.next();break;case 90:P=d.value,d=Y.next();break;case 10:k.vertices=u(P);break;case 40:0!==d.value&&(k.startWidth=d.value),d=Y.next();break;case 41:0!==d.value&&(k.endWidth=d.value),d=Y.next();break;case 43:0!==d.value&&(k.width=d.value),d=Y.next();break;default:H(k)}return k},C=function(){var g={type:d.value,vertices:[]};for(d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:case 20:case 30:case 39:d=Y.next();break;case 40:0!==d.value&&(g.startWidth=d.value),d=Y.next();break;case 41:0!==d.value&&(g.endWidth=d.value),d=Y.next();break;case 70:g.shape=1===d.value,d=Y.next();break;case 71:case 72:case 73:case 74:case 75:d=Y.next();break;case 100:d=Y.next();break;default:H(g)}return g.vertices=i(),g},a=function(){var $={type:d.value,vertices:[]};for(d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:$.vertices.unshift(A());break;case 11:$.vertices.push(A());break;case 100:if("AcDbLine"==d.value){d=Y.next();break}default:H($)}return $},N=function(){var B,l;for(B={type:d.value},d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:B.center=A();break;case 40:B.radius=d.value,d=Y.next();break;case 50:B.startAngle=Math.PI/180*d.value,d=Y.next();break;case 51:l=Math.PI/180*d.value,B.angleLength=l<B.startAngle?l+2*Math.PI-B.startAngle:l-B.startAngle,B.endAngle=l,d=Y.next();break;default:H(B)}return B},D=function(){var O,V;for(O={type:d.value},d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:O.center=A();break;case 11:O.major=A();break;case 40:O.ratio=d.value,d=Y.next();break;case 41:O.startAngle=d.value,d=Y.next();break;case 42:V=d.value,O.angleLength=V<O.startAngle?V+2*Math.PI-O.startAngle:V-O.startAngle,O.endAngle=V,d=Y.next();break;default:H(O)}return O},g=function(){var W,G,L=[];for(W={type:d.value,attribs:L},d=Y.next();"EOF"!==d;){if(0===d.code){if(G&&"ATTRIB"===d.value){L.push(M());continue}if(G&&"SEQEND"===d.value){v();continue}break}switch(d.code){case 2:W.block=b.sanitizeFileName(d.value),d=Y.next();break;case 10:W.center=A();break;case 41:W.scale=O();break;case 50:W.deg=d.value,d=Y.next();break;case 66:G=1===d.value,d=Y.next();break;default:H(W)}}var n={},I=s.blocks;if(I){var c=I[W.block];c&&c.entities&&c.entities.forEach(function(q){"ATTDEF"===q.type&&(n[q.tag]=1)})}var u=[W],t=[],f=W.center;return L.forEach(function(i){if(!n[i.attr])return u.push(i),void 0;t.push(i);var H=i.startPoint;H&&(H.x-=f.x,H.y=f.y-H.y),H=i.endPoint,H&&(H.x-=f.x,H.y=f.y-H.y)}),W.attribs=t,u},V=function(){var P;for(P={type:d.value},d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 2:P.block=b.sanitizeFileName(d.value),d=Y.next();break;case 10:P.center=A();break;case 41:P.scale=O();break;case 50:P.deg=d.value,d=Y.next();break;default:H(P)}return P},U=function(){var b,D;for(b={type:d.value},d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:b.center=A();break;case 11:b.major=A();break;case 40:b.ratio=d.value,d=Y.next();break;case 41:b.startAngle=d.value,d=Y.next();break;case 42:D=d.value,b.angleLength=D<b.startAngle?D+2*Math.PI-b.startAngle:D-b.startAngle,b.endAngle=D,d=Y.next();break;default:H(b)}return b},P=function(){var Z;for(Z={type:d.value},d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:Z.startPoint=A();break;case 11:Z.endPoint=A();break;case 40:Z.textHeight=d.value,d=Y.next();break;case 41:Z.xScale=d.value,d=Y.next();break;case 1:Z.text=d.value,d=Y.next();break;case 7:Z.font=d.value,d=Y.next();break;case 71:Z.generationFlags=d.value,d=Y.next();break;case 72:Z.halign=d.value,d=Y.next();break;case 73:Z.valign=d.value,d=Y.next();break;case 50:Z.rotation=2*d.value*Math.PI/360,d=Y.next();break;case 60:Z.hidden=1===d.value,d=Y.next();break;default:H(Z)}return Z},M=function(){var r;for(r={type:d.value},d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:r.startPoint=A();break;case 11:r.endPoint=A();break;case 40:r.textHeight=d.value,d=Y.next();break;case 41:r.xScale=d.value,d=Y.next();break;case 1:r.text=d.value,d=Y.next();break;case 7:r.font=d.value,d=Y.next();break;case 71:r.generationFlags=d.value,d=Y.next();break;case 72:r.halign=d.value,d=Y.next();break;case 74:r.valign=d.value,d=Y.next();break;case 50:r.rotation=2*d.value*Math.PI/360,d=Y.next();break;case 70:r.hidden=1===d.value,d=Y.next();break;case 2:r.attr=d.value,d=Y.next();break;default:H(r)}return r},t=function(){var r;for(r={type:d.value},d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 2:r.block=b.sanitizeFileName(d.value),d=Y.next();break;case 10:r.anchorPoint=A();break;case 11:r.middleOfText=A();break;case 71:r.attachmentPoint=d.value,d=Y.next();break;case 42:r.actualMeasurement=d.value,d=Y.next();break;case 1:r.text=d.value,d=Y.next();break;case 50:r.angle=d.value,d=Y.next();break;default:H(r)}return r},f=function(){var o;for(o={type:d.value},o.points=[],d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:o.points[0]=A();break;case 11:o.points[1]=A();break;case 12:o.points[2]=A();break;case 13:o.points[3]=A();break;default:H(o)}return o},W=function(){var I;for(I={type:d.value},d=Y.next();"EOF"!==d&&0!==d.code;)switch(d.code){case 10:I.position=A();break;case 39:I.thickness=d.value,d=Y.next();break;case 100:if("AcDbPoint"==d.value){d=Y.next();break}default:H(I)}return I},_=function(k){if(!k)throw new TypeError("entity cannot be undefined or null");k.handle||(k.handle=K++)};return T(),s};var f=m.CadViewer.DxfViewer=function(Q,R){var u=this;u._gv=Q,u.$17w={},u.$16w(R)};f.prototype={},f.prototype.constructor=f;var s={LINE:["LINE","POLYLINE","LWPOLYLINE"],CIRCLE:["CIRCLE","ARC"],ELLIPSE:["ELLIPSE"],TEXT:["TEXT","MTEXT"],SOLID:["SOLID"],POINT:["POINT"]};x.defineProperties(f.prototype,{gv:{get:function(){return this._gv}},dxf:{get:function(){return this._dxf}},forceUpdate:{get:function(){return this.$1ew},set:function(J){var x=this;x.$1ew=J,x.$18w&&(clearTimeout(x.$18w),x.$18w=e),J&&x.gv&&x.gv.redraw()}},viewport:{get:function(){var j=this;if(j._dxf){var E=j.options;return{x:E.x===e?j.$19w.x:E.x,y:E.y===e?j.$19w.y:E.y}}},set:function(s){var b=this;b.options.x=s.x||0,b.options.y=s.y||0,b.forceUpdate=!0}},zoom:{get:function(){var W=this;return W._gv?W._gv.getZoom():W.options.zoom},set:function(J){var x=this;x._gv?x._gv.setZoom(J):x.options.zoom=J}}}),f.prototype.$16w=function(A){var o=this,f=o.options={};A=A||{},f.zoom=A.zoom||1,A.zoom&&o._gv&&A.zoom!==o._gv.getZoom()&&o._gv.setZoom(f.zoom),f.baseCacheUpdateInterval=A.baseCacheUpdateInterval||0,f.extraCacheUpdateInterval=A.extraCacheUpdateInterval===e?500:A.extraCacheUpdateInterval,f.lineWidth=A.lineWidth||1,f.linesBatchSize=A.linesBatchSize||1e5,f.font=A.font||"Courier",f.pointCircleSize=A.pointCircleSize||5,f.pointCenterSize=A.pointCenterSize||2,f.textMinFontSize=A.textMinFontSize||3,f.textScaleRatio=A.textScaleRatio||1},f.prototype.draw=function(O){var d=this;d._dxf&&d.$5w()&&(d._now=Date.now(),d._resolution=m.Default.devicePixelRatio,d.$64w(),d.$6w(),d.$13w(O),d.$1ew=!1)},f.prototype.$64w=function(){var r=this,T=r.gv,t=T.getZoom(),c=T.tx(),w=T.ty(),O=r.$17w,R=r.options.extraCacheUpdateInterval;t!==O.zoom||c!==O.tx||w!==O.ty?(O.zoom=t,O.tx=c,O.ty=w,O.dirty=!0,O.dirtyTime=r._now,r.$18w&&clearTimeout(r.$18w),0===R?r.forceUpdate=!0:r.$18w=setTimeout(function(){r.forceUpdate=!0},r.options.extraCacheUpdateInterval)):O.dirty=!1},f.prototype.$13w=function(q){var f=this;f.options,f.$17w;var e;e=f.$1aw;var B=e.zoom;q.drawImage(f.$15w,-e.tx/B,-e.ty/B,e.width/B,e.height/B),f.$18w||(e=f.$1fw,q.drawImage(f.$1cw,-e.tx/B,-e.ty/B,e.width/B,e.height/B))},f.prototype.$12w=function(w){var D,X,n,L,y,A,m,V,K,S,c,O,u,E,H,T,h,v,C,G=this,t=G._models;for(w.lineWidth=G.options.lineWidth,O=G.options.linesBatchSize,D=s.LINE,L=0,y=D.length;y>L;L++){X=D[L],n=t[X];for(V in n){for(w.strokeStyle=V,K=n[V],w.beginPath(),c=0,A=0,m=K.length;m>A;A++)if(S=K[A],(c++>=O||S.width)&&(w.save(),w.setTransform(1,0,0,1,0,0),w.stroke(),w.restore(),w.beginPath(),c=0),u=S.vertices,u&&u.length){for(h=G.$3w(u[0].x,1),v=G.$3w(u[0].y,2),C=e,S.startWidth?C=(S.startWidth+(S.endWidth?S.endWidth:S.startWidth))/2:S.width&&(C=S.width),w.moveTo(h,v),H=1,T=u.length;T>H;H++)E=u[H],w.lineTo(G.$3w(E.x,1),G.$3w(E.y,2));S.shape&&w.lineTo(h,v),C&&(w.lineWidth=Math.max(1,G.$3w(S.width)),w.stroke(),w.beginPath(),w.lineWidth=1)}w.save(),w.setTransform(1,0,0,1,0,0),w.stroke(),w.restore()}}},f.prototype.$11w=function(h){var z,y,Z,e,J,D,F,B,d,o,q,j,p,E=this,O=E._models;for(h.lineWidth=E.options.lineWidth,j=E.options.linesBatchSize,z=s.SOLID,e=0,J=z.length;J>e;e++){y=z[e],Z=O[y];for(B in Z){for(h.fillStyle=B,d=Z[B],h.beginPath(),q=0,D=0,F=d.length;F>D;D++)o=d[D],q++>=j&&(h.fill(),h.beginPath(),q=0),p=o.points,h.moveTo(E.$3w(p[0].x,1),E.$3w(p[0].y,2)),h.lineTo(E.$3w(p[1].x,1),E.$3w(p[1].y,2)),h.lineTo(E.$3w(p[3].x,1),E.$3w(p[3].y,2)),h.lineTo(E.$3w(p[2].x,1),E.$3w(p[2].y,2)),h.lineTo(E.$3w(p[0].x,1),E.$3w(p[0].y,2));h.fill()}}},f.prototype.$10w=function(o){var f,D,J,k,Q,t,R,g,z,x,E,N,C,Z,p=this,U=p._models;for(o.lineWidth=p.options.lineWidth,f=s.POINT,C=p.$3w(p.options.pointCircleSize),Z=p.$3w(p.options.pointCenterSize),k=0,Q=f.length;Q>k;k++){D=f[k],J=U[D];for(g in J)for(o.strokeStyle=g,o.fillStyle=g,z=J[g],t=0,R=z.length;R>t;t++)x=z[t],E=p.$3w(x.position.x,1),N=p.$3w(x.position.y,2),o.fillRect(E,N,Z,Z),o.beginPath(),o.arc(E,N,C,0,2*Math.PI,!0),o.stroke()}},f.prototype.$9w=function($){var l,T,w,n,X,N,M,P,V,d,U,Y,u,t,k,c,v,e,S,D,Q=this,Z=Q._models;for($.lineWidth=Q.options.lineWidth,l=s.CIRCLE,n=0,X=l.length;X>n;n++){T=l[n],w=Z[T];for(P in w)for($.strokeStyle=P,V=w[P],N=0,M=V.length;M>N;N++)d=V[N],$.beginPath(),U=d.startAngle||0,Y=d.angleLength||2*Math.PI,u=U+Y,t=d.radius,k=d.addonAngle||0,c=Q.$3w(d.center.x,1),v=Q.$3w(d.center.y,2),D=d.xInvert^(d.extrusionDirection&&-1===d.extrusionDirection.z),S=d.yInvert,S||D?D&&S?(U=Math.PI+U,u=Math.PI+u,e=!1):(U=Math.PI*(D?1:2)-U,u=Math.PI*(D?1:2)-u,e=!0):e=!1,$.arc(c,v,Q.$3w(t),U+k,u+k,e),$.stroke()}},f.prototype.$8w=function(D){var p,R,A,X,a,O,B,i,W,Q,Z,f,L,C,r,P,n,c,j,T,_,U,x,V,G,q=this,w=q._models;for(p=s.TEXT,r=q.options.font,x=q.options.textScaleRatio,V=q.options.textMinFontSize,X=0,a=p.length;a>X;X++){R=p[X],A=w[R];for(i in A)for(D.fillStyle=i,W=A[i],O=0,B=W.length;B>O;O++)if(Q=W[O],Z=Q.text,"MTEXT"===R?(f=q.$3w(Q.height||12),L=q.$3w(Q.position.x,1),C=q.$3w(Q.position.y,2),j=Q.angle?Q.angle:Q.directionX?Math.atan2(Q.directionY,Q.directionX):0,j+=Q.addonAngle||0,U=1,c=Q.attachmentPoint||1,P=c%3,n=Math.floor(c/3)):(f=q.$3w(Q.textHeight||12),L=Q.startPoint.x,C=Q.startPoint.y,j=Q.rotation||0,U=Q.xScale||1,2===Q.generationFlags?j=2*Math.PI-j:4===Q.generationFlags?j=Math.PI-j:6===Q.generationFlags&&(j=Math.PI+j),L=q.$3w(L,1),C=q.$3w(C,2),P=1,n=2),!(V>f)){if(D.save(),D.translate(L,C),D.rotate(j),D.scale(U,-1),"MTEXT"===R&&(1===n?D.translate(0,f/2):0===n&&D.translate(0,f)),D.textAlign=0===P?"right":2===P?"center":"left",D.font=f*x+"px "+r,"MTEXT"===R)for(Z=Z.replace(/\\{/g,"#@#"),Z=Z.replace(/\\}/g,"#@@"),Z=Z.replace(/({|})/g,""),Z=Z.replace(/#@#/g,"{"),Z=Z.replace(/#@@/g,"}"),Z=Z.replace(/\\[ACT]\d+;/g,""),(G=Z.match(/\\f[^;]*;/))&&(Z=Z.replace(G[0],""),G=G[0].match(/\|p(\d+)/),G&&(D.font=G[0]/10*f*x+"px "+r)),T=Z.split("\\P"),_=0;_<T.length;_++)D.fillText(T[_],0,1.2*_*f);else D.fillText(Z,0,0);D.restore()}}},f.prototype.$7w=function(D){var G,u,j,d,K,q,c,C,I,R,v,E,r,T,N,F,$,i,w,P,H,V=this,X=V._models;for(G=s.ELLIPSE,d=0,K=G.length;K>d;d++){u=G[d],j=X[u];for(C in j)for(D.strokeStyle=C,I=j[C],q=0,c=I.length;c>q;q++)R=I[q],v=R.major,E=Math.atan2(v.y,v.x),r=Math.sqrt(v.x*v.x+v.y*v.y),T=R.startAngle||0,N=R.angleLength||2*Math.PI,F=T+N,$=V.$3w(R.center.x,1),i=V.$3w(R.center.y,2),w=R.xInvert,P=R.yInvert^(R.extrusionDirection&&-1===R.extrusionDirection.z),P||w?w&&P?(T=Math.PI+T,F=Math.PI+F,H=!1):(T=Math.PI*(w?1:2)-T,F=Math.PI*(w?1:2)-F,H=!0):H=!1,D.lineWidth=V.options.lineWidth,D.save(),D.translate($,i),D.scale(R.ratio,1),D.rotate(E),D.beginPath(),D.arc(0,0,V.$3w(r),T,F,H),D.strokeStyle=C,D.restore(),D.stroke()}},f.prototype.$6w=function(){var d,j,M,z,W,$,t,X,Z=this,S=Z.$17w,b=Z._resolution;if($=Z.viewport,t=-$.x,X=-$.y,Z._shiftX=Z.viewport.x,Z._shiftY=Z.viewport.y,Z._zoom=S.zoom,Z.forceUpdate||Z._now-(Z._baseCacheUpdateTime||0)>Z.options.baseCacheUpdateInterval){var A=Z.$1bw,x=Z.$15w;z=x.width,W=x.height,A.clearRect(0,0,z,W),Z.$1aw={tx:d=S.tx,ty:j=S.ty,zoom:M=S.zoom,width:z/b,height:W/b},A.save(),A.setTransform(b,0,0,-b,b*d,b*j),Z.$12w(A),Z._baseCacheUpdateTime=Z._now,A.restore()}if(Z.forceUpdate){var e=Z.$1dw,E=Z.$1cw;z=E.width,W=E.height,e.clearRect(0,0,z,W),Z.$1fw={tx:d=S.tx,ty:j=S.ty,zoom:M=S.zoom,width:z/b,height:W/b},e.save(),e.setTransform(b,0,0,-b,b*d,b*j),Z.$10w(e),Z.$9w(e),Z.$11w(e),Z.$7w(e),Z.$8w(e),e.restore()}},f.prototype.$5w=function(){var i=this,E=i._gv.getCanvas();if(!E)return!1;var m,S=i.$15w;return S?m=i.$1cw:(S=i.$15w=document.createElement("canvas"),i.$1bw=S.getContext("2d"),m=i.$1cw=document.createElement("canvas"),i.$1dw=m.getContext("2d")),(S.style.width!==E.style.width||S.style.height!==E.style.height||S.width!==E.width||S.height!==E.height)&&(S.style.width=m.style.width=E.style.width,S.style.height=m.style.height=E.style.height,S.width=m.width=E.width,S.height=m.height=E.height,i.$1ew=!0),!0},f.prototype.$4w=function(y,v,g,$){var S=this,C=S.$2w(v,g);if(C){var K,J,L,r=v.type;if("DIMENSION"!==r&&"INSERT"!==r){(K=y[r])||(K=y[r]={}),(J=K[C])||(J=K[C]=[]);var O=v.extrusionDirection&&-1===v.extrusionDirection.z&&["POINT","LINE","POLYLINE","LWPOLYLINE","ELLIPSE"].indexOf(r)<0;if($||O){$||($={a:1,b:0,c:0,d:1,tx:0,ty:0});var i={};for(var m in v)i[m]=v[m];i.radius&&(i.radius*=Math.sqrt($.a*$.a+$.b*$.b)),i.textHeight&&(i.textHeight*=Math.sqrt($.a*$.a+$.b*$.b));var E=O?-1:1,B=function(o,j){if(o){var R=o.x,J=o.y;return{x:R*E*j.a+J*j.c+j.tx,y:R*E*j.b+J*j.d+j.ty}}};if(i.position=B(i.position,$),i.startPoint=B(i.startPoint,$),i.center=B(i.center,$),"ELLIPSE"===r){var o;o=B({x:v.major.x+v.center.x,y:v.major.y+v.center.y},$),i.major={x:o.x-i.center.x,y:o.y-i.center.y},v.extrusionDirection&&-1===v.extrusionDirection.z&&(i.major.x*=-1)}var u;i.vertices&&(u=[],i.vertices.forEach(function(P){u.push(B(P,$))}),i.vertices=u),i.points&&(u=[],i.points.forEach(function(s){u.push(B(s,$))}),i.points=u);var h=Math.atan2($.b,$.a),G=Math.cos(h);i.yInvert=$.d*G<0,i.xInvert=$.a*G<0,0!==h&&(i.addonAngle=h),J.push(i)}else J.push(v)}else{if(!v.block)return;var s=g.blocks[v.block];if(!s||!s.entities)return;var q=$;if("INSERT"===r){var H=v.scale?v.scale.x:1,N=v.scale?v.scale.y:1,M=0,Z=1,D=0;if(v.deg&&(M=v.deg*Math.PI/180,Z=Math.cos(M),D=Math.sin(M)),$){var W=H*Z,P=H*D,X=-N*D,R=N*Z,f=v.center.x,n=v.center.y;q={a:$.a*W+$.c*P,b:$.b*W+$.d*P,c:$.a*X+$.c*R,d:$.b*X+$.d*R,tx:$.a*f+$.c*n+$.tx,ty:$.b*f+$.d*n+$.ty}}else q={a:H*Z,b:H*D,c:-N*D,d:N*Z,tx:v.center.x,ty:v.center.y}}for(L=0;L<s.entities.length;L++)S.$4w(y,s.entities[L],g,q)}}},f.prototype.parseFile=function(C){var P=this,n=new M,U=n.parseSync(C);P._dxf=U,P.$19w=P.$1w(U),P._isAc2015="AC1015"===U.header.$ACADVER,P._isAc1027="AC1027"===U.header.$ACADVER;var u=P.gv?P.gv.getWidth():1e3,V=P.gv?P.gv.getZoom():1;P._dxfSelfZoom=u/P.$19w.width/V,P.$19w.x-=P.$19w.width/2,P.$19w.y+=P.$19w.height/2;var I,_,B,o=P._models={};for(I=0,_=U.entities.length;_>I;I++)B=U.entities[I],P.$4w(o,B,U);console.log("parse finished"),P.forceUpdate=!0},f.prototype.$3w=function(g,Q){var B=1===Q?this._shiftX:2===Q?this._shiftY:0,d=this._zoom*this._dxfSelfZoom;return(g-B)*d},f.prototype.$2w=function(r,S){var K;if(S.tables&&S.tables.layer&&(K=S.tables.layer.layers[r.layer]),!K||K.visible){var M;return r.color!==e?(M=r.color,0===M&&(M=16777215)):K&&(M=K.color),M||(M=16777215),"#"+((1<<24)+M).toString(16).slice(1)}},f.prototype.$1w=function($){var U,c,V,j,t,L,Q,x,a,z,E,f,W=0;if(!U&&$.tables&&$.tables.viewPort){z=$.tables.viewPort.viewPorts;for(a in z)if(E=z[a],f=E.viewDirectionFromTarget,E.center&&(E.renderMode===W||f&&0===f.x&&0===f.y&&1===f.z)){V=E.center,j=E.upperRightCorner,t=E.lowerLeftCorner,U={x:j.x,y:j.y},c={x:t.x,y:t.y},L=E.viewWidth||0,Q=E.viewHeight||0,E.viewTarget&&(V={x:V.x+E.viewTarget.x,y:V.y+E.viewTarget.y});break}}return!U&&$.header&&(x=$.header,x.$EXTMIN&&x.$EXTMAX&&(U=x.$EXTMAX,c=x.$EXTMIN)),L=Math.max(L,U.x-c.x),Q=Math.max(Q,U.y-c.y),V=V||{x:L/2+c.x,y:Q/2+c.y},{width:L,height:Q,x:V.x,y:V.y}
};var F=m.CadViewer.VirtualCanvas=function(w){this.view=w};F.prototype={},F.prototype.constructor=F,F.prototype.getCanvas=function(){return this.view.getCanvas()},F.prototype.redraw=function(){var j=this.view;j.redraw(),j.validateImpl()},F.prototype.getView=function(){return this.view};var R=m.CadViewer.Context2dProxy=function(y,h){var H=this;H.ctx=y,H.writer=h,H._currentContext={a:1,b:0,c:0,d:1,tx:0,ty:0},H.$3fw(),H._contextStack=[],H._textScale=.8,H._forceSplitEllipse=!0,H._ellipseSegments=32,H._styleToColorCache={};for(var X in CanvasRenderingContext2D.prototype)if("webkitImageSmoothingEnabled"!==X){var Y=y[X];if("function"==typeof Y)H[X]=function(n,f){return function(){var p=f.apply(y,arguments);return H.$20w(n,arguments),p}}(X,Y);else{var n=x.getOwnPropertyDescriptor(CanvasRenderingContext2D.prototype,X);if(!n.get&&!n.set)continue;!function(A){x.defineProperty(H,A,{get:function(){return y[A]},set:function(w){y[A]=w,H.$21w(A,w)}})}(X)}}};R.prototype={},R.prototype.constructor=R,R.prototype.$20w=function(C,E){var H=this;switch(C){case"save":H.$22w();break;case"restore":H.$23w();break;case"translate":H.$24w.apply(H,E);break;case"rotate":H.$26w.apply(H,E);break;case"scale":H.$25w.apply(H,E);break;case"setTransform":H.$27w.apply(H,E);break;case"transform":H.$28w.apply(H,E);break;case"fillText":case"strokeText":H.$30w(E[0],E[1],E[2],"fillText"===C);break;case"rect":H.$31w.apply(H,E);break;case"fill":H.$32w();break;case"stroke":H.$3ew();break;case"moveTo":H.$34w(E[0],E[1]);break;case"lineTo":H.$35w(E[0],E[1]);break;case"beginPath":H.$39w();break;case"closePath":H.$3aw();break;case"arc":H.$36w.apply(H,E);break;case"ellipse":H.$37w.apply(H,E);break;case"quadraticCurveTo":H.$38w([{x:E[0],y:E[1]}],E[2],E[3]);break;case"bezierCurveTo":H.$38w([{x:E[0],y:E[1]},{x:E[2],y:E[3]}],E[4],E[5])}},R.prototype.$21w=function(){},R.prototype.$22w=function(){var l=this,r={},H=l._currentContext;for(var $ in H)r[$]=H[$];l._contextStack.push(r)},R.prototype.$23w=function(){var z=this;z._currentContext=z._contextStack.pop(),z.$29w()},R.prototype.$24w=function(j,e){if(0!==j||0!==e){var T=this,z=T._currentContext,w=z.a,h=z.b,n=z.c,I=z.d;z.tx=w*j+n*e+z.tx,z.ty=h*j+I*e+z.ty,T.$29w()}},R.prototype.$25w=function(W,v){if(1!==W||1!==v){var u=this,p=u._currentContext;p.a*=W,p.b*=W,p.c*=v,p.d*=v,u.$29w()}},R.prototype.$26w=function(Z){var B=Math.cos(Z),S=Math.sin(Z),u=this,J=u._currentContext,j=J.a,E=J.b,x=J.c,s=J.d;J.a=j*B+x*S,J.b=E*B+s*S,J.c=-j*S+x*B,J.d=-E*S+s*B,u.$29w()},R.prototype.$27w=function(f,A,W,C,y,e){var T=this,B=T._currentContext;B.a=f,B.b=A,B.c=W,B.d=C,B.tx=y,B.ty=e,T.$29w()},R.prototype.$28w=function(P,z,T,Q,l,U){var B=this,o=B._currentContext,M=o.a,e=o.b,H=o.c,d=o.d;o.a=M*P+H*z,o.b=e*P+d*z,o.c=M*T+H*Q,o.d=e*T+d*Q,o.tx=M*l+H*U+o.tx,o.ty=e*l+d*U+o.ty,B.$29w()},R.prototype.$29w=function(){var k=this;k.writer.$40w(k._currentContext)},R.prototype.$2aw=function(){var $=this._currentContext;return 0===$.b&&0===$.c?0:Math.atan2($.b,$.a)},R.prototype.$2bw=function(){var g=this._currentContext;return{x:Math.sqrt(g.a*g.a+g.c*g.c),y:Math.sqrt(g.b*g.b+g.d*g.d)}},R.prototype.$2cw=function(H){var b=this._currentContext,q=H.x,S=H.y;return{x:b.a*q+b.c*S+b.tx,y:b.b*q+b.d*S+b.ty}},R.prototype.$2dw=function(L){for(var v=this,d=new Array(L.length),i=0,U=L.length;U>i;i++)d[i]=v.$2cw(L[i]);return d},R.prototype.$2ew=function(e){var k=this._currentContext;return e*Math.sqrt(k.a*k.a+k.b*k.b)},R.prototype._equal=function(P,h){var e=P-h;return e>-1e-5&&1e-5>e},R.cadColorConst=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215],R.prototype.$2fw=function(r){var n=this,o=n._styleToColorCache[r];if(o!==e)return o;for(var $,i,y,s="string"==typeof r?parseInt("0x"+r.slice(1)):7,Q=R.cadColorConst,g=1e4,E=0,t=Q.length;t>E;E++)$=Q[E],i=Math.abs(($>>16)-(s>>16))+Math.abs((255&$>>8)-(255&s>>8))+Math.abs((255&$)-(255&s)),g>i&&(g=i,y=E);return n._styleToColorCache[r]=y,y},R.prototype.$30w=function(N,U,V,Z){var c,S,D=this,p=D.ctx,G=p.font,d=Z?p.fillStyle:p.strokeStyle,C=p.textAlign,x=p.textBaseline;S=p.measureText("e").width,U+=S/2,"left"!==C&&(c=p.measureText(N).width,"center"===C?U-=c/2:"right"===C&&(U-=c)),"middle"===x&&(V+=S/2);var n,h=8;"string"==typeof G&&(n=G.match(/^\d+/),n&&(h=n[0]));var R=D.$2aw(),f=D.$2fw(d);N=(""+N).split("\n").join(","),D.writer.$49w(N,D.$2cw({x:U,y:V}),D.$2ew(D._textScale*h),R,f)},R.prototype.$31w=function(Z,_,e,v){var x=this,G=x.$2dw([{x:Z,y:_},{x:Z+e,y:_},{x:Z+e,y:_+v},{x:Z,y:_+v}]);x.$3bw(G[0]),x._path.push({type:"rect",points:G})},R.prototype.$32w=function(){var S,I=this,N=I._path;if(N.length){var i=N.length;"closePath"!==N[N.length-1].subType&&I.$3aw();var A,f,Y,O=I.$2fw(I.ctx.fillStyle),d=!0;for(Y=0;i>Y;Y++){if(A=N[Y].type,"moveTo"!==A&&"rect"!==A){d=!1;break}if("rect"===A){if(f){d=!1;break}f=Y}}d?(S=N[f],I.writer.$4aw(S.points,O)):(I._filling=!0,I._hatchContext={startId:I.writer.entities.length,color:O},I.$3ew(),I.$33w(),I._filling=e)}},R.prototype.$33w=function(){var H=this,z=H._hatchContext;if(z){var R=z.startId,h=H.writer.entities,Q=h.length,x=Q-R;if(x){var Y;for(Y=R;Q>Y;Y++)h[Y].invisible=!0;H.writer.$45w(x,z.color),z.startId=h.length}}},R.prototype.$34w=function(Q,U){var T=this,N=T.$2cw({x:Q,y:U});T._headPoint=N,T._path.push({type:"moveTo",x:N.x,y:N.y})},R.prototype.$35w=function(Y,R){var E=this,y=E.$2cw({x:Y,y:R});E._path.push({type:"lineTo",x:y.x,y:y.y})},R.prototype.$36w=function(k,u,P,m,U,D){this.$37w(k,u,P,P,0,m,U,D)},R.prototype.$37w=function(s,g,T,R,l,M,B,u){var K,C,O,f,A,t,m,h,v,d,o,_,N,E,L,S=this,k=S.$2bw(),e=S.$2cw({x:s,y:g});t=Math.sin(l),m=Math.cos(l);var I=function(A){var q=T*Math.cos(-A),B=R*Math.sin(-A);return S.$2cw({x:s+(m*q-t*B),y:g+(t*q+m*B)})},W=[],$=B;if(u)for(;$>=M;)$-=2*Math.PI;else for(;M>=$;)$+=2*Math.PI;for(d=($-M)/S._ellipseSegments,_=0;_<=S._ellipseSegments;_++)o=M+d*_,N=I(-o),W.push(N);if(f=W[0],A=W[W.length-1],K=S.$3cw(M,B,u),M=K.start,B=K.end,S.$3bw(f),h=S._equal(k.x,k.y),v=S._equal(T,R),!S._forceSplitEllipse&&h&&v&&S._equal(Math.abs(M-B),2*Math.PI))S._path.push({type:"circle",x:e.x,y:e.y,end:A,keyPoints:W,radius:T*k.x});else if(!S._forceSplitEllipse&&h&&v)C=S.$2aw(),O=Math.cos(C),E=S._currentContext.a*O<0,L=S._currentContext.d*O<0,K=S.$3dw(M,B,E,L),M=K.start-C,B=K.end-C,S._path.push({type:"arc",x:e.x,y:e.y,end:A,radius:T*k.x,startAngle:M,endAngle:B,keyPoints:W});else{if(S._forceSplitEllipse||!h){for(_=1;_<=S._ellipseSegments;_++)N=W[_],S._path.push({type:"lineTo",x:N.x,y:N.y});return}var r,j,n=I(0),H=I(Math.PI/2),J=function(X,E){var V=X.x-E.x,Q=X.y-E.y;return Math.sqrt(V*V+Q*Q)},y=J(n,e),U=J(H,e);U>y?(j=y,y=U,U=j,r=H):r=n,C=S.$2aw(),O=Math.cos(C),E=S._currentContext.a*O<0,L=S._currentContext.d*O<0,K=S.$3dw(M-Math.PI/2,B-Math.PI/2,E,L),M=K.start,B=K.end,S._path.push({type:"ellipse",x:e.x,y:e.y,end:A,major:{x:r.x-e.x,y:r.y-e.y},ratio:U/y,startAngle:M,endAngle:B,keyPoints:W})}},R.prototype.$38w=function(e,j,w){var H=this,N=H.$2cw({x:j,y:w});this._path.push({type:"bezier",x:N.x,y:N.y,ctrl:H.$2dw(e)})},R.prototype.$39w=function(){this.$3fw()},R.prototype.$3aw=function(){var x=this,g=x._headPoint;g&&(x._path.push({type:"lineTo",x:g.x,y:g.y,subType:"closePath"}),x._headPoint=null,x._lastPoint=null)},R.prototype.$3bw=function(q){var D=this;return D._headPoint?(D._path.push({type:"lineTo",x:q.x,y:q.y,subType:"connect"}),void 0):(D._headPoint=q,D._path.push({type:"moveTo",x:q.x,y:q.y}),void 0)},R.prototype.$3cw=function(B,C,l){B=-B,C=-C;var p,Q=B%(2*Math.PI),g=C%(2*Math.PI);for(0>Q&&(Q+=2*Math.PI),0>g&&(g+=2*Math.PI),l||(p=Q,Q=g,g=p);Q>=g;)g+=2*Math.PI;return{start:Q,end:g}},R.prototype.$3dw=function(m,K,R,C){var k;return(C||R)&&(R&&C?(m=Math.PI+m,K=Math.PI+K):(k=Math.PI*(R?1:2)-K,K=Math.PI*(R?1:2)-m,m=k)),{start:m,end:K}},R.prototype.$3ew=function(){var D=this,i=D._path;if(i.length){var Z,Y,J,C,c,g,E=[],r=D.$2fw(D.ctx.strokeStyle),y=function(){E.length>1&&D.writer.$48w(E,r),E=[]};for(Y=0,Z=i.length;Z>Y;Y++){if(J=i[Y],D._filling&&["circle","arc","ellipse"].indexOf(J.type)>=0){if(g=J.keyPoints,!D._lastPoint)break;E.length||E.push(D._lastPoint),E=E.concat(g),D._lastPoint=J.end;break}switch(J.type){case"moveTo":y(),D._filling&&D.$33w(),D._lastPoint={x:J.x,y:J.y},E.push(D._lastPoint);break;case"lineTo":if(!D._lastPoint)break;E.length||E.push(D._lastPoint),E.push({x:J.x,y:J.y}),D._lastPoint={x:J.x,y:J.y};break;case"rect":y(),c=[].concat(J.points,J.points[0]),D.writer.$48w(c,r),D._lastPoint=J.points[0];break;case"circle":y(),D.writer.$43w(J.x,J.y,J.radius,r),D._lastPoint=J.end;break;case"arc":y(),D.writer.$44w(J.x,J.y,J.radius,J.startAngle,J.endAngle,r),D._lastPoint=J.end;break;case"ellipse":y(),D.writer.$46w(J.x,J.y,J.major,J.ratio,J.startAngle,J.endAngle,r),D._lastPoint=J.end;break;case"bezier":if(y(),C=D._lastPoint,!C)break;D.writer.$47w(C.x,C.y,J.x,J.y,J.ctrl,r),D._lastPoint={x:J.x,y:J.y};break;default:E.push({x:J.x,y:J.y})}}y()}},R.prototype.$3fw=function(){var L=this;L._path=[],L._lastPoint=null,L._headPoint=null};var H=m.CadViewer.DxfWriter=function(N){var $=this;$.version=N||"AC1027",$._lineContents=[],$._entityList=[]};H.prototype={},H.prototype.constructor=H,H.version="0.9.2",x.defineProperties(H.prototype,{entities:{get:function(){return this._entityList}}}),H.prototype.snapshotView=function(Y,U){this.snapshotVCanvas(new F(Y,U))},H.prototype.snapshotVCanvas=function(_,j){var m=this;m._lineContents=[],m._viewport={left:1/0,up:-1/0,right:-1/0,down:1/0},m._matrix={a:1,b:0,c:0,d:-1*j?-1:1,tx:0,ty:0};var y=_.getCanvas(),J=_.getView()._42,M=y.getContext;y.getContext=function(r){return function(w){var i=r.apply(this,arguments);return"2d"===w&&(i=m.$41w(i)),i}}(y.getContext),_.getView()._42=function(L){return J.call(_.getView(),L)},_.redraw(),_.getView()._42=J,y.getContext=M},H.prototype.$40w=function(){},H.prototype.$41w=function(C){return new R(C,this)},H.prototype.write=function(){var j=this;return j.$4cw(),j.$56w(),j.$57w(),j.$59w(),j.$58w(),j.$67w(),j._lineContents.join("\n")},H.prototype.$42w=function(h,y,e,V){var b=this;b.$4bw("LINE",{p1:h=b.$2cw(h),p2:y=b.$2cw(y),color:e||7,layer:V||0}),b.$64w([h,y])},H.prototype.$43w=function(c,Y,R,G){var u=this,w=u.$2ew(R),X=u.$2cw({x:c,y:Y});u.$4bw("CIRCLE",{center:X,radius:w,color:G}),u.$64w([{x:X.x-w,y:X.y-w},{x:X.x+w,y:X.y+w}])},H.prototype.$44w=function(d,o,a,h,w,k){var P=this,a=P.$2ew(a),N=P.$2cw({x:d,y:o});P.$4bw("ARC",{center:N,radius:a,color:k,startAngle:h,endAngle:w}),P.$64w([{x:N.x-a,y:N.y-a},{x:N.x+a,y:N.y+a}])},H.prototype.$45w=function(M,g){this.$4bw("HATCH",{color:g||7,edgeNum:M})},H.prototype.$46w=function(m,T,F,P,n,g,d){var i=this,v=i.$2cw({x:m,y:T}),F=i.$2cw(F);i.$4bw("ELLIPSE",{center:v,majorAxis:F,axisRatio:P,color:d,startAngle:n,endAngle:g}),i.$64w([{x:v.x-F.x,y:v.y-F.y},{x:v.x+F.x,y:v.y+F.y}])},H.prototype.$47w=function(I,U,l,L,F,q){var Z=this,X=Z.$2cw({x:I,y:U}),d=Z.$2cw({x:l,y:L}),f=Z.$2dw(F);Z.$4bw("SPLINE",{source:X,dest:d,ctrl:f,color:q||7}),Z.$64w([X,d]),Z.$64w(F)},H.prototype.$48w=function(H,Y,B){var s=this;s.$4bw("LWPOLYLINE",{points:H=s.$2dw(H),color:Y||7,layer:B||0}),s.$64w(H)},H.prototype.$49w=function(J,Y,m,G,M){var v=this;v.$4bw("TEXT",{text:J,pos:Y=v.$2cw(Y),size:v.$2ew(m),degree:v.$8bw(G||0),color:M||7}),v.$64w([Y])},H.prototype.$4aw=function(w,L){var c=this,k=[w[0],w[1],w[3],w[2]];c.$4bw("SOLID",{points:k=c.$2dw(k),color:L||7}),c.$64w(k)},H.prototype.$4bw=function(i,f){f.type=i,this._entityList.push(f)},H.prototype.$4cw=function(){var L=this;L.$76w("HT Dxf Writer. Version: "+H.version),L.$72w(),L.$7aw(9,"$ACADVER"),L.$7aw(1,L.version),L.$7aw(9,"$INSBASE"),L.$79w(10,0),L.$79w(20,0),L.$79w(30,0),L.$7aw(9,"$EXTMIN"),L.$79w(10,0),L.$79w(20,0),L.$79w(30,0),L.$7aw(9,"$EXTMAX"),L.$79w(10,1e3),L.$79w(20,1e3),L.$79w(30,0),L.$7aw(9,"$HANDSEED"),L._dxfHandleValue=672,L.$6dw(),L.$74w()},H.prototype.$4dw=function(){var t=this,r=t._viewport;t.$75w("VPORT",8,1),t.$7aw(0,"VPORT"),t.$77w(5,94),t.$77w(330,8),t.$7aw(100,"AcDbSymbolTableRecord"),t.$7aw(100,"AcDbViewportTableRecord"),t.$7aw(2,"*Active"),t.$77w(70,0),t.$79w(10,0),t.$79w(20,0),t.$79w(11,1),t.$79w(21,1),t.$79w(12,(r.left+r.right)/2),t.$79w(22,(r.down+r.up)/2),t.$79w(13,0),t.$79w(23,0),t.$79w(14,1),t.$79w(24,1),t.$79w(15,0),t.$79w(25,0),t.$79w(16,0),t.$79w(26,0),t.$79w(36,1),t.$79w(17,0),t.$79w(27,0),t.$79w(37,0),t.$79w(40,r.up-r.down),t.$79w(41,(r.up-r.down)/(r.right-r.left)),t.$79w(42,50),t.$79w(43,0),t.$79w(44,0),t.$79w(50,0),t.$79w(51,0),t.$77w(71,0),t.$77w(72,1e3),t.$77w(73,1),t.$77w(74,3),t.$77w(75,0),t.$77w(76,0),t.$77w(77,0),t.$77w(78,0),t.$71w()},H.prototype.$4ew=function(){var K=this;K.$75w("LTYPE",5,1),K.$73w(14,"ByBlock"),K.$73w(15,"ByLayer"),K.$73w(16,"Continuous","Solid line"),K.$71w()},H.prototype.$4fw=function(){var O=this;O.$75w("LAYER",2,1),O.$7aw(0,"LAYER"),O.$77w(5,10),O.$77w(330,2),O.$7aw(100,"AcDbSymbolTableRecord"),O.$7aw(100,"AcDbLayerTableRecord"),O.$77w(2,0),O.$77w(70,0),O.$77w(62,7),O.$7aw(6,"Continuous"),O.$7aw(390,"F"),O.$71w()},H.prototype.$50w=function(){var p=this;p.$75w("STYLE",3,2),p.$69w("Standard","11"),p.$69w("Annotative","DC"),p.$71w()},H.prototype.$51w=function(){var L=this;L.$75w("UCS",7,0),L.$71w()},H.prototype.$52w=function(){var f=this;f.$75w("VIEW",6,1),f.$71w()},H.prototype.$53w=function(){var n=this;n.$75w("APPID",9,7),n.$6aw("ACAD","12"),n.$6aw("AcadAnnoPO","DD"),n.$6aw("AcadAnnotative","DE"),n.$6aw("ACAD_DSTYLE_DIMJAG","DF"),n.$6aw("ACAD_DSTYLE_DIMTALN","E0"),n.$6aw("ACAD_MLEADERVER","107"),n.$6aw("ACAD_NAV_VCDISPLAY","1A6"),n.$71w()},H.prototype.$54w=function(){var n=this;n.$75w("DIMSTYLE","A",2),n.$7aw(100,"AcDbDimStyleTable"),n.$77w(71,2),n.$7aw(340,"27"),n.$7aw(340,"E1"),n.$71w()},H.prototype.$55w=function(){var a=this;a.$75w("BLOCK_RECORD",1,1),a.$6bw("*Model_Space","1F","22"),a.$6bw("*Paper_Space","58","59"),a.$6bw("*Paper_Space0","5D","5E"),a.$71w()},H.prototype.$56w=function(){var d=this;d.$70w(),d.$4dw(),d.$4ew(),d.$4fw(),d.$50w(),d.$52w(),d.$51w(),d.$53w(),d.$54w(),d.$55w(),d.$74w()},H.prototype.$57w=function(){var c=this;c.$68w("BLOCKS"),c.$6cw("*Model_Space",32,31),c.$6cw("*Paper_Space",90,88,!0),c.$6cw("*Paper_Space0",95,93,!0),c.$74w()},H.prototype.$58w=function(){var U=this;U.$68w("OBJECTS"),U.$6ew("C","0",0,1),U.$6fw(350,{ACAD_CIP_PREVIOUS_PRODUCT_INFO:"1A5",ACAD_COLOR:"73",ACAD_DETAILVIEWSTYLE:"1AB",ACAD_GROUP:"D",ACAD_LAYOUT:"1A",ACAD_MATERIAL:"72",ACAD_MLEADERSTYLE:"D7",ACAD_MLINESTYLE:"17",ACAD_PLOTSETTINGS:"19",ACAD_PLOTSTYLENAME:"E",ACAD_SCALELIST:"B6",ACAD_SECTIONVIEWSTYLE:"1A8",ACAD_TABLESTYLE:"86",ACAD_VISUALSTYLE:"99",ACDB_RECOMPOSE_DATA:"2A6",AcDbVariableDictionary:"66"}),U.$6ew("18E","2",1,1),U.$6fw(360,{ACAD_LAYERSTATES:"18F"}),U.$6ew("15D","1F",1,1),U.$6ew("D","C",0,1),U.$6ew("1A","C",0,1),U.$6fw(350,{Layout1:"59",Layout2:"5E",Model:"22"}),U.$6ew("D7","C",0,1),U.$6fw(350,{Annotative:"E5",Standard:"D8"}),U.$6ew("17","C",0,1),U.$6fw(350,{Standard:18}),U.$6ew("19","C",0,1),U.$74w()},H.prototype.$59w=function(){var S=this;S.$68w("ENTITIES"),S._dxfHandleValue=720;var i,T,q,N=S._entityList;for(i in N)if(q=N[i],q.id=i,!q.invisible)switch(T=q.type,S.$7aw(0,T),S.$6dw(),S.$78w(330,31),S.$7aw(100,"AcDbEntity"),S.$77w(62,q.color||7),S.$77w(8,q.layer||0),T){case"LINE":S.$5aw(q);break;case"TEXT":S.$65w(q);break;case"SOLID":S.$66w(q);break;case"LWPOLYLINE":S.$63w(q);break;case"CIRCLE":S.$5bw(q);break;case"ARC":S.$5cw(q);break;case"ELLIPSE":S.$5dw(q);break;case"SPLINE":S.$5ew(q);break;case"HATCH":S.$5fw(q)}S.$74w()},H.prototype.$5aw=function(u){var S=this,Y=u.p1,z=u.p2;S.$7aw(100,"AcDbLine"),S.$7cw(10,Y),S.$7cw(11,z)},H.prototype.$5bw=function($){var J=this;J.$7aw(100,"AcDbCircle"),J.$7cw(10,$.center),J.$79w(40,$.radius)},H.prototype.$5cw=function(t){var d=this;d.$7aw(100,"AcDbCircle"),d.$7cw(10,t.center),d.$79w(40,t.radius),d.$7aw(100,"AcDbArc"),d.$79w(50,d.$8bw(t.startAngle)),d.$79w(51,d.$8bw(t.endAngle))},H.prototype.$5dw=function(M){var h=this;h.$7aw(100,"AcDbEllipse"),h.$7cw(10,M.center),h.$7cw(11,M.majorAxis),h.$79w(40,M.axisRatio),h.$79w(41,M.startAngle),h.$79w(42,M.endAngle)},H.prototype.$5ew=function(d){var h=this,Q=[d.source];Q=Q.concat(d.ctrl,[d.dest]);var O,j=Q.length;for(h.$7aw(6,"Continuous"),h.$7aw(100,"AcDbSpline"),h.$77w(70,8),h.$77w(71,j-1),h.$77w(72,2*j),h.$77w(73,j),h.$77w(74,0),h.$7aw(42,"0.000000001"),h.$7aw(43,"0.0000000001"),O=0;j>O;O++)h.$7aw(40,"0.0");for(O=0;j>O;O++)h.$7aw(40,"1.0");for(O=0;j>O;O++){var E=Q[O];h.$79w(10,E.x),h.$79w(20,E.y),h.$79w(30,0)}},H.prototype.$5fw=function(N){var U=this;U.$7aw(6,"Continuous"),U.$7aw(100,"AcDbHatch"),U.$7cw(10,{x:0,y:0,z:0}),U.$7cw(210,{x:0,y:0,z:1}),U.$7aw(2,"SOLID"),U.$77w(70,1),U.$77w(71,0),U.$60w(N),U.$62w(N)},H.prototype.$60w=function($){var M=this;M.$77w(91,1);var S,x,u,n,m=M._entityList;for(u=0,x=5,S=$.id-$.edgeNum;S<$.id;S++)switch(n=m[S],n.type){case"ARC":case"CIRCLE":case"ELLIPSE":case"LINE":case"SPLINE":u+=1;break;case"LWPOLYLINE":u+=n.points.length-1}for(M.$77w(92,x),2!==(2&$.pathTypeFlag)&&M.$77w(93,u),S=$.id-$.edgeNum;S<$.id;S++)M.$61w(m[S]);M.$77w(97,0)},H.prototype.$61w=function(r){var X,c,H,z=this;switch(r.type){case"LWPOLYLINE":for(c=r.points.length,X=0;c-1>X;X++)z.$77w(72,1),z.$7cw(10,r.points[X]),z.$7cw(11,r.points[X+1]);break;case"ARC":z.$77w(72,2),z.$7cw(10,r.center),z.$79w(40,r.radius),z.$79w(50,z.$8bw(r.startAngle)),z.$79w(51,z.$8bw(r.endAngle));break;case"CIRCLE":z.$77w(72,2),z.$7cw(10,r.center),z.$7cw(40,r.radius),z.$79w(50,0),z.$79w(51,360);break;case"ELLIPSE":z.$77w(72,3),z.$7cw(10,r.center),z.$7cw(11,r.majorAxis),z.$79w(40,r.axisRatio),z.$79w(50,r.startAngle),z.$79w(51,r.endAngle);break;case"SPLINE":for(z.$77w(72,4),H=[r.source],H=H.concat(r.ctrl,[r.dest]),c=H.length,z.$77w(94,c-1),z.$77w(73,0),z.$77w(74,0),z.$77w(95,2*c),z.$77w(96,c),X=0;c>X;X++)z.$7aw(40,"0.0");for(X=0;c>X;X++)z.$7aw(40,"1.0");for(X=0;c>X;X++){var O=H[X];z.$79w(10,O.x),z.$79w(20,O.y)}z.$77w(97,0)}},H.prototype.$62w=function(){var H=this;H.$77w(75,1),H.$77w(76,1),H.$79w(47,0),H.$77w(98,1),H.$79w(10,0),H.$79w(20,0),H.$77w(450,0),H.$77w(451,0),H.$79w(460,0),H.$79w(461,0),H.$77w(452,0),H.$79w(462,1),H.$77w(453,0),H.$7aw(470,"LINEAR")},H.prototype.$63w=function(g){var N,q=this,P=g.points.length;for(q.$7aw(6,"Continuous"),q.$7aw(100,"AcDbPolyline"),q.$77w(90,P),q.$77w(70,0),q.$79w(43,0),N=0;P>N;N++)q.$7cw(10,g.points[N])},H.prototype.$64w=function(z){var d,K,h,t=this,w=t._viewport;for(K=0,h=z.length;h>K;K++)d=z[K],d.x<w.left&&(w.left=d.x),d.x>w.right&&(w.right=d.x),d.y<w.down&&(w.down=d.y),d.y>w.up&&(w.up=d.y)},H.prototype.$65w=function(K){var o=this,y=K.text,n=K.pos,X=K.size,C=K.degree;K.color,o.$7aw(100,"AcDbText"),o.$7cw(10,n),o.$79w(40,X),o.$7aw(1,y),o.$79w(50,360-C),o.$7aw(100,"AcDbText")},H.prototype.$66w=function(o){var U=this;U.$7aw(100,"AcDbTrace"),U.$7cw(10,o.points[0]),U.$7cw(11,o.points[1]),U.$7cw(12,o.points[2]),U.$7cw(13,o.points[3])},H.prototype.$67w=function(){this.$7aw(0,"EOF")},H.prototype.$68w=function(r){var E=this;E.$7aw(0,"SECTION"),E.$7aw(2,r)},H.prototype.$69w=function(Y,u){var v=this;v.$7aw(0,"STYLE"),v.$7aw(5,u),v.$7aw(330,3),v.$7aw(100,"AcDbSymbolTableRecord"),v.$7aw(100,"AcDbTextStyleTableRecord"),v.$7aw(2,Y),v.$77w(70,0),v.$79w(40,0),v.$79w(41,1),v.$79w(50,0),v.$77w(71,0),v.$79w(42,.2),v.$7aw(3,"Arial.ttf"),v.$7aw(4,""),v.$7aw(1001,"ACAD"),v.$7aw(1e3,"Arial"),v.$77w(1071,34)},H.prototype.$6aw=function(E,g){var y=this;y.$7aw(0,"APPID"),y.$7aw(5,g),y.$77w(330,9),y.$7aw(100,"AcDbSymbolTableRecord"),y.$7aw(100,"AcDbRegAppTableRecord"),y.$7aw(2,E),y.$77w(70,0)},H.prototype.$6bw=function(W,f,c){var H=this;H.$7aw(0,"BLOCK_RECORD"),H.$7aw(5,f),H.$77w(330,1),H.$7aw(100,"AcDbSymbolTableRecord"),H.$7aw(100,"AcDbBlockTableRecord"),H.$7aw(2,W),H.$7aw(340,c),H.$77w(70,0),H.$77w(280,1),H.$77w(281,0)},H.prototype.$6cw=function(E,w,V,T){var O=this;O.$7aw(0,"BLOCK"),O.$78w(5,w),O.$78w(330,V),O.$7aw(100,"AcDbEntity"),T&&O.$77w(67,1),O.$77w(8,0),O.$7aw(100,"AcDbBlockBegin"),O.$7aw(2,E),O.$77w(70,0),O.$79w(10,0),O.$79w(20,0),O.$79w(30,0),O.$7aw(3,E),O.$7aw(1,""),O.$7aw(0,"ENDBLK"),O.$78w(5,w+1),O.$78w(330,V),O.$7aw(100,"AcDbEntity"),T&&O.$77w(67,1),O.$77w(8,0),O.$7aw(100,"AcDbBlockEnd")},H.prototype.$6dw=function(){var I=this;I.$78w(5,I._dxfHandleValue++)},H.prototype.$6ew=function(e,X,U,l){var b=this;b.$7aw(0,"DICTIONARY"),b.$7aw(5,e),"C"===X&&(b.$7aw(102,"{ACAD_REACTORS"),b.$7aw(330,X),b.$7aw(102,"}")),b.$7aw(330,X),b.$7aw(100,"AcDbDictionary"),U&&b.$77w(280,U),b.$77w(281,l)},H.prototype.$6fw=function(l,z){var X=this;for(var M in z){var L=z[M];X.$7aw(3,M),X.$7aw(l,L)}},H.prototype.$70w=function(){this.$68w("TABLES")},H.prototype.$71w=function(){this.$7aw(0,"ENDTAB")},H.prototype.$72w=function(){this.$68w("HEADER")},H.prototype.$73w=function(w,c,J){var L=this;L.$7aw(0,"LTYPE"),L.$77w(5,w),L.$77w(330,5),L.$7aw(100,"AcDbSymbolTableRecord"),L.$7aw(100,"AcDbLinetypeTableRecord"),L.$7aw(2,c),L.$77w(70,0),L.$77w(3,J||""),L.$77w(72,65),L.$77w(73,0),L.$79w(40,0)},H.prototype.$74w=function(){this.$7aw(0,"ENDSEC")},H.prototype.$75w=function(w,O,U){var a=this;a.$7aw(0,"TABLE"),a.$7aw(2,w),a.$77w(5,O),a.$77w(330,0),a.$7aw(100,"AcDbSymbolTable"),a.$77w(70,U)},H.prototype.$76w=function(s){this.$7aw(999,s)},H.prototype.$77w=function(H,h){return this.$7aw(H,h)},H.prototype.$78w=function(v,S){return this.$7aw(v,S.toString(16).toUpperCase())},H.prototype.$79w=function(L,I){return I=""+I,I.indexOf(".")<0&&(I+=".0"),this.$7aw(L,I)},H.prototype.$7aw=function(G,g){var u;u=10>G?"  ":100>G?" ":"",this._lineContents.push(u+G+"\n"+g)},H.prototype.$7bw=function(b){this._lineContents.push(b.join("\n"))},H.prototype.$7cw=function(u,U){var z=this;z.$79w(u,U.x),z.$79w(u+10,U.y),U.z!==e&&z.$79w(u+20,U.z)},H.prototype.$7dw=function(W){var q,h,m=this;for(q=0,h=W.length;h>q;q++)m.$7aw(0,"VERTEX"),m.$77w(8,0),m.$7cw(10,W[q])},H.prototype.$2cw=function(R){var U=this._matrix,q=R.x,f=R.y;return{x:U.a*q+U.c*f+U.tx,y:U.b*q+U.d*f+U.ty}},H.prototype.$2dw=function(V){for(var O=this,y=new Array(V.length),H=0,R=V.length;R>H;H++)y[H]=O.$2cw(V[H]);return y},H.prototype.$2ew=function(U){var f=this._matrix;return U*Math.sqrt(f.a*f.a+f.b*f.b)},H.prototype.$8bw=function(b){return 180*(b/Math.PI)}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);