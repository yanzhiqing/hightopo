!function(a){"use strict";function A(z){var B,n,C,p,V,_,S,Z=[],i=0;B=R.createDiv(!0);var Q=z.getView();Q.insertBefore(B,z.getCanvas()),n=w.Default.createDiv(),n.style.WebkitTransformStyle="preserve-3d",n.style.MozTransformStyle="preserve-3d",n.style.transformStyle="preserve-3d",B.appendChild(n),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(S){var g=S.style;Y.addEventListener(Q,S.event,function(){z.isDragProtectForWebView()&&(B.style.pointerEvents=g)})}),this.updateWebView=function(){if(z.getWidth()&&z.getHeight()){var Q=z.getCanvas(),L=1*Q.style.width.slice(0,-2),f=1*Q.style.height.slice(0,-2);(Z[0]!==L||Z[1]!==f)&&(Z[0]=L,Z[1]=f,B.style.width=L+"px",B.style.height=f+"px",n.style.width=L+"px",n.style.height=f+"px");var b=z._projectMatrix[5]*Z[1]/2;b!==C&&(C=b,B.style.WebkitPerspective=C+"px",B.style.MozPerspective=C+"px",B.style.perspective=C+"px"),_="translateZ("+C+"px)"+K(z._viewMatrix);var P=_+"translate("+Z[0]/2+"px,"+Z[1]/2+"px)";p===P||V||(n.style.WebkitTransform=P,n.style.MozTransform=P,n.style.transform=P,p=P),i++,S=!1,z.dm().each(function(l){l.isWebView&&k(l)});for(var $,t=n.children,Y=[],U=0,y=t.length;y>U;U++)$=t[U],$._isHtWebView&&$._renderCookie!==i&&Y.push($);Y.length&&Y.forEach(function(g){n.removeChild(g)})}};var g=new Array(16),k=function(I){var p=I.getAttach();if(p){var d=z.isVisible(I);if(d&&p.parentNode!==n?n.appendChild(p):!d&&p.parentNode&&R.removeHTML(p),d){p._renderCookie=i,S=!0;var b=I.getFinalScale3d(),c=I._prefrenceSize;c&&c[0]?c[1]||(c[1]=c[0]/b[0]*b[1]):c=[b[0],b[1]],p.style.width=c[0]+"px",p.style.height=c[1]+"px";var T=1/c[0],K=1/c[1],Y=1,w=I.mat;g[0]=w[0]*T,g[1]=w[1]*T,g[2]=w[2]*T,g[3]=w[3]*T,g[4]=w[4]*K,g[5]=w[5]*K,g[6]=w[6]*K,g[7]=w[7]*K,g[8]=w[8]*Y,g[9]=w[9]*Y,g[10]=w[10]*Y,g[11]=w[11]*Y,g[12]=w[12],g[13]=w[13],g[14]=w[14],g[15]=w[15];var q=M(g,V?"translate("+Z[0]/2+"px,"+Z[1]/2+"px)"+_:""),o=p.$a2;o!==q&&(p.$a2=q,p.style.WebkitTransform=q,p.style.MozTransform=q,p.style.transform=q)}}}}function c(u){return Math.abs(u)<1e-10?0:u}function K(K){var C=K;return"matrix3d("+c(C[0])+","+c(-C[1])+","+c(C[2])+","+c(C[3])+","+c(C[4])+","+c(-C[5])+","+c(C[6])+","+c(C[7])+","+c(C[8])+","+c(-C[9])+","+c(C[10])+","+c(C[11])+","+c(C[12])+","+c(-C[13])+","+c(C[14])+","+c(C[15])+")"}function M(K,x){var u=K,O="matrix3d("+c(u[0])+","+c(u[1])+","+c(u[2])+","+c(u[3])+","+c(-u[4])+","+c(-u[5])+","+c(-u[6])+","+c(-u[7])+","+c(u[8])+","+c(u[9])+","+c(u[10])+","+c(u[11])+","+c(u[12])+","+c(u[13])+","+c(u[14])+","+c(u[15])+")";return"translate(-50%,-50%)"+(x||"")+O}var z="ht",w=a[z],R=w.Default,Y=R.getInternal(),P=Y.superCall,l=w.graph3d.Graph3dView,k=l.prototype.validateImpl;l.prototype.validateImpl=function(){k.call(this);var s=this._webViewRenderer;s||(s=this._webViewRenderer=new A(this)),s.updateWebView()},l.prototype.isDragProtectForWebView=function(){return this._dragProtectForWebView},l.prototype.setDragProtectForWebView=function(f){this._dragProtectForWebView=f};var y=w.WebView3d=function(){var f=this;P(y,f),f.s({shape3d:"billboard","shape3d.reverse.flip":!0})},n=[1,1,1,1],f=[0,0,0,0];R.def(z+"."+"WebView3d",w.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(G,p,Y){if(!G)return this.detachDOM();if("string"==typeof G){var S=document.createElement("iframe");S.src=G,G=S}var W=G.style;W.position="absolute",W.border=0,W.outline=0,W.padding=0,W.margin=0,G._isHtWebView=!0,this.setAttach(G),this._prefrenceSize=[p,Y],this.s("shape3d.blend",f)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(M){this.a("defaultBgColor",M),this.getAttach()||this.s("shape3d.blend",M)},getBgColor:function(){return this.a("defaultBgColor")||n}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);