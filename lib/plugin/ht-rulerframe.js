!function(N,L){"use strict";var C="position",U="absolute",W="relative",v="px",x="left",G="right",S="top",B="bottom",k="display",n="none",o="block",Z=ht.Default,p=Z.getInternal(),q=Math.floor,I=Math.ceil,b=Math.PI,X=null,e=N.parseInt,a=function(c){return c.getContext("2d")},E=function(){return document},A=function(D){return E().createElement(D)},V=function(){return A("canvas")},R=function(j,S,N){j.style.setProperty(S,N,X)},$=function(y,u,N){Z.def(ht.widget[y],u,N)},O=function(B,m){B.appendChild(m)},m=function(F,q){F.removeChild(q)},Y=Z.eventListenerOptionsFalse,t=(Z.eventListenerOptionsTrue,function(B,e,z,s){B.addEventListener(e,z,s?Y:Y)}),Q=function(V,M,T,C){V.removeEventListener(M,T,C?Y:Y)};ht.widget.RulerFrame=function(A){var s=this,J=s._view=p.createView(null,s),$=s.$1k=V(),c=s.$2k=V(),I=s.$3k=V(),D=s.$4k=V();s._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},s._topRulerConfig={visible:!0},s._rightRulerConfig={visible:!1},s._bottomRulerConfig={visible:!1},s._leftRulerConfig={visible:!0},O(J,$),O(J,I),O(J,c),O(J,D),R(J,C,W),R(J,"box-sizing","border-box"),R(J,"-moz-box-sizing","border-box"),R($,C,U),R(c,C,U),R(I,C,U),R(D,C,U),s.$14k=function(){s.$13k=1,s.iv()},s.$15k=function(C){if(s._topRulerConfig.guideVisible||s._rightRulerConfig.guideVisible||s._bottomRulerConfig.guideVisible||s._leftRulerConfig.guideVisible||s._defaultRulerConfig.guideVisible||(s._topRulerConfig.guideTipVisible||s._rightRulerConfig.guideTipVisible||s._bottomRulerConfig.guideTipVisible||s._leftRulerConfig.guideTipVisible||s._defaultRulerConfig.guideTipVisible)&&s._component){var Q=J.getBoundingClientRect();s.$16k={x:C.clientX-Q.left,y:C.clientY-Q.top},s.$5k()}},s.setComponent(A)},$("RulerFrame",L,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(l){var M=this,X=M._component,c=M.getView();if(c){if(M._component=l,M.fp("component",X,l),X){var G=M.getComponentView(X);m(c,G),Q(c,"mousemove",M.$15k),M.removeComponentPropertyChangeListener(X,M.$14k)}if(l){var r=M.getComponentView(l);O(c,r),R(r,C,U),t(c,"mousemove",M.$15k),M.addComponentPropertyChangeListener(l,M.$14k)}}},addComponentPropertyChangeListener:function(K,s){K&&K.mp&&K.mp(s)},removeComponentPropertyChangeListener:function(C,y){C&&C.ump&&C.ump(y)},getComponentHZoom:function(L){return L&&L.getZoom?L.getZoom():1},getComponentVZoom:function(z){return z&&z.getZoom?z.getZoom():1},getComponentViewRect:function(k){return k&&k.getViewRect?k.getViewRect():void 0},getComponentView:function(C){return C&&C.getView?C.getView():C},invalidateComponent:function(Q){Q&&Q.iv&&Q.iv()},validateComponent:function(j){j&&j.validate&&j.validate()},$7k:function(b,Z,j,y,D,g,N,s,m,i,u,K){if(Z.visible){var t=this._defaultRulerConfig,M="borderStyle",I="borderColor",d="borderWidth",c="background",U=Z[M]||t[M],q=Z[I]||t[I],l=Z[d]||t[d],P=Z.size!=X?Z.size:t.size,B=Z[c]||t[c],Q=P+l,J=this.$6k(l,U,q,b,j,D,Q,N,s,m,i,u,K);R(b,D,"0px"),g?p.setCanvas(b,y-J,P):p.setCanvas(b,P,y-J),R(b,"background",B),R(b,k,o)}else R(b,k,n),R(this.getComponentView(this._component),D,"0px")},$6k:function(j,F,N,V,m,G,o,S,h,B,p,C,K){var $=0;return R(V,m,j+"px "+F+" "+N),R(this.getComponentView(this._component),G,o+v),S?(R(V,h,B+v),$+=B):R(V,h,"0px"),p?(R(V,C,K+v),$+=K):R(V,C,"0px"),$},validateImpl:function(){var d=this,e=d._component,Z=d.$1k,b=d.$2k,r=d.$3k,A=d.$4k,s=d._view,F=d._defaultRulerConfig,p=d._topRulerConfig,Y=d._rightRulerConfig,J=d._bottomRulerConfig,N=d._leftRulerConfig,o=F.size;if(s&&e){var H=p.size!=X?p.size:o,V=Y.size!=X?Y.size:o,v=J.size!=X?J.size:o,z=N.size!=X?N.size:o;d.$7k(Z,p,"border-bottom",s.offsetWidth,S,!0,N.visible,x,z,Y.visible,G,V),d.$7k(b,Y,"border-left",s.offsetHeight,G,!1,p.visible,S,H,J.visible,B,v),d.$7k(r,J,"border-top",s.offsetWidth,B,!0,N.visible,x,z,Y.visible,G,V),d.$7k(A,N,"border-right",s.offsetHeight,x,!1,p.visible,S,H,J.visible,B,v),d.$13k?delete d.$13k:d.invalidateComponent(e),d.validateComponent(e),d.$5k()}},$5k:function(){function F(x,A,J,K,b,d){if(A.visible){var p=a(x),j=A[v]||O,z=A[C]!=X?A[C]:m,s=A[U]||L,F=A[I]||t,e=A.size!=X?A.size:T,Rr=A[q]||r,kr=A[V]||D,cr=A[M]||B,Se=A[N]!=X?A[N]:f,Tc=A[W]!=X?A[W]:k,uh=A[i]!=X?A[i]:H,nr=A[n]!=X?A[n]:Q,jo=A[w]!=X?A[w]:h,ig=A[l]!=X?A[l]:o,wg=A[S]||ip,Fl=A[E]||Lp;z&&(j=R[d]=R.$8k(R[d]||j,A[g]||$,A[Y]||G,K?u:Z,kr)),J.call(R,p,y,c,P,_,e,K?u:Z,j,s,F,b,Rr,cr);var Dd=R.$16k;(Se||Tc)&&Dd&&(K?R.$9k(p,Dd.x,e,wg,Fl,Se,Tc,uh,nr,jo,ig):R.$10k(p,Dd.y,e,wg,Fl,Se,Tc,uh,nr,jo,ig,b))}}var R=this,p=R.$1k,J=R.$2k,b=R.$3k,x=R.$4k,j=R._topRulerConfig,s=R._rightRulerConfig,A=R._bottomRulerConfig,z=R._leftRulerConfig,K=R._defaultRulerConfig,e=R._component,d=R.getComponentViewRect(e),u=R.getComponentHZoom(e),Z=R.getComponentVZoom(e),y=d.x*u,P=y+d.width*u,c=d.y*Z,_=c+d.height*Z,T=R._defaultRulerConfig.size,v="defaultMajorTickSpacing",g="maxPhysicalMajorTickSpacing",Y="minPhysicalMajorTickSpacing",C="tickSpacingAdaptable",U="majorTickTextFont",I="majorTickTextColor",q="majorTickColor",M="minorTickColor",N="guideVisible",W="guideTipVisible",i="guideTipBorderColor",n="guideTipTextColor",w="guideTipTextFont",l="guideTipBackground",S="guideColor",E="guideWidth",V="minMajorTickSpacing",O=K[v],$=K[g],G=K[Y],m=K[C],L=K[U],t=K[I],r=K[q],D=K[V],B=K[M],f=K[N],k=K[W],H=K[i],Q=K[n],h=K[w],o=K[l],ip=K[S],Lp=K[E];R._view&&e&&(F(p,j,R.$11k,!0,!1,"_currentTopMajorTickSpacing"),F(J,s,R.$12k,!1,!0,"_currentRightMajorTickSpacing"),F(b,A,R.$11k,!0,!0,"_currentBottomMajorTickSpacing"),F(x,z,R.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(a,H,t,N,n){return t>a*N?a=q(H/N/n)*n:a*N>H&&(a=I(t/N/n)*n),a},getHTipText:function(c){var P=this,s=P._component,a=0,R=P._view.getBoundingClientRect();return s.lp?a=e(s.lp({x:c.x+R.left,y:c.y}).x):a-=e(this.getComponentView(s).style.left)||0,a},$9k:function(m,C,_,h,F,T,P,i,n,l,W){var y=this,v=y._component;m.save(),p.translateAndScale(m,0,0,1);var D=C-(e(this.getComponentView(v).style.left)||0),r=0;if(C=y.getHTipText(y.$16k),T&&(m.beginPath(),m.fillStyle=h,m.rect(D,r,F,_),m.fill()),P){m.beginPath(),m.textAlign="center",m.textBaseline="middle",m.font=l;var X=m.measureText(C).width+6;m.fillStyle=W,m.rect(D-X/2,r,X,_),m.fill(),m.strokeStyle=i,m.stroke(),m.beginPath(),m.fillStyle=n,m.fillText(C,D,r+_/2)}m.restore()},getVTipText:function(G){var q=this,T=q._component,o=0,U=q._view.getBoundingClientRect();return T.lp?o=e(T.lp({x:G.x,y:G.y+U.top}).y):o-=e(this.getComponentView(T).style.top)||0,o},formatScaleText:function(s){return Math.round(s)},$10k:function(W,$,o,q,j,l,z,H,L,I,B,M){var n=this,J=n._component;W.save(),p.translateAndScale(W,0,0,1);var d=o/2,E=$-(e(this.getComponentView(J).style.top)||0);if($=n.getVTipText(n.$16k),l&&(W.beginPath(),W.fillStyle=q,W.rect(d-o/2,E,o,j),W.fill()),z){W.translate(d,E),W.rotate((M?90:-90)*b/180),W.translate(-d,-E),W.beginPath(),W.textAlign="center",W.textBaseline="middle",W.font=I;var U=W.measureText($).width+6;W.fillStyle=B,W.rect(d-U/2,E-o/2,U,o),W.fill(),W.strokeStyle=H,W.stroke(),W.fillStyle=L,W.fillText($,d,E)}W.restore()},$11k:function(m,A,$,c,a,C,t,F,g,P,S,Q,u){m.save(),$=0;var x=A,w=c,W=(x+w)/2;A=0,c=w-x,p.translateAndScale(m,0,0,1);var K=0,Y=0,s=e(C/2),B=C-s,Z=S?0:s,d=F*t,j=d/10;A-=d,c+=d,m.clearRect(A,0,c-A,C),m.beginPath(),m.fillStyle=u;var R=q(W/j)*j-x;for(K=R;c>K;K+=j)m.rect(K,$+Z,1,B);for(K=R;K>A;K-=j)m.rect(K,$+Z,1,B);for(m.fill(),Z=S?0:1,m.beginPath(),m.fillStyle=Q,R=q(W/d)*d-x,K=R;c>K;K+=d)m.rect(K,$+Z,1,C-1);for(K=R;K>A;K-=d)m.rect(K,$+Z,1,C-1);m.fill();var O=e(/\d+px/.exec(g)[0]),D=(O||10)/2;m.textBaseline="middle",Z=S?C-D-2:D+2,m.beginPath(),m.fillStyle=P,m.font=g;var U=q(W/d)*d/t;for(K=R,Y=U;c>K;K+=d,Y+=F){var v=this.getHScaleText?this.getHScaleText(K):Y;m.fillText(this.formatScaleText(v),K+2,$+Z)}for(K=R,Y=U;K>A;K-=d,Y-=F){var v=this.getHScaleText?this.getHScaleText(K):Y;m.fillText(this.formatScaleText(v),K+2,$+Z)}m.restore()},$12k:function(s,L,j,r,I,T,C,N,f,n,D,d,l){function J(h,j,N,b,d,f){d=o.getVScaleText?o.getVScaleText(N):d,d=o.formatScaleText(d),s.translate(h+j,N),s.rotate(-b),s.translate(-h-j,-N),s.fillText(d,h+j+(f?2:1),N),s.translate(h+j,N),s.rotate(b),s.translate(-h-j,-N)}s.save(),L=0;var U=j,$=I,A=(U+$)/2;j=0,I=$-U,p.translateAndScale(s,0,0,1);var B=0,o=this,k=0,Y=e(T/2),V=T-Y,m=D?0:Y,S=N*C,Q=S/10;j-=S,I+=S,s.clearRect(L,0,T,I-j),s.beginPath(),s.fillStyle=l;var x=q(A/Q)*Q-U;for(B=x;I>B;B+=Q)s.rect(L+m,B,V,1);for(B=x;B>j;B-=Q)s.rect(L+m,B,V,1);for(s.fill(),m=D?0:1,s.beginPath(),s.fillStyle=d,x=q(A/S)*S-U,B=x;I>B;B+=S)s.rect(L+m,B,T-1,1);for(B=x;B>j;B-=S)s.rect(L+m,B,T-1,1);s.fill();var O=e(/\d+px/.exec(f)[0]),i=(O||10)/2,y=90*b/180;s.textBaseline="middle",m=D?T-i:i+2,y=D?-y:y,s.beginPath(),s.fillStyle=n,s.font=f;var R=q(A/S)*S/C;for(B=x,k=R;I>B;B+=S,k+=N)J(L,m,B,y,k,D);for(B=x,k=R;B>j;B-=S,k-=N)J(L,m,B,y,k,D);s.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var l=this,d=l._component,_=l._view;d&&l.removeComponentPropertyChangeListener(d,l.$14k),_&&(Q(_,"mousemove",l.$15k),m(_.parentNode,_),l._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);