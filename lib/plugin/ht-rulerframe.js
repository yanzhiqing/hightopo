!function(q,X){"use strict";var d="position",I="absolute",a="relative",g="px",h="left",E="right",o="top",K="bottom",J="display",j="none",l="block",F=ht.Default,i=F.getInternal(),G=Math.floor,H=Math.ceil,n=Math.PI,z=null,u=q.parseInt,Y=function(q){return q.getContext("2d")},$=function(){return document},m=function(c){return $().createElement(c)},b=function(){return m("canvas")},p=function(A,M,s){A.style.setProperty(M,s,z)},v=function(K,P,M){F.def(ht.widget[K],P,M)},x=function(C,R){C.appendChild(R)},D=function(V,s){V.removeChild(s)},i=F.getInternal(),e=i.addEventListener,B=i.removeEventListener;ht.widget.RulerFrame=function(E){var N=this,Q=N._view=i.createView(null,N),A=N.$1k=b(),D=N.$2k=b(),k=N.$3k=b(),K=N.$4k=b();N._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},N._topRulerConfig={visible:!0},N._rightRulerConfig={visible:!1},N._bottomRulerConfig={visible:!1},N._leftRulerConfig={visible:!0},x(Q,A),x(Q,k),x(Q,D),x(Q,K),p(Q,d,a),p(Q,"box-sizing","border-box"),p(Q,"-moz-box-sizing","border-box"),p(A,d,I),p(D,d,I),p(k,d,I),p(K,d,I),N.$14k=function(){N.$13k=1,N.iv()},N.$15k=function(J){if(N._topRulerConfig.guideVisible||N._rightRulerConfig.guideVisible||N._bottomRulerConfig.guideVisible||N._leftRulerConfig.guideVisible||N._defaultRulerConfig.guideVisible||(N._topRulerConfig.guideTipVisible||N._rightRulerConfig.guideTipVisible||N._bottomRulerConfig.guideTipVisible||N._leftRulerConfig.guideTipVisible||N._defaultRulerConfig.guideTipVisible)&&N._component){var A=Q.getBoundingClientRect();N.$16k={x:J.clientX-A.left,y:J.clientY-A.top},N.$5k()}},N.setComponent(E)},v("RulerFrame",X,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(X){var J=this,Z=J._component,W=J.getView();if(W){if(J._component=X,J.fp("component",Z,X),Z){var z=J.getComponentView(Z);D(W,z),B(W,"mousemove",J.$15k),J.removeComponentPropertyChangeListener(Z,J.$14k)}if(X){var C=J.getComponentView(X);x(W,C),p(C,d,I),e(W,"mousemove",J.$15k),J.addComponentPropertyChangeListener(X,J.$14k)}}},addComponentPropertyChangeListener:function(F,l){F&&F.mp&&F.mp(l)},removeComponentPropertyChangeListener:function(Q,v){Q&&Q.ump&&Q.ump(v)},getComponentHZoom:function(m){return m&&m.getZoom?m.getZoom():1},getComponentVZoom:function(x){return x&&x.getZoom?x.getZoom():1},getComponentViewRect:function(X){return X&&X.getViewRect?X.getViewRect():void 0},getComponentView:function(K){return K&&K.getView?K.getView():K},invalidateComponent:function(o){o&&o.iv&&o.iv()},validateComponent:function(H){H&&H.validate&&H.validate()},$7k:function(v,E,L,I,m,T,q,R,U,_,t,B){if(E.visible){var Y=this._defaultRulerConfig,O="borderStyle",d="borderColor",r="borderWidth",G="background",a=E[O]||Y[O],P=E[d]||Y[d],F=E[r]||Y[r],o=E.size!=z?E.size:Y.size,e=E[G]||Y[G],x=o+F,Q=this.$6k(F,a,P,v,L,m,x,q,R,U,_,t,B);p(v,m,"0px"),T?i.setCanvas(v,I-Q,o):i.setCanvas(v,o,I-Q),p(v,"background",e),p(v,J,l)}else p(v,J,j),p(this.getComponentView(this._component),m,"0px")},$6k:function(b,I,r,M,e,N,U,m,l,Q,J,C,z){var $=0;return p(M,e,b+"px "+I+" "+r),p(this.getComponentView(this._component),N,U+g),m?(p(M,l,Q+g),$+=Q):p(M,l,"0px"),J?(p(M,C,z+g),$+=z):p(M,C,"0px"),$},validateImpl:function(){var R=this,s=R._component,J=R.$1k,t=R.$2k,i=R.$3k,n=R.$4k,_=R._view,C=R._defaultRulerConfig,Y=R._topRulerConfig,b=R._rightRulerConfig,f=R._bottomRulerConfig,r=R._leftRulerConfig,w=C.size;if(_&&s){var Z=Y.size!=z?Y.size:w,k=b.size!=z?b.size:w,l=f.size!=z?f.size:w,x=r.size!=z?r.size:w;R.$7k(J,Y,"border-bottom",_.offsetWidth,o,!0,r.visible,h,x,b.visible,E,k),R.$7k(t,b,"border-left",_.offsetHeight,E,!1,Y.visible,o,Z,f.visible,K,l),R.$7k(i,f,"border-top",_.offsetWidth,K,!0,r.visible,h,x,b.visible,E,k),R.$7k(n,r,"border-right",_.offsetHeight,h,!1,Y.visible,o,Z,f.visible,K,l),R.$13k?delete R.$13k:R.invalidateComponent(s),R.validateComponent(s),R.$5k()}},$5k:function(){function E(r,U,o,K,y,T){if(U.visible){var E=Y(r),Q=U[M]||p,m=U[L]!=z?U[L]:d,b=U[u]||_,g=U[O]||x,J=U.size!=z?U.size:B,no=U[W]||h,Dr=U[V]||F,_d=U[I]||G,Ej=U[i]!=z?U[i]:e,tg=U[R]!=z?U[R]:t,Td=U[D]!=z?U[D]:n,Nk=U[v]!=z?U[v]:C,Jb=U[S]!=z?U[S]:a,sg=U[Z]!=z?U[Z]:k,eq=U[P]||am,bn=U[l]||bl;m&&(Q=$[T]=$.$8k($[T]||Q,U[w]||s,U[X]||A,K?H:c,Dr)),o.call($,E,j,N,q,f,J,K?H:c,Q,b,g,y,no,_d);var _o=$.$16k;(Ej||tg)&&_o&&(K?$.$9k(E,_o.x,J,eq,bn,Ej,tg,Td,Nk,Jb,sg):$.$10k(E,_o.y,J,eq,bn,Ej,tg,Td,Nk,Jb,sg,y))}}var $=this,U=$.$1k,m=$.$2k,K=$.$3k,b=$.$4k,T=$._topRulerConfig,o=$._rightRulerConfig,g=$._bottomRulerConfig,r=$._leftRulerConfig,y=$._defaultRulerConfig,J=$._component,Q=$.getComponentViewRect(J),H=$.getComponentHZoom(J),c=$.getComponentVZoom(J),j=Q.x*H,q=j+Q.width*H,N=Q.y*c,f=N+Q.height*c,B=$._defaultRulerConfig.size,M="defaultMajorTickSpacing",w="maxPhysicalMajorTickSpacing",X="minPhysicalMajorTickSpacing",L="tickSpacingAdaptable",u="majorTickTextFont",O="majorTickTextColor",W="majorTickColor",I="minorTickColor",i="guideVisible",R="guideTipVisible",D="guideTipBorderColor",v="guideTipTextColor",S="guideTipTextFont",Z="guideTipBackground",P="guideColor",l="guideWidth",V="minMajorTickSpacing",p=y[M],s=y[w],A=y[X],d=y[L],_=y[u],x=y[O],h=y[W],F=y[V],G=y[I],e=y[i],t=y[R],n=y[D],C=y[v],a=y[S],k=y[Z],am=y[P],bl=y[l];$._view&&J&&(E(U,T,$.$11k,!0,!1,"_currentTopMajorTickSpacing"),E(m,o,$.$12k,!1,!0,"_currentRightMajorTickSpacing"),E(K,g,$.$11k,!0,!0,"_currentBottomMajorTickSpacing"),E(b,r,$.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(B,C,R,g,Z){return R>B*g?B=G(C/g/Z)*Z:B*g>C&&(B=H(R/g/Z)*Z),B},getHTipText:function(W){var Q=this,T=Q._component,d=0,F=Q._view.getBoundingClientRect();return T.lp?d=u(T.lp({x:W.x+F.left,y:W.y}).x):d-=u(this.getComponentView(T).style.left)||0,d},$9k:function(z,H,B,E,S,m,o,a,F,p,r){var l=this,n=l._component;z.save(),i.translateAndScale(z,0,0,1);var O=H-(u(this.getComponentView(n).style.left)||0),W=0;if(H=l.getHTipText(l.$16k),m&&(z.beginPath(),z.fillStyle=E,z.rect(O,W,S,B),z.fill()),o){z.beginPath(),z.textAlign="center",z.textBaseline="middle",z.font=p;var X=z.measureText(H).width+6;z.fillStyle=r,z.rect(O-X/2,W,X,B),z.fill(),z.strokeStyle=a,z.stroke(),z.beginPath(),z.fillStyle=F,z.fillText(H,O,W+B/2)}z.restore()},getVTipText:function(B){var x=this,q=x._component,n=0,J=x._view.getBoundingClientRect();return q.lp?n=u(q.lp({x:B.x,y:B.y+J.top}).y):n-=u(this.getComponentView(q).style.top)||0,n},formatScaleText:function(M){return Math.round(M)},$10k:function(w,H,R,r,h,b,d,m,T,g,I,v){var L=this,s=L._component;w.save(),i.translateAndScale(w,0,0,1);var Q=R/2,f=H-(u(this.getComponentView(s).style.top)||0);if(H=L.getVTipText(L.$16k),b&&(w.beginPath(),w.fillStyle=r,w.rect(Q-R/2,f,R,h),w.fill()),d){w.translate(Q,f),w.rotate((v?90:-90)*n/180),w.translate(-Q,-f),w.beginPath(),w.textAlign="center",w.textBaseline="middle",w.font=g;var y=w.measureText(H).width+6;w.fillStyle=I,w.rect(Q-y/2,f-R/2,y,R),w.fill(),w.strokeStyle=m,w.stroke(),w.fillStyle=T,w.fillText(H,Q,f)}w.restore()},$11k:function(q,K,U,B,R,W,E,c,$,L,l,p,N){q.save(),U=0;var P=K,g=B,m=(P+g)/2;K=0,B=g-P,i.translateAndScale(q,0,0,1);var h=0,k=0,I=u(W/2),X=W-I,j=l?0:I,J=c*E,Z=J/10;K-=J,B+=J,q.clearRect(K,0,B-K,W),q.beginPath(),q.fillStyle=N;var Q=G(m/Z)*Z-P;for(h=Q;B>h;h+=Z)q.rect(h,U+j,1,X);for(h=Q;h>K;h-=Z)q.rect(h,U+j,1,X);for(q.fill(),j=l?0:1,q.beginPath(),q.fillStyle=p,Q=G(m/J)*J-P,h=Q;B>h;h+=J)q.rect(h,U+j,1,W-1);for(h=Q;h>K;h-=J)q.rect(h,U+j,1,W-1);q.fill();var x=u(/\d+px/.exec($)[0]),_=(x||10)/2;q.textBaseline="middle",j=l?W-_-2:_+2,q.beginPath(),q.fillStyle=L,q.font=$;var O=G(m/J)*J/E;for(h=Q,k=O;B>h;h+=J,k+=c){var y=this.getHScaleText?this.getHScaleText(h):k;q.fillText(this.formatScaleText(y),h+2,U+j)}for(h=Q,k=O;h>K;h-=J,k-=c){var y=this.getHScaleText?this.getHScaleText(h):k;q.fillText(this.formatScaleText(y),h+2,U+j)}q.restore()},$12k:function(g,A,F,B,y,X,Y,k,p,N,K,J,d){function C(P,k,p,Y,Z,j){Z=V.getVScaleText?V.getVScaleText(p):Z,Z=V.formatScaleText(Z),g.translate(P+k,p),g.rotate(-Y),g.translate(-P-k,-p),g.fillText(Z,P+k+(j?2:1),p),g.translate(P+k,p),g.rotate(Y),g.translate(-P-k,-p)}g.save(),A=0;var e=F,U=y,I=(e+U)/2;F=0,y=U-e,i.translateAndScale(g,0,0,1);var c=0,V=this,l=0,j=u(X/2),x=X-j,_=K?0:j,T=k*Y,W=T/10;F-=T,y+=T,g.clearRect(A,0,X,y-F),g.beginPath(),g.fillStyle=d;var E=G(I/W)*W-e;for(c=E;y>c;c+=W)g.rect(A+_,c,x,1);for(c=E;c>F;c-=W)g.rect(A+_,c,x,1);for(g.fill(),_=K?0:1,g.beginPath(),g.fillStyle=J,E=G(I/T)*T-e,c=E;y>c;c+=T)g.rect(A+_,c,X-1,1);for(c=E;c>F;c-=T)g.rect(A+_,c,X-1,1);g.fill();var b=u(/\d+px/.exec(p)[0]),M=(b||10)/2,o=90*n/180;g.textBaseline="middle",_=K?X-M:M+2,o=K?-o:o,g.beginPath(),g.fillStyle=N,g.font=p;var $=G(I/T)*T/Y;for(c=E,l=$;y>c;c+=T,l+=k)C(A,_,c,o,l,K);for(c=E,l=$;c>F;c-=T,l-=k)C(A,_,c,o,l,K);g.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var f=this,E=f._component,C=f._view;E&&f.removeComponentPropertyChangeListener(E,f.$14k),C&&(B(C,"mousemove",f.$15k),D(C.parentNode,C),f._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);